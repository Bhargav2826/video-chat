/*! For license information please see main.9ecc0e3a.js.LICENSE.txt */
(()=>{"use strict";var e={4:(e,t,n)=>{var i=n(853),r=n(43),o=n(950);function a(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function c(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function l(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function u(e){if(31===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function d(e){if(c(e)!==e)throw Error(a(188))}function h(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e;for(e=e.child;null!==e;){if(null!==(t=h(e)))return t;e=e.sibling}return null}var p=Object.assign,f=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),g=Symbol.for("react.portal"),v=Symbol.for("react.fragment"),y=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),S=Symbol.for("react.context"),w=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),C=Symbol.for("react.suspense_list"),E=Symbol.for("react.memo"),P=Symbol.for("react.lazy");Symbol.for("react.scope");var R=Symbol.for("react.activity");Symbol.for("react.legacy_hidden"),Symbol.for("react.tracing_marker");var _=Symbol.for("react.memo_cache_sentinel");Symbol.for("react.view_transition");var O=Symbol.iterator;function x(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var I=Symbol.for("react.client.reference");function N(e){if(null==e)return null;if("function"===typeof e)return e.$$typeof===I?null:e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case v:return"Fragment";case b:return"Profiler";case y:return"StrictMode";case T:return"Suspense";case C:return"SuspenseList";case R:return"Activity"}if("object"===typeof e)switch(e.$$typeof){case g:return"Portal";case S:return e.displayName||"Context";case k:return(e._context.displayName||"Context")+".Consumer";case w:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case E:return null!==(t=e.displayName||null)?t:N(e.type)||"Memo";case P:t=e._payload,e=e._init;try{return N(e(t))}catch(n){}}return null}var A=Array.isArray,D=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L=o.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,M={pending:!1,data:null,method:null,action:null},j=[],U=-1;function F(e){return{current:e}}function B(e){0>U||(e.current=j[U],j[U]=null,U--)}function z(e,t){U++,j[U]=e.current,e.current=t}var q,V,H=F(null),W=F(null),K=F(null),G=F(null);function J(e,t){switch(z(K,t),z(W,e),z(H,null),t.nodeType){case 9:case 11:e=(e=t.documentElement)&&(e=e.namespaceURI)?yd(e):0;break;default:if(e=t.tagName,t=t.namespaceURI)e=bd(t=yd(t),e);else switch(e){case"svg":e=1;break;case"math":e=2;break;default:e=0}}B(H),z(H,e)}function Q(){B(H),B(W),B(K)}function $(e){null!==e.memoizedState&&z(G,e);var t=H.current,n=bd(t,e.type);t!==n&&(z(W,e),z(H,n))}function Y(e){W.current===e&&(B(H),B(W)),G.current===e&&(B(G),dh._currentValue=M)}function X(e){if(void 0===q)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);q=t&&t[1]||"",V=-1<n.stack.indexOf("\n    at")?" (<anonymous>)":-1<n.stack.indexOf("@")?"@unknown:0:0":""}return"\n"+q+e+V}var Z=!1;function ee(e,t){if(!e||Z)return"";Z=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var i={DetermineComponentFrameRoot:function(){try{if(t){var n=function(){throw Error()};if(Object.defineProperty(n.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(n,[])}catch(r){var i=r}Reflect.construct(e,[],n)}else{try{n.call()}catch(o){i=o}e.call(n.prototype)}}else{try{throw Error()}catch(a){i=a}(n=e())&&"function"===typeof n.catch&&n.catch(function(){})}}catch(s){if(s&&i&&"string"===typeof s.stack)return[s.stack,i.stack]}return[null,null]}};i.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var r=Object.getOwnPropertyDescriptor(i.DetermineComponentFrameRoot,"name");r&&r.configurable&&Object.defineProperty(i.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var o=i.DetermineComponentFrameRoot(),a=o[0],s=o[1];if(a&&s){var c=a.split("\n"),l=s.split("\n");for(r=i=0;i<c.length&&!c[i].includes("DetermineComponentFrameRoot");)i++;for(;r<l.length&&!l[r].includes("DetermineComponentFrameRoot");)r++;if(i===c.length||r===l.length)for(i=c.length-1,r=l.length-1;1<=i&&0<=r&&c[i]!==l[r];)r--;for(;1<=i&&0<=r;i--,r--)if(c[i]!==l[r]){if(1!==i||1!==r)do{if(i--,0>--r||c[i]!==l[r]){var u="\n"+c[i].replace(" at new "," at ");return e.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",e.displayName)),u}}while(1<=i&&0<=r);break}}}finally{Z=!1,Error.prepareStackTrace=n}return(n=e?e.displayName||e.name:"")?X(n):""}function te(e,t){switch(e.tag){case 26:case 27:case 5:return X(e.type);case 16:return X("Lazy");case 13:return e.child!==t&&null!==t?X("Suspense Fallback"):X("Suspense");case 19:return X("SuspenseList");case 0:case 15:return ee(e.type,!1);case 11:return ee(e.type.render,!1);case 1:return ee(e.type,!0);case 31:return X("Activity");default:return""}}function ne(e){try{var t="",n=null;do{t+=te(e,n),n=e,e=e.return}while(e);return t}catch(i){return"\nError generating stack: "+i.message+"\n"+i.stack}}var ie=Object.prototype.hasOwnProperty,re=i.unstable_scheduleCallback,oe=i.unstable_cancelCallback,ae=i.unstable_shouldYield,se=i.unstable_requestPaint,ce=i.unstable_now,le=i.unstable_getCurrentPriorityLevel,ue=i.unstable_ImmediatePriority,de=i.unstable_UserBlockingPriority,he=i.unstable_NormalPriority,pe=i.unstable_LowPriority,fe=i.unstable_IdlePriority,me=i.log,ge=i.unstable_setDisableYieldValue,ve=null,ye=null;function be(e){if("function"===typeof me&&ge(e),ye&&"function"===typeof ye.setStrictMode)try{ye.setStrictMode(ve,e)}catch(t){}}var ke=Math.clz32?Math.clz32:function(e){return 0===(e>>>=0)?32:31-(Se(e)/we|0)|0},Se=Math.log,we=Math.LN2;var Te=256,Ce=262144,Ee=4194304;function Pe(e){var t=42&e;if(0!==t)return t;switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return 261888&e;case 262144:case 524288:case 1048576:case 2097152:return 3932160&e;case 4194304:case 8388608:case 16777216:case 33554432:return 62914560&e;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return e}}function Re(e,t,n){var i=e.pendingLanes;if(0===i)return 0;var r=0,o=e.suspendedLanes,a=e.pingedLanes;e=e.warmLanes;var s=134217727&i;return 0!==s?0!==(i=s&~o)?r=Pe(i):0!==(a&=s)?r=Pe(a):n||0!==(n=s&~e)&&(r=Pe(n)):0!==(s=i&~o)?r=Pe(s):0!==a?r=Pe(a):n||0!==(n=i&~e)&&(r=Pe(n)),0===r?0:0!==t&&t!==r&&0===(t&o)&&((o=r&-r)>=(n=t&-t)||32===o&&0!==(4194048&n))?t:r}function _e(e,t){return 0===(e.pendingLanes&~(e.suspendedLanes&~e.pingedLanes)&t)}function Oe(e,t){switch(e){case 1:case 2:case 4:case 8:case 64:return t+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function xe(){var e=Ee;return 0===(62914560&(Ee<<=1))&&(Ee=4194304),e}function Ie(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Ne(e,t){e.pendingLanes|=t,268435456!==t&&(e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0)}function Ae(e,t,n){e.pendingLanes|=t,e.suspendedLanes&=~t;var i=31-ke(t);e.entangledLanes|=t,e.entanglements[i]=1073741824|e.entanglements[i]|261930&n}function De(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var i=31-ke(n),r=1<<i;r&t|e[i]&t&&(e[i]|=t),n&=~r}}function Le(e,t){var n=t&-t;return 0!==((n=0!==(42&n)?1:Me(n))&(e.suspendedLanes|t))?0:n}function Me(e){switch(e){case 2:e=1;break;case 8:e=4;break;case 32:e=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:e=128;break;case 268435456:e=134217728;break;default:e=0}return e}function je(e){return 2<(e&=-e)?8<e?0!==(134217727&e)?32:268435456:8:2}function Ue(){var e=L.p;return 0!==e?e:void 0===(e=window.event)?32:Rh(e.type)}function Fe(e,t){var n=L.p;try{return L.p=e,t()}finally{L.p=n}}var Be=Math.random().toString(36).slice(2),ze="__reactFiber$"+Be,qe="__reactProps$"+Be,Ve="__reactContainer$"+Be,He="__reactEvents$"+Be,We="__reactListeners$"+Be,Ke="__reactHandles$"+Be,Ge="__reactResources$"+Be,Je="__reactMarker$"+Be;function Qe(e){delete e[ze],delete e[qe],delete e[He],delete e[We],delete e[Ke]}function $e(e){var t=e[ze];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Ve]||n[ze]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=jd(e);null!==e;){if(n=e[ze])return n;e=jd(e)}return t}n=(e=n).parentNode}return null}function Ye(e){if(e=e[ze]||e[Ve]){var t=e.tag;if(5===t||6===t||13===t||31===t||26===t||27===t||3===t)return e}return null}function Xe(e){var t=e.tag;if(5===t||26===t||27===t||6===t)return e.stateNode;throw Error(a(33))}function Ze(e){var t=e[Ge];return t||(t=e[Ge]={hoistableStyles:new Map,hoistableScripts:new Map}),t}function et(e){e[Je]=!0}var tt=new Set,nt={};function it(e,t){rt(e,t),rt(e+"Capture",t)}function rt(e,t){for(nt[e]=t,e=0;e<t.length;e++)tt.add(t[e])}var ot=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),at={},st={};function ct(e,t,n){if(r=t,ie.call(st,r)||!ie.call(at,r)&&(ot.test(r)?st[r]=!0:(at[r]=!0,0)))if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":return void e.removeAttribute(t);case"boolean":var i=t.toLowerCase().slice(0,5);if("data-"!==i&&"aria-"!==i)return void e.removeAttribute(t)}e.setAttribute(t,""+n)}var r}function lt(e,t,n){if(null===n)e.removeAttribute(t);else{switch(typeof n){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(t)}e.setAttribute(t,""+n)}}function ut(e,t,n,i){if(null===i)e.removeAttribute(n);else{switch(typeof i){case"undefined":case"function":case"symbol":case"boolean":return void e.removeAttribute(n)}e.setAttributeNS(t,n,""+i)}}function dt(e){switch(typeof e){case"bigint":case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function ht(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function pt(e){if(!e._valueTracker){var t=ht(e)?"checked":"value";e._valueTracker=function(e,t,n){var i=Object.getOwnPropertyDescriptor(e.constructor.prototype,t);if(!e.hasOwnProperty(t)&&"undefined"!==typeof i&&"function"===typeof i.get&&"function"===typeof i.set){var r=i.get,o=i.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return r.call(this)},set:function(e){n=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:i.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e,t,""+e[t])}}function ft(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),i="";return e&&(i=ht(e)?e.checked?"true":"false":e.value),(e=i)!==n&&(t.setValue(e),!0)}function mt(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(So){return e.body}}var gt=/[\n"\\]/g;function vt(e){return e.replace(gt,function(e){return"\\"+e.charCodeAt(0).toString(16)+" "})}function yt(e,t,n,i,r,o,a,s){e.name="",null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a?e.type=a:e.removeAttribute("type"),null!=t?"number"===a?(0===t&&""===e.value||e.value!=t)&&(e.value=""+dt(t)):e.value!==""+dt(t)&&(e.value=""+dt(t)):"submit"!==a&&"reset"!==a||e.removeAttribute("value"),null!=t?kt(e,a,dt(t)):null!=n?kt(e,a,dt(n)):null!=i&&e.removeAttribute("value"),null==r&&null!=o&&(e.defaultChecked=!!o),null!=r&&(e.checked=r&&"function"!==typeof r&&"symbol"!==typeof r),null!=s&&"function"!==typeof s&&"symbol"!==typeof s&&"boolean"!==typeof s?e.name=""+dt(s):e.removeAttribute("name")}function bt(e,t,n,i,r,o,a,s){if(null!=o&&"function"!==typeof o&&"symbol"!==typeof o&&"boolean"!==typeof o&&(e.type=o),null!=t||null!=n){if(!("submit"!==o&&"reset"!==o||void 0!==t&&null!==t))return void pt(e);n=null!=n?""+dt(n):"",t=null!=t?""+dt(t):n,s||t===e.value||(e.value=t),e.defaultValue=t}i="function"!==typeof(i=null!=i?i:r)&&"symbol"!==typeof i&&!!i,e.checked=s?e.checked:!!i,e.defaultChecked=!!i,null!=a&&"function"!==typeof a&&"symbol"!==typeof a&&"boolean"!==typeof a&&(e.name=a),pt(e)}function kt(e,t,n){"number"===t&&mt(e.ownerDocument)===e||e.defaultValue===""+n||(e.defaultValue=""+n)}function St(e,t,n,i){if(e=e.options,t){t={};for(var r=0;r<n.length;r++)t["$"+n[r]]=!0;for(n=0;n<e.length;n++)r=t.hasOwnProperty("$"+e[n].value),e[n].selected!==r&&(e[n].selected=r),r&&i&&(e[n].defaultSelected=!0)}else{for(n=""+dt(n),t=null,r=0;r<e.length;r++){if(e[r].value===n)return e[r].selected=!0,void(i&&(e[r].defaultSelected=!0));null!==t||e[r].disabled||(t=e[r])}null!==t&&(t.selected=!0)}}function wt(e,t,n){null==t||((t=""+dt(t))!==e.value&&(e.value=t),null!=n)?e.defaultValue=null!=n?""+dt(n):"":e.defaultValue!==t&&(e.defaultValue=t)}function Tt(e,t,n,i){if(null==t){if(null!=i){if(null!=n)throw Error(a(92));if(A(i)){if(1<i.length)throw Error(a(93));i=i[0]}n=i}null==n&&(n=""),t=n}n=dt(t),e.defaultValue=n,(i=e.textContent)===n&&""!==i&&null!==i&&(e.value=i),pt(e)}function Ct(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var Et=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Pt(e,t,n){var i=0===t.indexOf("--");null==n||"boolean"===typeof n||""===n?i?e.setProperty(t,""):"float"===t?e.cssFloat="":e[t]="":i?e.setProperty(t,n):"number"!==typeof n||0===n||Et.has(t)?"float"===t?e.cssFloat=n:e[t]=(""+n).trim():e[t]=n+"px"}function Rt(e,t,n){if(null!=t&&"object"!==typeof t)throw Error(a(62));if(e=e.style,null!=n){for(var i in n)!n.hasOwnProperty(i)||null!=t&&t.hasOwnProperty(i)||(0===i.indexOf("--")?e.setProperty(i,""):"float"===i?e.cssFloat="":e[i]="");for(var r in t)i=t[r],t.hasOwnProperty(r)&&n[r]!==i&&Pt(e,r,i)}else for(var o in t)t.hasOwnProperty(o)&&Pt(e,o,t[o])}function _t(e){if(-1===e.indexOf("-"))return!1;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ot=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),xt=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function It(e){return xt.test(""+e)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":e}function Nt(){}var At=null;function Dt(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Lt=null,Mt=null;function jt(e){var t=Ye(e);if(t&&(e=t.stateNode)){var n=e[qe]||null;e:switch(e=t.stateNode,t.type){case"input":if(yt(e,n.value,n.defaultValue,n.defaultValue,n.checked,n.defaultChecked,n.type,n.name),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll('input[name="'+vt(""+t)+'"][type="radio"]'),t=0;t<n.length;t++){var i=n[t];if(i!==e&&i.form===e.form){var r=i[qe]||null;if(!r)throw Error(a(90));yt(i,r.value,r.defaultValue,r.defaultValue,r.checked,r.defaultChecked,r.type,r.name)}}for(t=0;t<n.length;t++)(i=n[t]).form===e.form&&ft(i)}break e;case"textarea":wt(e,n.value,n.defaultValue);break e;case"select":null!=(t=n.value)&&St(e,!!n.multiple,t,!1)}}}var Ut=!1;function Ft(e,t,n){if(Ut)return e(t,n);Ut=!0;try{return e(t)}finally{if(Ut=!1,(null!==Lt||null!==Mt)&&(eu(),Lt&&(t=Lt,e=Mt,Mt=Lt=null,jt(t),e)))for(t=0;t<e.length;t++)jt(e[t])}}function Bt(e,t){var n=e.stateNode;if(null===n)return null;var i=n[qe]||null;if(null===i)return null;n=i[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(i=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!i;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var zt=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),qt=!1;if(zt)try{var Vt={};Object.defineProperty(Vt,"passive",{get:function(){qt=!0}}),window.addEventListener("test",Vt,Vt),window.removeEventListener("test",Vt,Vt)}catch(So){qt=!1}var Ht=null,Wt=null,Kt=null;function Gt(){if(Kt)return Kt;var e,t,n=Wt,i=n.length,r="value"in Ht?Ht.value:Ht.textContent,o=r.length;for(e=0;e<i&&n[e]===r[e];e++);var a=i-e;for(t=1;t<=a&&n[i-t]===r[o-t];t++);return Kt=r.slice(e,1<t?1-t:void 0)}function Jt(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function Qt(){return!0}function $t(){return!1}function Yt(e){function t(t,n,i,r,o){for(var a in this._reactName=t,this._targetInst=i,this.type=n,this.nativeEvent=r,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(null!=r.defaultPrevented?r.defaultPrevented:!1===r.returnValue)?Qt:$t,this.isPropagationStopped=$t,this}return p(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Qt)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Qt)},persist:function(){},isPersistent:Qt}),t}var Xt,Zt,en,tn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},nn=Yt(tn),rn=p({},tn,{view:0,detail:0}),on=Yt(rn),an=p({},rn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:vn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==en&&(en&&"mousemove"===e.type?(Xt=e.screenX-en.screenX,Zt=e.screenY-en.screenY):Zt=Xt=0,en=e),Xt)},movementY:function(e){return"movementY"in e?e.movementY:Zt}}),sn=Yt(an),cn=Yt(p({},an,{dataTransfer:0})),ln=Yt(p({},rn,{relatedTarget:0})),un=Yt(p({},tn,{animationName:0,elapsedTime:0,pseudoElement:0})),dn=Yt(p({},tn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),hn=Yt(p({},tn,{data:0})),pn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},fn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function gn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=mn[e])&&!!t[e]}function vn(){return gn}var yn=Yt(p({},rn,{key:function(e){if(e.key){var t=pn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Jt(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?fn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:vn,charCode:function(e){return"keypress"===e.type?Jt(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Jt(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),bn=Yt(p({},an,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),kn=Yt(p({},rn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:vn})),Sn=Yt(p({},tn,{propertyName:0,elapsedTime:0,pseudoElement:0})),wn=Yt(p({},an,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Tn=Yt(p({},tn,{newState:0,oldState:0})),Cn=[9,13,27,32],En=zt&&"CompositionEvent"in window,Pn=null;zt&&"documentMode"in document&&(Pn=document.documentMode);var Rn=zt&&"TextEvent"in window&&!Pn,_n=zt&&(!En||Pn&&8<Pn&&11>=Pn),On=String.fromCharCode(32),xn=!1;function In(e,t){switch(e){case"keyup":return-1!==Cn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Nn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var An=!1;var Dn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ln(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Dn[e.type]:"textarea"===t}function Mn(e,t,n,i){Lt?Mt?Mt.push(i):Mt=[i]:Lt=i,0<(t=rd(t,"onChange")).length&&(n=new nn("onChange","change",null,n,i),e.push({event:n,listeners:t}))}var jn=null,Un=null;function Fn(e){$u(e,0)}function Bn(e){if(ft(Xe(e)))return e}function zn(e,t){if("change"===e)return t}var qn=!1;if(zt){var Vn;if(zt){var Hn="oninput"in document;if(!Hn){var Wn=document.createElement("div");Wn.setAttribute("oninput","return;"),Hn="function"===typeof Wn.oninput}Vn=Hn}else Vn=!1;qn=Vn&&(!document.documentMode||9<document.documentMode)}function Kn(){jn&&(jn.detachEvent("onpropertychange",Gn),Un=jn=null)}function Gn(e){if("value"===e.propertyName&&Bn(Un)){var t=[];Mn(t,Un,e,Dt(e)),Ft(Fn,t)}}function Jn(e,t,n){"focusin"===e?(Kn(),Un=n,(jn=t).attachEvent("onpropertychange",Gn)):"focusout"===e&&Kn()}function Qn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Bn(Un)}function $n(e,t){if("click"===e)return Bn(t)}function Yn(e,t){if("input"===e||"change"===e)return Bn(t)}var Xn="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function Zn(e,t){if(Xn(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!ie.call(t,r)||!Xn(e[r],t[r]))return!1}return!0}function ei(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ti(e,t){var n,i=ei(e);for(e=0;i;){if(3===i.nodeType){if(n=e+i.textContent.length,e<=t&&n>=t)return{node:i,offset:t-e};e=n}e:{for(;i;){if(i.nextSibling){i=i.nextSibling;break e}i=i.parentNode}i=void 0}i=ei(i)}}function ni(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?ni(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ii(e){for(var t=mt((e=null!=e&&null!=e.ownerDocument&&null!=e.ownerDocument.defaultView?e.ownerDocument.defaultView:window).document);t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(i){n=!1}if(!n)break;t=mt((e=t.contentWindow).document)}return t}function ri(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var oi=zt&&"documentMode"in document&&11>=document.documentMode,ai=null,si=null,ci=null,li=!1;function ui(e,t,n){var i=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;li||null==ai||ai!==mt(i)||("selectionStart"in(i=ai)&&ri(i)?i={start:i.selectionStart,end:i.selectionEnd}:i={anchorNode:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset},ci&&Zn(ci,i)||(ci=i,0<(i=rd(si,"onSelect")).length&&(t=new nn("onSelect","select",null,t,n),e.push({event:t,listeners:i}),t.target=ai)))}function di(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var hi={animationend:di("Animation","AnimationEnd"),animationiteration:di("Animation","AnimationIteration"),animationstart:di("Animation","AnimationStart"),transitionrun:di("Transition","TransitionRun"),transitionstart:di("Transition","TransitionStart"),transitioncancel:di("Transition","TransitionCancel"),transitionend:di("Transition","TransitionEnd")},pi={},fi={};function mi(e){if(pi[e])return pi[e];if(!hi[e])return e;var t,n=hi[e];for(t in n)if(n.hasOwnProperty(t)&&t in fi)return pi[e]=n[t];return e}zt&&(fi=document.createElement("div").style,"AnimationEvent"in window||(delete hi.animationend.animation,delete hi.animationiteration.animation,delete hi.animationstart.animation),"TransitionEvent"in window||delete hi.transitionend.transition);var gi=mi("animationend"),vi=mi("animationiteration"),yi=mi("animationstart"),bi=mi("transitionrun"),ki=mi("transitionstart"),Si=mi("transitioncancel"),wi=mi("transitionend"),Ti=new Map,Ci="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ei(e,t){Ti.set(e,t),it(t,[e])}Ci.push("scrollEnd");var Pi="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},Ri=[],_i=0,Oi=0;function xi(){for(var e=_i,t=Oi=_i=0;t<e;){var n=Ri[t];Ri[t++]=null;var i=Ri[t];Ri[t++]=null;var r=Ri[t];Ri[t++]=null;var o=Ri[t];if(Ri[t++]=null,null!==i&&null!==r){var a=i.pending;null===a?r.next=r:(r.next=a.next,a.next=r),i.pending=r}0!==o&&Di(n,r,o)}}function Ii(e,t,n,i){Ri[_i++]=e,Ri[_i++]=t,Ri[_i++]=n,Ri[_i++]=i,Oi|=i,e.lanes|=i,null!==(e=e.alternate)&&(e.lanes|=i)}function Ni(e,t,n,i){return Ii(e,t,n,i),Li(e)}function Ai(e,t){return Ii(e,null,null,t),Li(e)}function Di(e,t,n){e.lanes|=n;var i=e.alternate;null!==i&&(i.lanes|=n);for(var r=!1,o=e.return;null!==o;)o.childLanes|=n,null!==(i=o.alternate)&&(i.childLanes|=n),22===o.tag&&(null===(e=o.stateNode)||1&e._visibility||(r=!0)),e=o,o=o.return;return 3===e.tag?(o=e.stateNode,r&&null!==t&&(r=31-ke(n),null===(i=(e=o.hiddenUpdates)[r])?e[r]=[t]:i.push(t),t.lane=536870912|n),o):null}function Li(e){if(50<Wl)throw Wl=0,Kl=null,Error(a(185));for(var t=e.return;null!==t;)t=(e=t).return;return 3===e.tag?e.stateNode:null}var Mi={};function ji(e,t,n,i){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ui(e,t,n,i){return new ji(e,t,n,i)}function Fi(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Bi(e,t){var n=e.alternate;return null===n?((n=Ui(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=65011712&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n.refCleanup=e.refCleanup,n}function zi(e,t){e.flags&=65011714;var n=e.alternate;return null===n?(e.childLanes=0,e.lanes=t,e.child=null,e.subtreeFlags=0,e.memoizedProps=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.stateNode=null):(e.childLanes=n.childLanes,e.lanes=n.lanes,e.child=n.child,e.subtreeFlags=0,e.deletions=null,e.memoizedProps=n.memoizedProps,e.memoizedState=n.memoizedState,e.updateQueue=n.updateQueue,e.type=n.type,t=n.dependencies,e.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext}),e}function qi(e,t,n,i,r,o){var s=0;if(i=e,"function"===typeof e)Fi(e)&&(s=1);else if("string"===typeof e)s=function(e,t,n){if(1===n||null!=t.itemProp)return!1;switch(e){case"meta":case"title":return!0;case"style":if("string"!==typeof t.precedence||"string"!==typeof t.href||""===t.href)break;return!0;case"link":if("string"!==typeof t.rel||"string"!==typeof t.href||""===t.href||t.onLoad||t.onError)break;return"stylesheet"!==t.rel||(e=t.disabled,"string"===typeof t.precedence&&null==e);case"script":if(t.async&&"function"!==typeof t.async&&"symbol"!==typeof t.async&&!t.onLoad&&!t.onError&&t.src&&"string"===typeof t.src)return!0}return!1}(e,n,H.current)?26:"html"===e||"head"===e||"body"===e?27:5;else e:switch(e){case R:return(e=Ui(31,n,t,r)).elementType=R,e.lanes=o,e;case v:return Vi(n.children,r,o,t);case y:s=8,r|=24;break;case b:return(e=Ui(12,n,t,2|r)).elementType=b,e.lanes=o,e;case T:return(e=Ui(13,n,t,r)).elementType=T,e.lanes=o,e;case C:return(e=Ui(19,n,t,r)).elementType=C,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case S:s=10;break e;case k:s=9;break e;case w:s=11;break e;case E:s=14;break e;case P:s=16,i=null;break e}s=29,n=Error(a(130,null===e?"null":typeof e,"")),i=null}return(t=Ui(s,n,t,r)).elementType=e,t.type=i,t.lanes=o,t}function Vi(e,t,n,i){return(e=Ui(7,e,i,t)).lanes=n,e}function Hi(e,t,n){return(e=Ui(6,e,null,t)).lanes=n,e}function Wi(e){var t=Ui(18,null,null,0);return t.stateNode=e,t}function Ki(e,t,n){return(t=Ui(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}var Gi=new WeakMap;function Ji(e,t){if("object"===typeof e&&null!==e){var n=Gi.get(e);return void 0!==n?n:(t={value:e,source:t,stack:ne(t)},Gi.set(e,t),t)}return{value:e,source:t,stack:ne(t)}}var Qi=[],$i=0,Yi=null,Xi=0,Zi=[],er=0,tr=null,nr=1,ir="";function rr(e,t){Qi[$i++]=Xi,Qi[$i++]=Yi,Yi=e,Xi=t}function or(e,t,n){Zi[er++]=nr,Zi[er++]=ir,Zi[er++]=tr,tr=e;var i=nr;e=ir;var r=32-ke(i)-1;i&=~(1<<r),n+=1;var o=32-ke(t)+r;if(30<o){var a=r-r%5;o=(i&(1<<a)-1).toString(32),i>>=a,r-=a,nr=1<<32-ke(t)+r|n<<r|i,ir=o+e}else nr=1<<o|n<<r|i,ir=e}function ar(e){null!==e.return&&(rr(e,1),or(e,1,0))}function sr(e){for(;e===Yi;)Yi=Qi[--$i],Qi[$i]=null,Xi=Qi[--$i],Qi[$i]=null;for(;e===tr;)tr=Zi[--er],Zi[er]=null,ir=Zi[--er],Zi[er]=null,nr=Zi[--er],Zi[er]=null}function cr(e,t){Zi[er++]=nr,Zi[er++]=ir,Zi[er++]=tr,nr=t.id,ir=t.overflow,tr=e}var lr=null,ur=null,dr=!1,hr=null,pr=!1,fr=Error(a(519));function mr(e){throw Sr(Ji(Error(a(418,1<arguments.length&&void 0!==arguments[1]&&arguments[1]?"text":"HTML","")),e)),fr}function gr(e){var t=e.stateNode,n=e.type,i=e.memoizedProps;switch(t[ze]=e,t[qe]=i,n){case"dialog":Yu("cancel",t),Yu("close",t);break;case"iframe":case"object":case"embed":Yu("load",t);break;case"video":case"audio":for(n=0;n<Ju.length;n++)Yu(Ju[n],t);break;case"source":Yu("error",t);break;case"img":case"image":case"link":Yu("error",t),Yu("load",t);break;case"details":Yu("toggle",t);break;case"input":Yu("invalid",t),bt(t,i.value,i.defaultValue,i.checked,i.defaultChecked,i.type,i.name,!0);break;case"select":Yu("invalid",t);break;case"textarea":Yu("invalid",t),Tt(t,i.value,i.defaultValue,i.children)}"string"!==typeof(n=i.children)&&"number"!==typeof n&&"bigint"!==typeof n||t.textContent===""+n||!0===i.suppressHydrationWarning||ud(t.textContent,n)?(null!=i.popover&&(Yu("beforetoggle",t),Yu("toggle",t)),null!=i.onScroll&&Yu("scroll",t),null!=i.onScrollEnd&&Yu("scrollend",t),null!=i.onClick&&(t.onclick=Nt),t=!0):t=!1,t||mr(e,!0)}function vr(e){for(lr=e.return;lr;)switch(lr.tag){case 5:case 31:case 13:return void(pr=!1);case 27:case 3:return void(pr=!0);default:lr=lr.return}}function yr(e){if(e!==lr)return!1;if(!dr)return vr(e),dr=!0,!1;var t,n=e.tag;if((t=3!==n&&27!==n)&&((t=5===n)&&(t=!("form"!==(t=e.type)&&"button"!==t)||kd(e.type,e.memoizedProps)),t=!t),t&&ur&&mr(e),vr(e),13===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));ur=Md(e)}else if(31===n){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));ur=Md(e)}else 27===n?(n=ur,Rd(e.type)?(e=Ld,Ld=null,ur=e):ur=n):ur=lr?Dd(e.stateNode.nextSibling):null;return!0}function br(){ur=lr=null,dr=!1}function kr(){var e=hr;return null!==e&&(null===Il?Il=e:Il.push.apply(Il,e),hr=null),e}function Sr(e){null===hr?hr=[e]:hr.push(e)}var wr=F(null),Tr=null,Cr=null;function Er(e,t,n){z(wr,t._currentValue),t._currentValue=n}function Pr(e){e._currentValue=wr.current,B(wr)}function Rr(e,t,n){for(;null!==e;){var i=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==i&&(i.childLanes|=t)):null!==i&&(i.childLanes&t)!==t&&(i.childLanes|=t),e===n)break;e=e.return}}function _r(e,t,n,i){var r=e.child;for(null!==r&&(r.return=e);null!==r;){var o=r.dependencies;if(null!==o){var s=r.child;o=o.firstContext;e:for(;null!==o;){var c=o;o=r;for(var l=0;l<t.length;l++)if(c.context===t[l]){o.lanes|=n,null!==(c=o.alternate)&&(c.lanes|=n),Rr(o.return,n,e),i||(s=null);break e}o=c.next}}else if(18===r.tag){if(null===(s=r.return))throw Error(a(341));s.lanes|=n,null!==(o=s.alternate)&&(o.lanes|=n),Rr(s,n,e),s=null}else s=r.child;if(null!==s)s.return=r;else for(s=r;null!==s;){if(s===e){s=null;break}if(null!==(r=s.sibling)){r.return=s.return,s=r;break}s=s.return}r=s}}function Or(e,t,n,i){e=null;for(var r=t,o=!1;null!==r;){if(!o)if(0!==(524288&r.flags))o=!0;else if(0!==(262144&r.flags))break;if(10===r.tag){var s=r.alternate;if(null===s)throw Error(a(387));if(null!==(s=s.memoizedProps)){var c=r.type;Xn(r.pendingProps.value,s.value)||(null!==e?e.push(c):e=[c])}}else if(r===G.current){if(null===(s=r.alternate))throw Error(a(387));s.memoizedState.memoizedState!==r.memoizedState.memoizedState&&(null!==e?e.push(dh):e=[dh])}r=r.return}null!==e&&_r(t,e,n,i),t.flags|=262144}function xr(e){for(e=e.firstContext;null!==e;){if(!Xn(e.context._currentValue,e.memoizedValue))return!0;e=e.next}return!1}function Ir(e){Tr=e,Cr=null,null!==(e=e.dependencies)&&(e.firstContext=null)}function Nr(e){return Dr(Tr,e)}function Ar(e,t){return null===Tr&&Ir(e),Dr(e,t)}function Dr(e,t){var n=t._currentValue;if(t={context:t,memoizedValue:n,next:null},null===Cr){if(null===e)throw Error(a(308));Cr=t,e.dependencies={lanes:0,firstContext:t},e.flags|=524288}else Cr=Cr.next=t;return n}var Lr="undefined"!==typeof AbortController?AbortController:function(){var e=[],t=this.signal={aborted:!1,addEventListener:function(t,n){e.push(n)}};this.abort=function(){t.aborted=!0,e.forEach(function(e){return e()})}},Mr=i.unstable_scheduleCallback,jr=i.unstable_NormalPriority,Ur={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fr(){return{controller:new Lr,data:new Map,refCount:0}}function Br(e){e.refCount--,0===e.refCount&&Mr(jr,function(){e.controller.abort()})}var zr=null,qr=0,Vr=0,Hr=null;function Wr(){if(0===--qr&&null!==zr){null!==Hr&&(Hr.status="fulfilled");var e=zr;zr=null,Vr=0,Hr=null;for(var t=0;t<e.length;t++)(0,e[t])()}}var Kr=D.S;D.S=function(e,t){Dl=ce(),"object"===typeof t&&null!==t&&"function"===typeof t.then&&function(e,t){if(null===zr){var n=zr=[];qr=0,Vr=Vu(),Hr={status:"pending",value:void 0,then:function(e){n.push(e)}}}qr++,t.then(Wr,Wr)}(0,t),null!==Kr&&Kr(e,t)};var Gr=F(null);function Jr(){var e=Gr.current;return null!==e?e:ml.pooledCache}function Qr(e,t){z(Gr,null===t?Gr.current:t.pool)}function $r(){var e=Jr();return null===e?null:{parent:Ur._currentValue,pool:e}}var Yr=Error(a(460)),Xr=Error(a(474)),Zr=Error(a(542)),eo={then:function(){}};function to(e){return"fulfilled"===(e=e.status)||"rejected"===e}function no(e,t,n){switch(void 0===(n=e[n])?e.push(t):n!==t&&(t.then(Nt,Nt),t=n),t.status){case"fulfilled":return t.value;case"rejected":throw ao(e=t.reason),e;default:if("string"===typeof t.status)t.then(Nt,Nt);else{if(null!==(e=ml)&&100<e.shellSuspendCounter)throw Error(a(482));(e=t).status="pending",e.then(function(e){if("pending"===t.status){var n=t;n.status="fulfilled",n.value=e}},function(e){if("pending"===t.status){var n=t;n.status="rejected",n.reason=e}})}switch(t.status){case"fulfilled":return t.value;case"rejected":throw ao(e=t.reason),e}throw ro=t,Yr}}function io(e){try{return(0,e._init)(e._payload)}catch(t){if(null!==t&&"object"===typeof t&&"function"===typeof t.then)throw ro=t,Yr;throw t}}var ro=null;function oo(){if(null===ro)throw Error(a(459));var e=ro;return ro=null,e}function ao(e){if(e===Yr||e===Zr)throw Error(a(483))}var so=null,co=0;function lo(e){var t=co;return co+=1,null===so&&(so=[]),no(so,e,t)}function uo(e,t){t=t.props.ref,e.ref=void 0!==t?t:null}function ho(e,t){if(t.$$typeof===f)throw Error(a(525));throw e=Object.prototype.toString.call(t),Error(a(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function po(e){function t(t,n){if(e){var i=t.deletions;null===i?(t.deletions=[n],t.flags|=16):i.push(n)}}function n(n,i){if(!e)return null;for(;null!==i;)t(n,i),i=i.sibling;return null}function i(e){for(var t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function r(e,t){return(e=Bi(e,t)).index=0,e.sibling=null,e}function o(t,n,i){return t.index=i,e?null!==(i=t.alternate)?(i=i.index)<n?(t.flags|=67108866,n):i:(t.flags|=67108866,n):(t.flags|=1048576,n)}function s(t){return e&&null===t.alternate&&(t.flags|=67108866),t}function c(e,t,n,i){return null===t||6!==t.tag?((t=Hi(n,e.mode,i)).return=e,t):((t=r(t,n)).return=e,t)}function l(e,t,n,i){var o=n.type;return o===v?d(e,t,n.props.children,i,n.key):null!==t&&(t.elementType===o||"object"===typeof o&&null!==o&&o.$$typeof===P&&io(o)===t.type)?(uo(t=r(t,n.props),n),t.return=e,t):(uo(t=qi(n.type,n.key,n.props,null,e.mode,i),n),t.return=e,t)}function u(e,t,n,i){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Ki(n,e.mode,i)).return=e,t):((t=r(t,n.children||[])).return=e,t)}function d(e,t,n,i,o){return null===t||7!==t.tag?((t=Vi(n,e.mode,i,o)).return=e,t):((t=r(t,n)).return=e,t)}function h(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t||"bigint"===typeof t)return(t=Hi(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case m:return uo(n=qi(t.type,t.key,t.props,null,e.mode,n),t),n.return=e,n;case g:return(t=Ki(t,e.mode,n)).return=e,t;case P:return h(e,t=io(t),n)}if(A(t)||x(t))return(t=Vi(t,e.mode,n,null)).return=e,t;if("function"===typeof t.then)return h(e,lo(t),n);if(t.$$typeof===S)return h(e,Ar(e,t),n);ho(e,t)}return null}function p(e,t,n,i){var r=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n||"bigint"===typeof n)return null!==r?null:c(e,t,""+n,i);if("object"===typeof n&&null!==n){switch(n.$$typeof){case m:return n.key===r?l(e,t,n,i):null;case g:return n.key===r?u(e,t,n,i):null;case P:return p(e,t,n=io(n),i)}if(A(n)||x(n))return null!==r?null:d(e,t,n,i,null);if("function"===typeof n.then)return p(e,t,lo(n),i);if(n.$$typeof===S)return p(e,t,Ar(e,n),i);ho(e,n)}return null}function f(e,t,n,i,r){if("string"===typeof i&&""!==i||"number"===typeof i||"bigint"===typeof i)return c(t,e=e.get(n)||null,""+i,r);if("object"===typeof i&&null!==i){switch(i.$$typeof){case m:return l(t,e=e.get(null===i.key?n:i.key)||null,i,r);case g:return u(t,e=e.get(null===i.key?n:i.key)||null,i,r);case P:return f(e,t,n,i=io(i),r)}if(A(i)||x(i))return d(t,e=e.get(n)||null,i,r,null);if("function"===typeof i.then)return f(e,t,n,lo(i),r);if(i.$$typeof===S)return f(e,t,n,Ar(t,i),r);ho(t,i)}return null}function y(c,l,u,d){if("object"===typeof u&&null!==u&&u.type===v&&null===u.key&&(u=u.props.children),"object"===typeof u&&null!==u){switch(u.$$typeof){case m:e:{for(var b=u.key;null!==l;){if(l.key===b){if((b=u.type)===v){if(7===l.tag){n(c,l.sibling),(d=r(l,u.props.children)).return=c,c=d;break e}}else if(l.elementType===b||"object"===typeof b&&null!==b&&b.$$typeof===P&&io(b)===l.type){n(c,l.sibling),uo(d=r(l,u.props),u),d.return=c,c=d;break e}n(c,l);break}t(c,l),l=l.sibling}u.type===v?((d=Vi(u.props.children,c.mode,d,u.key)).return=c,c=d):(uo(d=qi(u.type,u.key,u.props,null,c.mode,d),u),d.return=c,c=d)}return s(c);case g:e:{for(b=u.key;null!==l;){if(l.key===b){if(4===l.tag&&l.stateNode.containerInfo===u.containerInfo&&l.stateNode.implementation===u.implementation){n(c,l.sibling),(d=r(l,u.children||[])).return=c,c=d;break e}n(c,l);break}t(c,l),l=l.sibling}(d=Ki(u,c.mode,d)).return=c,c=d}return s(c);case P:return y(c,l,u=io(u),d)}if(A(u))return function(r,a,s,c){for(var l=null,u=null,d=a,m=a=0,g=null;null!==d&&m<s.length;m++){d.index>m?(g=d,d=null):g=d.sibling;var v=p(r,d,s[m],c);if(null===v){null===d&&(d=g);break}e&&d&&null===v.alternate&&t(r,d),a=o(v,a,m),null===u?l=v:u.sibling=v,u=v,d=g}if(m===s.length)return n(r,d),dr&&rr(r,m),l;if(null===d){for(;m<s.length;m++)null!==(d=h(r,s[m],c))&&(a=o(d,a,m),null===u?l=d:u.sibling=d,u=d);return dr&&rr(r,m),l}for(d=i(d);m<s.length;m++)null!==(g=f(d,r,m,s[m],c))&&(e&&null!==g.alternate&&d.delete(null===g.key?m:g.key),a=o(g,a,m),null===u?l=g:u.sibling=g,u=g);return e&&d.forEach(function(e){return t(r,e)}),dr&&rr(r,m),l}(c,l,u,d);if(x(u)){if("function"!==typeof(b=x(u)))throw Error(a(150));return function(r,s,c,l){if(null==c)throw Error(a(151));for(var u=null,d=null,m=s,g=s=0,v=null,y=c.next();null!==m&&!y.done;g++,y=c.next()){m.index>g?(v=m,m=null):v=m.sibling;var b=p(r,m,y.value,l);if(null===b){null===m&&(m=v);break}e&&m&&null===b.alternate&&t(r,m),s=o(b,s,g),null===d?u=b:d.sibling=b,d=b,m=v}if(y.done)return n(r,m),dr&&rr(r,g),u;if(null===m){for(;!y.done;g++,y=c.next())null!==(y=h(r,y.value,l))&&(s=o(y,s,g),null===d?u=y:d.sibling=y,d=y);return dr&&rr(r,g),u}for(m=i(m);!y.done;g++,y=c.next())null!==(y=f(m,r,g,y.value,l))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=o(y,s,g),null===d?u=y:d.sibling=y,d=y);return e&&m.forEach(function(e){return t(r,e)}),dr&&rr(r,g),u}(c,l,u=b.call(u),d)}if("function"===typeof u.then)return y(c,l,lo(u),d);if(u.$$typeof===S)return y(c,l,Ar(c,u),d);ho(c,u)}return"string"===typeof u&&""!==u||"number"===typeof u||"bigint"===typeof u?(u=""+u,null!==l&&6===l.tag?(n(c,l.sibling),(d=r(l,u)).return=c,c=d):(n(c,l),(d=Hi(u,c.mode,d)).return=c,c=d),s(c)):n(c,l)}return function(e,t,n,i){try{co=0;var r=y(e,t,n,i);return so=null,r}catch(a){if(a===Yr||a===Zr)throw a;var o=Ui(29,a,null,e.mode);return o.lanes=i,o.return=e,o}}}var fo=po(!0),mo=po(!1),go=!1;function vo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function yo(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,callbacks:null})}function bo(e){return{lane:e,tag:0,payload:null,callback:null,next:null}}function ko(e,t,n){var i=e.updateQueue;if(null===i)return null;if(i=i.shared,0!==(2&fl)){var r=i.pending;return null===r?t.next=t:(t.next=r.next,r.next=t),i.pending=t,t=Li(e),Di(e,null,n),t}return Ii(e,i,t,n),Li(e)}function wo(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194048&n))){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,De(e,n)}}function To(e,t){var n=e.updateQueue,i=e.alternate;if(null!==i&&n===(i=i.updateQueue)){var r=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={lane:n.lane,tag:n.tag,payload:n.payload,callback:null,next:null};null===o?r=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?r=o=t:o=o.next=t}else r=o=t;return n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:i.shared,callbacks:i.callbacks},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}var Co=!1;function Eo(){if(Co){if(null!==Hr)throw Hr}}function Po(e,t,n,i){Co=!1;var r=e.updateQueue;go=!1;var o=r.firstBaseUpdate,a=r.lastBaseUpdate,s=r.shared.pending;if(null!==s){r.shared.pending=null;var c=s,l=c.next;c.next=null,null===a?o=l:a.next=l,a=c;var u=e.alternate;null!==u&&((s=(u=u.updateQueue).lastBaseUpdate)!==a&&(null===s?u.firstBaseUpdate=l:s.next=l,u.lastBaseUpdate=c))}if(null!==o){var d=r.baseState;for(a=0,u=l=c=null,s=o;;){var h=-536870913&s.lane,f=h!==s.lane;if(f?(vl&h)===h:(i&h)===h){0!==h&&h===Vr&&(Co=!0),null!==u&&(u=u.next={lane:0,tag:s.tag,payload:s.payload,callback:null,next:null});e:{var m=e,g=s;h=t;var v=n;switch(g.tag){case 1:if("function"===typeof(m=g.payload)){d=m.call(v,d,h);break e}d=m;break e;case 3:m.flags=-65537&m.flags|128;case 0:if(null===(h="function"===typeof(m=g.payload)?m.call(v,d,h):m)||void 0===h)break e;d=p({},d,h);break e;case 2:go=!0}}null!==(h=s.callback)&&(e.flags|=64,f&&(e.flags|=8192),null===(f=r.callbacks)?r.callbacks=[h]:f.push(h))}else f={lane:h,tag:s.tag,payload:s.payload,callback:s.callback,next:null},null===u?(l=u=f,c=d):u=u.next=f,a|=h;if(null===(s=s.next)){if(null===(s=r.shared.pending))break;s=(f=s).next,f.next=null,r.lastBaseUpdate=f,r.shared.pending=null}}null===u&&(c=d),r.baseState=c,r.firstBaseUpdate=l,r.lastBaseUpdate=u,null===o&&(r.shared.lanes=0),El|=a,e.lanes=a,e.memoizedState=d}}function Ro(e,t){if("function"!==typeof e)throw Error(a(191,e));e.call(t)}function _o(e,t){var n=e.callbacks;if(null!==n)for(e.callbacks=null,e=0;e<n.length;e++)Ro(n[e],t)}var Oo=F(null),xo=F(0);function Io(e,t){z(xo,e=Tl),z(Oo,t),Tl=e|t.baseLanes}function No(){z(xo,Tl),z(Oo,Oo.current)}function Ao(){Tl=xo.current,B(Oo),B(xo)}var Do=F(null),Lo=null;function Mo(e){var t=e.alternate;z(zo,1&zo.current),z(Do,e),null===Lo&&(null===t||null!==Oo.current||null!==t.memoizedState)&&(Lo=e)}function jo(e){z(zo,zo.current),z(Do,e),null===Lo&&(Lo=e)}function Uo(e){22===e.tag?(z(zo,zo.current),z(Do,e),null===Lo&&(Lo=e)):Fo()}function Fo(){z(zo,zo.current),z(Do,Do.current)}function Bo(e){B(Do),Lo===e&&(Lo=null),B(zo)}var zo=F(0);function qo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||Nd(n)||Ad(n)))return t}else if(19!==t.tag||"forwards"!==t.memoizedProps.revealOrder&&"backwards"!==t.memoizedProps.revealOrder&&"unstable_legacy-backwards"!==t.memoizedProps.revealOrder&&"together"!==t.memoizedProps.revealOrder){if(null!==t.child){t.child.return=t,t=t.child;continue}}else if(0!==(128&t.flags))return t;if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Vo=0,Ho=null,Wo=null,Ko=null,Go=!1,Jo=!1,Qo=!1,$o=0,Yo=0,Xo=null,Zo=0;function ea(){throw Error(a(321))}function ta(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Xn(e[n],t[n]))return!1;return!0}function na(e,t,n,i,r,o){return Vo=o,Ho=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,D.H=null===e||null===e.memoizedState?vs:ys,Qo=!1,o=n(i,r),Qo=!1,Jo&&(o=ra(t,n,i,r)),ia(e),o}function ia(e){D.H=gs;var t=null!==Wo&&null!==Wo.next;if(Vo=0,Ko=Wo=Ho=null,Go=!1,Yo=0,Xo=null,t)throw Error(a(300));null===e||Ds||null!==(e=e.dependencies)&&xr(e)&&(Ds=!0)}function ra(e,t,n,i){Ho=e;var r=0;do{if(Jo&&(Xo=null),Yo=0,Jo=!1,25<=r)throw Error(a(301));if(r+=1,Ko=Wo=null,null!=e.updateQueue){var o=e.updateQueue;o.lastEffect=null,o.events=null,o.stores=null,null!=o.memoCache&&(o.memoCache.index=0)}D.H=bs,o=t(n,i)}while(Jo);return o}function oa(){var e=D.H,t=e.useState()[0];return t="function"===typeof t.then?da(t):t,e=e.useState()[0],(null!==Wo?Wo.memoizedState:null)!==e&&(Ho.flags|=1024),t}function aa(){var e=0!==$o;return $o=0,e}function sa(e,t,n){t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n}function ca(e){if(Go){for(e=e.memoizedState;null!==e;){var t=e.queue;null!==t&&(t.pending=null),e=e.next}Go=!1}Vo=0,Ko=Wo=Ho=null,Jo=!1,Yo=$o=0,Xo=null}function la(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Ko?Ho.memoizedState=Ko=e:Ko=Ko.next=e,Ko}function ua(){if(null===Wo){var e=Ho.alternate;e=null!==e?e.memoizedState:null}else e=Wo.next;var t=null===Ko?Ho.memoizedState:Ko.next;if(null!==t)Ko=t,Wo=e;else{if(null===e){if(null===Ho.alternate)throw Error(a(467));throw Error(a(310))}e={memoizedState:(Wo=e).memoizedState,baseState:Wo.baseState,baseQueue:Wo.baseQueue,queue:Wo.queue,next:null},null===Ko?Ho.memoizedState=Ko=e:Ko=Ko.next=e}return Ko}function da(e){var t=Yo;return Yo+=1,null===Xo&&(Xo=[]),e=no(Xo,e,t),t=Ho,null===(null===Ko?t.memoizedState:Ko.next)&&(t=t.alternate,D.H=null===t||null===t.memoizedState?vs:ys),e}function ha(e){if(null!==e&&"object"===typeof e){if("function"===typeof e.then)return da(e);if(e.$$typeof===S)return Nr(e)}throw Error(a(438,String(e)))}function pa(e){var t=null,n=Ho.updateQueue;if(null!==n&&(t=n.memoCache),null==t){var i=Ho.alternate;null!==i&&(null!==(i=i.updateQueue)&&(null!=(i=i.memoCache)&&(t={data:i.data.map(function(e){return e.slice()}),index:0})))}if(null==t&&(t={data:[],index:0}),null===n&&(n={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=n),n.memoCache=t,void 0===(n=t.data[t.index]))for(n=t.data[t.index]=Array(e),i=0;i<e;i++)n[i]=_;return t.index++,n}function fa(e,t){return"function"===typeof t?t(e):t}function ma(e){return ga(ua(),Wo,e)}function ga(e,t,n){var i=e.queue;if(null===i)throw Error(a(311));i.lastRenderedReducer=n;var r=e.baseQueue,o=i.pending;if(null!==o){if(null!==r){var s=r.next;r.next=o.next,o.next=s}t.baseQueue=r=o,i.pending=null}if(o=e.baseState,null===r)e.memoizedState=o;else{var c=s=null,l=null,u=t=r.next,d=!1;do{var h=-536870913&u.lane;if(h!==u.lane?(vl&h)===h:(Vo&h)===h){var p=u.revertLane;if(0===p)null!==l&&(l=l.next={lane:0,revertLane:0,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),h===Vr&&(d=!0);else{if((Vo&p)===p){u=u.next,p===Vr&&(d=!0);continue}h={lane:0,revertLane:u.revertLane,gesture:null,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===l?(c=l=h,s=o):l=l.next=h,Ho.lanes|=p,El|=p}h=u.action,Qo&&n(o,h),o=u.hasEagerState?u.eagerState:n(o,h)}else p={lane:h,revertLane:u.revertLane,gesture:u.gesture,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null},null===l?(c=l=p,s=o):l=l.next=p,Ho.lanes|=h,El|=h;u=u.next}while(null!==u&&u!==t);if(null===l?s=o:l.next=c,!Xn(o,e.memoizedState)&&(Ds=!0,d&&null!==(n=Hr)))throw n;e.memoizedState=o,e.baseState=s,e.baseQueue=l,i.lastRenderedState=o}return null===r&&(i.lanes=0),[e.memoizedState,i.dispatch]}function va(e){var t=ua(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var i=n.dispatch,r=n.pending,o=t.memoizedState;if(null!==r){n.pending=null;var s=r=r.next;do{o=e(o,s.action),s=s.next}while(s!==r);Xn(o,t.memoizedState)||(Ds=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,i]}function ya(e,t,n){var i=Ho,r=ua(),o=dr;if(o){if(void 0===n)throw Error(a(407));n=n()}else n=t();var s=!Xn((Wo||r).memoizedState,n);if(s&&(r.memoizedState=n,Ds=!0),r=r.queue,Va(Sa.bind(null,i,r,e),[e]),r.getSnapshot!==t||s||null!==Ko&&1&Ko.memoizedState.tag){if(i.flags|=2048,Ua(9,{destroy:void 0},ka.bind(null,i,r,n,t),null),null===ml)throw Error(a(349));o||0!==(127&Vo)||ba(i,t,n)}return n}function ba(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=Ho.updateQueue)?(t={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function ka(e,t,n,i){t.value=n,t.getSnapshot=i,wa(t)&&Ta(e)}function Sa(e,t,n){return n(function(){wa(t)&&Ta(e)})}function wa(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Xn(e,n)}catch(i){return!0}}function Ta(e){var t=Ai(e,2);null!==t&&Ql(t,e,2)}function Ca(e){var t=la();if("function"===typeof e){var n=e;if(e=n(),Qo){be(!0);try{n()}finally{be(!1)}}}return t.memoizedState=t.baseState=e,t.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:e},t}function Ea(e,t,n,i){return e.baseState=n,ga(e,Wo,"function"===typeof i?i:fa)}function Pa(e,t,n,i,r){if(ps(e))throw Error(a(485));if(null!==(e=t.action)){var o={payload:r,action:e,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(e){o.listeners.push(e)}};null!==D.T?n(!0):o.isTransition=!1,i(o),null===(n=t.pending)?(o.next=t.pending=o,Ra(t,o)):(o.next=n.next,t.pending=n.next=o)}}function Ra(e,t){var n=t.action,i=t.payload,r=e.state;if(t.isTransition){var o=D.T,a={};D.T=a;try{var s=n(r,i),c=D.S;null!==c&&c(a,s),_a(e,t,s)}catch(l){xa(e,t,l)}finally{null!==o&&null!==a.types&&(o.types=a.types),D.T=o}}else try{_a(e,t,o=n(r,i))}catch(u){xa(e,t,u)}}function _a(e,t,n){null!==n&&"object"===typeof n&&"function"===typeof n.then?n.then(function(n){Oa(e,t,n)},function(n){return xa(e,t,n)}):Oa(e,t,n)}function Oa(e,t,n){t.status="fulfilled",t.value=n,Ia(t),e.state=n,null!==(t=e.pending)&&((n=t.next)===t?e.pending=null:(n=n.next,t.next=n,Ra(e,n)))}function xa(e,t,n){var i=e.pending;if(e.pending=null,null!==i){i=i.next;do{t.status="rejected",t.reason=n,Ia(t),t=t.next}while(t!==i)}e.action=null}function Ia(e){e=e.listeners;for(var t=0;t<e.length;t++)(0,e[t])()}function Na(e,t){return t}function Aa(e,t){if(dr){var n=ml.formState;if(null!==n){e:{var i=Ho;if(dr){if(ur){t:{for(var r=ur,o=pr;8!==r.nodeType;){if(!o){r=null;break t}if(null===(r=Dd(r.nextSibling))){r=null;break t}}r="F!"===(o=r.data)||"F"===o?r:null}if(r){ur=Dd(r.nextSibling),i="F!"===r.data;break e}}mr(i)}i=!1}i&&(t=n[0])}}return(n=la()).memoizedState=n.baseState=t,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Na,lastRenderedState:t},n.queue=i,n=us.bind(null,Ho,i),i.dispatch=n,i=Ca(!1),o=hs.bind(null,Ho,!1,i.queue),r={state:t,dispatch:null,action:e,pending:null},(i=la()).queue=r,n=Pa.bind(null,Ho,r,o,n),r.dispatch=n,i.memoizedState=e,[t,n,!1]}function Da(e){return La(ua(),Wo,e)}function La(e,t,n){if(t=ga(e,t,Na)[0],e=ma(fa)[0],"object"===typeof t&&null!==t&&"function"===typeof t.then)try{var i=da(t)}catch(a){if(a===Yr)throw Zr;throw a}else i=t;var r=(t=ua()).queue,o=r.dispatch;return n!==t.memoizedState&&(Ho.flags|=2048,Ua(9,{destroy:void 0},Ma.bind(null,r,n),null)),[i,o,e]}function Ma(e,t){e.action=t}function ja(e){var t=ua(),n=Wo;if(null!==n)return La(t,n,e);ua(),t=t.memoizedState;var i=(n=ua()).queue.dispatch;return n.memoizedState=e,[t,i,!1]}function Ua(e,t,n,i){return e={tag:e,create:n,deps:i,inst:t,next:null},null===(t=Ho.updateQueue)&&(t={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=t),null===(n=t.lastEffect)?t.lastEffect=e.next=e:(i=n.next,n.next=e,e.next=i,t.lastEffect=e),e}function Fa(){return ua().memoizedState}function Ba(e,t,n,i){var r=la();Ho.flags|=e,r.memoizedState=Ua(1|t,{destroy:void 0},n,void 0===i?null:i)}function za(e,t,n,i){var r=ua();i=void 0===i?null:i;var o=r.memoizedState.inst;null!==Wo&&null!==i&&ta(i,Wo.memoizedState.deps)?r.memoizedState=Ua(t,o,n,i):(Ho.flags|=e,r.memoizedState=Ua(1|t,o,n,i))}function qa(e,t){Ba(8390656,8,e,t)}function Va(e,t){za(2048,8,e,t)}function Ha(e){var t=ua().memoizedState;return function(e){Ho.flags|=4;var t=Ho.updateQueue;if(null===t)t={lastEffect:null,events:null,stores:null,memoCache:null},Ho.updateQueue=t,t.events=[e];else{var n=t.events;null===n?t.events=[e]:n.push(e)}}({ref:t,nextImpl:e}),function(){if(0!==(2&fl))throw Error(a(440));return t.impl.apply(void 0,arguments)}}function Wa(e,t){return za(4,2,e,t)}function Ka(e,t){return za(4,4,e,t)}function Ga(e,t){if("function"===typeof t){e=e();var n=t(e);return function(){"function"===typeof n?n():t(null)}}if(null!==t&&void 0!==t)return e=e(),t.current=e,function(){t.current=null}}function Ja(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,za(4,4,Ga.bind(null,t,e),n)}function Qa(){}function $a(e,t){var n=ua();t=void 0===t?null:t;var i=n.memoizedState;return null!==t&&ta(t,i[1])?i[0]:(n.memoizedState=[e,t],e)}function Ya(e,t){var n=ua();t=void 0===t?null:t;var i=n.memoizedState;if(null!==t&&ta(t,i[1]))return i[0];if(i=e(),Qo){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[i,t],i}function Xa(e,t,n){return void 0===n||0!==(1073741824&Vo)&&0===(261930&vl)?e.memoizedState=t:(e.memoizedState=n,e=Jl(),Ho.lanes|=e,El|=e,n)}function Za(e,t,n,i){return Xn(n,t)?n:null!==Oo.current?(e=Xa(e,n,i),Xn(e,t)||(Ds=!0),e):0===(42&Vo)||0!==(1073741824&Vo)&&0===(261930&vl)?(Ds=!0,e.memoizedState=n):(e=Jl(),Ho.lanes|=e,El|=e,t)}function es(e,t,n,i,r){var o=L.p;L.p=0!==o&&8>o?o:8;var a=D.T,s={};D.T=s,hs(e,!1,t,n);try{var c=r(),l=D.S;if(null!==l&&l(s,c),null!==c&&"object"===typeof c&&"function"===typeof c.then)ds(e,t,function(e,t){var n=[],i={status:"pending",value:null,reason:null,then:function(e){n.push(e)}};return e.then(function(){i.status="fulfilled",i.value=t;for(var e=0;e<n.length;e++)(0,n[e])(t)},function(e){for(i.status="rejected",i.reason=e,e=0;e<n.length;e++)(0,n[e])(void 0)}),i}(c,i),Gl());else ds(e,t,i,Gl())}catch(u){ds(e,t,{then:function(){},status:"rejected",reason:u},Gl())}finally{L.p=o,null!==a&&null!==s.types&&(a.types=s.types),D.T=a}}function ts(){}function ns(e,t,n,i){if(5!==e.tag)throw Error(a(476));var r=is(e).queue;es(e,r,t,M,null===n?ts:function(){return rs(e),n(i)})}function is(e){var t=e.memoizedState;if(null!==t)return t;var n={};return(t={memoizedState:M,baseState:M,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:M},next:null}).next={memoizedState:n,baseState:n,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:fa,lastRenderedState:n},next:null},e.memoizedState=t,null!==(e=e.alternate)&&(e.memoizedState=t),t}function rs(e){var t=is(e);null===t.next&&(t=e.alternate.memoizedState),ds(e,t.next.queue,{},Gl())}function os(){return Nr(dh)}function as(){return ua().memoizedState}function ss(){return ua().memoizedState}function cs(e){for(var t=e.return;null!==t;){switch(t.tag){case 24:case 3:var n=Gl(),i=ko(t,e=bo(n),n);return null!==i&&(Ql(i,t,n),wo(i,t,n)),t={cache:Fr()},void(e.payload=t)}t=t.return}}function ls(e,t,n){var i=Gl();n={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null},ps(e)?fs(t,n):null!==(n=Ni(e,t,n,i))&&(Ql(n,e,i),ms(n,t,i))}function us(e,t,n){ds(e,t,n,Gl())}function ds(e,t,n,i){var r={lane:i,revertLane:0,gesture:null,action:n,hasEagerState:!1,eagerState:null,next:null};if(ps(e))fs(t,r);else{var o=e.alternate;if(0===e.lanes&&(null===o||0===o.lanes)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(r.hasEagerState=!0,r.eagerState=s,Xn(s,a))return Ii(e,t,r,0),null===ml&&xi(),!1}catch(c){}if(null!==(n=Ni(e,t,r,i)))return Ql(n,e,i),ms(n,t,i),!0}return!1}function hs(e,t,n,i){if(i={lane:2,revertLane:Vu(),gesture:null,action:i,hasEagerState:!1,eagerState:null,next:null},ps(e)){if(t)throw Error(a(479))}else null!==(t=Ni(e,n,i,2))&&Ql(t,e,2)}function ps(e){var t=e.alternate;return e===Ho||null!==t&&t===Ho}function fs(e,t){Jo=Go=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ms(e,t,n){if(0!==(4194048&n)){var i=t.lanes;n|=i&=e.pendingLanes,t.lanes=n,De(e,n)}}var gs={readContext:Nr,use:ha,useCallback:ea,useContext:ea,useEffect:ea,useImperativeHandle:ea,useLayoutEffect:ea,useInsertionEffect:ea,useMemo:ea,useReducer:ea,useRef:ea,useState:ea,useDebugValue:ea,useDeferredValue:ea,useTransition:ea,useSyncExternalStore:ea,useId:ea,useHostTransitionStatus:ea,useFormState:ea,useActionState:ea,useOptimistic:ea,useMemoCache:ea,useCacheRefresh:ea};gs.useEffectEvent=ea;var vs={readContext:Nr,use:ha,useCallback:function(e,t){return la().memoizedState=[e,void 0===t?null:t],e},useContext:Nr,useEffect:qa,useImperativeHandle:function(e,t,n){n=null!==n&&void 0!==n?n.concat([e]):null,Ba(4194308,4,Ga.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Ba(4194308,4,e,t)},useInsertionEffect:function(e,t){Ba(4,2,e,t)},useMemo:function(e,t){var n=la();t=void 0===t?null:t;var i=e();if(Qo){be(!0);try{e()}finally{be(!1)}}return n.memoizedState=[i,t],i},useReducer:function(e,t,n){var i=la();if(void 0!==n){var r=n(t);if(Qo){be(!0);try{n(t)}finally{be(!1)}}}else r=t;return i.memoizedState=i.baseState=r,e={pending:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:r},i.queue=e,e=e.dispatch=ls.bind(null,Ho,e),[i.memoizedState,e]},useRef:function(e){return e={current:e},la().memoizedState=e},useState:function(e){var t=(e=Ca(e)).queue,n=us.bind(null,Ho,t);return t.dispatch=n,[e.memoizedState,n]},useDebugValue:Qa,useDeferredValue:function(e,t){return Xa(la(),e,t)},useTransition:function(){var e=Ca(!1);return e=es.bind(null,Ho,e.queue,!0,!1),la().memoizedState=e,[!1,e]},useSyncExternalStore:function(e,t,n){var i=Ho,r=la();if(dr){if(void 0===n)throw Error(a(407));n=n()}else{if(n=t(),null===ml)throw Error(a(349));0!==(127&vl)||ba(i,t,n)}r.memoizedState=n;var o={value:n,getSnapshot:t};return r.queue=o,qa(Sa.bind(null,i,o,e),[e]),i.flags|=2048,Ua(9,{destroy:void 0},ka.bind(null,i,o,n,t),null),n},useId:function(){var e=la(),t=ml.identifierPrefix;if(dr){var n=ir;t="_"+t+"R_"+(n=(nr&~(1<<32-ke(nr)-1)).toString(32)+n),0<(n=$o++)&&(t+="H"+n.toString(32)),t+="_"}else t="_"+t+"r_"+(n=Zo++).toString(32)+"_";return e.memoizedState=t},useHostTransitionStatus:os,useFormState:Aa,useActionState:Aa,useOptimistic:function(e){var t=la();t.memoizedState=t.baseState=e;var n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return t.queue=n,t=hs.bind(null,Ho,!0,n),n.dispatch=t,[e,t]},useMemoCache:pa,useCacheRefresh:function(){return la().memoizedState=cs.bind(null,Ho)},useEffectEvent:function(e){var t=la(),n={impl:e};return t.memoizedState=n,function(){if(0!==(2&fl))throw Error(a(440));return n.impl.apply(void 0,arguments)}}},ys={readContext:Nr,use:ha,useCallback:$a,useContext:Nr,useEffect:Va,useImperativeHandle:Ja,useInsertionEffect:Wa,useLayoutEffect:Ka,useMemo:Ya,useReducer:ma,useRef:Fa,useState:function(){return ma(fa)},useDebugValue:Qa,useDeferredValue:function(e,t){return Za(ua(),Wo.memoizedState,e,t)},useTransition:function(){var e=ma(fa)[0],t=ua().memoizedState;return["boolean"===typeof e?e:da(e),t]},useSyncExternalStore:ya,useId:as,useHostTransitionStatus:os,useFormState:Da,useActionState:Da,useOptimistic:function(e,t){return Ea(ua(),0,e,t)},useMemoCache:pa,useCacheRefresh:ss};ys.useEffectEvent=Ha;var bs={readContext:Nr,use:ha,useCallback:$a,useContext:Nr,useEffect:Va,useImperativeHandle:Ja,useInsertionEffect:Wa,useLayoutEffect:Ka,useMemo:Ya,useReducer:va,useRef:Fa,useState:function(){return va(fa)},useDebugValue:Qa,useDeferredValue:function(e,t){var n=ua();return null===Wo?Xa(n,e,t):Za(n,Wo.memoizedState,e,t)},useTransition:function(){var e=va(fa)[0],t=ua().memoizedState;return["boolean"===typeof e?e:da(e),t]},useSyncExternalStore:ya,useId:as,useHostTransitionStatus:os,useFormState:ja,useActionState:ja,useOptimistic:function(e,t){var n=ua();return null!==Wo?Ea(n,0,e,t):(n.baseState=e,[e,n.queue.dispatch])},useMemoCache:pa,useCacheRefresh:ss};function ks(e,t,n,i){n=null===(n=n(i,t=e.memoizedState))||void 0===n?t:p({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}bs.useEffectEvent=Ha;var Ss={enqueueSetState:function(e,t,n){e=e._reactInternals;var i=Gl(),r=bo(i);r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=ko(e,r,i))&&(Ql(t,e,i),wo(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var i=Gl(),r=bo(i);r.tag=1,r.payload=t,void 0!==n&&null!==n&&(r.callback=n),null!==(t=ko(e,r,i))&&(Ql(t,e,i),wo(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Gl(),i=bo(n);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=ko(e,i,n))&&(Ql(t,e,n),wo(t,e,n))}};function ws(e,t,n,i,r,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(i,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!Zn(n,i)||!Zn(r,o))}function Ts(e,t,n,i){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,i),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,i),t.state!==e&&Ss.enqueueReplaceState(t,t.state,null)}function Cs(e,t){var n=t;if("ref"in t)for(var i in n={},t)"ref"!==i&&(n[i]=t[i]);if(e=e.defaultProps)for(var r in n===t&&(n=p({},n)),e)void 0===n[r]&&(n[r]=e[r]);return n}function Es(e){Pi(e)}function Ps(e){console.error(e)}function Rs(e){Pi(e)}function _s(e,t){try{(0,e.onUncaughtError)(t.value,{componentStack:t.stack})}catch(n){setTimeout(function(){throw n})}}function Os(e,t,n){try{(0,e.onCaughtError)(n.value,{componentStack:n.stack,errorBoundary:1===t.tag?t.stateNode:null})}catch(i){setTimeout(function(){throw i})}}function xs(e,t,n){return(n=bo(n)).tag=3,n.payload={element:null},n.callback=function(){_s(e,t)},n}function Is(e){return(e=bo(e)).tag=3,e}function Ns(e,t,n,i){var r=n.type.getDerivedStateFromError;if("function"===typeof r){var o=i.value;e.payload=function(){return r(o)},e.callback=function(){Os(t,n,i)}}var a=n.stateNode;null!==a&&"function"===typeof a.componentDidCatch&&(e.callback=function(){Os(t,n,i),"function"!==typeof r&&(null===jl?jl=new Set([this]):jl.add(this));var e=i.stack;this.componentDidCatch(i.value,{componentStack:null!==e?e:""})})}var As=Error(a(461)),Ds=!1;function Ls(e,t,n,i){t.child=null===e?mo(t,null,n,i):fo(t,e.child,n,i)}function Ms(e,t,n,i,r){n=n.render;var o=t.ref;if("ref"in i){var a={};for(var s in i)"ref"!==s&&(a[s]=i[s])}else a=i;return Ir(t),i=na(e,t,n,a,o,r),s=aa(),null===e||Ds?(dr&&s&&ar(t),t.flags|=1,Ls(e,t,i,r),t.child):(sa(e,t,r),oc(e,t,r))}function js(e,t,n,i,r){if(null===e){var o=n.type;return"function"!==typeof o||Fi(o)||void 0!==o.defaultProps||null!==n.compare?((e=qi(n.type,null,i,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=o,Us(e,t,o,i,r))}if(o=e.child,!ac(e,r)){var a=o.memoizedProps;if((n=null!==(n=n.compare)?n:Zn)(a,i)&&e.ref===t.ref)return oc(e,t,r)}return t.flags|=1,(e=Bi(o,i)).ref=t.ref,e.return=t,t.child=e}function Us(e,t,n,i,r){if(null!==e){var o=e.memoizedProps;if(Zn(o,i)&&e.ref===t.ref){if(Ds=!1,t.pendingProps=i=o,!ac(e,r))return t.lanes=e.lanes,oc(e,t,r);0!==(131072&e.flags)&&(Ds=!0)}}return Ws(e,t,n,i,r)}function Fs(e,t,n,i){var r=i.children,o=null!==e?e.memoizedState:null;if(null===e&&null===t.stateNode&&(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),"hidden"===i.mode){if(0!==(128&t.flags)){if(o=null!==o?o.baseLanes|n:n,null!==e){for(i=t.child=e.child,r=0;null!==i;)r=r|i.lanes|i.childLanes,i=i.sibling;i=r&~o}else i=0,t.child=null;return zs(e,t,o,n,i)}if(0===(536870912&n))return i=t.lanes=536870912,zs(e,t,null!==o?o.baseLanes|n:n,n,i);t.memoizedState={baseLanes:0,cachePool:null},null!==e&&Qr(0,null!==o?o.cachePool:null),null!==o?Io(t,o):No(),Uo(t)}else null!==o?(Qr(0,o.cachePool),Io(t,o),Fo(),t.memoizedState=null):(null!==e&&Qr(0,null),No(),Fo());return Ls(e,t,r,n),t.child}function Bs(e,t){return null!==e&&22===e.tag||null!==t.stateNode||(t.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),t.sibling}function zs(e,t,n,i,r){var o=Jr();return o=null===o?null:{parent:Ur._currentValue,pool:o},t.memoizedState={baseLanes:n,cachePool:o},null!==e&&Qr(0,null),No(),Uo(t),null!==e&&Or(e,t,i,!0),t.childLanes=r,null}function qs(e,t){return(t=ec({mode:t.mode,children:t.children},e.mode)).ref=e.ref,e.child=t,t.return=e,t}function Vs(e,t,n){return fo(t,e.child,null,n),(e=qs(t,t.pendingProps)).flags|=2,Bo(t),t.memoizedState=null,e}function Hs(e,t){var n=t.ref;if(null===n)null!==e&&null!==e.ref&&(t.flags|=4194816);else{if("function"!==typeof n&&"object"!==typeof n)throw Error(a(284));null!==e&&e.ref===n||(t.flags|=4194816)}}function Ws(e,t,n,i,r){return Ir(t),n=na(e,t,n,i,void 0,r),i=aa(),null===e||Ds?(dr&&i&&ar(t),t.flags|=1,Ls(e,t,n,r),t.child):(sa(e,t,r),oc(e,t,r))}function Ks(e,t,n,i,r,o){return Ir(t),t.updateQueue=null,n=ra(t,i,n,r),ia(e),i=aa(),null===e||Ds?(dr&&i&&ar(t),t.flags|=1,Ls(e,t,n,o),t.child):(sa(e,t,o),oc(e,t,o))}function Gs(e,t,n,i,r){if(Ir(t),null===t.stateNode){var o=Mi,a=n.contextType;"object"===typeof a&&null!==a&&(o=Nr(a)),o=new n(i,o),t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,o.updater=Ss,t.stateNode=o,o._reactInternals=t,(o=t.stateNode).props=i,o.state=t.memoizedState,o.refs={},vo(t),a=n.contextType,o.context="object"===typeof a&&null!==a?Nr(a):Mi,o.state=t.memoizedState,"function"===typeof(a=n.getDerivedStateFromProps)&&(ks(t,n,a,i),o.state=t.memoizedState),"function"===typeof n.getDerivedStateFromProps||"function"===typeof o.getSnapshotBeforeUpdate||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||(a=o.state,"function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),a!==o.state&&Ss.enqueueReplaceState(o,o.state,null),Po(t,i,o,r),Eo(),o.state=t.memoizedState),"function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!0}else if(null===e){o=t.stateNode;var s=t.memoizedProps,c=Cs(n,s);o.props=c;var l=o.context,u=n.contextType;a=Mi,"object"===typeof u&&null!==u&&(a=Nr(u));var d=n.getDerivedStateFromProps;u="function"===typeof d||"function"===typeof o.getSnapshotBeforeUpdate,s=t.pendingProps!==s,u||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(s||l!==a)&&Ts(t,o,i,a),go=!1;var h=t.memoizedState;o.state=h,Po(t,i,o,r),Eo(),l=t.memoizedState,s||h!==l||go?("function"===typeof d&&(ks(t,n,d,i),l=t.memoizedState),(c=go||ws(t,n,c,i,h,l,a))?(u||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=i,t.memoizedState=l),o.props=i,o.state=l,o.context=a,i=c):("function"===typeof o.componentDidMount&&(t.flags|=4194308),i=!1)}else{o=t.stateNode,yo(e,t),u=Cs(n,a=t.memoizedProps),o.props=u,d=t.pendingProps,h=o.context,l=n.contextType,c=Mi,"object"===typeof l&&null!==l&&(c=Nr(l)),(l="function"===typeof(s=n.getDerivedStateFromProps)||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==d||h!==c)&&Ts(t,o,i,c),go=!1,h=t.memoizedState,o.state=h,Po(t,i,o,r),Eo();var p=t.memoizedState;a!==d||h!==p||go||null!==e&&null!==e.dependencies&&xr(e.dependencies)?("function"===typeof s&&(ks(t,n,s,i),p=t.memoizedState),(u=go||ws(t,n,u,i,h,p,c)||null!==e&&null!==e.dependencies&&xr(e.dependencies))?(l||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(i,p,c),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(i,p,c)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=i,t.memoizedState=p),o.props=i,o.state=p,o.context=c,i=u):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),i=!1)}return o=i,Hs(e,t),i=0!==(128&t.flags),o||i?(o=t.stateNode,n=i&&"function"!==typeof n.getDerivedStateFromError?null:o.render(),t.flags|=1,null!==e&&i?(t.child=fo(t,e.child,null,r),t.child=fo(t,null,n,r)):Ls(e,t,n,r),t.memoizedState=o.state,e=t.child):e=oc(e,t,r),e}function Js(e,t,n,i){return br(),t.flags|=256,Ls(e,t,n,i),t.child}var Qs={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function $s(e){return{baseLanes:e,cachePool:$r()}}function Ys(e,t,n){return e=null!==e?e.childLanes&~n:0,t&&(e|=_l),e}function Xs(e,t,n){var i,r=t.pendingProps,o=!1,s=0!==(128&t.flags);if((i=s)||(i=(null===e||null!==e.memoizedState)&&0!==(2&zo.current)),i&&(o=!0,t.flags&=-129),i=0!==(32&t.flags),t.flags&=-33,null===e){if(dr){if(o?Mo(t):Fo(),(e=ur)?null!==(e=null!==(e=Id(e,pr))&&"&"!==e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==tr?{id:nr,overflow:ir}:null,retryLane:536870912,hydrationErrors:null},(n=Wi(e)).return=t,t.child=n,lr=t,ur=null):e=null,null===e)throw mr(t);return Ad(e)?t.lanes=32:t.lanes=536870912,null}var c=r.children;return r=r.fallback,o?(Fo(),c=ec({mode:"hidden",children:c},o=t.mode),r=Vi(r,o,n,null),c.return=t,r.return=t,c.sibling=r,t.child=c,(r=t.child).memoizedState=$s(n),r.childLanes=Ys(e,i,n),t.memoizedState=Qs,Bs(null,r)):(Mo(t),Zs(t,c))}var l=e.memoizedState;if(null!==l&&null!==(c=l.dehydrated)){if(s)256&t.flags?(Mo(t),t.flags&=-257,t=tc(e,t,n)):null!==t.memoizedState?(Fo(),t.child=e.child,t.flags|=128,t=null):(Fo(),c=r.fallback,o=t.mode,r=ec({mode:"visible",children:r.children},o),(c=Vi(c,o,n,null)).flags|=2,r.return=t,c.return=t,r.sibling=c,t.child=r,fo(t,e.child,null,n),(r=t.child).memoizedState=$s(n),r.childLanes=Ys(e,i,n),t.memoizedState=Qs,t=Bs(null,r));else if(Mo(t),Ad(c)){if(i=c.nextSibling&&c.nextSibling.dataset)var u=i.dgst;i=u,(r=Error(a(419))).stack="",r.digest=i,Sr({value:r,source:null,stack:null}),t=tc(e,t,n)}else if(Ds||Or(e,t,n,!1),i=0!==(n&e.childLanes),Ds||i){if(null!==(i=ml)&&(0!==(r=Le(i,n))&&r!==l.retryLane))throw l.retryLane=r,Ai(e,r),Ql(i,e,r),As;Nd(c)||su(),t=tc(e,t,n)}else Nd(c)?(t.flags|=192,t.child=e.child,t=null):(e=l.treeContext,ur=Dd(c.nextSibling),lr=t,dr=!0,hr=null,pr=!1,null!==e&&cr(t,e),(t=Zs(t,r.children)).flags|=4096);return t}return o?(Fo(),c=r.fallback,o=t.mode,u=(l=e.child).sibling,(r=Bi(l,{mode:"hidden",children:r.children})).subtreeFlags=65011712&l.subtreeFlags,null!==u?c=Bi(u,c):(c=Vi(c,o,n,null)).flags|=2,c.return=t,r.return=t,r.sibling=c,t.child=r,Bs(null,r),r=t.child,null===(c=e.child.memoizedState)?c=$s(n):(null!==(o=c.cachePool)?(l=Ur._currentValue,o=o.parent!==l?{parent:l,pool:l}:o):o=$r(),c={baseLanes:c.baseLanes|n,cachePool:o}),r.memoizedState=c,r.childLanes=Ys(e,i,n),t.memoizedState=Qs,Bs(e.child,r)):(Mo(t),e=(n=e.child).sibling,(n=Bi(n,{mode:"visible",children:r.children})).return=t,n.sibling=null,null!==e&&(null===(i=t.deletions)?(t.deletions=[e],t.flags|=16):i.push(e)),t.child=n,t.memoizedState=null,n)}function Zs(e,t){return(t=ec({mode:"visible",children:t},e.mode)).return=e,e.child=t}function ec(e,t){return(e=Ui(22,e,null,t)).lanes=0,e}function tc(e,t,n){return fo(t,e.child,null,n),(e=Zs(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function nc(e,t,n){e.lanes|=t;var i=e.alternate;null!==i&&(i.lanes|=t),Rr(e.return,t,n)}function ic(e,t,n,i,r,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r,treeForkCount:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=i,a.tail=n,a.tailMode=r,a.treeForkCount=o)}function rc(e,t,n){var i=t.pendingProps,r=i.revealOrder,o=i.tail;i=i.children;var a=zo.current,s=0!==(2&a);if(s?(a=1&a|2,t.flags|=128):a&=1,z(zo,a),Ls(e,t,i,n),i=dr?Xi:0,!s&&null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&nc(e,n,t);else if(19===e.tag)nc(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}switch(r){case"forwards":for(n=t.child,r=null;null!==n;)null!==(e=n.alternate)&&null===qo(e)&&(r=n),n=n.sibling;null===(n=r)?(r=t.child,t.child=null):(r=n.sibling,n.sibling=null),ic(t,!1,r,n,o,i);break;case"backwards":case"unstable_legacy-backwards":for(n=null,r=t.child,t.child=null;null!==r;){if(null!==(e=r.alternate)&&null===qo(e)){t.child=r;break}e=r.sibling,r.sibling=n,n=r,r=e}ic(t,!0,n,null,o,i);break;case"together":ic(t,!1,null,null,void 0,i);break;default:t.memoizedState=null}return t.child}function oc(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),El|=t.lanes,0===(n&t.childLanes)){if(null===e)return null;if(Or(e,t,n,!1),0===(n&t.childLanes))return null}if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Bi(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Bi(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function ac(e,t){return 0!==(e.lanes&t)||!(null===(e=e.dependencies)||!xr(e))}function sc(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps)Ds=!0;else{if(!ac(e,n)&&0===(128&t.flags))return Ds=!1,function(e,t,n){switch(t.tag){case 3:J(t,t.stateNode.containerInfo),Er(0,Ur,e.memoizedState.cache),br();break;case 27:case 5:$(t);break;case 4:J(t,t.stateNode.containerInfo);break;case 10:Er(0,t.type,t.memoizedProps.value);break;case 31:if(null!==t.memoizedState)return t.flags|=128,jo(t),null;break;case 13:var i=t.memoizedState;if(null!==i)return null!==i.dehydrated?(Mo(t),t.flags|=128,null):0!==(n&t.child.childLanes)?Xs(e,t,n):(Mo(t),null!==(e=oc(e,t,n))?e.sibling:null);Mo(t);break;case 19:var r=0!==(128&e.flags);if((i=0!==(n&t.childLanes))||(Or(e,t,n,!1),i=0!==(n&t.childLanes)),r){if(i)return rc(e,t,n);t.flags|=128}if(null!==(r=t.memoizedState)&&(r.rendering=null,r.tail=null,r.lastEffect=null),z(zo,zo.current),i)break;return null;case 22:return t.lanes=0,Fs(e,t,n,t.pendingProps);case 24:Er(0,Ur,e.memoizedState.cache)}return oc(e,t,n)}(e,t,n);Ds=0!==(131072&e.flags)}else Ds=!1,dr&&0!==(1048576&t.flags)&&or(t,Xi,t.index);switch(t.lanes=0,t.tag){case 16:e:{var i=t.pendingProps;if(e=io(t.elementType),t.type=e,"function"!==typeof e){if(void 0!==e&&null!==e){var r=e.$$typeof;if(r===w){t.tag=11,t=Ms(null,t,e,i,n);break e}if(r===E){t.tag=14,t=js(null,t,e,i,n);break e}}throw t=N(e)||e,Error(a(306,t,""))}Fi(e)?(i=Cs(e,i),t.tag=1,t=Gs(null,t,e,i,n)):(t.tag=0,t=Ws(null,t,e,i,n))}return t;case 0:return Ws(e,t,t.type,t.pendingProps,n);case 1:return Gs(e,t,i=t.type,r=Cs(i,t.pendingProps),n);case 3:e:{if(J(t,t.stateNode.containerInfo),null===e)throw Error(a(387));i=t.pendingProps;var o=t.memoizedState;r=o.element,yo(e,t),Po(t,i,null,n);var s=t.memoizedState;if(i=s.cache,Er(0,Ur,i),i!==o.cache&&_r(t,[Ur],n,!0),Eo(),i=s.element,o.isDehydrated){if(o={element:i,isDehydrated:!1,cache:s.cache},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Js(e,t,i,n);break e}if(i!==r){Sr(r=Ji(Error(a(424)),t)),t=Js(e,t,i,n);break e}if(9===(e=t.stateNode.containerInfo).nodeType)e=e.body;else e="HTML"===e.nodeName?e.ownerDocument.body:e;for(ur=Dd(e.firstChild),lr=t,dr=!0,hr=null,pr=!0,n=mo(t,null,i,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(br(),i===r){t=oc(e,t,n);break e}Ls(e,t,i,n)}t=t.child}return t;case 26:return Hs(e,t),null===e?(n=Kd(t.type,null,t.pendingProps,null))?t.memoizedState=n:dr||(n=t.type,e=t.pendingProps,(i=vd(K.current).createElement(n))[ze]=t,i[qe]=e,pd(i,n,e),et(i),t.stateNode=i):t.memoizedState=Kd(t.type,e.memoizedProps,t.pendingProps,e.memoizedState),null;case 27:return $(t),null===e&&dr&&(i=t.stateNode=Ud(t.type,t.pendingProps,K.current),lr=t,pr=!0,r=ur,Rd(t.type)?(Ld=r,ur=Dd(i.firstChild)):ur=r),Ls(e,t,t.pendingProps.children,n),Hs(e,t),null===e&&(t.flags|=4194304),t.child;case 5:return null===e&&dr&&((r=i=ur)&&(null!==(i=function(e,t,n,i){for(;1===e.nodeType;){var r=n;if(e.nodeName.toLowerCase()!==t.toLowerCase()){if(!i&&("INPUT"!==e.nodeName||"hidden"!==e.type))break}else if(i){if(!e[Je])switch(t){case"meta":if(!e.hasAttribute("itemprop"))break;return e;case"link":if("stylesheet"===(o=e.getAttribute("rel"))&&e.hasAttribute("data-precedence"))break;if(o!==r.rel||e.getAttribute("href")!==(null==r.href||""===r.href?null:r.href)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin)||e.getAttribute("title")!==(null==r.title?null:r.title))break;return e;case"style":if(e.hasAttribute("data-precedence"))break;return e;case"script":if(((o=e.getAttribute("src"))!==(null==r.src?null:r.src)||e.getAttribute("type")!==(null==r.type?null:r.type)||e.getAttribute("crossorigin")!==(null==r.crossOrigin?null:r.crossOrigin))&&o&&e.hasAttribute("async")&&!e.hasAttribute("itemprop"))break;return e;default:return e}}else{if("input"!==t||"hidden"!==e.type)return e;var o=null==r.name?null:""+r.name;if("hidden"===r.type&&e.getAttribute("name")===o)return e}if(null===(e=Dd(e.nextSibling)))break}return null}(i,t.type,t.pendingProps,pr))?(t.stateNode=i,lr=t,ur=Dd(i.firstChild),pr=!1,r=!0):r=!1),r||mr(t)),$(t),r=t.type,o=t.pendingProps,s=null!==e?e.memoizedProps:null,i=o.children,kd(r,o)?i=null:null!==s&&kd(r,s)&&(t.flags|=32),null!==t.memoizedState&&(r=na(e,t,oa,null,null,n),dh._currentValue=r),Hs(e,t),Ls(e,t,i,n),t.child;case 6:return null===e&&dr&&((e=n=ur)&&(null!==(n=function(e,t,n){if(""===t)return null;for(;3!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!n)return null;if(null===(e=Dd(e.nextSibling)))return null}return e}(n,t.pendingProps,pr))?(t.stateNode=n,lr=t,ur=null,e=!0):e=!1),e||mr(t)),null;case 13:return Xs(e,t,n);case 4:return J(t,t.stateNode.containerInfo),i=t.pendingProps,null===e?t.child=fo(t,null,i,n):Ls(e,t,i,n),t.child;case 11:return Ms(e,t,t.type,t.pendingProps,n);case 7:return Ls(e,t,t.pendingProps,n),t.child;case 8:case 12:return Ls(e,t,t.pendingProps.children,n),t.child;case 10:return i=t.pendingProps,Er(0,t.type,i.value),Ls(e,t,i.children,n),t.child;case 9:return r=t.type._context,i=t.pendingProps.children,Ir(t),i=i(r=Nr(r)),t.flags|=1,Ls(e,t,i,n),t.child;case 14:return js(e,t,t.type,t.pendingProps,n);case 15:return Us(e,t,t.type,t.pendingProps,n);case 19:return rc(e,t,n);case 31:return function(e,t,n){var i=t.pendingProps,r=0!==(128&t.flags);if(t.flags&=-129,null===e){if(dr){if("hidden"===i.mode)return e=qs(t,i),t.lanes=536870912,Bs(null,e);if(jo(t),(e=ur)?null!==(e=null!==(e=Id(e,pr))&&"&"===e.data?e:null)&&(t.memoizedState={dehydrated:e,treeContext:null!==tr?{id:nr,overflow:ir}:null,retryLane:536870912,hydrationErrors:null},(n=Wi(e)).return=t,t.child=n,lr=t,ur=null):e=null,null===e)throw mr(t);return t.lanes=536870912,null}return qs(t,i)}var o=e.memoizedState;if(null!==o){var s=o.dehydrated;if(jo(t),r)if(256&t.flags)t.flags&=-257,t=Vs(e,t,n);else{if(null===t.memoizedState)throw Error(a(558));t.child=e.child,t.flags|=128,t=null}else if(Ds||Or(e,t,n,!1),r=0!==(n&e.childLanes),Ds||r){if(null!==(i=ml)&&0!==(s=Le(i,n))&&s!==o.retryLane)throw o.retryLane=s,Ai(e,s),Ql(i,e,s),As;su(),t=Vs(e,t,n)}else e=o.treeContext,ur=Dd(s.nextSibling),lr=t,dr=!0,hr=null,pr=!1,null!==e&&cr(t,e),(t=qs(t,i)).flags|=4096;return t}return(e=Bi(e.child,{mode:i.mode,children:i.children})).ref=t.ref,t.child=e,e.return=t,e}(e,t,n);case 22:return Fs(e,t,n,t.pendingProps);case 24:return Ir(t),i=Nr(Ur),null===e?(null===(r=Jr())&&(r=ml,o=Fr(),r.pooledCache=o,o.refCount++,null!==o&&(r.pooledCacheLanes|=n),r=o),t.memoizedState={parent:i,cache:r},vo(t),Er(0,Ur,r)):(0!==(e.lanes&n)&&(yo(e,t),Po(t,null,null,n),Eo()),r=e.memoizedState,o=t.memoizedState,r.parent!==i?(r={parent:i,cache:i},t.memoizedState=r,0===t.lanes&&(t.memoizedState=t.updateQueue.baseState=r),Er(0,Ur,i)):(i=o.cache,Er(0,Ur,i),i!==r.cache&&_r(t,[Ur],n,!0))),Ls(e,t,t.pendingProps.children,n),t.child;case 29:throw t.pendingProps}throw Error(a(156,t.tag))}function cc(e){e.flags|=4}function lc(e,t,n,i,r){if((t=0!==(32&e.mode))&&(t=!1),t){if(e.flags|=16777216,(335544128&r)===r)if(e.stateNode.complete)e.flags|=8192;else{if(!ru())throw ro=eo,Xr;e.flags|=8192}}else e.flags&=-16777217}function uc(e,t){if("stylesheet"!==t.type||0!==(4&t.state.loading))e.flags&=-16777217;else if(e.flags|=16777216,!oh(t)){if(!ru())throw ro=eo,Xr;e.flags|=8192}}function dc(e,t){null!==t&&(e.flags|=4),16384&e.flags&&(t=22!==e.tag?xe():536870912,e.lanes|=t,Ol|=t)}function hc(e,t){if(!dr)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var i=null;null!==n;)null!==n.alternate&&(i=n),n=n.sibling;null===i?t||null===e.tail?e.tail=null:e.tail.sibling=null:i.sibling=null}}function pc(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,i=0;if(t)for(var r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=65011712&r.subtreeFlags,i|=65011712&r.flags,r.return=e,r=r.sibling;else for(r=e.child;null!==r;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=e,r=r.sibling;return e.subtreeFlags|=i,e.childLanes=n,t}function fc(e,t,n){var i=t.pendingProps;switch(sr(t),t.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:case 1:return pc(t),null;case 3:return n=t.stateNode,i=null,null!==e&&(i=e.memoizedState.cache),t.memoizedState.cache!==i&&(t.flags|=2048),Pr(Ur),Q(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(yr(t)?cc(t):null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,kr())),pc(t),null;case 26:var r=t.type,o=t.memoizedState;return null===e?(cc(t),null!==o?(pc(t),uc(t,o)):(pc(t),lc(t,r,0,0,n))):o?o!==e.memoizedState?(cc(t),pc(t),uc(t,o)):(pc(t),t.flags&=-16777217):((e=e.memoizedProps)!==i&&cc(t),pc(t),lc(t,r,0,0,n)),null;case 27:if(Y(t),n=K.current,r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&cc(t);else{if(!i){if(null===t.stateNode)throw Error(a(166));return pc(t),null}e=H.current,yr(t)?gr(t):(e=Ud(r,i,n),t.stateNode=e,cc(t))}return pc(t),null;case 5:if(Y(t),r=t.type,null!==e&&null!=t.stateNode)e.memoizedProps!==i&&cc(t);else{if(!i){if(null===t.stateNode)throw Error(a(166));return pc(t),null}if(o=H.current,yr(t))gr(t);else{var s=vd(K.current);switch(o){case 1:o=s.createElementNS("http://www.w3.org/2000/svg",r);break;case 2:o=s.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;default:switch(r){case"svg":o=s.createElementNS("http://www.w3.org/2000/svg",r);break;case"math":o=s.createElementNS("http://www.w3.org/1998/Math/MathML",r);break;case"script":(o=s.createElement("div")).innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o="string"===typeof i.is?s.createElement("select",{is:i.is}):s.createElement("select"),i.multiple?o.multiple=!0:i.size&&(o.size=i.size);break;default:o="string"===typeof i.is?s.createElement(r,{is:i.is}):s.createElement(r)}}o[ze]=t,o[qe]=i;e:for(s=t.child;null!==s;){if(5===s.tag||6===s.tag)o.appendChild(s.stateNode);else if(4!==s.tag&&27!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break e;for(;null===s.sibling;){if(null===s.return||s.return===t)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}t.stateNode=o;e:switch(pd(o,r,i),r){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&cc(t)}}return pc(t),lc(t,t.type,null===e||e.memoizedProps,t.pendingProps,n),null;case 6:if(e&&null!=t.stateNode)e.memoizedProps!==i&&cc(t);else{if("string"!==typeof i&&null===t.stateNode)throw Error(a(166));if(e=K.current,yr(t)){if(e=t.stateNode,n=t.memoizedProps,i=null,null!==(r=lr))switch(r.tag){case 27:case 5:i=r.memoizedProps}e[ze]=t,(e=!!(e.nodeValue===n||null!==i&&!0===i.suppressHydrationWarning||ud(e.nodeValue,n)))||mr(t,!0)}else(e=vd(e).createTextNode(i))[ze]=t,t.stateNode=e}return pc(t),null;case 31:if(n=t.memoizedState,null===e||null!==e.memoizedState){if(i=yr(t),null!==n){if(null===e){if(!i)throw Error(a(318));if(!(e=null!==(e=t.memoizedState)?e.dehydrated:null))throw Error(a(557));e[ze]=t}else br(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;pc(t),e=!1}else n=kr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=n),e=!0;if(!e)return 256&t.flags?(Bo(t),t):(Bo(t),null);if(0!==(128&t.flags))throw Error(a(558))}return pc(t),null;case 13:if(i=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(r=yr(t),null!==i&&null!==i.dehydrated){if(null===e){if(!r)throw Error(a(318));if(!(r=null!==(r=t.memoizedState)?r.dehydrated:null))throw Error(a(317));r[ze]=t}else br(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;pc(t),r=!1}else r=kr(),null!==e&&null!==e.memoizedState&&(e.memoizedState.hydrationErrors=r),r=!0;if(!r)return 256&t.flags?(Bo(t),t):(Bo(t),null)}return Bo(t),0!==(128&t.flags)?(t.lanes=n,t):(n=null!==i,e=null!==e&&null!==e.memoizedState,n&&(r=null,null!==(i=t.child).alternate&&null!==i.alternate.memoizedState&&null!==i.alternate.memoizedState.cachePool&&(r=i.alternate.memoizedState.cachePool.pool),o=null,null!==i.memoizedState&&null!==i.memoizedState.cachePool&&(o=i.memoizedState.cachePool.pool),o!==r&&(i.flags|=2048)),n!==e&&n&&(t.child.flags|=8192),dc(t,t.updateQueue),pc(t),null);case 4:return Q(),null===e&&ed(t.stateNode.containerInfo),pc(t),null;case 10:return Pr(t.type),pc(t),null;case 19:if(B(zo),null===(i=t.memoizedState))return pc(t),null;if(r=0!==(128&t.flags),null===(o=i.rendering))if(r)hc(i,!1);else{if(0!==Cl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=qo(e))){for(t.flags|=128,hc(i,!1),e=o.updateQueue,t.updateQueue=e,dc(t,e),t.subtreeFlags=0,e=n,n=t.child;null!==n;)zi(n,e),n=n.sibling;return z(zo,1&zo.current|2),dr&&rr(t,i.treeForkCount),t.child}e=e.sibling}null!==i.tail&&ce()>Ll&&(t.flags|=128,r=!0,hc(i,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=qo(o))){if(t.flags|=128,r=!0,e=e.updateQueue,t.updateQueue=e,dc(t,e),hc(i,!0),null===i.tail&&"hidden"===i.tailMode&&!o.alternate&&!dr)return pc(t),null}else 2*ce()-i.renderingStartTime>Ll&&536870912!==n&&(t.flags|=128,r=!0,hc(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(null!==(e=i.last)?e.sibling=o:t.child=o,i.last=o)}return null!==i.tail?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=ce(),e.sibling=null,n=zo.current,z(zo,r?1&n|2:1&n),dr&&rr(t,i.treeForkCount),e):(pc(t),null);case 22:case 23:return Bo(t),Ao(),i=null!==t.memoizedState,null!==e?null!==e.memoizedState!==i&&(t.flags|=8192):i&&(t.flags|=8192),i?0!==(536870912&n)&&0===(128&t.flags)&&(pc(t),6&t.subtreeFlags&&(t.flags|=8192)):pc(t),null!==(n=t.updateQueue)&&dc(t,n.retryQueue),n=null,null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),i=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(i=t.memoizedState.cachePool.pool),i!==n&&(t.flags|=2048),null!==e&&B(Gr),null;case 24:return n=null,null!==e&&(n=e.memoizedState.cache),t.memoizedState.cache!==n&&(t.flags|=2048),Pr(Ur),pc(t),null;case 25:case 30:return null}throw Error(a(156,t.tag))}function mc(e,t){switch(sr(t),t.tag){case 1:return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Pr(Ur),Q(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 26:case 27:case 5:return Y(t),null;case 31:if(null!==t.memoizedState){if(Bo(t),null===t.alternate)throw Error(a(340));br()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 13:if(Bo(t),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(a(340));br()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return B(zo),null;case 4:return Q(),null;case 10:return Pr(t.type),null;case 22:case 23:return Bo(t),Ao(),null!==e&&B(Gr),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 24:return Pr(Ur),null;default:return null}}function gc(e,t){switch(sr(t),t.tag){case 3:Pr(Ur),Q();break;case 26:case 27:case 5:Y(t);break;case 4:Q();break;case 31:null!==t.memoizedState&&Bo(t);break;case 13:Bo(t);break;case 19:B(zo);break;case 10:Pr(t.type);break;case 22:case 23:Bo(t),Ao(),null!==e&&B(Gr);break;case 24:Pr(Ur)}}function vc(e,t){try{var n=t.updateQueue,i=null!==n?n.lastEffect:null;if(null!==i){var r=i.next;n=r;do{if((n.tag&e)===e){i=void 0;var o=n.create,a=n.inst;i=o(),a.destroy=i}n=n.next}while(n!==r)}}catch(s){Cu(t,t.return,s)}}function yc(e,t,n){try{var i=t.updateQueue,r=null!==i?i.lastEffect:null;if(null!==r){var o=r.next;i=o;do{if((i.tag&e)===e){var a=i.inst,s=a.destroy;if(void 0!==s){a.destroy=void 0,r=t;var c=n,l=s;try{l()}catch(u){Cu(r,c,u)}}}i=i.next}while(i!==o)}}catch(u){Cu(t,t.return,u)}}function bc(e){var t=e.updateQueue;if(null!==t){var n=e.stateNode;try{_o(t,n)}catch(i){Cu(e,e.return,i)}}}function kc(e,t,n){n.props=Cs(e.type,e.memoizedProps),n.state=e.memoizedState;try{n.componentWillUnmount()}catch(i){Cu(e,t,i)}}function Sc(e,t){try{var n=e.ref;if(null!==n){switch(e.tag){case 26:case 27:case 5:var i=e.stateNode;break;default:i=e.stateNode}"function"===typeof n?e.refCleanup=n(i):n.current=i}}catch(r){Cu(e,t,r)}}function wc(e,t){var n=e.ref,i=e.refCleanup;if(null!==n)if("function"===typeof i)try{i()}catch(r){Cu(e,t,r)}finally{e.refCleanup=null,null!=(e=e.alternate)&&(e.refCleanup=null)}else if("function"===typeof n)try{n(null)}catch(o){Cu(e,t,o)}else n.current=null}function Tc(e){var t=e.type,n=e.memoizedProps,i=e.stateNode;try{e:switch(t){case"button":case"input":case"select":case"textarea":n.autoFocus&&i.focus();break e;case"img":n.src?i.src=n.src:n.srcSet&&(i.srcset=n.srcSet)}}catch(r){Cu(e,e.return,r)}}function Cc(e,t,n){try{var i=e.stateNode;!function(e,t,n,i){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var r=null,o=null,s=null,c=null,l=null,u=null,d=null;for(f in n){var h=n[f];if(n.hasOwnProperty(f)&&null!=h)switch(f){case"checked":case"value":break;case"defaultValue":l=h;default:i.hasOwnProperty(f)||dd(e,t,f,null,i,h)}}for(var p in i){var f=i[p];if(h=n[p],i.hasOwnProperty(p)&&(null!=f||null!=h))switch(p){case"type":o=f;break;case"name":r=f;break;case"checked":u=f;break;case"defaultChecked":d=f;break;case"value":s=f;break;case"defaultValue":c=f;break;case"children":case"dangerouslySetInnerHTML":if(null!=f)throw Error(a(137,t));break;default:f!==h&&dd(e,t,p,f,i,h)}}return void yt(e,s,c,l,u,d,o,r);case"select":for(o in f=s=c=p=null,n)if(l=n[o],n.hasOwnProperty(o)&&null!=l)switch(o){case"value":break;case"multiple":f=l;default:i.hasOwnProperty(o)||dd(e,t,o,null,i,l)}for(r in i)if(o=i[r],l=n[r],i.hasOwnProperty(r)&&(null!=o||null!=l))switch(r){case"value":p=o;break;case"defaultValue":c=o;break;case"multiple":s=o;default:o!==l&&dd(e,t,r,o,i,l)}return t=c,n=s,i=f,void(null!=p?St(e,!!n,p,!1):!!i!==!!n&&(null!=t?St(e,!!n,t,!0):St(e,!!n,n?[]:"",!1)));case"textarea":for(c in f=p=null,n)if(r=n[c],n.hasOwnProperty(c)&&null!=r&&!i.hasOwnProperty(c))switch(c){case"value":case"children":break;default:dd(e,t,c,null,i,r)}for(s in i)if(r=i[s],o=n[s],i.hasOwnProperty(s)&&(null!=r||null!=o))switch(s){case"value":p=r;break;case"defaultValue":f=r;break;case"children":break;case"dangerouslySetInnerHTML":if(null!=r)throw Error(a(91));break;default:r!==o&&dd(e,t,s,r,i,o)}return void wt(e,p,f);case"option":for(var m in n)if(p=n[m],n.hasOwnProperty(m)&&null!=p&&!i.hasOwnProperty(m))if("selected"===m)e.selected=!1;else dd(e,t,m,null,i,p);for(l in i)if(p=i[l],f=n[l],i.hasOwnProperty(l)&&p!==f&&(null!=p||null!=f))if("selected"===l)e.selected=p&&"function"!==typeof p&&"symbol"!==typeof p;else dd(e,t,l,p,i,f);return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var g in n)p=n[g],n.hasOwnProperty(g)&&null!=p&&!i.hasOwnProperty(g)&&dd(e,t,g,null,i,p);for(u in i)if(p=i[u],f=n[u],i.hasOwnProperty(u)&&p!==f&&(null!=p||null!=f))switch(u){case"children":case"dangerouslySetInnerHTML":if(null!=p)throw Error(a(137,t));break;default:dd(e,t,u,p,i,f)}return;default:if(_t(t)){for(var v in n)p=n[v],n.hasOwnProperty(v)&&void 0!==p&&!i.hasOwnProperty(v)&&hd(e,t,v,void 0,i,p);for(d in i)p=i[d],f=n[d],!i.hasOwnProperty(d)||p===f||void 0===p&&void 0===f||hd(e,t,d,p,i,f);return}}for(var y in n)p=n[y],n.hasOwnProperty(y)&&null!=p&&!i.hasOwnProperty(y)&&dd(e,t,y,null,i,p);for(h in i)p=i[h],f=n[h],!i.hasOwnProperty(h)||p===f||null==p&&null==f||dd(e,t,h,p,i,f)}(i,e.type,n,t),i[qe]=t}catch(r){Cu(e,e.return,r)}}function Ec(e){return 5===e.tag||3===e.tag||26===e.tag||27===e.tag&&Rd(e.type)||4===e.tag}function Pc(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||Ec(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(27===e.tag&&Rd(e.type))continue e;if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function Rc(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?(9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).insertBefore(e,t):((t=9===n.nodeType?n.body:"HTML"===n.nodeName?n.ownerDocument.body:n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Nt));else if(4!==i&&(27===i&&Rd(e.type)&&(n=e.stateNode,t=null),null!==(e=e.child)))for(Rc(e,t,n),e=e.sibling;null!==e;)Rc(e,t,n),e=e.sibling}function _c(e,t,n){var i=e.tag;if(5===i||6===i)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==i&&(27===i&&Rd(e.type)&&(n=e.stateNode),null!==(e=e.child)))for(_c(e,t,n),e=e.sibling;null!==e;)_c(e,t,n),e=e.sibling}function Oc(e){var t=e.stateNode,n=e.memoizedProps;try{for(var i=e.type,r=t.attributes;r.length;)t.removeAttributeNode(r[0]);pd(t,i,n),t[ze]=e,t[qe]=n}catch(o){Cu(e,e.return,o)}}var xc=!1,Ic=!1,Nc=!1,Ac="function"===typeof WeakSet?WeakSet:Set,Dc=null;function Lc(e,t,n){var i=n.flags;switch(n.tag){case 0:case 11:case 15:Qc(e,n),4&i&&vc(5,n);break;case 1:if(Qc(e,n),4&i)if(e=n.stateNode,null===t)try{e.componentDidMount()}catch(a){Cu(n,n.return,a)}else{var r=Cs(n.type,t.memoizedProps);t=t.memoizedState;try{e.componentDidUpdate(r,t,e.__reactInternalSnapshotBeforeUpdate)}catch(s){Cu(n,n.return,s)}}64&i&&bc(n),512&i&&Sc(n,n.return);break;case 3:if(Qc(e,n),64&i&&null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 27:case 5:case 1:t=n.child.stateNode}try{_o(e,t)}catch(a){Cu(n,n.return,a)}}break;case 27:null===t&&4&i&&Oc(n);case 26:case 5:Qc(e,n),null===t&&4&i&&Tc(n),512&i&&Sc(n,n.return);break;case 12:Qc(e,n);break;case 31:Qc(e,n),4&i&&zc(e,n);break;case 13:Qc(e,n),4&i&&qc(e,n),64&i&&(null!==(e=n.memoizedState)&&(null!==(e=e.dehydrated)&&function(e,t){var n=e.ownerDocument;if("$~"===e.data)e._reactRetry=t;else if("$?"!==e.data||"loading"!==n.readyState)t();else{var i=function(){t(),n.removeEventListener("DOMContentLoaded",i)};n.addEventListener("DOMContentLoaded",i),e._reactRetry=i}}(e,n=_u.bind(null,n))));break;case 22:if(!(i=null!==n.memoizedState||xc)){t=null!==t&&null!==t.memoizedState||Ic,r=xc;var o=Ic;xc=i,(Ic=t)&&!o?Yc(e,n,0!==(8772&n.subtreeFlags)):Qc(e,n),xc=r,Ic=o}break;case 30:break;default:Qc(e,n)}}function Mc(e){var t=e.alternate;null!==t&&(e.alternate=null,Mc(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&Qe(t)),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}var jc=null,Uc=!1;function Fc(e,t,n){for(n=n.child;null!==n;)Bc(e,t,n),n=n.sibling}function Bc(e,t,n){if(ye&&"function"===typeof ye.onCommitFiberUnmount)try{ye.onCommitFiberUnmount(ve,n)}catch(o){}switch(n.tag){case 26:Ic||wc(n,t),Fc(e,t,n),n.memoizedState?n.memoizedState.count--:n.stateNode&&(n=n.stateNode).parentNode.removeChild(n);break;case 27:Ic||wc(n,t);var i=jc,r=Uc;Rd(n.type)&&(jc=n.stateNode,Uc=!1),Fc(e,t,n),Fd(n.stateNode),jc=i,Uc=r;break;case 5:Ic||wc(n,t);case 6:if(i=jc,r=Uc,jc=null,Fc(e,t,n),Uc=r,null!==(jc=i))if(Uc)try{(9===jc.nodeType?jc.body:"HTML"===jc.nodeName?jc.ownerDocument.body:jc).removeChild(n.stateNode)}catch(a){Cu(n,t,a)}else try{jc.removeChild(n.stateNode)}catch(a){Cu(n,t,a)}break;case 18:null!==jc&&(Uc?(_d(9===(e=jc).nodeType?e.body:"HTML"===e.nodeName?e.ownerDocument.body:e,n.stateNode),Wh(e)):_d(jc,n.stateNode));break;case 4:i=jc,r=Uc,jc=n.stateNode.containerInfo,Uc=!0,Fc(e,t,n),jc=i,Uc=r;break;case 0:case 11:case 14:case 15:yc(2,n,t),Ic||yc(4,n,t),Fc(e,t,n);break;case 1:Ic||(wc(n,t),"function"===typeof(i=n.stateNode).componentWillUnmount&&kc(n,t,i)),Fc(e,t,n);break;case 21:Fc(e,t,n);break;case 22:Ic=(i=Ic)||null!==n.memoizedState,Fc(e,t,n),Ic=i;break;default:Fc(e,t,n)}}function zc(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&null!==(e=e.memoizedState))){e=e.dehydrated;try{Wh(e)}catch(n){Cu(t,t.return,n)}}}function qc(e,t){if(null===t.memoizedState&&(null!==(e=t.alternate)&&(null!==(e=e.memoizedState)&&null!==(e=e.dehydrated))))try{Wh(e)}catch(n){Cu(t,t.return,n)}}function Vc(e,t){var n=function(e){switch(e.tag){case 31:case 13:case 19:var t=e.stateNode;return null===t&&(t=e.stateNode=new Ac),t;case 22:return null===(t=(e=e.stateNode)._retryCache)&&(t=e._retryCache=new Ac),t;default:throw Error(a(435,e.tag))}}(e);t.forEach(function(t){if(!n.has(t)){n.add(t);var i=Ou.bind(null,e,t);t.then(i,i)}})}function Hc(e,t){var n=t.deletions;if(null!==n)for(var i=0;i<n.length;i++){var r=n[i],o=e,s=t,c=s;e:for(;null!==c;){switch(c.tag){case 27:if(Rd(c.type)){jc=c.stateNode,Uc=!1;break e}break;case 5:jc=c.stateNode,Uc=!1;break e;case 3:case 4:jc=c.stateNode.containerInfo,Uc=!0;break e}c=c.return}if(null===jc)throw Error(a(160));Bc(o,s,r),jc=null,Uc=!1,null!==(o=r.alternate)&&(o.return=null),r.return=null}if(13886&t.subtreeFlags)for(t=t.child;null!==t;)Kc(t,e),t=t.sibling}var Wc=null;function Kc(e,t){var n=e.alternate,i=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:Hc(t,e),Gc(e),4&i&&(yc(3,e,e.return),vc(3,e),yc(5,e,e.return));break;case 1:Hc(t,e),Gc(e),512&i&&(Ic||null===n||wc(n,n.return)),64&i&&xc&&(null!==(e=e.updateQueue)&&(null!==(i=e.callbacks)&&(n=e.shared.hiddenCallbacks,e.shared.hiddenCallbacks=null===n?i:n.concat(i))));break;case 26:var r=Wc;if(Hc(t,e),Gc(e),512&i&&(Ic||null===n||wc(n,n.return)),4&i){var o=null!==n?n.memoizedState:null;if(i=e.memoizedState,null===n)if(null===i)if(null===e.stateNode){e:{i=e.type,n=e.memoizedProps,r=r.ownerDocument||r;t:switch(i){case"title":(!(o=r.getElementsByTagName("title")[0])||o[Je]||o[ze]||"http://www.w3.org/2000/svg"===o.namespaceURI||o.hasAttribute("itemprop"))&&(o=r.createElement(i),r.head.insertBefore(o,r.querySelector("head > title"))),pd(o,i,n),o[ze]=e,et(o),i=o;break e;case"link":var s=ih("link","href",r).get(i+(n.href||""));if(s)for(var c=0;c<s.length;c++)if((o=s[c]).getAttribute("href")===(null==n.href||""===n.href?null:n.href)&&o.getAttribute("rel")===(null==n.rel?null:n.rel)&&o.getAttribute("title")===(null==n.title?null:n.title)&&o.getAttribute("crossorigin")===(null==n.crossOrigin?null:n.crossOrigin)){s.splice(c,1);break t}pd(o=r.createElement(i),i,n),r.head.appendChild(o);break;case"meta":if(s=ih("meta","content",r).get(i+(n.content||"")))for(c=0;c<s.length;c++)if((o=s[c]).getAttribute("content")===(null==n.content?null:""+n.content)&&o.getAttribute("name")===(null==n.name?null:n.name)&&o.getAttribute("property")===(null==n.property?null:n.property)&&o.getAttribute("http-equiv")===(null==n.httpEquiv?null:n.httpEquiv)&&o.getAttribute("charset")===(null==n.charSet?null:n.charSet)){s.splice(c,1);break t}pd(o=r.createElement(i),i,n),r.head.appendChild(o);break;default:throw Error(a(468,i))}o[ze]=e,et(o),i=o}e.stateNode=i}else rh(r,e.type,e.stateNode);else e.stateNode=Xd(r,i,e.memoizedProps);else o!==i?(null===o?null!==n.stateNode&&(n=n.stateNode).parentNode.removeChild(n):o.count--,null===i?rh(r,e.type,e.stateNode):Xd(r,i,e.memoizedProps)):null===i&&null!==e.stateNode&&Cc(e,e.memoizedProps,n.memoizedProps)}break;case 27:Hc(t,e),Gc(e),512&i&&(Ic||null===n||wc(n,n.return)),null!==n&&4&i&&Cc(e,e.memoizedProps,n.memoizedProps);break;case 5:if(Hc(t,e),Gc(e),512&i&&(Ic||null===n||wc(n,n.return)),32&e.flags){r=e.stateNode;try{Ct(r,"")}catch(m){Cu(e,e.return,m)}}4&i&&null!=e.stateNode&&Cc(e,r=e.memoizedProps,null!==n?n.memoizedProps:r),1024&i&&(Nc=!0);break;case 6:if(Hc(t,e),Gc(e),4&i){if(null===e.stateNode)throw Error(a(162));i=e.memoizedProps,n=e.stateNode;try{n.nodeValue=i}catch(m){Cu(e,e.return,m)}}break;case 3:if(nh=null,r=Wc,Wc=qd(t.containerInfo),Hc(t,e),Wc=r,Gc(e),4&i&&null!==n&&n.memoizedState.isDehydrated)try{Wh(t.containerInfo)}catch(m){Cu(e,e.return,m)}Nc&&(Nc=!1,Jc(e));break;case 4:i=Wc,Wc=qd(e.stateNode.containerInfo),Hc(t,e),Gc(e),Wc=i;break;case 12:default:Hc(t,e),Gc(e);break;case 31:case 19:Hc(t,e),Gc(e),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,Vc(e,i)));break;case 13:Hc(t,e),Gc(e),8192&e.child.flags&&null!==e.memoizedState!==(null!==n&&null!==n.memoizedState)&&(Al=ce()),4&i&&(null!==(i=e.updateQueue)&&(e.updateQueue=null,Vc(e,i)));break;case 22:r=null!==e.memoizedState;var l=null!==n&&null!==n.memoizedState,u=xc,d=Ic;if(xc=u||r,Ic=d||l,Hc(t,e),Ic=d,xc=u,Gc(e),8192&i)e:for(t=e.stateNode,t._visibility=r?-2&t._visibility:1|t._visibility,r&&(null===n||l||xc||Ic||$c(e)),n=null,t=e;;){if(5===t.tag||26===t.tag){if(null===n){l=n=t;try{if(o=l.stateNode,r)"function"===typeof(s=o.style).setProperty?s.setProperty("display","none","important"):s.display="none";else{c=l.stateNode;var h=l.memoizedProps.style,p=void 0!==h&&null!==h&&h.hasOwnProperty("display")?h.display:null;c.style.display=null==p||"boolean"===typeof p?"":(""+p).trim()}}catch(m){Cu(l,l.return,m)}}}else if(6===t.tag){if(null===n){l=t;try{l.stateNode.nodeValue=r?"":l.memoizedProps}catch(m){Cu(l,l.return,m)}}}else if(18===t.tag){if(null===n){l=t;try{var f=l.stateNode;r?Od(f,!0):Od(l.stateNode,!1)}catch(m){Cu(l,l.return,m)}}}else if((22!==t.tag&&23!==t.tag||null===t.memoizedState||t===e)&&null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;null===t.sibling;){if(null===t.return||t.return===e)break e;n===t&&(n=null),t=t.return}n===t&&(n=null),t.sibling.return=t.return,t=t.sibling}4&i&&(null!==(i=e.updateQueue)&&(null!==(n=i.retryQueue)&&(i.retryQueue=null,Vc(e,n))));case 30:case 21:}}function Gc(e){var t=e.flags;if(2&t){try{for(var n,i=e.return;null!==i;){if(Ec(i)){n=i;break}i=i.return}if(null==n)throw Error(a(160));switch(n.tag){case 27:var r=n.stateNode;_c(e,Pc(e),r);break;case 5:var o=n.stateNode;32&n.flags&&(Ct(o,""),n.flags&=-33),_c(e,Pc(e),o);break;case 3:case 4:var s=n.stateNode.containerInfo;Rc(e,Pc(e),s);break;default:throw Error(a(161))}}catch(c){Cu(e,e.return,c)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function Jc(e){if(1024&e.subtreeFlags)for(e=e.child;null!==e;){var t=e;Jc(t),5===t.tag&&1024&t.flags&&t.stateNode.reset(),e=e.sibling}}function Qc(e,t){if(8772&t.subtreeFlags)for(t=t.child;null!==t;)Lc(e,t.alternate,t),t=t.sibling}function $c(e){for(e=e.child;null!==e;){var t=e;switch(t.tag){case 0:case 11:case 14:case 15:yc(4,t,t.return),$c(t);break;case 1:wc(t,t.return);var n=t.stateNode;"function"===typeof n.componentWillUnmount&&kc(t,t.return,n),$c(t);break;case 27:Fd(t.stateNode);case 26:case 5:wc(t,t.return),$c(t);break;case 22:null===t.memoizedState&&$c(t);break;default:$c(t)}e=e.sibling}}function Yc(e,t,n){for(n=n&&0!==(8772&t.subtreeFlags),t=t.child;null!==t;){var i=t.alternate,r=e,o=t,a=o.flags;switch(o.tag){case 0:case 11:case 15:Yc(r,o,n),vc(4,o);break;case 1:if(Yc(r,o,n),"function"===typeof(r=(i=o).stateNode).componentDidMount)try{r.componentDidMount()}catch(l){Cu(i,i.return,l)}if(null!==(r=(i=o).updateQueue)){var s=i.stateNode;try{var c=r.shared.hiddenCallbacks;if(null!==c)for(r.shared.hiddenCallbacks=null,r=0;r<c.length;r++)Ro(c[r],s)}catch(l){Cu(i,i.return,l)}}n&&64&a&&bc(o),Sc(o,o.return);break;case 27:Oc(o);case 26:case 5:Yc(r,o,n),n&&null===i&&4&a&&Tc(o),Sc(o,o.return);break;case 12:Yc(r,o,n);break;case 31:Yc(r,o,n),n&&4&a&&zc(r,o);break;case 13:Yc(r,o,n),n&&4&a&&qc(r,o);break;case 22:null===o.memoizedState&&Yc(r,o,n),Sc(o,o.return);break;case 30:break;default:Yc(r,o,n)}t=t.sibling}}function Xc(e,t){var n=null;null!==e&&null!==e.memoizedState&&null!==e.memoizedState.cachePool&&(n=e.memoizedState.cachePool.pool),e=null,null!==t.memoizedState&&null!==t.memoizedState.cachePool&&(e=t.memoizedState.cachePool.pool),e!==n&&(null!=e&&e.refCount++,null!=n&&Br(n))}function Zc(e,t){e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Br(e))}function el(e,t,n,i){if(10256&t.subtreeFlags)for(t=t.child;null!==t;)tl(e,t,n,i),t=t.sibling}function tl(e,t,n,i){var r=t.flags;switch(t.tag){case 0:case 11:case 15:el(e,t,n,i),2048&r&&vc(9,t);break;case 1:case 31:case 13:default:el(e,t,n,i);break;case 3:el(e,t,n,i),2048&r&&(e=null,null!==t.alternate&&(e=t.alternate.memoizedState.cache),(t=t.memoizedState.cache)!==e&&(t.refCount++,null!=e&&Br(e)));break;case 12:if(2048&r){el(e,t,n,i),e=t.stateNode;try{var o=t.memoizedProps,a=o.id,s=o.onPostCommit;"function"===typeof s&&s(a,null===t.alternate?"mount":"update",e.passiveEffectDuration,-0)}catch(c){Cu(t,t.return,c)}}else el(e,t,n,i);break;case 23:break;case 22:o=t.stateNode,a=t.alternate,null!==t.memoizedState?2&o._visibility?el(e,t,n,i):il(e,t):2&o._visibility?el(e,t,n,i):(o._visibility|=2,nl(e,t,n,i,0!==(10256&t.subtreeFlags)||!1)),2048&r&&Xc(a,t);break;case 24:el(e,t,n,i),2048&r&&Zc(t.alternate,t)}}function nl(e,t,n,i,r){for(r=r&&(0!==(10256&t.subtreeFlags)||!1),t=t.child;null!==t;){var o=e,a=t,s=n,c=i,l=a.flags;switch(a.tag){case 0:case 11:case 15:nl(o,a,s,c,r),vc(8,a);break;case 23:break;case 22:var u=a.stateNode;null!==a.memoizedState?2&u._visibility?nl(o,a,s,c,r):il(o,a):(u._visibility|=2,nl(o,a,s,c,r)),r&&2048&l&&Xc(a.alternate,a);break;case 24:nl(o,a,s,c,r),r&&2048&l&&Zc(a.alternate,a);break;default:nl(o,a,s,c,r)}t=t.sibling}}function il(e,t){if(10256&t.subtreeFlags)for(t=t.child;null!==t;){var n=e,i=t,r=i.flags;switch(i.tag){case 22:il(n,i),2048&r&&Xc(i.alternate,i);break;case 24:il(n,i),2048&r&&Zc(i.alternate,i);break;default:il(n,i)}t=t.sibling}}var rl=8192;function ol(e,t,n){if(e.subtreeFlags&rl)for(e=e.child;null!==e;)al(e,t,n),e=e.sibling}function al(e,t,n){switch(e.tag){case 26:ol(e,t,n),e.flags&rl&&null!==e.memoizedState&&function(e,t,n,i){if("stylesheet"===n.type&&("string"!==typeof i.media||!1!==matchMedia(i.media).matches)&&0===(4&n.state.loading)){if(null===n.instance){var r=Gd(i.href),o=t.querySelector(Jd(r));if(o)return null!==(t=o._p)&&"object"===typeof t&&"function"===typeof t.then&&(e.count++,e=sh.bind(e),t.then(e,e)),n.state.loading|=4,n.instance=o,void et(o);o=t.ownerDocument||t,i=Qd(i),(r=Bd.get(r))&&eh(i,r),et(o=o.createElement("link"));var a=o;a._p=new Promise(function(e,t){a.onload=e,a.onerror=t}),pd(o,"link",i),n.instance=o}null===e.stylesheets&&(e.stylesheets=new Map),e.stylesheets.set(n,t),(t=n.state.preload)&&0===(3&n.state.loading)&&(e.count++,n=sh.bind(e),t.addEventListener("load",n),t.addEventListener("error",n))}}(n,Wc,e.memoizedState,e.memoizedProps);break;case 5:default:ol(e,t,n);break;case 3:case 4:var i=Wc;Wc=qd(e.stateNode.containerInfo),ol(e,t,n),Wc=i;break;case 22:null===e.memoizedState&&(null!==(i=e.alternate)&&null!==i.memoizedState?(i=rl,rl=16777216,ol(e,t,n),rl=i):ol(e,t,n))}}function sl(e){var t=e.alternate;if(null!==t&&null!==(e=t.child)){t.child=null;do{t=e.sibling,e.sibling=null,e=t}while(null!==e)}}function cl(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Dc=i,dl(i,e)}sl(e)}if(10256&e.subtreeFlags)for(e=e.child;null!==e;)ll(e),e=e.sibling}function ll(e){switch(e.tag){case 0:case 11:case 15:cl(e),2048&e.flags&&yc(9,e,e.return);break;case 3:case 12:default:cl(e);break;case 22:var t=e.stateNode;null!==e.memoizedState&&2&t._visibility&&(null===e.return||13!==e.return.tag)?(t._visibility&=-3,ul(e)):cl(e)}}function ul(e){var t=e.deletions;if(0!==(16&e.flags)){if(null!==t)for(var n=0;n<t.length;n++){var i=t[n];Dc=i,dl(i,e)}sl(e)}for(e=e.child;null!==e;){switch((t=e).tag){case 0:case 11:case 15:yc(8,t,t.return),ul(t);break;case 22:2&(n=t.stateNode)._visibility&&(n._visibility&=-3,ul(t));break;default:ul(t)}e=e.sibling}}function dl(e,t){for(;null!==Dc;){var n=Dc;switch(n.tag){case 0:case 11:case 15:yc(8,n,t);break;case 23:case 22:if(null!==n.memoizedState&&null!==n.memoizedState.cachePool){var i=n.memoizedState.cachePool.pool;null!=i&&i.refCount++}break;case 24:Br(n.memoizedState.cache)}if(null!==(i=n.child))i.return=n,Dc=i;else e:for(n=e;null!==Dc;){var r=(i=Dc).sibling,o=i.return;if(Mc(i),i===n){Dc=null;break e}if(null!==r){r.return=o,Dc=r;break e}Dc=o}}}var hl={getCacheForType:function(e){var t=Nr(Ur),n=t.data.get(e);return void 0===n&&(n=e(),t.data.set(e,n)),n},cacheSignal:function(){return Nr(Ur).controller.signal}},pl="function"===typeof WeakMap?WeakMap:Map,fl=0,ml=null,gl=null,vl=0,yl=0,bl=null,kl=!1,Sl=!1,wl=!1,Tl=0,Cl=0,El=0,Pl=0,Rl=0,_l=0,Ol=0,xl=null,Il=null,Nl=!1,Al=0,Dl=0,Ll=1/0,Ml=null,jl=null,Ul=0,Fl=null,Bl=null,zl=0,ql=0,Vl=null,Hl=null,Wl=0,Kl=null;function Gl(){return 0!==(2&fl)&&0!==vl?vl&-vl:null!==D.T?Vu():Ue()}function Jl(){if(0===_l)if(0===(536870912&vl)||dr){var e=Ce;0===(3932160&(Ce<<=1))&&(Ce=262144),_l=e}else _l=536870912;return null!==(e=Do.current)&&(e.flags|=32),_l}function Ql(e,t,n){(e!==ml||2!==yl&&9!==yl)&&null===e.cancelPendingCommit||(nu(e,0),Zl(e,vl,_l,!1)),Ne(e,n),0!==(2&fl)&&e===ml||(e===ml&&(0===(2&fl)&&(Pl|=n),4===Cl&&Zl(e,vl,_l,!1)),Mu(e))}function $l(e,t,n){if(0!==(6&fl))throw Error(a(327));for(var i=!n&&0===(127&t)&&0===(t&e.expiredLanes)||_e(e,t),r=i?function(e,t){var n=fl;fl|=2;var i=ou(),r=au();ml!==e||vl!==t?(Ml=null,Ll=ce()+500,nu(e,t)):Sl=_e(e,t);e:for(;;)try{if(0!==yl&&null!==gl){t=gl;var o=bl;t:switch(yl){case 1:yl=0,bl=null,pu(e,t,o,1);break;case 2:case 9:if(to(o)){yl=0,bl=null,hu(t);break}t=function(){2!==yl&&9!==yl||ml!==e||(yl=7),Mu(e)},o.then(t,t);break e;case 3:yl=7;break e;case 4:yl=5;break e;case 7:to(o)?(yl=0,bl=null,hu(t)):(yl=0,bl=null,pu(e,t,o,7));break;case 5:var s=null;switch(gl.tag){case 26:s=gl.memoizedState;case 5:case 27:var c=gl;if(s?oh(s):c.stateNode.complete){yl=0,bl=null;var l=c.sibling;if(null!==l)gl=l;else{var u=c.return;null!==u?(gl=u,fu(u)):gl=null}break t}}yl=0,bl=null,pu(e,t,o,5);break;case 6:yl=0,bl=null,pu(e,t,o,6);break;case 8:tu(),Cl=6;break e;default:throw Error(a(462))}}uu();break}catch(d){iu(e,d)}return Cr=Tr=null,D.H=i,D.A=r,fl=n,null!==gl?0:(ml=null,vl=0,xi(),Cl)}(e,t):cu(e,t,!0),o=i;;){if(0===r){Sl&&!i&&Zl(e,t,0,!1);break}if(n=e.current.alternate,!o||Xl(n)){if(2===r){if(o=t,e.errorRecoveryDisabledLanes&o)var s=0;else s=0!==(s=-536870913&e.pendingLanes)?s:536870912&s?536870912:0;if(0!==s){t=s;e:{var c=e;r=xl;var l=c.current.memoizedState.isDehydrated;if(l&&(nu(c,s).flags|=256),2!==(s=cu(c,s,!1))){if(wl&&!l){c.errorRecoveryDisabledLanes|=o,Pl|=o,r=4;break e}o=Il,Il=r,null!==o&&(null===Il?Il=o:Il.push.apply(Il,o))}r=s}if(o=!1,2!==r)continue}}if(1===r){nu(e,0),Zl(e,t,0,!0);break}e:{switch(i=e,o=r){case 0:case 1:throw Error(a(345));case 4:if((4194048&t)!==t)break;case 6:Zl(i,t,_l,!kl);break e;case 2:Il=null;break;case 3:case 5:break;default:throw Error(a(329))}if((62914560&t)===t&&10<(r=Al+300-ce())){if(Zl(i,t,_l,!kl),0!==Re(i,0,!0))break e;zl=t,i.timeoutHandle=wd(Yl.bind(null,i,n,Il,Ml,Nl,t,_l,Pl,Ol,kl,o,"Throttled",-0,0),r)}else Yl(i,n,Il,Ml,Nl,t,_l,Pl,Ol,kl,o,null,-0,0)}break}r=cu(e,t,!1),o=!1}Mu(e)}function Yl(e,t,n,i,r,o,a,s,c,l,u,d,h,p){if(e.timeoutHandle=-1,8192&(d=t.subtreeFlags)||16785408===(16785408&d)){al(t,o,d={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:Nt});var f=(62914560&o)===o?Al-ce():(4194048&o)===o?Dl-ce():0;if(null!==(f=function(e,t){return e.stylesheets&&0===e.count&&lh(e,e.stylesheets),0<e.count||0<e.imgCount?function(n){var i=setTimeout(function(){if(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend){var t=e.unsuspend;e.unsuspend=null,t()}},6e4+t);0<e.imgBytes&&0===ah&&(ah=62500*function(){if("function"===typeof performance.getEntriesByType){for(var e=0,t=0,n=performance.getEntriesByType("resource"),i=0;i<n.length;i++){var r=n[i],o=r.transferSize,a=r.initiatorType,s=r.duration;if(o&&s&&fd(a)){for(a=0,s=r.responseEnd,i+=1;i<n.length;i++){var c=n[i],l=c.startTime;if(l>s)break;var u=c.transferSize,d=c.initiatorType;u&&fd(d)&&(a+=u*((c=c.responseEnd)<s?1:(s-l)/(c-l)))}if(--i,t+=8*(o+a)/(r.duration/1e3),10<++e)break}}if(0<e)return t/e/1e6}return navigator.connection&&"number"===typeof(e=navigator.connection.downlink)?e:5}());var r=setTimeout(function(){if(e.waitingForImages=!1,0===e.count&&(e.stylesheets&&lh(e,e.stylesheets),e.unsuspend)){var t=e.unsuspend;e.unsuspend=null,t()}},(e.imgBytes>ah?50:800)+t);return e.unsuspend=n,function(){e.unsuspend=null,clearTimeout(i),clearTimeout(r)}}:null}(d,f)))return zl=o,e.cancelPendingCommit=f(gu.bind(null,e,t,o,n,i,r,a,s,c,u,d,null,h,p)),void Zl(e,o,a,!l)}gu(e,t,o,n,i,r,a,s,c)}function Xl(e){for(var t=e;;){var n=t.tag;if((0===n||11===n||15===n)&&16384&t.flags&&(null!==(n=t.updateQueue)&&null!==(n=n.stores)))for(var i=0;i<n.length;i++){var r=n[i],o=r.getSnapshot;r=r.value;try{if(!Xn(o(),r))return!1}catch(a){return!1}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function Zl(e,t,n,i){t&=~Rl,t&=~Pl,e.suspendedLanes|=t,e.pingedLanes&=~t,i&&(e.warmLanes|=t),i=e.expirationTimes;for(var r=t;0<r;){var o=31-ke(r),a=1<<o;i[o]=-1,r&=~a}0!==n&&Ae(e,n,t)}function eu(){return 0!==(6&fl)||(ju(0,!1),!1)}function tu(){if(null!==gl){if(0===yl)var e=gl.return;else Cr=Tr=null,ca(e=gl),so=null,co=0,e=gl;for(;null!==e;)gc(e.alternate,e),e=e.return;gl=null}}function nu(e,t){var n=e.timeoutHandle;-1!==n&&(e.timeoutHandle=-1,Td(n)),null!==(n=e.cancelPendingCommit)&&(e.cancelPendingCommit=null,n()),zl=0,tu(),ml=e,gl=n=Bi(e.current,null),vl=t,yl=0,bl=null,kl=!1,Sl=_e(e,t),wl=!1,Ol=_l=Rl=Pl=El=Cl=0,Il=xl=null,Nl=!1,0!==(8&t)&&(t|=32&t);var i=e.entangledLanes;if(0!==i)for(e=e.entanglements,i&=t;0<i;){var r=31-ke(i),o=1<<r;t|=e[r],i&=~o}return Tl=t,xi(),n}function iu(e,t){Ho=null,D.H=gs,t===Yr||t===Zr?(t=oo(),yl=3):t===Xr?(t=oo(),yl=4):yl=t===As?8:null!==t&&"object"===typeof t&&"function"===typeof t.then?6:1,bl=t,null===gl&&(Cl=1,_s(e,Ji(t,e.current)))}function ru(){var e=Do.current;return null===e||((4194048&vl)===vl?null===Lo:((62914560&vl)===vl||0!==(536870912&vl))&&e===Lo)}function ou(){var e=D.H;return D.H=gs,null===e?gs:e}function au(){var e=D.A;return D.A=hl,e}function su(){Cl=4,kl||(4194048&vl)!==vl&&null!==Do.current||(Sl=!0),0===(134217727&El)&&0===(134217727&Pl)||null===ml||Zl(ml,vl,_l,!1)}function cu(e,t,n){var i=fl;fl|=2;var r=ou(),o=au();ml===e&&vl===t||(Ml=null,nu(e,t)),t=!1;var a=Cl;e:for(;;)try{if(0!==yl&&null!==gl){var s=gl,c=bl;switch(yl){case 8:tu(),a=6;break e;case 3:case 2:case 9:case 6:null===Do.current&&(t=!0);var l=yl;if(yl=0,bl=null,pu(e,s,c,l),n&&Sl){a=0;break e}break;default:l=yl,yl=0,bl=null,pu(e,s,c,l)}}lu(),a=Cl;break}catch(u){iu(e,u)}return t&&e.shellSuspendCounter++,Cr=Tr=null,fl=i,D.H=r,D.A=o,null===gl&&(ml=null,vl=0,xi()),a}function lu(){for(;null!==gl;)du(gl)}function uu(){for(;null!==gl&&!ae();)du(gl)}function du(e){var t=sc(e.alternate,e,Tl);e.memoizedProps=e.pendingProps,null===t?fu(e):gl=t}function hu(e){var t=e,n=t.alternate;switch(t.tag){case 15:case 0:t=Ks(n,t,t.pendingProps,t.type,void 0,vl);break;case 11:t=Ks(n,t,t.pendingProps,t.type.render,t.ref,vl);break;case 5:ca(t);default:gc(n,t),t=sc(n,t=gl=zi(t,Tl),Tl)}e.memoizedProps=e.pendingProps,null===t?fu(e):gl=t}function pu(e,t,n,i){Cr=Tr=null,ca(t),so=null,co=0;var r=t.return;try{if(function(e,t,n,i,r){if(n.flags|=32768,null!==i&&"object"===typeof i&&"function"===typeof i.then){if(null!==(t=n.alternate)&&Or(t,n,r,!0),null!==(n=Do.current)){switch(n.tag){case 31:case 13:return null===Lo?su():null===n.alternate&&0===Cl&&(Cl=3),n.flags&=-257,n.flags|=65536,n.lanes=r,i===eo?n.flags|=16384:(null===(t=n.updateQueue)?n.updateQueue=new Set([i]):t.add(i),Eu(e,i,r)),!1;case 22:return n.flags|=65536,i===eo?n.flags|=16384:(null===(t=n.updateQueue)?(t={transitions:null,markerInstances:null,retryQueue:new Set([i])},n.updateQueue=t):null===(n=t.retryQueue)?t.retryQueue=new Set([i]):n.add(i),Eu(e,i,r)),!1}throw Error(a(435,n.tag))}return Eu(e,i,r),su(),!1}if(dr)return null!==(t=Do.current)?(0===(65536&t.flags)&&(t.flags|=256),t.flags|=65536,t.lanes=r,i!==fr&&Sr(Ji(e=Error(a(422),{cause:i}),n))):(i!==fr&&Sr(Ji(t=Error(a(423),{cause:i}),n)),(e=e.current.alternate).flags|=65536,r&=-r,e.lanes|=r,i=Ji(i,n),To(e,r=xs(e.stateNode,i,r)),4!==Cl&&(Cl=2)),!1;var o=Error(a(520),{cause:i});if(o=Ji(o,n),null===xl?xl=[o]:xl.push(o),4!==Cl&&(Cl=2),null===t)return!0;i=Ji(i,n),n=t;do{switch(n.tag){case 3:return n.flags|=65536,e=r&-r,n.lanes|=e,To(n,e=xs(n.stateNode,i,e)),!1;case 1:if(t=n.type,o=n.stateNode,0===(128&n.flags)&&("function"===typeof t.getDerivedStateFromError||null!==o&&"function"===typeof o.componentDidCatch&&(null===jl||!jl.has(o))))return n.flags|=65536,r&=-r,n.lanes|=r,Ns(r=Is(r),e,n,i),To(n,r),!1}n=n.return}while(null!==n);return!1}(e,r,t,n,vl))return Cl=1,_s(e,Ji(n,e.current)),void(gl=null)}catch(o){if(null!==r)throw gl=r,o;return Cl=1,_s(e,Ji(n,e.current)),void(gl=null)}32768&t.flags?(dr||1===i?e=!0:Sl||0!==(536870912&vl)?e=!1:(kl=e=!0,(2===i||9===i||3===i||6===i)&&(null!==(i=Do.current)&&13===i.tag&&(i.flags|=16384))),mu(t,e)):fu(t)}function fu(e){var t=e;do{if(0!==(32768&t.flags))return void mu(t,kl);e=t.return;var n=fc(t.alternate,t,Tl);if(null!==n)return void(gl=n);if(null!==(t=t.sibling))return void(gl=t);gl=t=e}while(null!==t);0===Cl&&(Cl=5)}function mu(e,t){do{var n=mc(e.alternate,e);if(null!==n)return n.flags&=32767,void(gl=n);if(null!==(n=e.return)&&(n.flags|=32768,n.subtreeFlags=0,n.deletions=null),!t&&null!==(e=e.sibling))return void(gl=e);gl=e=n}while(null!==e);Cl=6,gl=null}function gu(e,t,n,i,r,o,s,c,l){e.cancelPendingCommit=null;do{Su()}while(0!==Ul);if(0!==(6&fl))throw Error(a(327));if(null!==t){if(t===e.current)throw Error(a(177));if(o=t.lanes|t.childLanes,function(e,t,n,i,r,o){var a=e.pendingLanes;e.pendingLanes=n,e.suspendedLanes=0,e.pingedLanes=0,e.warmLanes=0,e.expiredLanes&=n,e.entangledLanes&=n,e.errorRecoveryDisabledLanes&=n,e.shellSuspendCounter=0;var s=e.entanglements,c=e.expirationTimes,l=e.hiddenUpdates;for(n=a&~n;0<n;){var u=31-ke(n),d=1<<u;s[u]=0,c[u]=-1;var h=l[u];if(null!==h)for(l[u]=null,u=0;u<h.length;u++){var p=h[u];null!==p&&(p.lane&=-536870913)}n&=~d}0!==i&&Ae(e,i,0),0!==o&&0===r&&0!==e.tag&&(e.suspendedLanes|=o&~(a&~t))}(e,n,o|=Oi,s,c,l),e===ml&&(gl=ml=null,vl=0),Bl=t,Fl=e,zl=n,ql=o,Vl=r,Hl=i,0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?(e.callbackNode=null,e.callbackPriority=0,re(he,function(){return wu(),null})):(e.callbackNode=null,e.callbackPriority=0),i=0!==(13878&t.flags),0!==(13878&t.subtreeFlags)||i){i=D.T,D.T=null,r=L.p,L.p=2,s=fl,fl|=4;try{!function(e,t){if(e=e.containerInfo,md=kh,ri(e=ii(e))){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var i=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(i&&0!==i.rangeCount){n=i.anchorNode;var r=i.anchorOffset,o=i.focusNode;i=i.focusOffset;try{n.nodeType,o.nodeType}catch(g){n=null;break e}var s=0,c=-1,l=-1,u=0,d=0,h=e,p=null;t:for(;;){for(var f;h!==n||0!==r&&3!==h.nodeType||(c=s+r),h!==o||0!==i&&3!==h.nodeType||(l=s+i),3===h.nodeType&&(s+=h.nodeValue.length),null!==(f=h.firstChild);)p=h,h=f;for(;;){if(h===e)break t;if(p===n&&++u===r&&(c=s),p===o&&++d===i&&(l=s),null!==(f=h.nextSibling))break;p=(h=p).parentNode}h=f}n=-1===c||-1===l?null:{start:c,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(gd={focusedElem:e,selectionRange:n},kh=!1,Dc=t;null!==Dc;)if(e=(t=Dc).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Dc=e;else for(;null!==Dc;){switch(o=(t=Dc).alternate,e=t.flags,t.tag){case 0:if(0!==(4&e)&&null!==(e=null!==(e=t.updateQueue)?e.events:null))for(n=0;n<e.length;n++)(r=e[n]).ref.impl=r.nextImpl;break;case 11:case 15:case 5:case 26:case 27:case 6:case 4:case 17:break;case 1:if(0!==(1024&e)&&null!==o){e=void 0,n=t,r=o.memoizedProps,o=o.memoizedState,i=n.stateNode;try{var m=Cs(n.type,r);e=i.getSnapshotBeforeUpdate(m,o),i.__reactInternalSnapshotBeforeUpdate=e}catch(v){Cu(n,n.return,v)}}break;case 3:if(0!==(1024&e))if(9===(n=(e=t.stateNode.containerInfo).nodeType))xd(e);else if(1===n)switch(e.nodeName){case"HEAD":case"HTML":case"BODY":xd(e);break;default:e.textContent=""}break;default:if(0!==(1024&e))throw Error(a(163))}if(null!==(e=t.sibling)){e.return=t.return,Dc=e;break}Dc=t.return}}(e,t)}finally{fl=s,L.p=r,D.T=i}}Ul=1,vu(),yu(),bu()}}function vu(){if(1===Ul){Ul=0;var e=Fl,t=Bl,n=0!==(13878&t.flags);if(0!==(13878&t.subtreeFlags)||n){n=D.T,D.T=null;var i=L.p;L.p=2;var r=fl;fl|=4;try{Kc(t,e);var o=gd,a=ii(e.containerInfo),s=o.focusedElem,c=o.selectionRange;if(a!==s&&s&&s.ownerDocument&&ni(s.ownerDocument.documentElement,s)){if(null!==c&&ri(s)){var l=c.start,u=c.end;if(void 0===u&&(u=l),"selectionStart"in s)s.selectionStart=l,s.selectionEnd=Math.min(u,s.value.length);else{var d=s.ownerDocument||document,h=d&&d.defaultView||window;if(h.getSelection){var p=h.getSelection(),f=s.textContent.length,m=Math.min(c.start,f),g=void 0===c.end?m:Math.min(c.end,f);!p.extend&&m>g&&(a=g,g=m,m=a);var v=ti(s,m),y=ti(s,g);if(v&&y&&(1!==p.rangeCount||p.anchorNode!==v.node||p.anchorOffset!==v.offset||p.focusNode!==y.node||p.focusOffset!==y.offset)){var b=d.createRange();b.setStart(v.node,v.offset),p.removeAllRanges(),m>g?(p.addRange(b),p.extend(y.node,y.offset)):(b.setEnd(y.node,y.offset),p.addRange(b))}}}}for(d=[],p=s;p=p.parentNode;)1===p.nodeType&&d.push({element:p,left:p.scrollLeft,top:p.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<d.length;s++){var k=d[s];k.element.scrollLeft=k.left,k.element.scrollTop=k.top}}kh=!!md,gd=md=null}finally{fl=r,L.p=i,D.T=n}}e.current=t,Ul=2}}function yu(){if(2===Ul){Ul=0;var e=Fl,t=Bl,n=0!==(8772&t.flags);if(0!==(8772&t.subtreeFlags)||n){n=D.T,D.T=null;var i=L.p;L.p=2;var r=fl;fl|=4;try{Lc(e,t.alternate,t)}finally{fl=r,L.p=i,D.T=n}}Ul=3}}function bu(){if(4===Ul||3===Ul){Ul=0,se();var e=Fl,t=Bl,n=zl,i=Hl;0!==(10256&t.subtreeFlags)||0!==(10256&t.flags)?Ul=5:(Ul=0,Bl=Fl=null,ku(e,e.pendingLanes));var r=e.pendingLanes;if(0===r&&(jl=null),je(n),t=t.stateNode,ye&&"function"===typeof ye.onCommitFiberRoot)try{ye.onCommitFiberRoot(ve,t,void 0,128===(128&t.current.flags))}catch(c){}if(null!==i){t=D.T,r=L.p,L.p=2,D.T=null;try{for(var o=e.onRecoverableError,a=0;a<i.length;a++){var s=i[a];o(s.value,{componentStack:s.stack})}}finally{D.T=t,L.p=r}}0!==(3&zl)&&Su(),Mu(e),r=e.pendingLanes,0!==(261930&n)&&0!==(42&r)?e===Kl?Wl++:(Wl=0,Kl=e):Wl=0,ju(0,!1)}}function ku(e,t){0===(e.pooledCacheLanes&=t)&&(null!=(t=e.pooledCache)&&(e.pooledCache=null,Br(t)))}function Su(){return vu(),yu(),bu(),wu()}function wu(){if(5!==Ul)return!1;var e=Fl,t=ql;ql=0;var n=je(zl),i=D.T,r=L.p;try{L.p=32>n?32:n,D.T=null,n=Vl,Vl=null;var o=Fl,s=zl;if(Ul=0,Bl=Fl=null,zl=0,0!==(6&fl))throw Error(a(331));var c=fl;if(fl|=4,ll(o.current),tl(o,o.current,s,n),fl=c,ju(0,!1),ye&&"function"===typeof ye.onPostCommitFiberRoot)try{ye.onPostCommitFiberRoot(ve,o)}catch(l){}return!0}finally{L.p=r,D.T=i,ku(e,t)}}function Tu(e,t,n){t=Ji(n,t),null!==(e=ko(e,t=xs(e.stateNode,t,2),2))&&(Ne(e,2),Mu(e))}function Cu(e,t,n){if(3===e.tag)Tu(e,e,n);else for(;null!==t;){if(3===t.tag){Tu(t,e,n);break}if(1===t.tag){var i=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof i.componentDidCatch&&(null===jl||!jl.has(i))){e=Ji(n,e),null!==(i=ko(t,n=Is(2),2))&&(Ns(n,i,t,e),Ne(i,2),Mu(i));break}}t=t.return}}function Eu(e,t,n){var i=e.pingCache;if(null===i){i=e.pingCache=new pl;var r=new Set;i.set(t,r)}else void 0===(r=i.get(t))&&(r=new Set,i.set(t,r));r.has(n)||(wl=!0,r.add(n),e=Pu.bind(null,e,t,n),t.then(e,e))}function Pu(e,t,n){var i=e.pingCache;null!==i&&i.delete(t),e.pingedLanes|=e.suspendedLanes&n,e.warmLanes&=~n,ml===e&&(vl&n)===n&&(4===Cl||3===Cl&&(62914560&vl)===vl&&300>ce()-Al?0===(2&fl)&&nu(e,0):Rl|=n,Ol===vl&&(Ol=0)),Mu(e)}function Ru(e,t){0===t&&(t=xe()),null!==(e=Ai(e,t))&&(Ne(e,t),Mu(e))}function _u(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Ru(e,n)}function Ou(e,t){var n=0;switch(e.tag){case 31:case 13:var i=e.stateNode,r=e.memoizedState;null!==r&&(n=r.retryLane);break;case 19:i=e.stateNode;break;case 22:i=e.stateNode._retryCache;break;default:throw Error(a(314))}null!==i&&i.delete(t),Ru(e,n)}var xu=null,Iu=null,Nu=!1,Au=!1,Du=!1,Lu=0;function Mu(e){e!==Iu&&null===e.next&&(null===Iu?xu=Iu=e:Iu=Iu.next=e),Au=!0,Nu||(Nu=!0,Ed(function(){0!==(6&fl)?re(ue,Uu):Fu()}))}function ju(e,t){if(!Du&&Au){Du=!0;do{for(var n=!1,i=xu;null!==i;){if(!t)if(0!==e){var r=i.pendingLanes;if(0===r)var o=0;else{var a=i.suspendedLanes,s=i.pingedLanes;o=(1<<31-ke(42|e)+1)-1,o=201326741&(o&=r&~(a&~s))?201326741&o|1:o?2|o:0}0!==o&&(n=!0,qu(i,o))}else o=vl,0===(3&(o=Re(i,i===ml?o:0,null!==i.cancelPendingCommit||-1!==i.timeoutHandle)))||_e(i,o)||(n=!0,qu(i,o));i=i.next}}while(n);Du=!1}}function Uu(){Fu()}function Fu(){Au=Nu=!1;var e=0;0!==Lu&&function(){var e=window.event;if(e&&"popstate"===e.type)return e!==Sd&&(Sd=e,!0);return Sd=null,!1}()&&(e=Lu);for(var t=ce(),n=null,i=xu;null!==i;){var r=i.next,o=Bu(i,t);0===o?(i.next=null,null===n?xu=r:n.next=r,null===r&&(Iu=n)):(n=i,(0!==e||0!==(3&o))&&(Au=!0)),i=r}0!==Ul&&5!==Ul||ju(e,!1),0!==Lu&&(Lu=0)}function Bu(e,t){for(var n=e.suspendedLanes,i=e.pingedLanes,r=e.expirationTimes,o=-62914561&e.pendingLanes;0<o;){var a=31-ke(o),s=1<<a,c=r[a];-1===c?0!==(s&n)&&0===(s&i)||(r[a]=Oe(s,t)):c<=t&&(e.expiredLanes|=s),o&=~s}if(n=vl,n=Re(e,e===(t=ml)?n:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle),i=e.callbackNode,0===n||e===t&&(2===yl||9===yl)||null!==e.cancelPendingCommit)return null!==i&&null!==i&&oe(i),e.callbackNode=null,e.callbackPriority=0;if(0===(3&n)||_e(e,n)){if((t=n&-n)===e.callbackPriority)return t;switch(null!==i&&oe(i),je(n)){case 2:case 8:n=de;break;case 32:default:n=he;break;case 268435456:n=fe}return i=zu.bind(null,e),n=re(n,i),e.callbackPriority=t,e.callbackNode=n,t}return null!==i&&null!==i&&oe(i),e.callbackPriority=2,e.callbackNode=null,2}function zu(e,t){if(0!==Ul&&5!==Ul)return e.callbackNode=null,e.callbackPriority=0,null;var n=e.callbackNode;if(Su()&&e.callbackNode!==n)return null;var i=vl;return 0===(i=Re(e,e===ml?i:0,null!==e.cancelPendingCommit||-1!==e.timeoutHandle))?null:($l(e,i,t),Bu(e,ce()),null!=e.callbackNode&&e.callbackNode===n?zu.bind(null,e):null)}function qu(e,t){if(Su())return null;$l(e,t,!0)}function Vu(){if(0===Lu){var e=Vr;0===e&&(e=Te,0===(261888&(Te<<=1))&&(Te=256)),Lu=e}return Lu}function Hu(e){return null==e||"symbol"===typeof e||"boolean"===typeof e?null:"function"===typeof e?e:It(""+e)}function Wu(e,t){var n=t.ownerDocument.createElement("input");return n.name=t.name,n.value=t.value,e.id&&n.setAttribute("form",e.id),t.parentNode.insertBefore(n,t),e=new FormData(e),n.parentNode.removeChild(n),e}for(var Ku=0;Ku<Ci.length;Ku++){var Gu=Ci[Ku];Ei(Gu.toLowerCase(),"on"+(Gu[0].toUpperCase()+Gu.slice(1)))}Ei(gi,"onAnimationEnd"),Ei(vi,"onAnimationIteration"),Ei(yi,"onAnimationStart"),Ei("dblclick","onDoubleClick"),Ei("focusin","onFocus"),Ei("focusout","onBlur"),Ei(bi,"onTransitionRun"),Ei(ki,"onTransitionStart"),Ei(Si,"onTransitionCancel"),Ei(wi,"onTransitionEnd"),rt("onMouseEnter",["mouseout","mouseover"]),rt("onMouseLeave",["mouseout","mouseover"]),rt("onPointerEnter",["pointerout","pointerover"]),rt("onPointerLeave",["pointerout","pointerover"]),it("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),it("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),it("onBeforeInput",["compositionend","keypress","textInput","paste"]),it("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),it("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ju="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qu=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Ju));function $u(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var i=e[n],r=i.event;i=i.listeners;e:{var o=void 0;if(t)for(var a=i.length-1;0<=a;a--){var s=i[a],c=s.instance,l=s.currentTarget;if(s=s.listener,c!==o&&r.isPropagationStopped())break e;o=s,r.currentTarget=l;try{o(r)}catch(u){Pi(u)}r.currentTarget=null,o=c}else for(a=0;a<i.length;a++){if(c=(s=i[a]).instance,l=s.currentTarget,s=s.listener,c!==o&&r.isPropagationStopped())break e;o=s,r.currentTarget=l;try{o(r)}catch(u){Pi(u)}r.currentTarget=null,o=c}}}}function Yu(e,t){var n=t[He];void 0===n&&(n=t[He]=new Set);var i=e+"__bubble";n.has(i)||(td(t,e,2,!1),n.add(i))}function Xu(e,t,n){var i=0;t&&(i|=4),td(n,e,i,t)}var Zu="_reactListening"+Math.random().toString(36).slice(2);function ed(e){if(!e[Zu]){e[Zu]=!0,tt.forEach(function(t){"selectionchange"!==t&&(Qu.has(t)||Xu(t,!1,e),Xu(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Zu]||(t[Zu]=!0,Xu("selectionchange",!1,t))}}function td(e,t,n,i){switch(Rh(t)){case 2:var r=Sh;break;case 8:r=wh;break;default:r=Th}n=r.bind(null,t,n,e),r=void 0,!qt||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(r=!0),i?void 0!==r?e.addEventListener(t,n,{capture:!0,passive:r}):e.addEventListener(t,n,!0):void 0!==r?e.addEventListener(t,n,{passive:r}):e.addEventListener(t,n,!1)}function nd(e,t,n,i,r){var o=i;if(0===(1&t)&&0===(2&t)&&null!==i)e:for(;;){if(null===i)return;var a=i.tag;if(3===a||4===a){var s=i.stateNode.containerInfo;if(s===r)break;if(4===a)for(a=i.return;null!==a;){var l=a.tag;if((3===l||4===l)&&a.stateNode.containerInfo===r)return;a=a.return}for(;null!==s;){if(null===(a=$e(s)))return;if(5===(l=a.tag)||6===l||26===l||27===l){i=o=a;continue e}s=s.parentNode}}i=i.return}Ft(function(){var i=o,r=Dt(n),a=[];e:{var s=Ti.get(e);if(void 0!==s){var l=nn,u=e;switch(e){case"keypress":if(0===Jt(n))break e;case"keydown":case"keyup":l=yn;break;case"focusin":u="focus",l=ln;break;case"focusout":u="blur",l=ln;break;case"beforeblur":case"afterblur":l=ln;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=sn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=cn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=kn;break;case gi:case vi:case yi:l=un;break;case wi:l=Sn;break;case"scroll":case"scrollend":l=on;break;case"wheel":l=wn;break;case"copy":case"cut":case"paste":l=dn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=bn;break;case"toggle":case"beforetoggle":l=Tn}var d=0!==(4&t),h=!d&&("scroll"===e||"scrollend"===e),p=d?null!==s?s+"Capture":null:s;d=[];for(var f,m=i;null!==m;){var g=m;if(f=g.stateNode,5!==(g=g.tag)&&26!==g&&27!==g||null===f||null===p||null!=(g=Bt(m,p))&&d.push(id(m,g,f)),h)break;m=m.return}0<d.length&&(s=new l(s,u,null,n,r),a.push({event:s,listeners:d}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||n===At||!(u=n.relatedTarget||n.fromElement)||!$e(u)&&!u[Ve])&&(l||s)&&(s=r.window===r?r:(s=r.ownerDocument)?s.defaultView||s.parentWindow:window,l?(l=i,null!==(u=(u=n.relatedTarget||n.toElement)?$e(u):null)&&(h=c(u),d=u.tag,u!==h||5!==d&&27!==d&&6!==d)&&(u=null)):(l=null,u=i),l!==u)){if(d=sn,g="onMouseLeave",p="onMouseEnter",m="mouse","pointerout"!==e&&"pointerover"!==e||(d=bn,g="onPointerLeave",p="onPointerEnter",m="pointer"),h=null==l?s:Xe(l),f=null==u?s:Xe(u),(s=new d(g,m+"leave",l,n,r)).target=h,s.relatedTarget=f,g=null,$e(r)===i&&((d=new d(p,m+"enter",u,n,r)).target=f,d.relatedTarget=h,g=d),h=g,l&&u)e:{for(d=od,m=u,f=0,g=p=l;g;g=d(g))f++;g=0;for(var v=m;v;v=d(v))g++;for(;0<f-g;)p=d(p),f--;for(;0<g-f;)m=d(m),g--;for(;f--;){if(p===m||null!==m&&p===m.alternate){d=p;break e}p=d(p),m=d(m)}d=null}else d=null;null!==l&&ad(a,s,l,d,!1),null!==u&&null!==h&&ad(a,h,u,d,!0)}if("select"===(l=(s=i?Xe(i):window).nodeName&&s.nodeName.toLowerCase())||"input"===l&&"file"===s.type)var y=zn;else if(Ln(s))if(qn)y=Yn;else{y=Qn;var b=Jn}else!(l=s.nodeName)||"input"!==l.toLowerCase()||"checkbox"!==s.type&&"radio"!==s.type?i&&_t(i.elementType)&&(y=zn):y=$n;switch(y&&(y=y(e,i))?Mn(a,y,n,r):(b&&b(e,s,i),"focusout"===e&&i&&"number"===s.type&&null!=i.memoizedProps.value&&kt(s,"number",s.value)),b=i?Xe(i):window,e){case"focusin":(Ln(b)||"true"===b.contentEditable)&&(ai=b,si=i,ci=null);break;case"focusout":ci=si=ai=null;break;case"mousedown":li=!0;break;case"contextmenu":case"mouseup":case"dragend":li=!1,ui(a,n,r);break;case"selectionchange":if(oi)break;case"keydown":case"keyup":ui(a,n,r)}var k;if(En)e:{switch(e){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else An?In(e,n)&&(S="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(S="onCompositionStart");S&&(_n&&"ko"!==n.locale&&(An||"onCompositionStart"!==S?"onCompositionEnd"===S&&An&&(k=Gt()):(Wt="value"in(Ht=r)?Ht.value:Ht.textContent,An=!0)),0<(b=rd(i,S)).length&&(S=new hn(S,e,null,n,r),a.push({event:S,listeners:b}),k?S.data=k:null!==(k=Nn(n))&&(S.data=k))),(k=Rn?function(e,t){switch(e){case"compositionend":return Nn(t);case"keypress":return 32!==t.which?null:(xn=!0,On);case"textInput":return(e=t.data)===On&&xn?null:e;default:return null}}(e,n):function(e,t){if(An)return"compositionend"===e||!En&&In(e,t)?(e=Gt(),Kt=Wt=Ht=null,An=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return _n&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(S=rd(i,"onBeforeInput")).length&&(b=new hn("onBeforeInput","beforeinput",null,n,r),a.push({event:b,listeners:S}),b.data=k)),function(e,t,n,i,r){if("submit"===t&&n&&n.stateNode===r){var o=Hu((r[qe]||null).action),a=i.submitter;a&&null!==(t=(t=a[qe]||null)?Hu(t.formAction):a.getAttribute("formAction"))&&(o=t,a=null);var s=new nn("action","action",null,i,r);e.push({event:s,listeners:[{instance:null,listener:function(){if(i.defaultPrevented){if(0!==Lu){var e=a?Wu(r,a):new FormData(r);ns(n,{pending:!0,data:e,method:r.method,action:o},null,e)}}else"function"===typeof o&&(s.preventDefault(),e=a?Wu(r,a):new FormData(r),ns(n,{pending:!0,data:e,method:r.method,action:o},o,e))},currentTarget:r}]})}}(a,e,i,n,r)}$u(a,t)})}function id(e,t,n){return{instance:e,listener:t,currentTarget:n}}function rd(e,t){for(var n=t+"Capture",i=[];null!==e;){var r=e,o=r.stateNode;if(5!==(r=r.tag)&&26!==r&&27!==r||null===o||(null!=(r=Bt(e,n))&&i.unshift(id(e,r,o)),null!=(r=Bt(e,t))&&i.push(id(e,r,o))),3===e.tag)return i;e=e.return}return[]}function od(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag&&27!==e.tag);return e||null}function ad(e,t,n,i,r){for(var o=t._reactName,a=[];null!==n&&n!==i;){var s=n,c=s.alternate,l=s.stateNode;if(s=s.tag,null!==c&&c===i)break;5!==s&&26!==s&&27!==s||null===l||(c=l,r?null!=(l=Bt(n,o))&&a.unshift(id(n,l,c)):r||null!=(l=Bt(n,o))&&a.push(id(n,l,c))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}var sd=/\r\n?/g,cd=/\u0000|\uFFFD/g;function ld(e){return("string"===typeof e?e:""+e).replace(sd,"\n").replace(cd,"")}function ud(e,t){return t=ld(t),ld(e)===t}function dd(e,t,n,i,r,o){switch(n){case"children":"string"===typeof i?"body"===t||"textarea"===t&&""===i||Ct(e,i):("number"===typeof i||"bigint"===typeof i)&&"body"!==t&&Ct(e,""+i);break;case"className":lt(e,"class",i);break;case"tabIndex":lt(e,"tabindex",i);break;case"dir":case"role":case"viewBox":case"width":case"height":lt(e,n,i);break;case"style":Rt(e,i,o);break;case"data":if("object"!==t){lt(e,"data",i);break}case"src":case"href":if(""===i&&("a"!==t||"href"!==n)){e.removeAttribute(n);break}if(null==i||"function"===typeof i||"symbol"===typeof i||"boolean"===typeof i){e.removeAttribute(n);break}i=It(""+i),e.setAttribute(n,i);break;case"action":case"formAction":if("function"===typeof i){e.setAttribute(n,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}if("function"===typeof o&&("formAction"===n?("input"!==t&&dd(e,t,"name",r.name,r,null),dd(e,t,"formEncType",r.formEncType,r,null),dd(e,t,"formMethod",r.formMethod,r,null),dd(e,t,"formTarget",r.formTarget,r,null)):(dd(e,t,"encType",r.encType,r,null),dd(e,t,"method",r.method,r,null),dd(e,t,"target",r.target,r,null))),null==i||"symbol"===typeof i||"boolean"===typeof i){e.removeAttribute(n);break}i=It(""+i),e.setAttribute(n,i);break;case"onClick":null!=i&&(e.onclick=Nt);break;case"onScroll":null!=i&&Yu("scroll",e);break;case"onScrollEnd":null!=i&&Yu("scrollend",e);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!==typeof i||!("__html"in i))throw Error(a(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(a(60));e.innerHTML=n}}break;case"multiple":e.multiple=i&&"function"!==typeof i&&"symbol"!==typeof i;break;case"muted":e.muted=i&&"function"!==typeof i&&"symbol"!==typeof i;break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":case"autoFocus":break;case"xlinkHref":if(null==i||"function"===typeof i||"boolean"===typeof i||"symbol"===typeof i){e.removeAttribute("xlink:href");break}n=It(""+i),e.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",n);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":null!=i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,""+i):e.removeAttribute(n);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,""):e.removeAttribute(n);break;case"capture":case"download":!0===i?e.setAttribute(n,""):!1!==i&&null!=i&&"function"!==typeof i&&"symbol"!==typeof i?e.setAttribute(n,i):e.removeAttribute(n);break;case"cols":case"rows":case"size":case"span":null!=i&&"function"!==typeof i&&"symbol"!==typeof i&&!isNaN(i)&&1<=i?e.setAttribute(n,i):e.removeAttribute(n);break;case"rowSpan":case"start":null==i||"function"===typeof i||"symbol"===typeof i||isNaN(i)?e.removeAttribute(n):e.setAttribute(n,i);break;case"popover":Yu("beforetoggle",e),Yu("toggle",e),ct(e,"popover",i);break;case"xlinkActuate":ut(e,"http://www.w3.org/1999/xlink","xlink:actuate",i);break;case"xlinkArcrole":ut(e,"http://www.w3.org/1999/xlink","xlink:arcrole",i);break;case"xlinkRole":ut(e,"http://www.w3.org/1999/xlink","xlink:role",i);break;case"xlinkShow":ut(e,"http://www.w3.org/1999/xlink","xlink:show",i);break;case"xlinkTitle":ut(e,"http://www.w3.org/1999/xlink","xlink:title",i);break;case"xlinkType":ut(e,"http://www.w3.org/1999/xlink","xlink:type",i);break;case"xmlBase":ut(e,"http://www.w3.org/XML/1998/namespace","xml:base",i);break;case"xmlLang":ut(e,"http://www.w3.org/XML/1998/namespace","xml:lang",i);break;case"xmlSpace":ut(e,"http://www.w3.org/XML/1998/namespace","xml:space",i);break;case"is":ct(e,"is",i);break;case"innerText":case"textContent":break;default:(!(2<n.length)||"o"!==n[0]&&"O"!==n[0]||"n"!==n[1]&&"N"!==n[1])&&ct(e,n=Ot.get(n)||n,i)}}function hd(e,t,n,i,r,o){switch(n){case"style":Rt(e,i,o);break;case"dangerouslySetInnerHTML":if(null!=i){if("object"!==typeof i||!("__html"in i))throw Error(a(61));if(null!=(n=i.__html)){if(null!=r.children)throw Error(a(60));e.innerHTML=n}}break;case"children":"string"===typeof i?Ct(e,i):("number"===typeof i||"bigint"===typeof i)&&Ct(e,""+i);break;case"onScroll":null!=i&&Yu("scroll",e);break;case"onScrollEnd":null!=i&&Yu("scrollend",e);break;case"onClick":null!=i&&(e.onclick=Nt);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":case"innerText":case"textContent":break;default:nt.hasOwnProperty(n)||("o"!==n[0]||"n"!==n[1]||(r=n.endsWith("Capture"),t=n.slice(2,r?n.length-7:void 0),"function"===typeof(o=null!=(o=e[qe]||null)?o[n]:null)&&e.removeEventListener(t,o,r),"function"!==typeof i)?n in e?e[n]=i:!0===i?e.setAttribute(n,""):ct(e,n,i):("function"!==typeof o&&null!==o&&(n in e?e[n]=null:e.hasAttribute(n)&&e.removeAttribute(n)),e.addEventListener(t,i,r)))}}function pd(e,t,n){switch(t){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Yu("error",e),Yu("load",e);var i,r=!1,o=!1;for(i in n)if(n.hasOwnProperty(i)){var s=n[i];if(null!=s)switch(i){case"src":r=!0;break;case"srcSet":o=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:dd(e,t,i,s,n,null)}}return o&&dd(e,t,"srcSet",n.srcSet,n,null),void(r&&dd(e,t,"src",n.src,n,null));case"input":Yu("invalid",e);var c=i=s=o=null,l=null,u=null;for(r in n)if(n.hasOwnProperty(r)){var d=n[r];if(null!=d)switch(r){case"name":o=d;break;case"type":s=d;break;case"checked":l=d;break;case"defaultChecked":u=d;break;case"value":i=d;break;case"defaultValue":c=d;break;case"children":case"dangerouslySetInnerHTML":if(null!=d)throw Error(a(137,t));break;default:dd(e,t,r,d,n,null)}}return void bt(e,i,c,l,u,s,o,!1);case"select":for(o in Yu("invalid",e),r=s=i=null,n)if(n.hasOwnProperty(o)&&null!=(c=n[o]))switch(o){case"value":i=c;break;case"defaultValue":s=c;break;case"multiple":r=c;default:dd(e,t,o,c,n,null)}return t=i,n=s,e.multiple=!!r,void(null!=t?St(e,!!r,t,!1):null!=n&&St(e,!!r,n,!0));case"textarea":for(s in Yu("invalid",e),i=o=r=null,n)if(n.hasOwnProperty(s)&&null!=(c=n[s]))switch(s){case"value":r=c;break;case"defaultValue":o=c;break;case"children":i=c;break;case"dangerouslySetInnerHTML":if(null!=c)throw Error(a(91));break;default:dd(e,t,s,c,n,null)}return void Tt(e,r,o,i);case"option":for(l in n)if(n.hasOwnProperty(l)&&null!=(r=n[l]))if("selected"===l)e.selected=r&&"function"!==typeof r&&"symbol"!==typeof r;else dd(e,t,l,r,n,null);return;case"dialog":Yu("beforetoggle",e),Yu("toggle",e),Yu("cancel",e),Yu("close",e);break;case"iframe":case"object":Yu("load",e);break;case"video":case"audio":for(r=0;r<Ju.length;r++)Yu(Ju[r],e);break;case"image":Yu("error",e),Yu("load",e);break;case"details":Yu("toggle",e);break;case"embed":case"source":case"link":Yu("error",e),Yu("load",e);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(u in n)if(n.hasOwnProperty(u)&&null!=(r=n[u]))switch(u){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,t));default:dd(e,t,u,r,n,null)}return;default:if(_t(t)){for(d in n)n.hasOwnProperty(d)&&(void 0!==(r=n[d])&&hd(e,t,d,r,n,void 0));return}}for(c in n)n.hasOwnProperty(c)&&(null!=(r=n[c])&&dd(e,t,c,r,n,null))}function fd(e){switch(e){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}var md=null,gd=null;function vd(e){return 9===e.nodeType?e:e.ownerDocument}function yd(e){switch(e){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bd(e,t){if(0===e)switch(t){case"svg":return 1;case"math":return 2;default:return 0}return 1===e&&"foreignObject"===t?0:e}function kd(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"bigint"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Sd=null;var wd="function"===typeof setTimeout?setTimeout:void 0,Td="function"===typeof clearTimeout?clearTimeout:void 0,Cd="function"===typeof Promise?Promise:void 0,Ed="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof Cd?function(e){return Cd.resolve(null).then(e).catch(Pd)}:wd;function Pd(e){setTimeout(function(){throw e})}function Rd(e){return"head"===e}function _d(e,t){var n=t,i=0;do{var r=n.nextSibling;if(e.removeChild(n),r&&8===r.nodeType)if("/$"===(n=r.data)||"/&"===n){if(0===i)return e.removeChild(r),void Wh(t);i--}else if("$"===n||"$?"===n||"$~"===n||"$!"===n||"&"===n)i++;else if("html"===n)Fd(e.ownerDocument.documentElement);else if("head"===n){Fd(n=e.ownerDocument.head);for(var o=n.firstChild;o;){var a=o.nextSibling,s=o.nodeName;o[Je]||"SCRIPT"===s||"STYLE"===s||"LINK"===s&&"stylesheet"===o.rel.toLowerCase()||n.removeChild(o),o=a}}else"body"===n&&Fd(e.ownerDocument.body);n=r}while(n);Wh(t)}function Od(e,t){var n=e;e=0;do{var i=n.nextSibling;if(1===n.nodeType?t?(n._stashedDisplay=n.style.display,n.style.display="none"):(n.style.display=n._stashedDisplay||"",""===n.getAttribute("style")&&n.removeAttribute("style")):3===n.nodeType&&(t?(n._stashedText=n.nodeValue,n.nodeValue=""):n.nodeValue=n._stashedText||""),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===e)break;e--}else"$"!==n&&"$?"!==n&&"$~"!==n&&"$!"!==n||e++;n=i}while(n)}function xd(e){var t=e.firstChild;for(t&&10===t.nodeType&&(t=t.nextSibling);t;){var n=t;switch(t=t.nextSibling,n.nodeName){case"HTML":case"HEAD":case"BODY":xd(n),Qe(n);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if("stylesheet"===n.rel.toLowerCase())continue}e.removeChild(n)}}function Id(e,t){for(;8!==e.nodeType;){if((1!==e.nodeType||"INPUT"!==e.nodeName||"hidden"!==e.type)&&!t)return null;if(null===(e=Dd(e.nextSibling)))return null}return e}function Nd(e){return"$?"===e.data||"$~"===e.data}function Ad(e){return"$!"===e.data||"$?"===e.data&&"loading"!==e.ownerDocument.readyState}function Dd(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t||"$~"===t||"&"===t||"F!"===t||"F"===t)break;if("/$"===t||"/&"===t)return null}}return e}var Ld=null;function Md(e){e=e.nextSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n||"/&"===n){if(0===t)return Dd(e.nextSibling);t--}else"$"!==n&&"$!"!==n&&"$?"!==n&&"$~"!==n&&"&"!==n||t++}e=e.nextSibling}return null}function jd(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n||"$~"===n||"&"===n){if(0===t)return e;t--}else"/$"!==n&&"/&"!==n||t++}e=e.previousSibling}return null}function Ud(e,t,n){switch(t=vd(n),e){case"html":if(!(e=t.documentElement))throw Error(a(452));return e;case"head":if(!(e=t.head))throw Error(a(453));return e;case"body":if(!(e=t.body))throw Error(a(454));return e;default:throw Error(a(451))}}function Fd(e){for(var t=e.attributes;t.length;)e.removeAttributeNode(t[0]);Qe(e)}var Bd=new Map,zd=new Set;function qd(e){return"function"===typeof e.getRootNode?e.getRootNode():9===e.nodeType?e:e.ownerDocument}var Vd=L.d;L.d={f:function(){var e=Vd.f(),t=eu();return e||t},r:function(e){var t=Ye(e);null!==t&&5===t.tag&&"form"===t.type?rs(t):Vd.r(e)},D:function(e){Vd.D(e),Wd("dns-prefetch",e,null)},C:function(e,t){Vd.C(e,t),Wd("preconnect",e,t)},L:function(e,t,n){Vd.L(e,t,n);var i=Hd;if(i&&e&&t){var r='link[rel="preload"][as="'+vt(t)+'"]';"image"===t&&n&&n.imageSrcSet?(r+='[imagesrcset="'+vt(n.imageSrcSet)+'"]',"string"===typeof n.imageSizes&&(r+='[imagesizes="'+vt(n.imageSizes)+'"]')):r+='[href="'+vt(e)+'"]';var o=r;switch(t){case"style":o=Gd(e);break;case"script":o=$d(e)}Bd.has(o)||(e=p({rel:"preload",href:"image"===t&&n&&n.imageSrcSet?void 0:e,as:t},n),Bd.set(o,e),null!==i.querySelector(r)||"style"===t&&i.querySelector(Jd(o))||"script"===t&&i.querySelector(Yd(o))||(pd(t=i.createElement("link"),"link",e),et(t),i.head.appendChild(t)))}},m:function(e,t){Vd.m(e,t);var n=Hd;if(n&&e){var i=t&&"string"===typeof t.as?t.as:"script",r='link[rel="modulepreload"][as="'+vt(i)+'"][href="'+vt(e)+'"]',o=r;switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":o=$d(e)}if(!Bd.has(o)&&(e=p({rel:"modulepreload",href:e},t),Bd.set(o,e),null===n.querySelector(r))){switch(i){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(n.querySelector(Yd(o)))return}pd(i=n.createElement("link"),"link",e),et(i),n.head.appendChild(i)}}},X:function(e,t){Vd.X(e,t);var n=Hd;if(n&&e){var i=Ze(n).hoistableScripts,r=$d(e),o=i.get(r);o||((o=n.querySelector(Yd(r)))||(e=p({src:e,async:!0},t),(t=Bd.get(r))&&th(e,t),et(o=n.createElement("script")),pd(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(r,o))}},S:function(e,t,n){Vd.S(e,t,n);var i=Hd;if(i&&e){var r=Ze(i).hoistableStyles,o=Gd(e);t=t||"default";var a=r.get(o);if(!a){var s={loading:0,preload:null};if(a=i.querySelector(Jd(o)))s.loading=5;else{e=p({rel:"stylesheet",href:e,"data-precedence":t},n),(n=Bd.get(o))&&eh(e,n);var c=a=i.createElement("link");et(c),pd(c,"link",e),c._p=new Promise(function(e,t){c.onload=e,c.onerror=t}),c.addEventListener("load",function(){s.loading|=1}),c.addEventListener("error",function(){s.loading|=2}),s.loading|=4,Zd(a,t,i)}a={type:"stylesheet",instance:a,count:1,state:s},r.set(o,a)}}},M:function(e,t){Vd.M(e,t);var n=Hd;if(n&&e){var i=Ze(n).hoistableScripts,r=$d(e),o=i.get(r);o||((o=n.querySelector(Yd(r)))||(e=p({src:e,async:!0,type:"module"},t),(t=Bd.get(r))&&th(e,t),et(o=n.createElement("script")),pd(o,"link",e),n.head.appendChild(o)),o={type:"script",instance:o,count:1,state:null},i.set(r,o))}}};var Hd="undefined"===typeof document?null:document;function Wd(e,t,n){var i=Hd;if(i&&"string"===typeof t&&t){var r=vt(t);r='link[rel="'+e+'"][href="'+r+'"]',"string"===typeof n&&(r+='[crossorigin="'+n+'"]'),zd.has(r)||(zd.add(r),e={rel:e,crossOrigin:n,href:t},null===i.querySelector(r)&&(pd(t=i.createElement("link"),"link",e),et(t),i.head.appendChild(t)))}}function Kd(e,t,n,i){var r,o,s,c,l=(l=K.current)?qd(l):null;if(!l)throw Error(a(446));switch(e){case"meta":case"title":return null;case"style":return"string"===typeof n.precedence&&"string"===typeof n.href?(t=Gd(n.href),(i=(n=Ze(l).hoistableStyles).get(t))||(i={type:"style",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};case"link":if("stylesheet"===n.rel&&"string"===typeof n.href&&"string"===typeof n.precedence){e=Gd(n.href);var u=Ze(l).hoistableStyles,d=u.get(e);if(d||(l=l.ownerDocument||l,d={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},u.set(e,d),(u=l.querySelector(Jd(e)))&&!u._p&&(d.instance=u,d.state.loading=5),Bd.has(e)||(n={rel:"preload",as:"style",href:n.href,crossOrigin:n.crossOrigin,integrity:n.integrity,media:n.media,hrefLang:n.hrefLang,referrerPolicy:n.referrerPolicy},Bd.set(e,n),u||(r=l,o=e,s=n,c=d.state,r.querySelector('link[rel="preload"][as="style"]['+o+"]")?c.loading=1:(o=r.createElement("link"),c.preload=o,o.addEventListener("load",function(){return c.loading|=1}),o.addEventListener("error",function(){return c.loading|=2}),pd(o,"link",s),et(o),r.head.appendChild(o))))),t&&null===i)throw Error(a(528,""));return d}if(t&&null!==i)throw Error(a(529,""));return null;case"script":return t=n.async,"string"===typeof(n=n.src)&&t&&"function"!==typeof t&&"symbol"!==typeof t?(t=$d(n),(i=(n=Ze(l).hoistableScripts).get(t))||(i={type:"script",instance:null,count:0,state:null},n.set(t,i)),i):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,e))}}function Gd(e){return'href="'+vt(e)+'"'}function Jd(e){return'link[rel="stylesheet"]['+e+"]"}function Qd(e){return p({},e,{"data-precedence":e.precedence,precedence:null})}function $d(e){return'[src="'+vt(e)+'"]'}function Yd(e){return"script[async]"+e}function Xd(e,t,n){if(t.count++,null===t.instance)switch(t.type){case"style":var i=e.querySelector('style[data-href~="'+vt(n.href)+'"]');if(i)return t.instance=i,et(i),i;var r=p({},n,{"data-href":n.href,"data-precedence":n.precedence,href:null,precedence:null});return et(i=(e.ownerDocument||e).createElement("style")),pd(i,"style",r),Zd(i,n.precedence,e),t.instance=i;case"stylesheet":r=Gd(n.href);var o=e.querySelector(Jd(r));if(o)return t.state.loading|=4,t.instance=o,et(o),o;i=Qd(n),(r=Bd.get(r))&&eh(i,r),et(o=(e.ownerDocument||e).createElement("link"));var s=o;return s._p=new Promise(function(e,t){s.onload=e,s.onerror=t}),pd(o,"link",i),t.state.loading|=4,Zd(o,n.precedence,e),t.instance=o;case"script":return o=$d(n.src),(r=e.querySelector(Yd(o)))?(t.instance=r,et(r),r):(i=n,(r=Bd.get(o))&&th(i=p({},n),r),et(r=(e=e.ownerDocument||e).createElement("script")),pd(r,"link",i),e.head.appendChild(r),t.instance=r);case"void":return null;default:throw Error(a(443,t.type))}else"stylesheet"===t.type&&0===(4&t.state.loading)&&(i=t.instance,t.state.loading|=4,Zd(i,n.precedence,e));return t.instance}function Zd(e,t,n){for(var i=n.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),r=i.length?i[i.length-1]:null,o=r,a=0;a<i.length;a++){var s=i[a];if(s.dataset.precedence===t)o=s;else if(o!==r)break}o?o.parentNode.insertBefore(e,o.nextSibling):(t=9===n.nodeType?n.head:n).insertBefore(e,t.firstChild)}function eh(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.title&&(e.title=t.title)}function th(e,t){null==e.crossOrigin&&(e.crossOrigin=t.crossOrigin),null==e.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),null==e.integrity&&(e.integrity=t.integrity)}var nh=null;function ih(e,t,n){if(null===nh){var i=new Map,r=nh=new Map;r.set(n,i)}else(i=(r=nh).get(n))||(i=new Map,r.set(n,i));if(i.has(e))return i;for(i.set(e,null),n=n.getElementsByTagName(e),r=0;r<n.length;r++){var o=n[r];if(!(o[Je]||o[ze]||"link"===e&&"stylesheet"===o.getAttribute("rel"))&&"http://www.w3.org/2000/svg"!==o.namespaceURI){var a=o.getAttribute(t)||"";a=e+a;var s=i.get(a);s?s.push(o):i.set(a,[o])}}return i}function rh(e,t,n){(e=e.ownerDocument||e).head.insertBefore(n,"title"===t?e.querySelector("head > title"):null)}function oh(e){return"stylesheet"!==e.type||0!==(3&e.state.loading)}var ah=0;function sh(){if(this.count--,0===this.count&&(0===this.imgCount||!this.waitingForImages))if(this.stylesheets)lh(this,this.stylesheets);else if(this.unsuspend){var e=this.unsuspend;this.unsuspend=null,e()}}var ch=null;function lh(e,t){e.stylesheets=null,null!==e.unsuspend&&(e.count++,ch=new Map,t.forEach(uh,e),ch=null,sh.call(e))}function uh(e,t){if(!(4&t.state.loading)){var n=ch.get(e);if(n)var i=n.get(null);else{n=new Map,ch.set(e,n);for(var r=e.querySelectorAll("link[data-precedence],style[data-precedence]"),o=0;o<r.length;o++){var a=r[o];"LINK"!==a.nodeName&&"not all"===a.getAttribute("media")||(n.set(a.dataset.precedence,a),i=a)}i&&n.set(null,i)}a=(r=t.instance).getAttribute("data-precedence"),(o=n.get(a)||i)===i&&n.set(null,r),n.set(a,r),this.count++,i=sh.bind(this),r.addEventListener("load",i),r.addEventListener("error",i),o?o.parentNode.insertBefore(r,o.nextSibling):(e=9===e.nodeType?e.head:e).insertBefore(r,e.firstChild),t.state.loading|=4}}var dh={$$typeof:S,Provider:null,Consumer:null,_currentValue:M,_currentValue2:M,_threadCount:0};function hh(e,t,n,i,r,o,a,s,c){this.tag=1,this.containerInfo=e,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ie(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ie(0),this.hiddenUpdates=Ie(null),this.identifierPrefix=i,this.onUncaughtError=r,this.onCaughtError=o,this.onRecoverableError=a,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=c,this.incompleteTransitions=new Map}function ph(e,t,n,i,r,o,a,s,c,l,u,d){return e=new hh(e,t,n,a,c,l,u,d,s),t=1,!0===o&&(t|=24),o=Ui(3,null,null,t),e.current=o,o.stateNode=e,(t=Fr()).refCount++,e.pooledCache=t,t.refCount++,o.memoizedState={element:i,isDehydrated:n,cache:t},vo(o),e}function fh(e){return e?e=Mi:Mi}function mh(e,t,n,i,r,o){r=fh(r),null===i.context?i.context=r:i.pendingContext=r,(i=bo(t)).payload={element:n},null!==(o=void 0===o?null:o)&&(i.callback=o),null!==(n=ko(e,i,t))&&(Ql(n,0,t),wo(n,e,t))}function gh(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function vh(e,t){gh(e,t),(e=e.alternate)&&gh(e,t)}function yh(e){if(13===e.tag||31===e.tag){var t=Ai(e,67108864);null!==t&&Ql(t,0,67108864),vh(e,67108864)}}function bh(e){if(13===e.tag||31===e.tag){var t=Gl(),n=Ai(e,t=Me(t));null!==n&&Ql(n,0,t),vh(e,t)}}var kh=!0;function Sh(e,t,n,i){var r=D.T;D.T=null;var o=L.p;try{L.p=2,Th(e,t,n,i)}finally{L.p=o,D.T=r}}function wh(e,t,n,i){var r=D.T;D.T=null;var o=L.p;try{L.p=8,Th(e,t,n,i)}finally{L.p=o,D.T=r}}function Th(e,t,n,i){if(kh){var r=Ch(i);if(null===r)nd(e,t,i,Eh,n),Mh(e,i);else if(function(e,t,n,i,r){switch(t){case"focusin":return Oh=jh(Oh,e,t,n,i,r),!0;case"dragenter":return xh=jh(xh,e,t,n,i,r),!0;case"mouseover":return Ih=jh(Ih,e,t,n,i,r),!0;case"pointerover":var o=r.pointerId;return Nh.set(o,jh(Nh.get(o)||null,e,t,n,i,r)),!0;case"gotpointercapture":return o=r.pointerId,Ah.set(o,jh(Ah.get(o)||null,e,t,n,i,r)),!0}return!1}(r,e,t,n,i))i.stopPropagation();else if(Mh(e,i),4&t&&-1<Lh.indexOf(e)){for(;null!==r;){var o=Ye(r);if(null!==o)switch(o.tag){case 3:if((o=o.stateNode).current.memoizedState.isDehydrated){var a=Pe(o.pendingLanes);if(0!==a){var s=o;for(s.pendingLanes|=2,s.entangledLanes|=2;a;){var c=1<<31-ke(a);s.entanglements[1]|=c,a&=~c}Mu(o),0===(6&fl)&&(Ll=ce()+500,ju(0,!1))}}break;case 31:case 13:null!==(s=Ai(o,2))&&Ql(s,0,2),eu(),vh(o,2)}if(null===(o=Ch(i))&&nd(e,t,i,Eh,n),o===r)break;r=o}null!==r&&i.stopPropagation()}else nd(e,t,i,null,n)}}function Ch(e){return Ph(e=Dt(e))}var Eh=null;function Ph(e){if(Eh=null,null!==(e=$e(e))){var t=c(e);if(null===t)e=null;else{var n=t.tag;if(13===n){if(null!==(e=l(t)))return e;e=null}else if(31===n){if(null!==(e=u(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null)}}return Eh=e,null}function Rh(e){switch(e){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(le()){case ue:return 2;case de:return 8;case he:case pe:return 32;case fe:return 268435456;default:return 32}default:return 32}}var _h=!1,Oh=null,xh=null,Ih=null,Nh=new Map,Ah=new Map,Dh=[],Lh="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Mh(e,t){switch(e){case"focusin":case"focusout":Oh=null;break;case"dragenter":case"dragleave":xh=null;break;case"mouseover":case"mouseout":Ih=null;break;case"pointerover":case"pointerout":Nh.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ah.delete(t.pointerId)}}function jh(e,t,n,i,r,o){return null===e||e.nativeEvent!==o?(e={blockedOn:t,domEventName:n,eventSystemFlags:i,nativeEvent:o,targetContainers:[r]},null!==t&&(null!==(t=Ye(t))&&yh(t)),e):(e.eventSystemFlags|=i,t=e.targetContainers,null!==r&&-1===t.indexOf(r)&&t.push(r),e)}function Uh(e){var t=$e(e.target);if(null!==t){var n=c(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=l(n)))return e.blockedOn=t,void Fe(e.priority,function(){bh(n)})}else if(31===t){if(null!==(t=u(n)))return e.blockedOn=t,void Fe(e.priority,function(){bh(n)})}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Fh(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Ch(e.nativeEvent);if(null!==n)return null!==(t=Ye(n))&&yh(t),e.blockedOn=n,!1;var i=new(n=e.nativeEvent).constructor(n.type,n);At=i,n.target.dispatchEvent(i),At=null,t.shift()}return!0}function Bh(e,t,n){Fh(e)&&n.delete(t)}function zh(){_h=!1,null!==Oh&&Fh(Oh)&&(Oh=null),null!==xh&&Fh(xh)&&(xh=null),null!==Ih&&Fh(Ih)&&(Ih=null),Nh.forEach(Bh),Ah.forEach(Bh)}function qh(e,t){e.blockedOn===t&&(e.blockedOn=null,_h||(_h=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,zh)))}var Vh=null;function Hh(e){Vh!==e&&(Vh=e,i.unstable_scheduleCallback(i.unstable_NormalPriority,function(){Vh===e&&(Vh=null);for(var t=0;t<e.length;t+=3){var n=e[t],i=e[t+1],r=e[t+2];if("function"!==typeof i){if(null===Ph(i||n))continue;break}var o=Ye(n);null!==o&&(e.splice(t,3),t-=3,ns(o,{pending:!0,data:r,method:n.method,action:i},i,r))}}))}function Wh(e){function t(t){return qh(t,e)}null!==Oh&&qh(Oh,e),null!==xh&&qh(xh,e),null!==Ih&&qh(Ih,e),Nh.forEach(t),Ah.forEach(t);for(var n=0;n<Dh.length;n++){var i=Dh[n];i.blockedOn===e&&(i.blockedOn=null)}for(;0<Dh.length&&null===(n=Dh[0]).blockedOn;)Uh(n),null===n.blockedOn&&Dh.shift();if(null!=(n=(e.ownerDocument||e).$$reactFormReplay))for(i=0;i<n.length;i+=3){var r=n[i],o=n[i+1],a=r[qe]||null;if("function"===typeof o)a||Hh(n);else if(a){var s=null;if(o&&o.hasAttribute("formAction")){if(r=o,a=o[qe]||null)s=a.formAction;else if(null!==Ph(r))continue}else s=a.action;"function"===typeof s?n[i+1]=s:(n.splice(i,3),i-=3),Hh(n)}}}function Kh(){function e(e){e.canIntercept&&"react-transition"===e.info&&e.intercept({handler:function(){return new Promise(function(e){return r=e})},focusReset:"manual",scroll:"manual"})}function t(){null!==r&&(r(),r=null),i||setTimeout(n,20)}function n(){if(!i&&!navigation.transition){var e=navigation.currentEntry;e&&null!=e.url&&navigation.navigate(e.url,{state:e.getState(),info:"react-transition",history:"replace"})}}if("object"===typeof navigation){var i=!1,r=null;return navigation.addEventListener("navigate",e),navigation.addEventListener("navigatesuccess",t),navigation.addEventListener("navigateerror",t),setTimeout(n,100),function(){i=!0,navigation.removeEventListener("navigate",e),navigation.removeEventListener("navigatesuccess",t),navigation.removeEventListener("navigateerror",t),null!==r&&(r(),r=null)}}}function Gh(e){this._internalRoot=e}function Jh(e){this._internalRoot=e}Jh.prototype.render=Gh.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(a(409));mh(t.current,Gl(),e,t,null,null)},Jh.prototype.unmount=Gh.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;mh(e.current,2,null,e,null,null),eu(),t[Ve]=null}},Jh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Ue();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dh.length&&0!==t&&t<Dh[n].priority;n++);Dh.splice(n,0,e),0===n&&Uh(e)}};var Qh=r.version;if("19.2.0"!==Qh)throw Error(a(527,Qh,"19.2.0"));L.findDOMNode=function(e){var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw e=Object.keys(e).join(","),Error(a(268,e))}return e=function(e){var t=e.alternate;if(!t){if(null===(t=c(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,i=t;;){var r=n.return;if(null===r)break;var o=r.alternate;if(null===o){if(null!==(i=r.return)){n=i;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return d(r),e;if(o===i)return d(r),t;o=o.sibling}throw Error(a(188))}if(n.return!==i.return)n=r,i=o;else{for(var s=!1,l=r.child;l;){if(l===n){s=!0,n=r,i=o;break}if(l===i){s=!0,i=r,n=o;break}l=l.sibling}if(!s){for(l=o.child;l;){if(l===n){s=!0,n=o,i=r;break}if(l===i){s=!0,i=o,n=r;break}l=l.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==i)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(t),e=null===(e=null!==e?h(e):null)?null:e.stateNode};var $h={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:D,reconcilerVersion:"19.2.0"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var Yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yh.isDisabled&&Yh.supportsFiber)try{ve=Yh.inject($h),ye=Yh}catch(Xh){}}t.createRoot=function(e,t){if(!s(e))throw Error(a(299));var n=!1,i="",r=Es,o=Ps,c=Rs;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(i=t.identifierPrefix),void 0!==t.onUncaughtError&&(r=t.onUncaughtError),void 0!==t.onCaughtError&&(o=t.onCaughtError),void 0!==t.onRecoverableError&&(c=t.onRecoverableError)),t=ph(e,1,!1,null,0,n,i,null,r,o,c,Kh),e[Ve]=t.current,ed(e),new Gh(t)},t.hydrateRoot=function(e,t,n){if(!s(e))throw Error(a(299));var i=!1,r="",o=Es,c=Ps,l=Rs,u=null;return null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(r=n.identifierPrefix),void 0!==n.onUncaughtError&&(o=n.onUncaughtError),void 0!==n.onCaughtError&&(c=n.onCaughtError),void 0!==n.onRecoverableError&&(l=n.onRecoverableError),void 0!==n.formState&&(u=n.formState)),(t=ph(e,1,!0,t,0,i,r,u,o,c,l,Kh)).context=fh(null),n=t.current,(r=bo(i=Me(i=Gl()))).callback=null,ko(n,r,i),n=i,t.current.lanes=n,Ne(t,n),Mu(t),e[Ve]=t.current,ed(e),new Jh(t)},t.version="19.2.0"},43:(e,t,n)=>{e.exports=n(288)},288:(e,t)=>{var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),o=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),s=Symbol.for("react.consumer"),c=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.for("react.activity"),f=Symbol.iterator;var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},g=Object.assign,v={};function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}function b(){}function k(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||m}y.prototype.isReactComponent={},y.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},y.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},b.prototype=y.prototype;var S=k.prototype=new b;S.constructor=k,g(S,y.prototype),S.isPureReactComponent=!0;var w=Array.isArray;function T(){}var C={H:null,A:null,T:null,S:null},E=Object.prototype.hasOwnProperty;function P(e,t,i){var r=i.ref;return{$$typeof:n,type:e,key:t,ref:void 0!==r?r:null,props:i}}function R(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var _=/\/+/g;function O(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function x(e,t,r,o,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c,l,u=!1;if(null===e)u=!0;else switch(s){case"bigint":case"string":case"number":u=!0;break;case"object":switch(e.$$typeof){case n:case i:u=!0;break;case h:return x((u=e._init)(e._payload),t,r,o,a)}}if(u)return a=a(e),u=""===o?"."+O(e,0):o,w(a)?(r="",null!=u&&(r=u.replace(_,"$&/")+"/"),x(a,t,r,"",function(e){return e})):null!=a&&(R(a)&&(c=a,l=r+(null==a.key||e&&e.key===a.key?"":(""+a.key).replace(_,"$&/")+"/")+u,a=P(c.type,l,c.props)),t.push(a)),1;u=0;var d,p=""===o?".":o+":";if(w(e))for(var m=0;m<e.length;m++)u+=x(o=e[m],t,r,s=p+O(o,m),a);else if("function"===typeof(m=null===(d=e)||"object"!==typeof d?null:"function"===typeof(d=f&&d[f]||d["@@iterator"])?d:null))for(e=m.call(e),m=0;!(o=e.next()).done;)u+=x(o=o.value,t,r,s=p+O(o,m++),a);else if("object"===s){if("function"===typeof e.then)return x(function(e){switch(e.status){case"fulfilled":return e.value;case"rejected":throw e.reason;default:switch("string"===typeof e.status?e.then(T,T):(e.status="pending",e.then(function(t){"pending"===e.status&&(e.status="fulfilled",e.value=t)},function(t){"pending"===e.status&&(e.status="rejected",e.reason=t)})),e.status){case"fulfilled":return e.value;case"rejected":throw e.reason}}throw e}(e),t,r,o,a);throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.")}return u}function I(e,t,n){if(null==e)return e;var i=[],r=0;return x(e,i,"","",function(e){return t.call(n,e,r++)}),i}function N(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var A="function"===typeof reportError?reportError:function(e){if("object"===typeof window&&"function"===typeof window.ErrorEvent){var t=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:"object"===typeof e&&null!==e&&"string"===typeof e.message?String(e.message):String(e),error:e});if(!window.dispatchEvent(t))return}else if("object"===typeof process&&"function"===typeof process.emit)return void process.emit("uncaughtException",e);console.error(e)},D={map:I,forEach:function(e,t,n){I(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return I(e,function(){t++}),t},toArray:function(e){return I(e,function(e){return e})||[]},only:function(e){if(!R(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};t.Activity=p,t.Children=D,t.Component=y,t.Fragment=r,t.Profiler=a,t.PureComponent=k,t.StrictMode=o,t.Suspense=u,t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,t.__COMPILER_RUNTIME={__proto__:null,c:function(e){return C.H.useMemoCache(e)}},t.cache=function(e){return function(){return e.apply(null,arguments)}},t.cacheSignal=function(){return null},t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error("The argument must be a React element, but you passed "+e+".");var i=g({},e.props),r=e.key;if(null!=t)for(o in void 0!==t.key&&(r=""+t.key),t)!E.call(t,o)||"key"===o||"__self"===o||"__source"===o||"ref"===o&&void 0===t.ref||(i[o]=t[o]);var o=arguments.length-2;if(1===o)i.children=n;else if(1<o){for(var a=Array(o),s=0;s<o;s++)a[s]=arguments[s+2];i.children=a}return P(e.type,r,i)},t.createContext=function(e){return(e={$$typeof:c,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider=e,e.Consumer={$$typeof:s,_context:e},e},t.createElement=function(e,t,n){var i,r={},o=null;if(null!=t)for(i in void 0!==t.key&&(o=""+t.key),t)E.call(t,i)&&"key"!==i&&"__self"!==i&&"__source"!==i&&(r[i]=t[i]);var a=arguments.length-2;if(1===a)r.children=n;else if(1<a){for(var s=Array(a),c=0;c<a;c++)s[c]=arguments[c+2];r.children=s}if(e&&e.defaultProps)for(i in a=e.defaultProps)void 0===r[i]&&(r[i]=a[i]);return P(e,o,r)},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:l,render:e}},t.isValidElement=R,t.lazy=function(e){return{$$typeof:h,_payload:{_status:-1,_result:e},_init:N}},t.memo=function(e,t){return{$$typeof:d,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=C.T,n={};C.T=n;try{var i=e(),r=C.S;null!==r&&r(n,i),"object"===typeof i&&null!==i&&"function"===typeof i.then&&i.then(T,A)}catch(o){A(o)}finally{null!==t&&null!==n.types&&(t.types=n.types),C.T=t}},t.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},t.use=function(e){return C.H.use(e)},t.useActionState=function(e,t,n){return C.H.useActionState(e,t,n)},t.useCallback=function(e,t){return C.H.useCallback(e,t)},t.useContext=function(e){return C.H.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e,t){return C.H.useDeferredValue(e,t)},t.useEffect=function(e,t){return C.H.useEffect(e,t)},t.useEffectEvent=function(e){return C.H.useEffectEvent(e)},t.useId=function(){return C.H.useId()},t.useImperativeHandle=function(e,t,n){return C.H.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return C.H.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return C.H.useLayoutEffect(e,t)},t.useMemo=function(e,t){return C.H.useMemo(e,t)},t.useOptimistic=function(e,t){return C.H.useOptimistic(e,t)},t.useReducer=function(e,t,n){return C.H.useReducer(e,t,n)},t.useRef=function(e){return C.H.useRef(e)},t.useState=function(e){return C.H.useState(e)},t.useSyncExternalStore=function(e,t,n){return C.H.useSyncExternalStore(e,t,n)},t.useTransition=function(){return C.H.useTransition()},t.version="19.2.0"},391:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(4)},579:(e,t,n)=>{e.exports=n(799)},672:(e,t,n)=>{var i=n(43);function r(e){var t="https://react.dev/errors/"+e;if(1<arguments.length){t+="?args[]="+encodeURIComponent(arguments[1]);for(var n=2;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n])}return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(){}var a={d:{f:o,r:function(){throw Error(r(522))},D:o,C:o,L:o,m:o,X:o,S:o,M:o},p:0,findDOMNode:null},s=Symbol.for("react.portal");var c=i.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function l(e,t){return"font"===e?"":"string"===typeof t?"use-credentials"===t?t:"":void 0}t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType)throw Error(r(299));return function(e,t,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:s,key:null==i?null:""+i,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.flushSync=function(e){var t=c.T,n=a.p;try{if(c.T=null,a.p=2,e)return e()}finally{c.T=t,a.p=n,a.d.f()}},t.preconnect=function(e,t){"string"===typeof e&&(t?t="string"===typeof(t=t.crossOrigin)?"use-credentials"===t?t:"":void 0:t=null,a.d.C(e,t))},t.prefetchDNS=function(e){"string"===typeof e&&a.d.D(e)},t.preinit=function(e,t){if("string"===typeof e&&t&&"string"===typeof t.as){var n=t.as,i=l(n,t.crossOrigin),r="string"===typeof t.integrity?t.integrity:void 0,o="string"===typeof t.fetchPriority?t.fetchPriority:void 0;"style"===n?a.d.S(e,"string"===typeof t.precedence?t.precedence:void 0,{crossOrigin:i,integrity:r,fetchPriority:o}):"script"===n&&a.d.X(e,{crossOrigin:i,integrity:r,fetchPriority:o,nonce:"string"===typeof t.nonce?t.nonce:void 0})}},t.preinitModule=function(e,t){if("string"===typeof e)if("object"===typeof t&&null!==t){if(null==t.as||"script"===t.as){var n=l(t.as,t.crossOrigin);a.d.M(e,{crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0})}}else null==t&&a.d.M(e)},t.preload=function(e,t){if("string"===typeof e&&"object"===typeof t&&null!==t&&"string"===typeof t.as){var n=t.as,i=l(n,t.crossOrigin);a.d.L(e,n,{crossOrigin:i,integrity:"string"===typeof t.integrity?t.integrity:void 0,nonce:"string"===typeof t.nonce?t.nonce:void 0,type:"string"===typeof t.type?t.type:void 0,fetchPriority:"string"===typeof t.fetchPriority?t.fetchPriority:void 0,referrerPolicy:"string"===typeof t.referrerPolicy?t.referrerPolicy:void 0,imageSrcSet:"string"===typeof t.imageSrcSet?t.imageSrcSet:void 0,imageSizes:"string"===typeof t.imageSizes?t.imageSizes:void 0,media:"string"===typeof t.media?t.media:void 0})}},t.preloadModule=function(e,t){if("string"===typeof e)if(t){var n=l(t.as,t.crossOrigin);a.d.m(e,{as:"string"===typeof t.as&&"script"!==t.as?t.as:void 0,crossOrigin:n,integrity:"string"===typeof t.integrity?t.integrity:void 0})}else a.d.m(e)},t.requestFormReset=function(e){a.d.r(e)},t.unstable_batchedUpdates=function(e,t){return e(t)},t.useFormState=function(e,t,n){return c.H.useFormState(e,t,n)},t.useFormStatus=function(){return c.H.useHostTransitionStatus()},t.version="19.2.0"},799:(e,t)=>{var n=Symbol.for("react.transitional.element"),i=Symbol.for("react.fragment");function r(e,t,i){var r=null;if(void 0!==i&&(r=""+i),void 0!==t.key&&(r=""+t.key),"key"in t)for(var o in i={},t)"key"!==o&&(i[o]=t[o]);else i=t;return t=i.ref,{$$typeof:n,type:e,key:r,ref:void 0!==t?t:null,props:i}}t.Fragment=i,t.jsx=r,t.jsxs=r},853:(e,t,n)=>{e.exports=n(896)},896:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var i=n-1>>>1,r=e[i];if(!(0<o(r,t)))break e;e[i]=t,e[n]=r,n=i}}function i(e){return 0===e.length?null:e[0]}function r(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var i=0,r=e.length,a=r>>>1;i<a;){var s=2*(i+1)-1,c=e[s],l=s+1,u=e[l];if(0>o(c,n))l<r&&0>o(u,c)?(e[i]=u,e[l]=n,i=l):(e[i]=c,e[s]=n,i=s);else{if(!(l<r&&0>o(u,n)))break e;e[i]=u,e[l]=n,i=l}}}return t}function o(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if(t.unstable_now=void 0,"object"===typeof performance&&"function"===typeof performance.now){var a=performance;t.unstable_now=function(){return a.now()}}else{var s=Date,c=s.now();t.unstable_now=function(){return s.now()-c}}var l=[],u=[],d=1,h=null,p=3,f=!1,m=!1,g=!1,v=!1,y="function"===typeof setTimeout?setTimeout:null,b="function"===typeof clearTimeout?clearTimeout:null,k="undefined"!==typeof setImmediate?setImmediate:null;function S(e){for(var t=i(u);null!==t;){if(null===t.callback)r(u);else{if(!(t.startTime<=e))break;r(u),t.sortIndex=t.expirationTime,n(l,t)}t=i(u)}}function w(e){if(g=!1,S(e),!m)if(null!==i(l))m=!0,C||(C=!0,T());else{var t=i(u);null!==t&&N(w,t.startTime-e)}}var T,C=!1,E=-1,P=5,R=-1;function _(){return!!v||!(t.unstable_now()-R<P)}function O(){if(v=!1,C){var e=t.unstable_now();R=e;var n=!0;try{e:{m=!1,g&&(g=!1,b(E),E=-1),f=!0;var o=p;try{t:{for(S(e),h=i(l);null!==h&&!(h.expirationTime>e&&_());){var a=h.callback;if("function"===typeof a){h.callback=null,p=h.priorityLevel;var s=a(h.expirationTime<=e);if(e=t.unstable_now(),"function"===typeof s){h.callback=s,S(e),n=!0;break t}h===i(l)&&r(l),S(e)}else r(l);h=i(l)}if(null!==h)n=!0;else{var c=i(u);null!==c&&N(w,c.startTime-e),n=!1}}break e}finally{h=null,p=o,f=!1}n=void 0}}finally{n?T():C=!1}}}if("function"===typeof k)T=function(){k(O)};else if("undefined"!==typeof MessageChannel){var x=new MessageChannel,I=x.port2;x.port1.onmessage=O,T=function(){I.postMessage(null)}}else T=function(){y(O,0)};function N(e,n){E=y(function(){e(t.unstable_now())},n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_next=function(e){switch(p){case 1:case 2:case 3:var t=3;break;default:t=p}var n=p;p=t;try{return e()}finally{p=n}},t.unstable_requestPaint=function(){v=!0},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=p;p=e;try{return t()}finally{p=n}},t.unstable_scheduleCallback=function(e,r,o){var a=t.unstable_now();switch("object"===typeof o&&null!==o?o="number"===typeof(o=o.delay)&&0<o?a+o:a:o=a,e){case 1:var s=-1;break;case 2:s=250;break;case 5:s=1073741823;break;case 4:s=1e4;break;default:s=5e3}return e={id:d++,callback:r,priorityLevel:e,startTime:o,expirationTime:s=o+s,sortIndex:-1},o>a?(e.sortIndex=o,n(u,e),null===i(l)&&e===i(u)&&(g?(b(E),E=-1):g=!0,N(w,o-a))):(e.sortIndex=s,n(l,e),m||f||(m=!0,C||(C=!0,T()))),e},t.unstable_shouldYield=_,t.unstable_wrapCallback=function(e){var t=p;return function(){var n=p;p=t;try{return e.apply(this,arguments)}finally{p=n}}}},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(672)}},t={};function n(i){var r=t[i];if(void 0!==r)return r.exports;var o=t[i]={exports:{}};return e[i](o,o.exports,n),o.exports}n.m=e,n.d=(e,t)=>{for(var i in t)n.o(t,i)&&!n.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce((t,i)=>(n.f[i](e,t),t),[])),n.u=e=>"static/js/"+e+".eb570f4f.chunk.js",n.miniCssF=e=>{},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="client:";n.l=(i,r,o,a)=>{if(e[i])e[i].push(r);else{var s,c;if(void 0!==o)for(var l=document.getElementsByTagName("script"),u=0;u<l.length;u++){var d=l[u];if(d.getAttribute("src")==i||d.getAttribute("data-webpack")==t+o){s=d;break}}s||(c=!0,(s=document.createElement("script")).charset="utf-8",n.nc&&s.setAttribute("nonce",n.nc),s.setAttribute("data-webpack",t+o),s.src=i),e[i]=[r];var h=(t,n)=>{s.onerror=s.onload=null,clearTimeout(p);var r=e[i];if(delete e[i],s.parentNode&&s.parentNode.removeChild(s),r&&r.forEach(e=>e(n)),t)return t(n)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),c&&document.head.appendChild(s)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/video-chat/",(()=>{var e={792:0};n.f.j=(t,i)=>{var r=n.o(e,t)?e[t]:void 0;if(0!==r)if(r)i.push(r[2]);else{var o=new Promise((n,i)=>r=e[t]=[n,i]);i.push(r[2]=o);var a=n.p+n.u(t),s=new Error;n.l(a,i=>{if(n.o(e,t)&&(0!==(r=e[t])&&(e[t]=void 0),r)){var o=i&&("load"===i.type?"missing":i.type),a=i&&i.target&&i.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,r[1](s)}},"chunk-"+t,t)}};var t=(t,i)=>{var r,o,[a,s,c]=i,l=0;if(a.some(t=>0!==e[t])){for(r in s)n.o(s,r)&&(n.m[r]=s[r]);if(c)c(n)}for(t&&t(i);l<a.length;l++)o=a[l],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0},i=self.webpackChunkclient=self.webpackChunkclient||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))})();var i={};n.r(i),n.d(i,{hasBrowserEnv:()=>On,hasStandardBrowserEnv:()=>In,hasStandardBrowserWebWorkerEnv:()=>Nn,navigator:()=>xn,origin:()=>An});var r={};n.r(r),n.d(r,{Decoder:()=>uo,Encoder:()=>co,PacketType:()=>so,protocol:()=>ao});var o=n(43),a=n(391);function s(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n={};for(var i in e)if({}.hasOwnProperty.call(e,i)){if(-1!==t.indexOf(i))continue;n[i]=e[i]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],-1===t.indexOf(n)&&{}.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}function c(e){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c(e)}function l(e){var t=function(e,t){if("object"!=c(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=c(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==c(t)?t:t+""}function u(e,t,n){return(t=l(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){u(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}const p=["sri"],f=["page"],m=["page","matches"],g=["onClick","discover","prefetch","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],v=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],y=["discover","fetcherKey","navigate","reloadDocument","replace","state","method","action","onSubmit","relative","preventScrollReset","viewTransition"];var b="popstate";function k(){return R(function(e,t){let{pathname:n,search:i,hash:r}=e.location;return C("",{pathname:n,search:i,hash:r},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:E(t)},null,arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}function S(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function w(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(So){}}}function T(e,t){return{usr:e.state,key:e.key,idx:t}}function C(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return h(h({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?P(t):t),{},{state:n,key:t&&t.key||i||Math.random().toString(36).substring(2,10)})}function E(e){let{pathname:t="/",search:n="",hash:i=""}=e;return n&&"?"!==n&&(t+="?"===n.charAt(0)?n:"?"+n),i&&"#"!==i&&(t+="#"===i.charAt(0)?i:"#"+i),t}function P(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let i=e.indexOf("?");i>=0&&(t.search=e.substring(i),e=e.substring(0,i)),e&&(t.pathname=e)}return t}function R(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},{window:r=document.defaultView,v5Compat:o=!1}=i,a=r.history,s="POP",c=null,l=u();function u(){return(a.state||{idx:null}).idx}function d(){s="POP";let e=u(),t=null==e?null:e-l;l=e,c&&c({action:s,location:f.location,delta:t})}function p(e){return _(e)}null==l&&(l=0,a.replaceState(h(h({},a.state),{},{idx:l}),""));let f={get action(){return s},get location(){return e(r,a)},listen(e){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(b,d),c=e,()=>{r.removeEventListener(b,d),c=null}},createHref:e=>t(r,e),createURL:p,encodeLocation(e){let t=p(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){s="PUSH";let i=C(f.location,e,t);n&&n(i,e),l=u()+1;let d=T(i,l),h=f.createHref(i);try{a.pushState(d,"",h)}catch(p){if(p instanceof DOMException&&"DataCloneError"===p.name)throw p;r.location.assign(h)}o&&c&&c({action:s,location:f.location,delta:1})},replace:function(e,t){s="REPLACE";let i=C(f.location,e,t);n&&n(i,e),l=u();let r=T(i,l),d=f.createHref(i);a.replaceState(r,"",d),o&&c&&c({action:s,location:f.location,delta:0})},go:e=>a.go(e)};return f}function _(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="http://localhost";"undefined"!==typeof window&&(n="null"!==window.location.origin?window.location.origin:window.location.href),S(n,"No window.location.(origin|href) available to create URL");let i="string"===typeof e?e:E(e);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=n+i),new URL(i,n)}new WeakMap;function O(e,t){return x(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:"/",!1)}function x(e,t,n,i){let r=W(("string"===typeof t?P(t):t).pathname||"/",n);if(null==r)return null;let o=I(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let n=e.length===t.length&&e.slice(0,-1).every((e,n)=>e===t[n]);return n?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(o);let a=null;for(let s=0;null==a&&s<o.length;++s){let e=H(r);a=z(o[s],e,i)}return a}function I(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=function(e,o){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r,s=arguments.length>3?arguments[3]:void 0,c={relativePath:void 0===s?e.path||"":s,caseSensitive:!0===e.caseSensitive,childrenIndex:o,route:e};if(c.relativePath.startsWith("/")){if(!c.relativePath.startsWith(i)&&a)return;S(c.relativePath.startsWith(i),'Absolute route path "'.concat(c.relativePath,'" nested under path "').concat(i,'" is not valid. An absolute child route path must start with the combined path of all its parent routes.')),c.relativePath=c.relativePath.slice(i.length)}let l=$([i,c.relativePath]),u=n.concat(c);e.children&&e.children.length>0&&(S(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'.concat(l,'".')),I(e.children,t,u,l,a)),(null!=e.path||e.index)&&t.push({path:l,score:B(l,e.index),routesMeta:u})};return e.forEach((e,t)=>{var n;if(""!==e.path&&null!==(n=e.path)&&void 0!==n&&n.includes("?"))for(let i of N(e.path))o(e,t,!0,i);else o(e,t)}),t}function N(e){let t=e.split("/");if(0===t.length)return[];let[n,...i]=t,r=n.endsWith("?"),o=n.replace(/\?$/,"");if(0===i.length)return r?[o,""]:[o];let a=N(i.join("/")),s=[];return s.push(...a.map(e=>""===e?o:[o,e].join("/"))),r&&s.push(...a),s.map(t=>e.startsWith("/")&&""===t?"/":t)}var A=/^:[\w-]+$/,D=3,L=2,M=1,j=10,U=-2,F=e=>"*"===e;function B(e,t){let n=e.split("/"),i=n.length;return n.some(F)&&(i+=U),t&&(i+=L),n.filter(e=>!F(e)).reduce((e,t)=>e+(A.test(t)?D:""===t?M:j),i)}function z(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],{routesMeta:i}=e,r={},o="/",a=[];for(let s=0;s<i.length;++s){let e=i[s],c=s===i.length-1,l="/"===o?t:t.slice(o.length)||"/",u=q({path:e.relativePath,caseSensitive:e.caseSensitive,end:c},l),d=e.route;if(!u&&c&&n&&!i[i.length-1].route.index&&(u=q({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},l)),!u)return null;Object.assign(r,u.params),a.push({params:r,pathname:$([o,u.pathname]),pathnameBase:Y($([o,u.pathnameBase])),route:d}),"/"!==u.pathnameBase&&(o=$([o,u.pathnameBase]))}return a}function q(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[n,i]=V(e.path,e.caseSensitive,e.end),r=t.match(n);if(!r)return null;let o=r[0],a=o.replace(/(.)\/+$/,"$1"),s=r.slice(1),c=i.reduce((e,t,n)=>{let{paramName:i,isOptional:r}=t;if("*"===i){let e=s[n]||"";a=o.slice(0,o.length-e.length).replace(/(.)\/+$/,"$1")}const c=s[n];return e[i]=r&&!c?void 0:(c||"").replace(/%2F/g,"/"),e},{});return{params:c,pathname:o,pathnameBase:a,pattern:e}}function V(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];w("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'.concat(e,'" will be treated as if it were "').concat(e.replace(/\*$/,"/*"),'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "').concat(e.replace(/\*$/,"/*"),'".'));let i=[],r="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,n)=>(i.push({paramName:t,isOptional:null!=n}),n?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return e.endsWith("*")?(i.push({paramName:"*"}),r+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":""!==e&&"/"!==e&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function H(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return w(!1,'The URL path "'.concat(e,'" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (').concat(t,").")),e}}function W(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,i=e.charAt(n);return i&&"/"!==i?null:e.slice(n)||"/"}function K(e,t,n,i){return"Cannot include a '".concat(e,"' character in a manually specified `to.").concat(t,"` field [").concat(JSON.stringify(i),"].  Please separate it out to the `to.").concat(n,'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.')}function G(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function J(e){let t=G(e);return t.map((e,n)=>n===t.length-1?e.pathname:e.pathnameBase)}function Q(e,t,n){let i,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];"string"===typeof e?i=P(e):(i=h({},e),S(!i.pathname||!i.pathname.includes("?"),K("?","pathname","search",i)),S(!i.pathname||!i.pathname.includes("#"),K("#","pathname","hash",i)),S(!i.search||!i.search.includes("#"),K("#","search","hash",i)));let o,a=""===e||""===i.pathname,s=a?"/":i.pathname;if(null==s)o=n;else{let e=t.length-1;if(!r&&s.startsWith("..")){let t=s.split("/");for(;".."===t[0];)t.shift(),e-=1;i.pathname=t.join("/")}o=e>=0?t[e]:"/"}let c=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",{pathname:n,search:i="",hash:r=""}="string"===typeof e?P(e):e,o=n?n.startsWith("/")?n:function(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?n.length>1&&n.pop():"."!==e&&n.push(e)}),n.length>1?n.join("/"):"/"}(n,t):t;return{pathname:o,search:X(i),hash:Z(r)}}(i,o),l=s&&"/"!==s&&s.endsWith("/"),u=(a||"."===s)&&n.endsWith("/");return c.pathname.endsWith("/")||!l&&!u||(c.pathname+="/"),c}var $=e=>e.join("/").replace(/\/\/+/g,"/"),Y=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),X=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",Z=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";function ee(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}var te=["POST","PUT","PATCH","DELETE"],ne=(new Set(te),["GET",...te]);new Set(ne),Symbol("ResetLoaderData");var ie=o.createContext(null);ie.displayName="DataRouter";var re=o.createContext(null);re.displayName="DataRouterState";var oe=o.createContext(!1);var ae=o.createContext({isTransitioning:!1});ae.displayName="ViewTransition";var se=o.createContext(new Map);se.displayName="Fetchers";var ce=o.createContext(null);ce.displayName="Await";var le=o.createContext(null);le.displayName="Navigation";var ue=o.createContext(null);ue.displayName="Location";var de=o.createContext({outlet:null,matches:[],isDataRoute:!1});de.displayName="Route";var he=o.createContext(null);he.displayName="RouteError";function pe(){return null!=o.useContext(ue)}function fe(){return S(pe(),"useLocation() may be used only in the context of a <Router> component."),o.useContext(ue).location}var me="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function ge(e){o.useContext(le).static||o.useLayoutEffect(e)}function ve(){let{isDataRoute:e}=o.useContext(de);return e?function(){let{router:e}=Pe("useNavigate"),t=_e("useNavigate"),n=o.useRef(!1);ge(()=>{n.current=!0});let i=o.useCallback(async function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};w(n.current,me),n.current&&("number"===typeof i?e.navigate(i):await e.navigate(i,h({fromRouteId:t},r)))},[e,t]);return i}():function(){S(pe(),"useNavigate() may be used only in the context of a <Router> component.");let e=o.useContext(ie),{basename:t,navigator:n}=o.useContext(le),{matches:i}=o.useContext(de),{pathname:r}=fe(),a=JSON.stringify(J(i)),s=o.useRef(!1);ge(()=>{s.current=!0});let c=o.useCallback(function(i){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(w(s.current,me),!s.current)return;if("number"===typeof i)return void n.go(i);let c=Q(i,JSON.parse(a),r,"path"===o.relative);null==e&&"/"!==t&&(c.pathname="/"===c.pathname?t:$([t,c.pathname])),(o.replace?n.replace:n.push)(c,o.state,o)},[t,n,a,r,e]);return c}()}o.createContext(null);function ye(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{matches:n}=o.useContext(de),{pathname:i}=fe(),r=JSON.stringify(J(n));return o.useMemo(()=>Q(e,JSON.parse(r),i,"path"===t),[e,r,i,t])}function be(e,t,n,i,r){S(pe(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=o.useContext(le),{matches:s}=o.useContext(de),c=s[s.length-1],l=c?c.params:{},u=c?c.pathname:"/",d=c?c.pathnameBase:"/",p=c&&c.route;{let e=p&&p.path||"";Ie(u,!p||e.endsWith("*")||e.endsWith("*?"),'You rendered descendant <Routes> (or called `useRoutes()`) at "'.concat(u,'" (under <Route path="').concat(e,'">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won\'t match anymore and therefore the child routes will never render.\n\nPlease change the parent <Route path="').concat(e,'"> to <Route path="').concat("/"===e?"*":"".concat(e,"/*"),'">.'))}let f,m=fe();if(t){var g;let e="string"===typeof t?P(t):t;S("/"===d||(null===(g=e.pathname)||void 0===g?void 0:g.startsWith(d)),'When overriding the location using `<Routes location>` or `useRoutes(routes, location)`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "'.concat(d,'" but pathname "').concat(e.pathname,'" was given in the `location` prop.')),f=e}else f=m;let v=f.pathname||"/",y=v;if("/"!==d){let e=d.replace(/^\//,"").split("/");y="/"+v.replace(/^\//,"").split("/").slice(e.length).join("/")}let b=O(e,{pathname:y});w(p||null!=b,'No routes matched location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" ')),w(null==b||void 0!==b[b.length-1].route.element||void 0!==b[b.length-1].route.Component||void 0!==b[b.length-1].route.lazy,'Matched leaf route at location "'.concat(f.pathname).concat(f.search).concat(f.hash,'" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.'));let k=Ce(b&&b.map(e=>Object.assign({},e,{params:Object.assign({},l,e.params),pathname:$([d,a.encodeLocation?a.encodeLocation(e.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:$([d,a.encodeLocation?a.encodeLocation(e.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:e.pathnameBase])})),s,n,i,r);return t&&k?o.createElement(ue.Provider,{value:{location:h({pathname:"/",search:"",hash:"",state:null,key:"default"},f),navigationType:"POP"}},k):k}function ke(){let e=Oe(),t=ee(e)?"".concat(e.status," ").concat(e.statusText):e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},a={padding:"2px 4px",backgroundColor:i},s=null;return console.error("Error handled by React Router default ErrorBoundary:",e),s=o.createElement(o.Fragment,null,o.createElement("p",null,"\ud83d\udcbf Hey developer \ud83d\udc4b"),o.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",o.createElement("code",{style:a},"ErrorBoundary")," or"," ",o.createElement("code",{style:a},"errorElement")," prop on your route.")),o.createElement(o.Fragment,null,o.createElement("h2",null,"Unexpected Application Error!"),o.createElement("h3",{style:{fontStyle:"italic"}},t),n?o.createElement("pre",{style:r},n):null,s)}var Se=o.createElement(ke,null),we=class extends o.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){this.props.unstable_onError?this.props.unstable_onError(e,t):console.error("React Router caught the following error during render",e)}render(){return void 0!==this.state.error?o.createElement(de.Provider,{value:this.props.routeContext},o.createElement(he.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Te(e){let{routeContext:t,match:n,children:i}=e,r=o.useContext(ie);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),o.createElement(de.Provider,{value:t},i)}function Ce(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null==e){if(!n)return null;if(n.errors)e=n.matches;else{if(0!==t.length||n.initialized||!(n.matches.length>0))return null;e=n.matches}}let r=e,a=null===n||void 0===n?void 0:n.errors;if(null!=a){let e=r.findIndex(e=>e.route.id&&void 0!==(null===a||void 0===a?void 0:a[e.route.id]));S(e>=0,"Could not find a matching route for errors on route IDs: ".concat(Object.keys(a).join(","))),r=r.slice(0,Math.min(r.length,e+1))}let s=!1,c=-1;if(n)for(let o=0;o<r.length;o++){let e=r[o];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(c=o),e.route.id){let{loaderData:t,errors:i}=n,o=e.route.loader&&!t.hasOwnProperty(e.route.id)&&(!i||void 0===i[e.route.id]);if(e.route.lazy||o){s=!0,r=c>=0?r.slice(0,c+1):[r[0]];break}}}return r.reduceRight((e,l,u)=>{let d,h=!1,p=null,f=null;n&&(d=a&&l.route.id?a[l.route.id]:void 0,p=l.route.errorElement||Se,s&&(c<0&&0===u?(Ie("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),h=!0,f=null):c===u&&(h=!0,f=l.route.hydrateFallbackElement||null)));let m=t.concat(r.slice(0,u+1)),g=()=>{let t;return t=d?p:h?f:l.route.Component?o.createElement(l.route.Component,null):l.route.element?l.route.element:e,o.createElement(Te,{match:l,routeContext:{outlet:e,matches:m,isDataRoute:null!=n},children:t})};return n&&(l.route.ErrorBoundary||l.route.errorElement||0===u)?o.createElement(we,{location:n.location,revalidation:n.revalidation,component:p,error:d,children:g(),routeContext:{outlet:null,matches:m,isDataRoute:!0},unstable_onError:i}):g()},null)}function Ee(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function Pe(e){let t=o.useContext(ie);return S(t,Ee(e)),t}function Re(e){let t=o.useContext(re);return S(t,Ee(e)),t}function _e(e){let t=function(e){let t=o.useContext(de);return S(t,Ee(e)),t}(e),n=t.matches[t.matches.length-1];return S(n.route.id,"".concat(e,' can only be used on routes that contain a unique "id"')),n.route.id}function Oe(){var e;let t=o.useContext(he),n=Re("useRouteError"),i=_e("useRouteError");return void 0!==t?t:null===(e=n.errors)||void 0===e?void 0:e[i]}var xe={};function Ie(e,t,n){t||xe[e]||(xe[e]=!0,w(!1,n))}var Ne={};function Ae(e,t){e||Ne[t]||(Ne[t]=!0,console.warn(t))}o.memo(function(e){let{routes:t,future:n,state:i,unstable_onError:r}=e;return be(t,void 0,i,r,n)});function De(e){S(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Le(e){let{basename:t="/",children:n=null,location:i,navigationType:r="POP",navigator:a,static:s=!1}=e;S(!pe(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),l=o.useMemo(()=>({basename:c,navigator:a,static:s,future:{}}),[c,a,s]);"string"===typeof i&&(i=P(i));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:f="default"}=i,m=o.useMemo(()=>{let e=W(u,c);return null==e?null:{location:{pathname:e,search:d,hash:h,state:p,key:f},navigationType:r}},[c,u,d,h,p,f,r]);return w(null!=m,'<Router basename="'.concat(c,'"> is not able to match the URL "').concat(u).concat(d).concat(h,"\" because it does not start with the basename, so the <Router> won't render anything.")),null==m?null:o.createElement(le.Provider,{value:l},o.createElement(ue.Provider,{children:n,value:m}))}function Me(e){let{children:t,location:n}=e;return be(je(t),n)}o.Component;function je(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[];return o.Children.forEach(e,(e,i)=>{if(!o.isValidElement(e))return;let r=[...t,i];if(e.type===o.Fragment)return void n.push.apply(n,je(e.props.children,r));S(e.type===De,"[".concat("string"===typeof e.type?e.type:e.type.name,"] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>")),S(!e.props.index||!e.props.children,"An index route cannot have child routes.");let a={id:e.props.id||r.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,middleware:e.props.middleware,loader:e.props.loader,action:e.props.action,hydrateFallbackElement:e.props.hydrateFallbackElement,HydrateFallback:e.props.HydrateFallback,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:!0===e.props.hasErrorBoundary||null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(a.children=je(e.props.children,r)),n.push(a)}),n}var Ue="get",Fe="application/x-www-form-urlencoded";function Be(e){return null!=e&&"string"===typeof e.tagName}var ze=null;var qe=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ve(e){return null==e||qe.has(e)?e:(w(!1,'"'.concat(e,'" is not a valid `encType` for `<Form>`/`<fetcher.Form>` and will default to "').concat(Fe,'"')),null)}function He(e,t){let n,i,r,o,a;if(Be(s=e)&&"form"===s.tagName.toLowerCase()){let a=e.getAttribute("action");i=a?W(a,t):null,n=e.getAttribute("method")||Ue,r=Ve(e.getAttribute("enctype"))||Fe,o=new FormData(e)}else if(function(e){return Be(e)&&"button"===e.tagName.toLowerCase()}(e)||function(e){return Be(e)&&"input"===e.tagName.toLowerCase()}(e)&&("submit"===e.type||"image"===e.type)){let a=e.form;if(null==a)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let s=e.getAttribute("formaction")||a.getAttribute("action");if(i=s?W(s,t):null,n=e.getAttribute("formmethod")||a.getAttribute("method")||Ue,r=Ve(e.getAttribute("formenctype"))||Ve(a.getAttribute("enctype"))||Fe,o=new FormData(a,e),!function(){if(null===ze)try{new FormData(document.createElement("form"),0),ze=!1}catch(So){ze=!0}return ze}()){let{name:t,type:n,value:i}=e;if("image"===n){let e=t?"".concat(t,"."):"";o.append("".concat(e,"x"),"0"),o.append("".concat(e,"y"),"0")}else t&&o.append(t,i)}}else{if(Be(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Ue,i=null,r=Fe,a=e}var s;return o&&"text/plain"===r&&(a=o,o=void 0),{action:i,method:n.toLowerCase(),encType:r,formData:o,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");"undefined"!==typeof window?window:"undefined"!==typeof globalThis&&globalThis;function We(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}Symbol("SingleFetchRedirect");function Ke(e,t,n){let i="string"===typeof e?new URL(e,"undefined"===typeof window?"server://singlefetch/":window.location.origin):e;return"/"===i.pathname?i.pathname="_root.".concat(n):t&&"/"===W(i.pathname,t)?i.pathname="".concat(t.replace(/\/$/,""),"/_root.").concat(n):i.pathname="".concat(i.pathname.replace(/\/$/,""),".").concat(n),i}async function Ge(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error("Error loading route module `".concat(e.module,"`, reloading page...")),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Je(e){return null!=e&&"string"===typeof e.page}function Qe(e){return null!=e&&(null==e.href?"preload"===e.rel&&"string"===typeof e.imageSrcSet&&"string"===typeof e.imageSizes:"string"===typeof e.rel&&"string"===typeof e.href)}function $e(e,t,n,i,r,o){let a=(e,t)=>!n[t]||e.route.id!==n[t].route.id,s=(e,t)=>{var i;return n[t].pathname!==e.pathname||(null===(i=n[t].route.path)||void 0===i?void 0:i.endsWith("*"))&&n[t].params["*"]!==e.params["*"]};return"assets"===o?t.filter((e,t)=>a(e,t)||s(e,t)):"data"===o?t.filter((t,o)=>{let c=i.routes[t.route.id];if(!c||!c.hasLoader)return!1;if(a(t,o)||s(t,o))return!0;if(t.route.shouldRevalidate){var l;let i=t.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:(null===(l=n[0])||void 0===l?void 0:l.params)||{},nextUrl:new URL(e,window.origin),nextParams:t.params,defaultShouldRevalidate:!0});if("boolean"===typeof i)return i}return!0}):[]}function Ye(e,t){let{includeHydrateFallback:n}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i=e.map(e=>{let i=t.routes[e.route.id];if(!i)return[];let r=[i.module];return i.clientActionModule&&(r=r.concat(i.clientActionModule)),i.clientLoaderModule&&(r=r.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(r=r.concat(i.hydrateFallbackModule)),i.imports&&(r=r.concat(i.imports)),r}).flat(1),[...new Set(i)];var i}function Xe(e,t){let n=new Set,i=new Set(t);return e.reduce((e,r)=>{if(t&&!Je(r)&&"script"===r.as&&r.href&&i.has(r.href))return e;let o=JSON.stringify(function(e){let t={},n=Object.keys(e).sort();for(let i of n)t[i]=e[i];return t}(r));return n.has(o)||(n.add(o),e.push({key:o,link:r})),e},[])}function Ze(e,t){return"lazy"===e.mode&&!0===t}function et(){let e=o.useContext(ie);return We(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function tt(){let e=o.useContext(re);return We(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var nt=o.createContext(void 0);function it(){let e=o.useContext(nt);return We(e,"You must render this element inside a <HydratedRouter> element"),e}function rt(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function ot(e,t,n){if(n&&!lt)return[e[0]];if(t){let n=e.findIndex(e=>void 0!==t[e.route.id]);return e.slice(0,n+1)}return e}nt.displayName="FrameworkContext";function at(e){let{page:t}=e,n=s(e,f),{router:i}=et(),r=o.useMemo(()=>O(i.routes,t,i.basename),[i.routes,t,i.basename]);return r?o.createElement(ct,h({page:t,matches:r},n)):null}function st(e){let{manifest:t,routeModules:n}=it(),[i,r]=o.useState([]);return o.useEffect(()=>{let i=!1;return async function(e,t,n){return Xe((await Promise.all(e.map(async e=>{let i=t.routes[e.route.id];if(i){let e=await Ge(i,n);return e.links?e.links():[]}return[]}))).flat(1).filter(Qe).filter(e=>"stylesheet"===e.rel||"preload"===e.rel).map(e=>"stylesheet"===e.rel?h(h({},e),{},{rel:"prefetch",as:"style"}):h(h({},e),{},{rel:"prefetch"})))}(e,t,n).then(e=>{i||r(e)}),()=>{i=!0}},[e,t,n]),i}function ct(e){let{page:t,matches:n}=e,i=s(e,m),r=fe(),{manifest:a,routeModules:c}=it(),{basename:l}=et(),{loaderData:u,matches:d}=tt(),p=o.useMemo(()=>$e(t,n,d,a,r,"data"),[t,n,d,a,r]),f=o.useMemo(()=>$e(t,n,d,a,r,"assets"),[t,n,d,a,r]),g=o.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let e=new Set,i=!1;if(n.forEach(t=>{var n;let r=a.routes[t.route.id];r&&r.hasLoader&&(!p.some(e=>e.route.id===t.route.id)&&t.route.id in u&&null!==(n=c[t.route.id])&&void 0!==n&&n.shouldRevalidate||r.hasClientLoader?i=!0:e.add(t.route.id))}),0===e.size)return[];let o=Ke(t,l,"data");return i&&e.size>0&&o.searchParams.set("_routes",n.filter(t=>e.has(t.route.id)).map(e=>e.route.id).join(",")),[o.pathname+o.search]},[l,u,r,a,p,n,t,c]),v=o.useMemo(()=>Ye(f,a),[f,a]),y=st(f);return o.createElement(o.Fragment,null,g.map(e=>o.createElement("link",h({key:e,rel:"prefetch",as:"fetch",href:e},i))),v.map(e=>o.createElement("link",h({key:e,rel:"modulepreload",href:e},i))),y.map(e=>{let{key:t,link:n}=e;return o.createElement("link",h({key:t,nonce:i.nonce},n))}))}var lt=!1;function ut(e){let{manifest:t,serverHandoffString:n,isSpaMode:i,renderMeta:r,routeDiscovery:a,ssr:c}=it(),{router:l,static:u,staticContext:d}=et(),{matches:f}=tt(),m=o.useContext(oe),g=Ze(a,c);r&&(r.didRenderScripts=!0);let v=ot(f,null,i);o.useEffect(()=>{lt=!0},[]);let y=o.useMemo(()=>{var i;if(m)return null;let r=d?"window.__reactRouterContext = ".concat(n,";").concat("window.__reactRouterContext.stream = new ReadableStream({start(controller){window.__reactRouterContext.streamController = controller;}}).pipeThrough(new TextEncoderStream());"):" ",a=u?"".concat(null!==(i=t.hmr)&&void 0!==i&&i.runtime?"import ".concat(JSON.stringify(t.hmr.runtime),";"):"").concat(g?"":"import ".concat(JSON.stringify(t.url)),";\n").concat(v.map((e,n)=>{let i="route".concat(n),r=t.routes[e.route.id];We(r,"Route ".concat(e.route.id," not found in manifest"));let{clientActionModule:o,clientLoaderModule:a,clientMiddlewareModule:s,hydrateFallbackModule:c,module:l}=r,u=[...o?[{module:o,varName:"".concat(i,"_clientAction")}]:[],...a?[{module:a,varName:"".concat(i,"_clientLoader")}]:[],...s?[{module:s,varName:"".concat(i,"_clientMiddleware")}]:[],...c?[{module:c,varName:"".concat(i,"_HydrateFallback")}]:[],{module:l,varName:"".concat(i,"_main")}];return 1===u.length?"import * as ".concat(i," from ").concat(JSON.stringify(l),";"):[u.map(e=>"import * as ".concat(e.varName,' from "').concat(e.module,'";')).join("\n"),"const ".concat(i," = {").concat(u.map(e=>"...".concat(e.varName)).join(","),"};")].join("\n")}).join("\n"),"\n  ").concat(g?"window.__reactRouterManifest = ".concat(JSON.stringify(function(e,t){let{sri:n}=e,i=s(e,p),r=new Set(t.state.matches.map(e=>e.route.id)),o=t.state.location.pathname.split("/").filter(Boolean),a=["/"];for(o.pop();o.length>0;)a.push("/".concat(o.join("/"))),o.pop();a.forEach(e=>{let n=O(t.routes,e,t.basename);n&&n.forEach(e=>r.add(e.route.id))});let c=[...r].reduce((e,t)=>Object.assign(e,{[t]:i.routes[t]}),{});return h(h({},i),{},{routes:c,sri:!!n||void 0})}(t,l),null,2),";"):"","\n  window.__reactRouterRouteModules = {").concat(v.map((e,t)=>"".concat(JSON.stringify(e.route.id),":route").concat(t)).join(","),"};\n\nimport(").concat(JSON.stringify(t.entry.module),");"):" ";return o.createElement(o.Fragment,null,o.createElement("script",h(h({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:r},type:void 0})),o.createElement("script",h(h({},e),{},{suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:a},type:"module",async:!0})))},[]),b=lt||m?[]:(k=t.entry.imports.concat(Ye(v,t,{includeHydrateFallback:!0})),[...new Set(k)]);var k;let S="object"===typeof t.sri?t.sri:{};return Ae(!m,"The <Scripts /> element is a no-op when using RSC and can be safely removed."),lt||m?null:o.createElement(o.Fragment,null,"object"===typeof t.sri?o.createElement("script",{"rr-importmap":"",type:"importmap",suppressHydrationWarning:!0,dangerouslySetInnerHTML:{__html:JSON.stringify({integrity:S})}}):null,g?null:o.createElement("link",{rel:"modulepreload",href:t.url,crossOrigin:e.crossOrigin,integrity:S[t.url],suppressHydrationWarning:!0}),o.createElement("link",{rel:"modulepreload",href:t.entry.module,crossOrigin:e.crossOrigin,integrity:S[t.entry.module],suppressHydrationWarning:!0}),b.map(t=>o.createElement("link",{key:t,rel:"modulepreload",href:t,crossOrigin:e.crossOrigin,integrity:S[t],suppressHydrationWarning:!0})),y)}function dt(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return e=>{t.forEach(t=>{"function"===typeof t?t(e):null!=t&&(t.current=e)})}}o.Component;function ht(e){let{error:t,isOutsideRemixApp:n}=e;console.error(t);let i,r=o.createElement("script",{dangerouslySetInnerHTML:{__html:'\n        console.log(\n          "\ud83d\udcbf Hey developer \ud83d\udc4b. You can provide a way better UX than this when your app throws errors. Check out https://reactrouter.com/how-to/error-boundary for more information."\n        );\n      '}});if(ee(t))return o.createElement(pt,{title:"Unhandled Thrown Response!"},o.createElement("h1",{style:{fontSize:"24px"}},t.status," ",t.statusText),r);if(t instanceof Error)i=t;else{let e=null==t?"Unknown Error":"object"===typeof t&&"toString"in t?t.toString():JSON.stringify(t);i=new Error(e)}return o.createElement(pt,{title:"Application Error!",isOutsideRemixApp:n},o.createElement("h1",{style:{fontSize:"24px"}},"Application Error"),o.createElement("pre",{style:{padding:"2rem",background:"hsla(10, 50%, 50%, 0.1)",color:"red",overflow:"auto"}},i.stack),r)}function pt(e){var t;let{title:n,renderScripts:i,isOutsideRemixApp:r,children:a}=e,{routeModules:s}=it();return null!==(t=s.root)&&void 0!==t&&t.Layout&&!r?a:o.createElement("html",{lang:"en"},o.createElement("head",null,o.createElement("meta",{charSet:"utf-8"}),o.createElement("meta",{name:"viewport",content:"width=device-width,initial-scale=1,viewport-fit=cover"}),o.createElement("title",null,n)),o.createElement("body",null,o.createElement("main",{style:{fontFamily:"system-ui, sans-serif",padding:"2rem"}},a,i?o.createElement(ut,null):null)))}var ft="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement;try{ft&&(window.__reactRouterVersion="7.9.4")}catch(So){}function mt(e){let{basename:t,children:n,window:i}=e,r=o.useRef();null==r.current&&(r.current=k({window:i,v5Compat:!0}));let a=r.current,[s,c]=o.useState({action:a.action,location:a.location}),l=o.useCallback(e=>{o.startTransition(()=>c(e))},[c]);return o.useLayoutEffect(()=>a.listen(l),[a,l]),o.createElement(Le,{basename:t,children:n,location:s.location,navigationType:s.action,navigator:a})}var gt=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,vt=o.forwardRef(function(e,t){let n,{onClick:i,discover:r="render",prefetch:a="none",relative:c,reloadDocument:l,replace:u,state:d,target:p,to:f,preventScrollReset:m,viewTransition:v}=e,y=s(e,g),{basename:b}=o.useContext(le),k="string"===typeof f&&gt.test(f),T=!1;if("string"===typeof f&&k&&(n=f,ft))try{let e=new URL(window.location.href),t=f.startsWith("//")?new URL(e.protocol+f):new URL(f),n=W(t.pathname,b);t.origin===e.origin&&null!=n?f=n+t.search+t.hash:T=!0}catch(So){w(!1,'<Link to="'.concat(f,'"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.'))}let C=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};S(pe(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:i}=o.useContext(le),{hash:r,pathname:a,search:s}=ye(e,{relative:t}),c=a;return"/"!==n&&(c="/"===a?n:$([n,a])),i.createHref({pathname:c,search:s,hash:r})}(f,{relative:c}),[P,R,_]=function(e,t){let n=o.useContext(nt),[i,r]=o.useState(!1),[a,s]=o.useState(!1),{onFocus:c,onBlur:l,onMouseEnter:u,onMouseLeave:d,onTouchStart:h}=t,p=o.useRef(null);o.useEffect(()=>{if("render"===e&&s(!0),"viewport"===e){let e=new IntersectionObserver(e=>{e.forEach(e=>{s(e.isIntersecting)})},{threshold:.5});return p.current&&e.observe(p.current),()=>{e.disconnect()}}},[e]),o.useEffect(()=>{if(i){let e=setTimeout(()=>{s(!0)},100);return()=>{clearTimeout(e)}}},[i]);let f=()=>{r(!0)},m=()=>{r(!1),s(!1)};return n?"intent"!==e?[a,p,{}]:[a,p,{onFocus:rt(c,f),onBlur:rt(l,m),onMouseEnter:rt(u,f),onMouseLeave:rt(d,m),onTouchStart:rt(h,f)}]:[!1,p,{}]}(a,y),O=function(e){let{target:t,replace:n,state:i,preventScrollReset:r,relative:a,viewTransition:s}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},c=ve(),l=fe(),u=ye(e,{relative:a});return o.useCallback(o=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(o,t)){o.preventDefault();let t=void 0!==n?n:E(l)===E(u);c(e,{replace:t,state:i,preventScrollReset:r,relative:a,viewTransition:s})}},[l,c,u,n,i,t,e,r,a,s])}(f,{replace:u,state:d,target:p,preventScrollReset:m,relative:c,viewTransition:v});let x=o.createElement("a",h(h(h({},y),_),{},{href:n||C,onClick:T||l?i:function(e){i&&i(e),e.defaultPrevented||O(e)},ref:dt(t,R),target:p,"data-discover":k||"render"!==r?void 0:"true"}));return P&&!k?o.createElement(o.Fragment,null,x,o.createElement(at,{page:C})):x});vt.displayName="Link",o.forwardRef(function(e,t){let{"aria-current":n="page",caseSensitive:i=!1,className:r="",end:a=!1,style:c,to:l,viewTransition:u,children:d}=e,p=s(e,v),f=ye(l,{relative:p.relative}),m=fe(),g=o.useContext(re),{navigator:y,basename:b}=o.useContext(le),k=null!=g&&function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=o.useContext(ae);S(null!=n,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=kt("useViewTransitionState"),r=ye(e,{relative:t});if(!n.isTransitioning)return!1;let a=W(n.currentLocation.pathname,i)||n.currentLocation.pathname,s=W(n.nextLocation.pathname,i)||n.nextLocation.pathname;return null!=q(r.pathname,s)||null!=q(r.pathname,a)}(f)&&!0===u,w=y.encodeLocation?y.encodeLocation(f).pathname:f.pathname,T=m.pathname,C=g&&g.navigation&&g.navigation.location?g.navigation.location.pathname:null;i||(T=T.toLowerCase(),C=C?C.toLowerCase():null,w=w.toLowerCase()),C&&b&&(C=W(C,b)||C);const E="/"!==w&&w.endsWith("/")?w.length-1:w.length;let P,R=T===w||!a&&T.startsWith(w)&&"/"===T.charAt(E),_=null!=C&&(C===w||!a&&C.startsWith(w)&&"/"===C.charAt(w.length)),O={isActive:R,isPending:_,isTransitioning:k},x=R?n:void 0;P="function"===typeof r?r(O):[r,R?"active":null,_?"pending":null,k?"transitioning":null].filter(Boolean).join(" ");let I="function"===typeof c?c(O):c;return o.createElement(vt,h(h({},p),{},{"aria-current":x,className:P,ref:t,style:I,to:l,viewTransition:u}),"function"===typeof d?d(O):d)}).displayName="NavLink";var yt=o.forwardRef((e,t)=>{let{discover:n="render",fetcherKey:i,navigate:r,reloadDocument:a,replace:c,state:l,method:u=Ue,action:d,onSubmit:p,relative:f,preventScrollReset:m,viewTransition:g}=e,v=s(e,y),b=Tt(),k=function(e){let{relative:t}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{basename:n}=o.useContext(le),i=o.useContext(de);S(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),a=h({},ye(e||".",{relative:t})),s=fe();if(null==e){a.search=s.search;let e=new URLSearchParams(a.search),t=e.getAll("index");if(t.some(e=>""===e)){e.delete("index"),t.filter(e=>e).forEach(t=>e.append("index",t));let n=e.toString();a.search=n?"?".concat(n):""}}e&&"."!==e||!r.route.index||(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index");"/"!==n&&(a.pathname="/"===a.pathname?n:$([n,a.pathname]));return E(a)}(d,{relative:f}),w="get"===u.toLowerCase()?"get":"post",T="string"===typeof d&&gt.test(d);return o.createElement("form",h(h({ref:t,method:w,action:k,onSubmit:a?p:e=>{if(p&&p(e),e.defaultPrevented)return;e.preventDefault();let t=e.nativeEvent.submitter,n=(null===t||void 0===t?void 0:t.getAttribute("formmethod"))||u;b(t||e.currentTarget,{fetcherKey:i,method:n,navigate:r,replace:c,state:l,relative:f,preventScrollReset:m,viewTransition:g})}},v),{},{"data-discover":T||"render"!==n?void 0:"true"}))});function bt(e){return"".concat(e," must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.")}function kt(e){let t=o.useContext(ie);return S(t,bt(e)),t}yt.displayName="Form";var St=0,wt=()=>"__".concat(String(++St),"__");function Tt(){let{router:e}=kt("useSubmit"),{basename:t}=o.useContext(le),n=_e("useRouteId");return o.useCallback(async function(i){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},{action:o,method:a,encType:s,formData:c,body:l}=He(i,t);if(!1===r.navigate){let t=r.fetcherKey||wt();await e.fetch(t,n,r.action||o,{preventScrollReset:r.preventScrollReset,formData:c,body:l,formMethod:r.method||a,formEncType:r.encType||s,flushSync:r.flushSync})}else await e.navigate(r.action||o,{preventScrollReset:r.preventScrollReset,formData:c,body:l,formMethod:r.method||a,formEncType:r.encType||s,replace:r.replace,state:r.state,fromRouteId:n,flushSync:r.flushSync,viewTransition:r.viewTransition})},[e,t,n])}function Ct(e,t){return function(){return e.apply(t,arguments)}}const{toString:Et}=Object.prototype,{getPrototypeOf:Pt}=Object,{iterator:Rt,toStringTag:_t}=Symbol,Ot=(e=>t=>{const n=Et.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),xt=e=>(e=e.toLowerCase(),t=>Ot(t)===e),It=e=>t=>typeof t===e,{isArray:Nt}=Array,At=It("undefined");function Dt(e){return null!==e&&!At(e)&&null!==e.constructor&&!At(e.constructor)&&jt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Lt=xt("ArrayBuffer");const Mt=It("string"),jt=It("function"),Ut=It("number"),Ft=e=>null!==e&&"object"===typeof e,Bt=e=>{if("object"!==Ot(e))return!1;const t=Pt(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(_t in e)&&!(Rt in e)},zt=xt("Date"),qt=xt("File"),Vt=xt("Blob"),Ht=xt("FileList"),Wt=xt("URLSearchParams"),[Kt,Gt,Jt,Qt]=["ReadableStream","Request","Response","Headers"].map(xt);function $t(e,t){let n,i,{allOwnKeys:r=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),Nt(e))for(n=0,i=e.length;n<i;n++)t.call(null,e[n],n,e);else{if(Dt(e))return;const i=r?Object.getOwnPropertyNames(e):Object.keys(e),o=i.length;let a;for(n=0;n<o;n++)a=i[n],t.call(null,e[a],a,e)}}function Yt(e,t){if(Dt(e))return null;t=t.toLowerCase();const n=Object.keys(e);let i,r=n.length;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const Xt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,Zt=e=>!At(e)&&e!==Xt;const en=(tn="undefined"!==typeof Uint8Array&&Pt(Uint8Array),e=>tn&&e instanceof tn);var tn;const nn=xt("HTMLFormElement"),rn=(e=>{let{hasOwnProperty:t}=e;return(e,n)=>t.call(e,n)})(Object.prototype),on=xt("RegExp"),an=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),i={};$t(n,(n,r)=>{let o;!1!==(o=t(n,r,e))&&(i[r]=o||n)}),Object.defineProperties(e,i)};const sn=xt("AsyncFunction"),cn=((e,t)=>{return e?setImmediate:t?(n="axios@".concat(Math.random()),i=[],Xt.addEventListener("message",e=>{let{source:t,data:r}=e;t===Xt&&r===n&&i.length&&i.shift()()},!1),e=>{i.push(e),Xt.postMessage(n,"*")}):e=>setTimeout(e);var n,i})("function"===typeof setImmediate,jt(Xt.postMessage)),ln="undefined"!==typeof queueMicrotask?queueMicrotask.bind(Xt):"undefined"!==typeof process&&process.nextTick||cn,un={isArray:Nt,isArrayBuffer:Lt,isBuffer:Dt,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||jt(e.append)&&("formdata"===(t=Ot(e))||"object"===t&&jt(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&Lt(e.buffer),t},isString:Mt,isNumber:Ut,isBoolean:e=>!0===e||!1===e,isObject:Ft,isPlainObject:Bt,isEmptyObject:e=>{if(!Ft(e)||Dt(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(So){return!1}},isReadableStream:Kt,isRequest:Gt,isResponse:Jt,isHeaders:Qt,isUndefined:At,isDate:zt,isFile:qt,isBlob:Vt,isRegExp:on,isFunction:jt,isStream:e=>Ft(e)&&jt(e.pipe),isURLSearchParams:Wt,isTypedArray:en,isFileList:Ht,forEach:$t,merge:function e(){const{caseless:t,skipUndefined:n}=Zt(this)&&this||{},i={},r=(r,o)=>{const a=t&&Yt(i,o)||o;Bt(i[a])&&Bt(r)?i[a]=e(i[a],r):Bt(r)?i[a]=e({},r):Nt(r)?i[a]=r.slice():n&&At(r)||(i[a]=r)};for(let o=0,a=arguments.length;o<a;o++)arguments[o]&&$t(arguments[o],r);return i},extend:function(e,t,n){let{allOwnKeys:i}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return $t(t,(t,i)=>{n&&jt(t)?e[i]=Ct(t,n):e[i]=t},{allOwnKeys:i}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,n,i)=>{e.prototype=Object.create(t.prototype,i),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},toFlatObject:(e,t,n,i)=>{let r,o,a;const s={};if(t=t||{},null==e)return t;do{for(r=Object.getOwnPropertyNames(e),o=r.length;o-- >0;)a=r[o],i&&!i(a,e,t)||s[a]||(t[a]=e[a],s[a]=!0);e=!1!==n&&Pt(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},kindOf:Ot,kindOfTest:xt,endsWith:(e,t,n)=>{e=String(e),(void 0===n||n>e.length)&&(n=e.length),n-=t.length;const i=e.indexOf(t,n);return-1!==i&&i===n},toArray:e=>{if(!e)return null;if(Nt(e))return e;let t=e.length;if(!Ut(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},forEachEntry:(e,t)=>{const n=(e&&e[Rt]).call(e);let i;for(;(i=n.next())&&!i.done;){const n=i.value;t.call(e,n[0],n[1])}},matchAll:(e,t)=>{let n;const i=[];for(;null!==(n=e.exec(t));)i.push(n);return i},isHTMLForm:nn,hasOwnProperty:rn,hasOwnProp:rn,reduceDescriptors:an,freezeMethods:e=>{an(e,(t,n)=>{if(jt(e)&&-1!==["arguments","caller","callee"].indexOf(n))return!1;const i=e[n];jt(i)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")}))})},toObjectSet:(e,t)=>{const n={},i=e=>{e.forEach(e=>{n[e]=!0})};return Nt(e)?i(e):i(String(e).split(t)),n},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,n){return t.toUpperCase()+n}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:Yt,global:Xt,isContextDefined:Zt,isSpecCompliantForm:function(e){return!!(e&&jt(e.append)&&"FormData"===e[_t]&&e[Rt])},toJSONObject:e=>{const t=new Array(10),n=(e,i)=>{if(Ft(e)){if(t.indexOf(e)>=0)return;if(Dt(e))return e;if(!("toJSON"in e)){t[i]=e;const r=Nt(e)?[]:{};return $t(e,(e,t)=>{const o=n(e,i+1);!At(o)&&(r[t]=o)}),t[i]=void 0,r}}return e};return n(e,0)},isAsyncFn:sn,isThenable:e=>e&&(Ft(e)||jt(e))&&jt(e.then)&&jt(e.catch),setImmediate:cn,asap:ln,isIterable:e=>null!=e&&jt(e[Rt])};function dn(e,t,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}un.inherits(dn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:un.toJSONObject(this.config),code:this.code,status:this.status}}});const hn=dn.prototype,pn={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{pn[e]={value:e}}),Object.defineProperties(dn,pn),Object.defineProperty(hn,"isAxiosError",{value:!0}),dn.from=(e,t,n,i,r,o)=>{const a=Object.create(hn);un.toFlatObject(e,a,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e);const s=e&&e.message?e.message:"Error",c=null==t&&e?e.code:t;return dn.call(a,s,c,n,i,r),e&&null==a.cause&&Object.defineProperty(a,"cause",{value:e,configurable:!0}),a.name=e&&e.name||"Error",o&&Object.assign(a,o),a};const fn=dn;function mn(e){return un.isPlainObject(e)||un.isArray(e)}function gn(e){return un.endsWith(e,"[]")?e.slice(0,-2):e}function vn(e,t,n){return e?e.concat(t).map(function(e,t){return e=gn(e),!n&&t?"["+e+"]":e}).join(n?".":""):t}const yn=un.toFlatObject(un,{},null,function(e){return/^is[A-Z]/.test(e)});const bn=function(e,t,n){if(!un.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const i=(n=un.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!un.isUndefined(t[e])})).metaTokens,r=n.visitor||l,o=n.dots,a=n.indexes,s=(n.Blob||"undefined"!==typeof Blob&&Blob)&&un.isSpecCompliantForm(t);if(!un.isFunction(r))throw new TypeError("visitor must be a function");function c(e){if(null===e)return"";if(un.isDate(e))return e.toISOString();if(un.isBoolean(e))return e.toString();if(!s&&un.isBlob(e))throw new fn("Blob is not supported. Use a Buffer instead.");return un.isArrayBuffer(e)||un.isTypedArray(e)?s&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function l(e,n,r){let s=e;if(e&&!r&&"object"===typeof e)if(un.endsWith(n,"{}"))n=i?n:n.slice(0,-2),e=JSON.stringify(e);else if(un.isArray(e)&&function(e){return un.isArray(e)&&!e.some(mn)}(e)||(un.isFileList(e)||un.endsWith(n,"[]"))&&(s=un.toArray(e)))return n=gn(n),s.forEach(function(e,i){!un.isUndefined(e)&&null!==e&&t.append(!0===a?vn([n],i,o):null===a?n:n+"[]",c(e))}),!1;return!!mn(e)||(t.append(vn(r,n,o),c(e)),!1)}const u=[],d=Object.assign(yn,{defaultVisitor:l,convertValue:c,isVisitable:mn});if(!un.isObject(e))throw new TypeError("data must be an object");return function e(n,i){if(!un.isUndefined(n)){if(-1!==u.indexOf(n))throw Error("Circular reference detected in "+i.join("."));u.push(n),un.forEach(n,function(n,o){!0===(!(un.isUndefined(n)||null===n)&&r.call(t,n,un.isString(o)?o.trim():o,i,d))&&e(n,i?i.concat(o):[o])}),u.pop()}}(e),t};function kn(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function Sn(e,t){this._pairs=[],e&&bn(e,this,t)}const wn=Sn.prototype;wn.append=function(e,t){this._pairs.push([e,t])},wn.toString=function(e){const t=e?function(t){return e.call(this,t,kn)}:kn;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const Tn=Sn;function Cn(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function En(e,t,n){if(!t)return e;const i=n&&n.encode||Cn;un.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let o;if(o=r?r(t,n):un.isURLSearchParams(t)?t.toString():new Tn(t,n).toString(i),o){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+o}return e}const Pn=class{constructor(){this.handlers=[]}use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){un.forEach(this.handlers,function(t){null!==t&&e(t)})}},Rn={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},_n={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:Tn,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},On="undefined"!==typeof window&&"undefined"!==typeof document,xn="object"===typeof navigator&&navigator||void 0,In=On&&(!xn||["ReactNative","NativeScript","NS"].indexOf(xn.product)<0),Nn="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,An=On&&window.location.href||"http://localhost",Dn=h(h({},i),_n);const Ln=function(e){function t(e,n,i,r){let o=e[r++];if("__proto__"===o)return!0;const a=Number.isFinite(+o),s=r>=e.length;if(o=!o&&un.isArray(i)?i.length:o,s)return un.hasOwnProp(i,o)?i[o]=[i[o],n]:i[o]=n,!a;i[o]&&un.isObject(i[o])||(i[o]=[]);return t(e,n,i[o],r)&&un.isArray(i[o])&&(i[o]=function(e){const t={},n=Object.keys(e);let i;const r=n.length;let o;for(i=0;i<r;i++)o=n[i],t[o]=e[o];return t}(i[o])),!a}if(un.isFormData(e)&&un.isFunction(e.entries)){const n={};return un.forEachEntry(e,(e,i)=>{t(function(e){return un.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),i,n,0)}),n}return null};const Mn={transitional:Rn,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const n=t.getContentType()||"",i=n.indexOf("application/json")>-1,r=un.isObject(e);r&&un.isHTMLForm(e)&&(e=new FormData(e));if(un.isFormData(e))return i?JSON.stringify(Ln(e)):e;if(un.isArrayBuffer(e)||un.isBuffer(e)||un.isStream(e)||un.isFile(e)||un.isBlob(e)||un.isReadableStream(e))return e;if(un.isArrayBufferView(e))return e.buffer;if(un.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(r){if(n.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return bn(e,new Dn.classes.URLSearchParams,h({visitor:function(e,t,n,i){return Dn.isNode&&un.isBuffer(e)?(this.append(t,e.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((o=un.isFileList(e))||n.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return bn(o?{"files[]":e}:e,t&&new t,this.formSerializer)}}return r||i?(t.setContentType("application/json",!1),function(e,t,n){if(un.isString(e))try{return(t||JSON.parse)(e),un.trim(e)}catch(So){if("SyntaxError"!==So.name)throw So}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||Mn.transitional,n=t&&t.forcedJSONParsing,i="json"===this.responseType;if(un.isResponse(e)||un.isReadableStream(e))return e;if(e&&un.isString(e)&&(n&&!this.responseType||i)){const n=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e,this.parseReviver)}catch(So){if(n){if("SyntaxError"===So.name)throw fn.from(So,fn.ERR_BAD_RESPONSE,this,null,this.response);throw So}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Dn.classes.FormData,Blob:Dn.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};un.forEach(["delete","get","head","post","put","patch"],e=>{Mn.headers[e]={}});const jn=Mn,Un=un.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Fn=Symbol("internals");function Bn(e){return e&&String(e).trim().toLowerCase()}function zn(e){return!1===e||null==e?e:un.isArray(e)?e.map(zn):String(e)}function qn(e,t,n,i,r){return un.isFunction(i)?i.call(this,t,n):(r&&(t=n),un.isString(t)?un.isString(i)?-1!==t.indexOf(i):un.isRegExp(i)?i.test(t):void 0:void 0)}class Vn{constructor(e){e&&this.set(e)}set(e,t,n){const i=this;function r(e,t,n){const r=Bn(t);if(!r)throw new Error("header name must be a non-empty string");const o=un.findKey(i,r);(!o||void 0===i[o]||!0===n||void 0===n&&!1!==i[o])&&(i[o||t]=zn(e))}const o=(e,t)=>un.forEach(e,(e,n)=>r(e,n,t));if(un.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(un.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))o((e=>{const t={};let n,i,r;return e&&e.split("\n").forEach(function(e){r=e.indexOf(":"),n=e.substring(0,r).trim().toLowerCase(),i=e.substring(r+1).trim(),!n||t[n]&&Un[n]||("set-cookie"===n?t[n]?t[n].push(i):t[n]=[i]:t[n]=t[n]?t[n]+", "+i:i)}),t})(e),t);else if(un.isObject(e)&&un.isIterable(e)){let n,i,r={};for(const t of e){if(!un.isArray(t))throw TypeError("Object iterator must return a key-value pair");r[i=t[0]]=(n=r[i])?un.isArray(n)?[...n,t[1]]:[n,t[1]]:t[1]}o(r,t)}else null!=e&&r(t,e,n);return this}get(e,t){if(e=Bn(e)){const n=un.findKey(this,e);if(n){const e=this[n];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(e);)t[i[1]]=i[2];return t}(e);if(un.isFunction(t))return t.call(this,e,n);if(un.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=Bn(e)){const n=un.findKey(this,e);return!(!n||void 0===this[n]||t&&!qn(0,this[n],n,t))}return!1}delete(e,t){const n=this;let i=!1;function r(e){if(e=Bn(e)){const r=un.findKey(n,e);!r||t&&!qn(0,n[r],r,t)||(delete n[r],i=!0)}}return un.isArray(e)?e.forEach(r):r(e),i}clear(e){const t=Object.keys(this);let n=t.length,i=!1;for(;n--;){const r=t[n];e&&!qn(0,this[r],r,e,!0)||(delete this[r],i=!0)}return i}normalize(e){const t=this,n={};return un.forEach(this,(i,r)=>{const o=un.findKey(n,r);if(o)return t[o]=zn(i),void delete t[r];const a=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,n)=>t.toUpperCase()+n)}(r):String(r).trim();a!==r&&delete t[r],t[a]=zn(i),n[a]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return un.forEach(this,(n,i)=>{null!=n&&!1!==n&&(t[i]=e&&un.isArray(n)?n.join(", "):n)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,n]=e;return t+": "+n}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[Fn]=this[Fn]={accessors:{}}).accessors,n=this.prototype;function i(e){const i=Bn(e);t[i]||(!function(e,t){const n=un.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(e,i+n,{value:function(e,n,r){return this[i].call(this,t,e,n,r)},configurable:!0})})}(n,e),t[i]=!0)}return un.isArray(e)?e.forEach(i):i(e),this}}Vn.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),un.reduceDescriptors(Vn.prototype,(e,t)=>{let{value:n}=e,i=t[0].toUpperCase()+t.slice(1);return{get:()=>n,set(e){this[i]=e}}}),un.freezeMethods(Vn);const Hn=Vn;function Wn(e,t){const n=this||jn,i=t||n,r=Hn.from(i.headers);let o=i.data;return un.forEach(e,function(e){o=e.call(n,o,r.normalize(),t?t.status:void 0)}),r.normalize(),o}function Kn(e){return!(!e||!e.__CANCEL__)}function Gn(e,t,n){fn.call(this,null==e?"canceled":e,fn.ERR_CANCELED,t,n),this.name="CanceledError"}un.inherits(Gn,fn,{__CANCEL__:!0});const Jn=Gn;function Qn(e,t,n){const i=n.config.validateStatus;n.status&&i&&!i(n.status)?t(new fn("Request failed with status code "+n.status,[fn.ERR_BAD_REQUEST,fn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n)):e(n)}const $n=function(e,t){e=e||10;const n=new Array(e),i=new Array(e);let r,o=0,a=0;return t=void 0!==t?t:1e3,function(s){const c=Date.now(),l=i[a];r||(r=c),n[o]=s,i[o]=c;let u=a,d=0;for(;u!==o;)d+=n[u++],u%=e;if(o=(o+1)%e,o===a&&(a=(a+1)%e),c-r<t)return;const h=l&&c-l;return h?Math.round(1e3*d/h):void 0}};const Yn=function(e,t){let n,i,r=0,o=1e3/t;const a=function(t){let o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();r=o,n=null,i&&(clearTimeout(i),i=null),e(...t)};return[function(){const e=Date.now(),t=e-r;for(var s=arguments.length,c=new Array(s),l=0;l<s;l++)c[l]=arguments[l];t>=o?a(c,e):(n=c,i||(i=setTimeout(()=>{i=null,a(n)},o-t)))},()=>n&&a(n)]},Xn=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,i=0;const r=$n(50,250);return Yn(n=>{const o=n.loaded,a=n.lengthComputable?n.total:void 0,s=o-i,c=r(s);i=o;e({loaded:o,total:a,progress:a?o/a:void 0,bytes:s,rate:c||void 0,estimated:c&&a&&o<=a?(a-o)/c:void 0,event:n,lengthComputable:null!=a,[t?"download":"upload"]:!0})},n)},Zn=(e,t)=>{const n=null!=e;return[i=>t[0]({lengthComputable:n,total:e,loaded:i}),t[1]]},ei=e=>function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return un.asap(()=>e(...n))},ti=Dn.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Dn.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Dn.origin),Dn.navigator&&/(msie|trident)/i.test(Dn.navigator.userAgent)):()=>!0,ni=Dn.hasStandardBrowserEnv?{write(e,t,n,i,r,o,a){if("undefined"===typeof document)return;const s=["".concat(e,"=").concat(encodeURIComponent(t))];un.isNumber(n)&&s.push("expires=".concat(new Date(n).toUTCString())),un.isString(i)&&s.push("path=".concat(i)),un.isString(r)&&s.push("domain=".concat(r)),!0===o&&s.push("secure"),un.isString(a)&&s.push("SameSite=".concat(a)),document.cookie=s.join("; ")},read(e){if("undefined"===typeof document)return null;const t=document.cookie.match(new RegExp("(?:^|; )"+e+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(e){this.write(e,"",Date.now()-864e5,"/")}}:{write(){},read:()=>null,remove(){}};function ii(e,t,n){let i=!function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}(t);return e&&(i||0==n)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const ri=e=>e instanceof Hn?h({},e):e;function oi(e,t){t=t||{};const n={};function i(e,t,n,i){return un.isPlainObject(e)&&un.isPlainObject(t)?un.merge.call({caseless:i},e,t):un.isPlainObject(t)?un.merge({},t):un.isArray(t)?t.slice():t}function r(e,t,n,r){return un.isUndefined(t)?un.isUndefined(e)?void 0:i(void 0,e,0,r):i(e,t,0,r)}function o(e,t){if(!un.isUndefined(t))return i(void 0,t)}function a(e,t){return un.isUndefined(t)?un.isUndefined(e)?void 0:i(void 0,e):i(void 0,t)}function s(n,r,o){return o in t?i(n,r):o in e?i(void 0,n):void 0}const c={url:o,method:o,data:o,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:s,headers:(e,t,n)=>r(ri(e),ri(t),0,!0)};return un.forEach(Object.keys(h(h({},e),t)),function(i){const o=c[i]||r,a=o(e[i],t[i],i);un.isUndefined(a)&&o!==s||(n[i]=a)}),n}const ai=e=>{const t=oi({},e);let{data:n,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:o,headers:a,auth:s}=t;if(t.headers=a=Hn.from(a),t.url=En(ii(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),s&&a.set("Authorization","Basic "+btoa((s.username||"")+":"+(s.password?unescape(encodeURIComponent(s.password)):""))),un.isFormData(n))if(Dn.hasStandardBrowserEnv||Dn.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if(un.isFunction(n.getHeaders)){const e=n.getHeaders(),t=["content-type","content-length"];Object.entries(e).forEach(e=>{let[n,i]=e;t.includes(n.toLowerCase())&&a.set(n,i)})}if(Dn.hasStandardBrowserEnv&&(i&&un.isFunction(i)&&(i=i(t)),i||!1!==i&&ti(t.url))){const e=r&&o&&ni.read(o);e&&a.set(r,e)}return t},si="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,n){const i=ai(e);let r=i.data;const o=Hn.from(i.headers).normalize();let a,s,c,l,u,{responseType:d,onUploadProgress:h,onDownloadProgress:p}=i;function f(){l&&l(),u&&u(),i.cancelToken&&i.cancelToken.unsubscribe(a),i.signal&&i.signal.removeEventListener("abort",a)}let m=new XMLHttpRequest;function g(){if(!m)return;const i=Hn.from("getAllResponseHeaders"in m&&m.getAllResponseHeaders());Qn(function(e){t(e),f()},function(e){n(e),f()},{data:d&&"text"!==d&&"json"!==d?m.response:m.responseText,status:m.status,statusText:m.statusText,headers:i,config:e,request:m}),m=null}m.open(i.method.toUpperCase(),i.url,!0),m.timeout=i.timeout,"onloadend"in m?m.onloadend=g:m.onreadystatechange=function(){m&&4===m.readyState&&(0!==m.status||m.responseURL&&0===m.responseURL.indexOf("file:"))&&setTimeout(g)},m.onabort=function(){m&&(n(new fn("Request aborted",fn.ECONNABORTED,e,m)),m=null)},m.onerror=function(t){const i=t&&t.message?t.message:"Network Error",r=new fn(i,fn.ERR_NETWORK,e,m);r.event=t||null,n(r),m=null},m.ontimeout=function(){let t=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const r=i.transitional||Rn;i.timeoutErrorMessage&&(t=i.timeoutErrorMessage),n(new fn(t,r.clarifyTimeoutError?fn.ETIMEDOUT:fn.ECONNABORTED,e,m)),m=null},void 0===r&&o.setContentType(null),"setRequestHeader"in m&&un.forEach(o.toJSON(),function(e,t){m.setRequestHeader(t,e)}),un.isUndefined(i.withCredentials)||(m.withCredentials=!!i.withCredentials),d&&"json"!==d&&(m.responseType=i.responseType),p&&([c,u]=Xn(p,!0),m.addEventListener("progress",c)),h&&m.upload&&([s,l]=Xn(h),m.upload.addEventListener("progress",s),m.upload.addEventListener("loadend",l)),(i.cancelToken||i.signal)&&(a=t=>{m&&(n(!t||t.type?new Jn(null,e,m):t),m.abort(),m=null)},i.cancelToken&&i.cancelToken.subscribe(a),i.signal&&(i.signal.aborted?a():i.signal.addEventListener("abort",a)));const v=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(i.url);v&&-1===Dn.protocols.indexOf(v)?n(new fn("Unsupported protocol "+v+":",fn.ERR_BAD_REQUEST,e)):m.send(r||null)})},ci=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let n,i=new AbortController;const r=function(e){if(!n){n=!0,a();const t=e instanceof Error?e:this.reason;i.abort(t instanceof fn?t:new Jn(t instanceof Error?t.message:t))}};let o=t&&setTimeout(()=>{o=null,r(new fn("timeout ".concat(t," of ms exceeded"),fn.ETIMEDOUT))},t);const a=()=>{e&&(o&&clearTimeout(o),o=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(r):e.removeEventListener("abort",r)}),e=null)};e.forEach(e=>e.addEventListener("abort",r));const{signal:s}=i;return s.unsubscribe=()=>un.asap(a),s}};function li(e,t){this.v=e,this.k=t}function ui(e){return function(){return new di(e.apply(this,arguments))}}function di(e){var t,n;function i(t,n){try{var o=e[t](n),a=o.value,s=a instanceof li;Promise.resolve(s?a.v:a).then(function(n){if(s){var c="return"===t?"return":"next";if(!a.k||n.done)return i(c,n);n=e[c](n).value}r(o.done?"return":"normal",n)},function(e){i("throw",e)})}catch(e){r("throw",e)}}function r(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise(function(o,a){var s={key:e,arg:r,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,i(e,r))})},"function"!=typeof e.return&&(this.return=void 0)}function hi(e){return new li(e,0)}function pi(e){var t={},n=!1;function i(t,i){return n=!0,i=new Promise(function(n){n(e[t](i))}),{done:!1,value:new li(i,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return n?(n=!1,e):i("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(n)throw n=!1,e;return i("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return n?(n=!1,e):i("return",e)}),t}function fi(e){var t,n,i,r=2;for("undefined"!=typeof Symbol&&(n=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(n&&null!=(t=e[n]))return t.call(e);if(i&&null!=(t=e[i]))return new mi(t.call(e));n="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}function mi(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return mi=function(e){this.s=e,this.n=e.next},mi.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var n=this.s.return;return void 0===n?Promise.resolve({value:e,done:!0}):t(n.apply(this.s,arguments))},throw:function(e){var n=this.s.return;return void 0===n?Promise.reject(e):t(n.apply(this.s,arguments))}},new mi(e)}di.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},di.prototype.next=function(e){return this._invoke("next",e)},di.prototype.throw=function(e){return this._invoke("throw",e)},di.prototype.return=function(e){return this._invoke("return",e)};const gi=function*(e,t){let n=e.byteLength;if(!t||n<t)return void(yield e);let i,r=0;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},vi=function(){var e=ui(function*(e,t){var n,i=!1,r=!1;try{for(var o,a=fi(yi(e));i=!(o=yield hi(a.next())).done;i=!1){const e=o.value;yield*pi(fi(gi(e,t)))}}catch(s){r=!0,n=s}finally{try{i&&null!=a.return&&(yield hi(a.return()))}finally{if(r)throw n}}});return function(t,n){return e.apply(this,arguments)}}(),yi=function(){var e=ui(function*(e){if(e[Symbol.asyncIterator])return void(yield*pi(fi(e)));const t=e.getReader();try{for(;;){const{done:e,value:n}=yield hi(t.read());if(e)break;yield n}}finally{yield hi(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),bi=(e,t,n,i)=>{const r=vi(e,t);let o,a=0,s=e=>{o||(o=!0,i&&i(e))};return new ReadableStream({async pull(e){try{const{done:t,value:i}=await r.next();if(t)return s(),void e.close();let o=i.byteLength;if(n){let e=a+=o;n(e)}e.enqueue(new Uint8Array(i))}catch(t){throw s(t),t}},cancel:e=>(s(e),r.return())},{highWaterMark:2})},{isFunction:ki}=un,Si=(e=>{let{Request:t,Response:n}=e;return{Request:t,Response:n}})(un.global),{ReadableStream:wi,TextEncoder:Ti}=un.global,Ci=function(e){try{for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return!!e(...n)}catch(So){return!1}},Ei=e=>{e=un.merge.call({skipUndefined:!0},Si,e);const{fetch:t,Request:n,Response:i}=e,r=t?ki(t):"function"===typeof fetch,o=ki(n),a=ki(i);if(!r)return!1;const s=r&&ki(wi),c=r&&("function"===typeof Ti?(l=new Ti,e=>l.encode(e)):async e=>new Uint8Array(await new n(e).arrayBuffer()));var l;const u=o&&s&&Ci(()=>{let e=!1;const t=new n(Dn.origin,{body:new wi,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),d=a&&s&&Ci(()=>un.isReadableStream(new i("").body)),p={stream:d&&(e=>e.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!p[e]&&(p[e]=(t,n)=>{let i=t&&t[e];if(i)return i.call(t);throw new fn("Response type '".concat(e,"' is not supported"),fn.ERR_NOT_SUPPORT,n)})});const f=async(e,t)=>{const i=un.toFiniteNumber(e.getContentLength());return null==i?(async e=>{if(null==e)return 0;if(un.isBlob(e))return e.size;if(un.isSpecCompliantForm(e)){const t=new n(Dn.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return un.isArrayBufferView(e)||un.isArrayBuffer(e)?e.byteLength:(un.isURLSearchParams(e)&&(e+=""),un.isString(e)?(await c(e)).byteLength:void 0)})(t):i};return async e=>{let{url:r,method:a,data:s,signal:c,cancelToken:l,timeout:m,onDownloadProgress:g,onUploadProgress:v,responseType:y,headers:b,withCredentials:k="same-origin",fetchOptions:S}=ai(e),w=t||fetch;y=y?(y+"").toLowerCase():"text";let T=ci([c,l&&l.toAbortSignal()],m),C=null;const E=T&&T.unsubscribe&&(()=>{T.unsubscribe()});let P;try{if(v&&u&&"get"!==a&&"head"!==a&&0!==(P=await f(b,s))){let e,t=new n(r,{method:"POST",body:s,duplex:"half"});if(un.isFormData(s)&&(e=t.headers.get("content-type"))&&b.setContentType(e),t.body){const[e,n]=Zn(P,Xn(ei(v)));s=bi(t.body,65536,e,n)}}un.isString(k)||(k=k?"include":"omit");const t=o&&"credentials"in n.prototype,c=h(h({},S),{},{signal:T,method:a.toUpperCase(),headers:b.normalize().toJSON(),body:s,duplex:"half",credentials:t?k:void 0});C=o&&new n(r,c);let l=await(o?w(C,S):w(r,c));const m=d&&("stream"===y||"response"===y);if(d&&(g||m&&E)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=l[t]});const t=un.toFiniteNumber(l.headers.get("content-length")),[n,r]=g&&Zn(t,Xn(ei(g),!0))||[];l=new i(bi(l.body,65536,n,()=>{r&&r(),E&&E()}),e)}y=y||"text";let R=await p[un.findKey(p,y)||"text"](l,e);return!m&&E&&E(),await new Promise((t,n)=>{Qn(t,n,{data:R,headers:Hn.from(l.headers),status:l.status,statusText:l.statusText,config:e,request:C})})}catch(R){if(E&&E(),R&&"TypeError"===R.name&&/Load failed|fetch/i.test(R.message))throw Object.assign(new fn("Network Error",fn.ERR_NETWORK,e,C),{cause:R.cause||R});throw fn.from(R,R&&R.code,e,C)}}},Pi=new Map,Ri=e=>{let t=e&&e.env||{};const{fetch:n,Request:i,Response:r}=t,o=[i,r,n];let a,s,c=o.length,l=Pi;for(;c--;)a=o[c],s=l.get(a),void 0===s&&l.set(a,s=c?new Map:Ei(t)),l=s;return s},_i=(Ri(),{http:null,xhr:si,fetch:{get:Ri}});un.forEach(_i,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(So){}Object.defineProperty(e,"adapterName",{value:t})}});const Oi=e=>"- ".concat(e),xi=e=>un.isFunction(e)||null===e||!1===e;const Ii={getAdapter:function(e,t){e=un.isArray(e)?e:[e];const{length:n}=e;let i,r;const o={};for(let a=0;a<n;a++){let n;if(i=e[a],r=i,!xi(i)&&(r=_i[(n=String(i)).toLowerCase()],void 0===r))throw new fn("Unknown adapter '".concat(n,"'"));if(r&&(un.isFunction(r)||(r=r.get(t))))break;o[n||"#"+a]=r}if(!r){const e=Object.entries(o).map(e=>{let[t,n]=e;return"adapter ".concat(t," ")+(!1===n?"is not supported by the environment":"is not available in the build")});let t=n?e.length>1?"since :\n"+e.map(Oi).join("\n"):" "+Oi(e[0]):"as no adapter specified";throw new fn("There is no suitable adapter to dispatch the request "+t,"ERR_NOT_SUPPORT")}return r},adapters:_i};function Ni(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Jn(null,e)}function Ai(e){Ni(e),e.headers=Hn.from(e.headers),e.data=Wn.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return Ii.getAdapter(e.adapter||jn.adapter,e)(e).then(function(t){return Ni(e),t.data=Wn.call(e,e.transformResponse,t),t.headers=Hn.from(t.headers),t},function(t){return Kn(t)||(Ni(e),t&&t.response&&(t.response.data=Wn.call(e,e.transformResponse,t.response),t.response.headers=Hn.from(t.response.headers))),Promise.reject(t)})}const Di="1.13.0",Li={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{Li[e]=function(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}});const Mi={};Li.transitional=function(e,t,n){function i(e,t){return"[Axios v"+Di+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return(n,r,o)=>{if(!1===e)throw new fn(i(r," has been removed"+(t?" in "+t:"")),fn.ERR_DEPRECATED);return t&&!Mi[r]&&(Mi[r]=!0,console.warn(i(r," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,r,o)}},Li.spelling=function(e){return(t,n)=>(console.warn("".concat(n," is likely a misspelling of ").concat(e)),!0)};const ji={assertOptions:function(e,t,n){if("object"!==typeof e)throw new fn("options must be an object",fn.ERR_BAD_OPTION_VALUE);const i=Object.keys(e);let r=i.length;for(;r-- >0;){const o=i[r],a=t[o];if(a){const t=e[o],n=void 0===t||a(t,o,e);if(!0!==n)throw new fn("option "+o+" must be "+n,fn.ERR_BAD_OPTION_VALUE);continue}if(!0!==n)throw new fn("Unknown option "+o,fn.ERR_BAD_OPTION)}},validators:Li},Ui=ji.validators;class Fi{constructor(e){this.defaults=e||{},this.interceptors={request:new Pn,response:new Pn}}async request(e,t){try{return await this._request(e,t)}catch(n){if(n instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{n.stack?t&&!String(n.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(n.stack+="\n"+t):n.stack=t}catch(So){}}throw n}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=oi(this.defaults,t);const{transitional:n,paramsSerializer:i,headers:r}=t;void 0!==n&&ji.assertOptions(n,{silentJSONParsing:Ui.transitional(Ui.boolean),forcedJSONParsing:Ui.transitional(Ui.boolean),clarifyTimeoutError:Ui.transitional(Ui.boolean)},!1),null!=i&&(un.isFunction(i)?t.paramsSerializer={serialize:i}:ji.assertOptions(i,{encode:Ui.function,serialize:Ui.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),ji.assertOptions(t,{baseUrl:Ui.spelling("baseURL"),withXsrfToken:Ui.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=r&&un.merge(r.common,r[t.method]);r&&un.forEach(["delete","get","head","post","put","patch","common"],e=>{delete r[e]}),t.headers=Hn.concat(o,r);const a=[];let s=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(s=s&&e.synchronous,a.unshift(e.fulfilled,e.rejected))});const c=[];let l;this.interceptors.response.forEach(function(e){c.push(e.fulfilled,e.rejected)});let u,d=0;if(!s){const e=[Ai.bind(this),void 0];for(e.unshift(...a),e.push(...c),u=e.length,l=Promise.resolve(t);d<u;)l=l.then(e[d++],e[d++]);return l}u=a.length;let h=t;for(;d<u;){const e=a[d++],t=a[d++];try{h=e(h)}catch(p){t.call(this,p);break}}try{l=Ai.call(this,h)}catch(p){return Promise.reject(p)}for(d=0,u=c.length;d<u;)l=l.then(c[d++],c[d++]);return l}getUri(e){return En(ii((e=oi(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}un.forEach(["delete","get","head","options"],function(e){Fi.prototype[e]=function(t,n){return this.request(oi(n||{},{method:e,url:t,data:(n||{}).data}))}}),un.forEach(["post","put","patch"],function(e){function t(t){return function(n,i,r){return this.request(oi(r||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:n,data:i}))}}Fi.prototype[e]=t(),Fi.prototype[e+"Form"]=t(!0)});const Bi=Fi;class zi{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const n=this;this.promise.then(e=>{if(!n._listeners)return;let t=n._listeners.length;for(;t-- >0;)n._listeners[t](e);n._listeners=null}),this.promise.then=e=>{let t;const i=new Promise(e=>{n.subscribe(e),t=e}).then(e);return i.cancel=function(){n.unsubscribe(t)},i},e(function(e,i,r){n.reason||(n.reason=new Jn(e,i,r),t(n.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new zi(function(t){e=t}),cancel:e}}}const qi=zi;const Vi={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Vi).forEach(e=>{let[t,n]=e;Vi[n]=t});const Hi=Vi;const Wi=function e(t){const n=new Bi(t),i=Ct(Bi.prototype.request,n);return un.extend(i,Bi.prototype,n,{allOwnKeys:!0}),un.extend(i,n,null,{allOwnKeys:!0}),i.create=function(n){return e(oi(t,n))},i}(jn);Wi.Axios=Bi,Wi.CanceledError=Jn,Wi.CancelToken=qi,Wi.isCancel=Kn,Wi.VERSION=Di,Wi.toFormData=bn,Wi.AxiosError=fn,Wi.Cancel=Wi.CanceledError,Wi.all=function(e){return Promise.all(e)},Wi.spread=function(e){return function(t){return e.apply(null,t)}},Wi.isAxiosError=function(e){return un.isObject(e)&&!0===e.isAxiosError},Wi.mergeConfig=oi,Wi.AxiosHeaders=Hn,Wi.formToJSON=e=>Ln(un.isHTMLForm(e)?new FormData(e):e),Wi.getAdapter=Ii.getAdapter,Wi.HttpStatusCode=Hi,Wi.default=Wi;const Ki=Wi;var Gi=n(579);const Ji=function(){const[e,t]=(0,o.useState)(""),[n,i]=(0,o.useState)(""),[r,a]=(0,o.useState)(""),s=ve();return(0,Gi.jsx)("div",{className:"d-flex justify-content-center align-items-center vh-100 bg-light",children:(0,Gi.jsxs)("div",{className:"card shadow p-4",style:{width:"22rem"},children:[(0,Gi.jsx)("h2",{className:"text-center mb-4",children:"Register"}),(0,Gi.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{await Ki.post("http://localhost:5000/api/auth/register",{username:e,email:n,password:r}),alert("Registered successfully!"),s("/login")}catch(a){var i,o;alert((null===(i=a.response)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.error)||"Registration failed")}},children:[(0,Gi.jsx)("input",{type:"text",className:"form-control mb-3",placeholder:"Username",value:e,onChange:e=>t(e.target.value),required:!0}),(0,Gi.jsx)("input",{type:"email",className:"form-control mb-3",placeholder:"Email",value:n,onChange:e=>i(e.target.value),required:!0}),(0,Gi.jsx)("input",{type:"password",className:"form-control mb-3",placeholder:"Password",value:r,onChange:e=>a(e.target.value),required:!0}),(0,Gi.jsx)("button",{type:"submit",className:"btn btn-primary w-100",children:"Register"})]})]})})};const Qi=function(){const[e,t]=(0,o.useState)(""),[n,i]=(0,o.useState)(""),r=ve();return(0,Gi.jsx)("div",{className:"d-flex justify-content-center align-items-center vh-100 bg-light",children:(0,Gi.jsxs)("div",{className:"card shadow p-4",style:{width:"22rem"},children:[(0,Gi.jsx)("h2",{className:"text-center mb-4",children:"Login"}),(0,Gi.jsxs)("form",{onSubmit:async t=>{t.preventDefault();try{const t=await Ki.post("http://localhost:5000/api/auth/login",{email:e,password:n});localStorage.setItem("userId",t.data.id),localStorage.setItem("username",t.data.username),r("/home")}catch(a){var i,o;alert((null===(i=a.response)||void 0===i||null===(o=i.data)||void 0===o?void 0:o.error)||"Login failed")}},children:[(0,Gi.jsx)("input",{type:"email",className:"form-control mb-3",placeholder:"Email",value:e,onChange:e=>t(e.target.value),required:!0}),(0,Gi.jsx)("input",{type:"password",className:"form-control mb-3",placeholder:"Password",value:n,onChange:e=>i(e.target.value),required:!0}),(0,Gi.jsx)("button",{type:"submit",className:"btn btn-primary w-100",children:"Login"})]})]})})},$i=Object.create(null);$i.open="0",$i.close="1",$i.ping="2",$i.pong="3",$i.message="4",$i.upgrade="5",$i.noop="6";const Yi=Object.create(null);Object.keys($i).forEach(e=>{Yi[$i[e]]=e});const Xi={type:"error",data:"parser error"},Zi="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),er="function"===typeof ArrayBuffer,tr=e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer instanceof ArrayBuffer,nr=(e,t,n)=>{let{type:i,data:r}=e;return Zi&&r instanceof Blob?t?n(r):ir(r,n):er&&(r instanceof ArrayBuffer||tr(r))?t?n(r):ir(new Blob([r]),n):n($i[i]+(r||""))},ir=(e,t)=>{const n=new FileReader;return n.onload=function(){const e=n.result.split(",")[1];t("b"+(e||""))},n.readAsDataURL(e)};function rr(e){return e instanceof Uint8Array?e:e instanceof ArrayBuffer?new Uint8Array(e):new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}let or;const ar="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",sr="undefined"===typeof Uint8Array?[]:new Uint8Array(256);for(let If=0;If<64;If++)sr[ar.charCodeAt(If)]=If;const cr="function"===typeof ArrayBuffer,lr=(e,t)=>{if("string"!==typeof e)return{type:"message",data:dr(e,t)};const n=e.charAt(0);if("b"===n)return{type:"message",data:ur(e.substring(1),t)};return Yi[n]?e.length>1?{type:Yi[n],data:e.substring(1)}:{type:Yi[n]}:Xi},ur=(e,t)=>{if(cr){const n=(e=>{let t,n,i,r,o,a=.75*e.length,s=e.length,c=0;"="===e[e.length-1]&&(a--,"="===e[e.length-2]&&a--);const l=new ArrayBuffer(a),u=new Uint8Array(l);for(t=0;t<s;t+=4)n=sr[e.charCodeAt(t)],i=sr[e.charCodeAt(t+1)],r=sr[e.charCodeAt(t+2)],o=sr[e.charCodeAt(t+3)],u[c++]=n<<2|i>>4,u[c++]=(15&i)<<4|r>>2,u[c++]=(3&r)<<6|63&o;return l})(e);return dr(n,t)}return{base64:!0,data:e}},dr=(e,t)=>"blob"===t?e instanceof Blob?e:new Blob([e]):e instanceof ArrayBuffer?e:e.buffer,hr=String.fromCharCode(30);function pr(){return new TransformStream({transform(e,t){!function(e,t){Zi&&e.data instanceof Blob?e.data.arrayBuffer().then(rr).then(t):er&&(e.data instanceof ArrayBuffer||tr(e.data))?t(rr(e.data)):nr(e,!1,e=>{or||(or=new TextEncoder),t(or.encode(e))})}(e,n=>{const i=n.length;let r;if(i<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,i);else if(i<65536){r=new Uint8Array(3);const e=new DataView(r.buffer);e.setUint8(0,126),e.setUint16(1,i)}else{r=new Uint8Array(9);const e=new DataView(r.buffer);e.setUint8(0,127),e.setBigUint64(1,BigInt(i))}e.data&&"string"!==typeof e.data&&(r[0]|=128),t.enqueue(r),t.enqueue(n)})}})}let fr;function mr(e){return e.reduce((e,t)=>e+t.length,0)}function gr(e,t){if(e[0].length===t)return e.shift();const n=new Uint8Array(t);let i=0;for(let r=0;r<t;r++)n[r]=e[0][i++],i===e[0].length&&(e.shift(),i=0);return e.length&&i<e[0].length&&(e[0]=e[0].slice(i)),n}function vr(e){if(e)return function(e){for(var t in vr.prototype)e[t]=vr.prototype[t];return e}(e)}vr.prototype.on=vr.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},vr.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},vr.prototype.off=vr.prototype.removeListener=vr.prototype.removeAllListeners=vr.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,i=this._callbacks["$"+e];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var r=0;r<i.length;r++)if((n=i[r])===t||n.fn===t){i.splice(r,1);break}return 0===i.length&&delete this._callbacks["$"+e],this},vr.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],i=1;i<arguments.length;i++)t[i-1]=arguments[i];if(n){i=0;for(var r=(n=n.slice(0)).length;i<r;++i)n[i].apply(this,t)}return this},vr.prototype.emitReserved=vr.prototype.emit,vr.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},vr.prototype.hasListeners=function(e){return!!this.listeners(e).length};const yr="function"===typeof Promise&&"function"===typeof Promise.resolve?e=>Promise.resolve().then(e):(e,t)=>t(e,0),br="undefined"!==typeof self?self:"undefined"!==typeof window?window:Function("return this")();function kr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return n.reduce((t,n)=>(e.hasOwnProperty(n)&&(t[n]=e[n]),t),{})}const Sr=br.setTimeout,wr=br.clearTimeout;function Tr(e,t){t.useNativeTimers?(e.setTimeoutFn=Sr.bind(br),e.clearTimeoutFn=wr.bind(br)):(e.setTimeoutFn=br.setTimeout.bind(br),e.clearTimeoutFn=br.clearTimeout.bind(br))}function Cr(e){return"string"===typeof e?function(e){let t=0,n=0;for(let i=0,r=e.length;i<r;i++)t=e.charCodeAt(i),t<128?n+=1:t<2048?n+=2:t<55296||t>=57344?n+=3:(i++,n+=4);return n}(e):Math.ceil(1.33*(e.byteLength||e.size))}function Er(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}class Pr extends Error{constructor(e,t,n){super(e),this.description=t,this.context=n,this.type="TransportError"}}class Rr extends vr{constructor(e){super(),this.writable=!1,Tr(this,e),this.opts=e,this.query=e.query,this.socket=e.socket,this.supportsBinary=!e.forceBase64}onError(e,t,n){return super.emitReserved("error",new Pr(e,t,n)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this}send(e){"open"===this.readyState&&this.write(e)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(e){const t=lr(e,this.socket.binaryType);this.onPacket(t)}onPacket(e){super.emitReserved("packet",e)}onClose(e){this.readyState="closed",super.emitReserved("close",e)}pause(e){}createUri(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e+"://"+this._hostname()+this._port()+this.opts.path+this._query(t)}_hostname(){const e=this.opts.hostname;return-1===e.indexOf(":")?e:"["+e+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(e){const t=function(e){let t="";for(let n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t}(e);return t.length?"?"+t:""}}class _r extends Rr{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(e){this.readyState="pausing";const t=()=>{this.readyState="paused",e()};if(this._polling||!this.writable){let e=0;this._polling&&(e++,this.once("pollComplete",function(){--e||t()})),this.writable||(e++,this.once("drain",function(){--e||t()}))}else t()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(e){((e,t)=>{const n=e.split(hr),i=[];for(let r=0;r<n.length;r++){const e=lr(n[r],t);if(i.push(e),"error"===e.type)break}return i})(e,this.socket.binaryType).forEach(e=>{if("opening"===this.readyState&&"open"===e.type&&this.onOpen(),"close"===e.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(e)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){const e=()=>{this.write([{type:"close"}])};"open"===this.readyState?e():this.once("open",e)}write(e){this.writable=!1,((e,t)=>{const n=e.length,i=new Array(n);let r=0;e.forEach((e,o)=>{nr(e,!1,e=>{i[o]=e,++r===n&&t(i.join(hr))})})})(e,e=>{this.doWrite(e,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const e=this.opts.secure?"https":"http",t=this.query||{};return!1!==this.opts.timestampRequests&&(t[this.opts.timestampParam]=Er()),this.supportsBinary||t.sid||(t.b64=1),this.createUri(e,t)}}let Or=!1;try{Or="undefined"!==typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(xf){}const xr=Or;function Ir(){}class Nr extends _r{constructor(e){if(super(e),"undefined"!==typeof location){const t="https:"===location.protocol;let n=location.port;n||(n=t?"443":"80"),this.xd="undefined"!==typeof location&&e.hostname!==location.hostname||n!==e.port}}doWrite(e,t){const n=this.request({method:"POST",data:e});n.on("success",t),n.on("error",(e,t)=>{this.onError("xhr post error",e,t)})}doPoll(){const e=this.request();e.on("data",this.onData.bind(this)),e.on("error",(e,t)=>{this.onError("xhr poll error",e,t)}),this.pollXhr=e}}class Ar extends vr{constructor(e,t,n){super(),this.createRequest=e,Tr(this,n),this._opts=n,this._method=n.method||"GET",this._uri=t,this._data=void 0!==n.data?n.data:null,this._create()}_create(){var e;const t=kr(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");t.xdomain=!!this._opts.xd;const n=this._xhr=this.createRequest(t);try{n.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0);for(let e in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(e)&&n.setRequestHeader(e,this._opts.extraHeaders[e])}}catch(So){}if("POST"===this._method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(So){}try{n.setRequestHeader("Accept","*/*")}catch(So){}null===(e=this._opts.cookieJar)||void 0===e||e.addCookies(n),"withCredentials"in n&&(n.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(n.timeout=this._opts.requestTimeout),n.onreadystatechange=()=>{var e;3===n.readyState&&(null===(e=this._opts.cookieJar)||void 0===e||e.parseCookies(n.getResponseHeader("set-cookie"))),4===n.readyState&&(200===n.status||1223===n.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"===typeof n.status?n.status:0)},0))},n.send(this._data)}catch(So){return void this.setTimeoutFn(()=>{this._onError(So)},0)}"undefined"!==typeof document&&(this._index=Ar.requestsCount++,Ar.requests[this._index]=this)}_onError(e){this.emitReserved("error",e,this._xhr),this._cleanup(!0)}_cleanup(e){if("undefined"!==typeof this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=Ir,e)try{this._xhr.abort()}catch(So){}"undefined"!==typeof document&&delete Ar.requests[this._index],this._xhr=null}}_onLoad(){const e=this._xhr.responseText;null!==e&&(this.emitReserved("data",e),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}if(Ar.requestsCount=0,Ar.requests={},"undefined"!==typeof document)if("function"===typeof attachEvent)attachEvent("onunload",Dr);else if("function"===typeof addEventListener){addEventListener("onpagehide"in br?"pagehide":"unload",Dr,!1)}function Dr(){for(let e in Ar.requests)Ar.requests.hasOwnProperty(e)&&Ar.requests[e].abort()}const Lr=function(){const e=Mr({xdomain:!1});return e&&null!==e.responseType}();function Mr(e){const t=e.xdomain;try{if("undefined"!==typeof XMLHttpRequest&&(!t||xr))return new XMLHttpRequest}catch(So){}if(!t)try{return new(br[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(So){}}const jr="undefined"!==typeof navigator&&"string"===typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();class Ur extends Rr{get name(){return"websocket"}doOpen(){const e=this.uri(),t=this.opts.protocols,n=jr?{}:kr(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(n.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(e,t,n)}catch(xf){return this.emitReserved("error",xf)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=e=>this.onClose({description:"websocket connection closed",context:e}),this.ws.onmessage=e=>this.onData(e.data),this.ws.onerror=e=>this.onError("websocket error",e)}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],i=t===e.length-1;nr(n,this.supportsBinary,e=>{try{this.doWrite(n,e)}catch(So){}i&&yr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){"undefined"!==typeof this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const e=this.opts.secure?"wss":"ws",t=this.query||{};return this.opts.timestampRequests&&(t[this.opts.timestampParam]=Er()),this.supportsBinary||(t.b64=1),this.createUri(e,t)}}const Fr=br.WebSocket||br.MozWebSocket;const Br={websocket:class extends Ur{createSocket(e,t,n){return jr?new Fr(e,t,n):t?new Fr(e,t):new Fr(e)}doWrite(e,t){this.ws.send(t)}},webtransport:class extends Rr{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(xf){return this.emitReserved("error",xf)}this._transport.closed.then(()=>{this.onClose()}).catch(e=>{this.onError("webtransport error",e)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(e=>{const t=function(e,t){fr||(fr=new TextDecoder);const n=[];let i=0,r=-1,o=!1;return new TransformStream({transform(a,s){for(n.push(a);;){if(0===i){if(mr(n)<1)break;const e=gr(n,1);o=128===(128&e[0]),r=127&e[0],i=r<126?3:126===r?1:2}else if(1===i){if(mr(n)<2)break;const e=gr(n,2);r=new DataView(e.buffer,e.byteOffset,e.length).getUint16(0),i=3}else if(2===i){if(mr(n)<8)break;const e=gr(n,8),t=new DataView(e.buffer,e.byteOffset,e.length),o=t.getUint32(0);if(o>Math.pow(2,21)-1){s.enqueue(Xi);break}r=o*Math.pow(2,32)+t.getUint32(4),i=3}else{if(mr(n)<r)break;const e=gr(n,r);s.enqueue(lr(o?e:fr.decode(e),t)),i=0}if(0===r||r>e){s.enqueue(Xi);break}}}})}(Number.MAX_SAFE_INTEGER,this.socket.binaryType),n=e.readable.pipeThrough(t).getReader(),i=pr();i.readable.pipeTo(e.writable),this._writer=i.writable.getWriter();const r=()=>{n.read().then(e=>{let{done:t,value:n}=e;t||(this.onPacket(n),r())}).catch(e=>{})};r();const o={type:"open"};this.query.sid&&(o.data='{"sid":"'.concat(this.query.sid,'"}')),this._writer.write(o).then(()=>this.onOpen())})})}write(e){this.writable=!1;for(let t=0;t<e.length;t++){const n=e[t],i=t===e.length-1;this._writer.write(n).then(()=>{i&&yr(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var e;null===(e=this._transport)||void 0===e||e.close()}},polling:class extends Nr{constructor(e){super(e);const t=e&&e.forceBase64;this.supportsBinary=Lr&&!t}request(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.assign(e,{xd:this.xd},this.opts),new Ar(Mr,this.uri(),e)}}},zr=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,qr=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Vr(e){if(e.length>8e3)throw"URI too long";const t=e,n=e.indexOf("["),i=e.indexOf("]");-1!=n&&-1!=i&&(e=e.substring(0,n)+e.substring(n,i).replace(/:/g,";")+e.substring(i,e.length));let r=zr.exec(e||""),o={},a=14;for(;a--;)o[qr[a]]=r[a]||"";return-1!=n&&-1!=i&&(o.source=t,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=function(e,t){const n=/\/{2,9}/g,i=t.replace(n,"/").split("/");"/"!=t.slice(0,1)&&0!==t.length||i.splice(0,1);"/"==t.slice(-1)&&i.splice(i.length-1,1);return i}(0,o.path),o.queryKey=function(e,t){const n={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(e,t,i){t&&(n[t]=i)}),n}(0,o.query),o}const Hr="function"===typeof addEventListener&&"function"===typeof removeEventListener,Wr=[];Hr&&addEventListener("offline",()=>{Wr.forEach(e=>e())},!1);class Kr extends vr{constructor(e,t){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,e&&"object"===typeof e&&(t=e,e=null),e){const n=Vr(e);t.hostname=n.host,t.secure="https"===n.protocol||"wss"===n.protocol,t.port=n.port,n.query&&(t.query=n.query)}else t.host&&(t.hostname=Vr(t.host).host);Tr(this,t),this.secure=null!=t.secure?t.secure:"undefined"!==typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.hostname=t.hostname||("undefined"!==typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!==typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},t.transports.forEach(e=>{const t=e.prototype.name;this.transports.push(t),this._transportsByName[t]=e}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},t),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"===typeof this.opts.query&&(this.opts.query=function(e){let t={},n=e.split("&");for(let i=0,r=n.length;i<r;i++){let e=n[i].split("=");t[decodeURIComponent(e[0])]=decodeURIComponent(e[1])}return t}(this.opts.query)),Hr&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},Wr.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(e){const t=Object.assign({},this.opts.query);t.EIO=4,t.transport=e,this.id&&(t.sid=this.id);const n=Object.assign({},this.opts,{query:t,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[e]);return new this._transportsByName[e](n)}_open(){if(0===this.transports.length)return void this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);const e=this.opts.rememberUpgrade&&Kr.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";const t=this.createTransport(e);t.open(),this.setTransport(t)}setTransport(e){this.transport&&this.transport.removeAllListeners(),this.transport=e,e.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",e=>this._onClose("transport close",e))}onOpen(){this.readyState="open",Kr.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",e),this.emitReserved("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const t=new Error("server error");t.code=e.data,this._onError(t);break;case"message":this.emitReserved("data",e.data),this.emitReserved("message",e.data)}}onHandshake(e){this.emitReserved("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this._pingInterval=e.pingInterval,this._pingTimeout=e.pingTimeout,this._maxPayload=e.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const e=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+e,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},e),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const e=this._getWritablePackets();this.transport.send(e),this._prevBufferLen=e.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let e=1;for(let t=0;t<this.writeBuffer.length;t++){const n=this.writeBuffer[t].data;if(n&&(e+=Cr(n)),t>0&&e>this._maxPayload)return this.writeBuffer.slice(0,t);e+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const e=Date.now()>this._pingTimeoutTime;return e&&(this._pingTimeoutTime=0,yr(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),e}write(e,t,n){return this._sendPacket("message",e,t,n),this}send(e,t,n){return this._sendPacket("message",e,t,n),this}_sendPacket(e,t,n,i){if("function"===typeof t&&(i=t,t=void 0),"function"===typeof n&&(i=n,n=null),"closing"===this.readyState||"closed"===this.readyState)return;(n=n||{}).compress=!1!==n.compress;const r={type:e,data:t,options:n};this.emitReserved("packetCreate",r),this.writeBuffer.push(r),i&&this.once("flush",i),this.flush()}close(){const e=()=>{this._onClose("forced close"),this.transport.close()},t=()=>{this.off("upgrade",t),this.off("upgradeError",t),e()},n=()=>{this.once("upgrade",t),this.once("upgradeError",t)};return"opening"!==this.readyState&&"open"!==this.readyState||(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?n():e()}):this.upgrading?n():e()),this}_onError(e){if(Kr.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",e),this._onClose("transport error",e)}_onClose(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Hr&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const e=Wr.indexOf(this._offlineEventListener);-1!==e&&Wr.splice(e,1)}this.readyState="closed",this.id=null,this.emitReserved("close",e,t),this.writeBuffer=[],this._prevBufferLen=0}}}Kr.protocol=4;class Gr extends Kr{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let e=0;e<this._upgrades.length;e++)this._probe(this._upgrades[e])}_probe(e){let t=this.createTransport(e),n=!1;Kr.priorWebsocketSuccess=!1;const i=()=>{n||(t.send([{type:"ping",data:"probe"}]),t.once("packet",e=>{if(!n)if("pong"===e.type&&"probe"===e.data){if(this.upgrading=!0,this.emitReserved("upgrading",t),!t)return;Kr.priorWebsocketSuccess="websocket"===t.name,this.transport.pause(()=>{n||"closed"!==this.readyState&&(l(),this.setTransport(t),t.send([{type:"upgrade"}]),this.emitReserved("upgrade",t),t=null,this.upgrading=!1,this.flush())})}else{const e=new Error("probe error");e.transport=t.name,this.emitReserved("upgradeError",e)}}))};function r(){n||(n=!0,l(),t.close(),t=null)}const o=e=>{const n=new Error("probe error: "+e);n.transport=t.name,r(),this.emitReserved("upgradeError",n)};function a(){o("transport closed")}function s(){o("socket closed")}function c(e){t&&e.name!==t.name&&r()}const l=()=>{t.removeListener("open",i),t.removeListener("error",o),t.removeListener("close",a),this.off("close",s),this.off("upgrading",c)};t.once("open",i),t.once("error",o),t.once("close",a),this.once("close",s),this.once("upgrading",c),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==e?this.setTimeoutFn(()=>{n||t.open()},200):t.open()}onHandshake(e){this._upgrades=this._filterUpgrades(e.upgrades),super.onHandshake(e)}_filterUpgrades(e){const t=[];for(let n=0;n<e.length;n++)~this.transports.indexOf(e[n])&&t.push(e[n]);return t}}class Jr extends Gr{constructor(e){const t="object"===typeof e?e:arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(!t.transports||t.transports&&"string"===typeof t.transports[0])&&(t.transports=(t.transports||["polling","websocket","webtransport"]).map(e=>Br[e]).filter(e=>!!e)),super(e,t)}}const Qr="function"===typeof ArrayBuffer,$r=Object.prototype.toString,Yr="function"===typeof Blob||"undefined"!==typeof Blob&&"[object BlobConstructor]"===$r.call(Blob),Xr="function"===typeof File||"undefined"!==typeof File&&"[object FileConstructor]"===$r.call(File);function Zr(e){return Qr&&(e instanceof ArrayBuffer||(e=>"function"===typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer)(e))||Yr&&e instanceof Blob||Xr&&e instanceof File}function eo(e,t){if(!e||"object"!==typeof e)return!1;if(Array.isArray(e)){for(let t=0,n=e.length;t<n;t++)if(eo(e[t]))return!0;return!1}if(Zr(e))return!0;if(e.toJSON&&"function"===typeof e.toJSON&&1===arguments.length)return eo(e.toJSON(),!0);for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&eo(e[n]))return!0;return!1}function to(e){const t=[],n=e.data,i=e;return i.data=no(n,t),i.attachments=t.length,{packet:i,buffers:t}}function no(e,t){if(!e)return e;if(Zr(e)){const n={_placeholder:!0,num:t.length};return t.push(e),n}if(Array.isArray(e)){const n=new Array(e.length);for(let i=0;i<e.length;i++)n[i]=no(e[i],t);return n}if("object"===typeof e&&!(e instanceof Date)){const n={};for(const i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=no(e[i],t));return n}return e}function io(e,t){return e.data=ro(e.data,t),delete e.attachments,e}function ro(e,t){if(!e)return e;if(e&&!0===e._placeholder){if("number"===typeof e.num&&e.num>=0&&e.num<t.length)return t[e.num];throw new Error("illegal attachments")}if(Array.isArray(e))for(let n=0;n<e.length;n++)e[n]=ro(e[n],t);else if("object"===typeof e)for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(e[n]=ro(e[n],t));return e}const oo=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],ao=5;var so;!function(e){e[e.CONNECT=0]="CONNECT",e[e.DISCONNECT=1]="DISCONNECT",e[e.EVENT=2]="EVENT",e[e.ACK=3]="ACK",e[e.CONNECT_ERROR=4]="CONNECT_ERROR",e[e.BINARY_EVENT=5]="BINARY_EVENT",e[e.BINARY_ACK=6]="BINARY_ACK"}(so||(so={}));class co{constructor(e){this.replacer=e}encode(e){return e.type!==so.EVENT&&e.type!==so.ACK||!eo(e)?[this.encodeAsString(e)]:this.encodeAsBinary({type:e.type===so.EVENT?so.BINARY_EVENT:so.BINARY_ACK,nsp:e.nsp,data:e.data,id:e.id})}encodeAsString(e){let t=""+e.type;return e.type!==so.BINARY_EVENT&&e.type!==so.BINARY_ACK||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data&&(t+=JSON.stringify(e.data,this.replacer)),t}encodeAsBinary(e){const t=to(e),n=this.encodeAsString(t.packet),i=t.buffers;return i.unshift(n),i}}function lo(e){return"[object Object]"===Object.prototype.toString.call(e)}class uo extends vr{constructor(e){super(),this.reviver=e}add(e){let t;if("string"===typeof e){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");t=this.decodeString(e);const n=t.type===so.BINARY_EVENT;n||t.type===so.BINARY_ACK?(t.type=n?so.EVENT:so.ACK,this.reconstructor=new ho(t),0===t.attachments&&super.emitReserved("decoded",t)):super.emitReserved("decoded",t)}else{if(!Zr(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");t=this.reconstructor.takeBinaryData(e),t&&(this.reconstructor=null,super.emitReserved("decoded",t))}}decodeString(e){let t=0;const n={type:Number(e.charAt(0))};if(void 0===so[n.type])throw new Error("unknown packet type "+n.type);if(n.type===so.BINARY_EVENT||n.type===so.BINARY_ACK){const i=t+1;for(;"-"!==e.charAt(++t)&&t!=e.length;);const r=e.substring(i,t);if(r!=Number(r)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===e.charAt(t+1)){const i=t+1;for(;++t;){if(","===e.charAt(t))break;if(t===e.length)break}n.nsp=e.substring(i,t)}else n.nsp="/";const i=e.charAt(t+1);if(""!==i&&Number(i)==i){const i=t+1;for(;++t;){const n=e.charAt(t);if(null==n||Number(n)!=n){--t;break}if(t===e.length)break}n.id=Number(e.substring(i,t+1))}if(e.charAt(++t)){const i=this.tryParse(e.substr(t));if(!uo.isPayloadValid(n.type,i))throw new Error("invalid payload");n.data=i}return n}tryParse(e){try{return JSON.parse(e,this.reviver)}catch(So){return!1}}static isPayloadValid(e,t){switch(e){case so.CONNECT:return lo(t);case so.DISCONNECT:return void 0===t;case so.CONNECT_ERROR:return"string"===typeof t||lo(t);case so.EVENT:case so.BINARY_EVENT:return Array.isArray(t)&&("number"===typeof t[0]||"string"===typeof t[0]&&-1===oo.indexOf(t[0]));case so.ACK:case so.BINARY_ACK:return Array.isArray(t)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ho{constructor(e){this.packet=e,this.buffers=[],this.reconPack=e}takeBinaryData(e){if(this.buffers.push(e),this.buffers.length===this.reconPack.attachments){const e=io(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}function po(e,t,n){return e.on(t,n),function(){e.off(t,n)}}const fo=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class mo extends vr{constructor(e,t,n){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=e,this.nsp=t,n&&n.auth&&(this.auth=n.auth),this._opts=Object.assign({},n),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const e=this.io;this.subs=[po(e,"open",this.onopen.bind(this)),po(e,"packet",this.onpacket.bind(this)),po(e,"error",this.onerror.bind(this)),po(e,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.unshift("message"),this.emit.apply(this,t),this}emit(e){var t,n,i;if(fo.hasOwnProperty(e))throw new Error('"'+e.toString()+'" is a reserved event name');for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];if(o.unshift(e),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(o),this;const s={type:so.EVENT,data:o,options:{}};if(s.options.compress=!1!==this.flags.compress,"function"===typeof o[o.length-1]){const e=this.ids++,t=o.pop();this._registerAckCallback(e,t),s.id=e}const c=null===(n=null===(t=this.io.engine)||void 0===t?void 0:t.transport)||void 0===n?void 0:n.writable,l=this.connected&&!(null===(i=this.io.engine)||void 0===i?void 0:i._hasPingExpired());return this.flags.volatile&&!c||(l?(this.notifyOutgoingListeners(s),this.packet(s)):this.sendBuffer.push(s)),this.flags={},this}_registerAckCallback(e,t){var n,i=this;const r=null!==(n=this.flags.timeout)&&void 0!==n?n:this._opts.ackTimeout;if(void 0===r)return void(this.acks[e]=t);const o=this.io.setTimeoutFn(()=>{delete this.acks[e];for(let t=0;t<this.sendBuffer.length;t++)this.sendBuffer[t].id===e&&this.sendBuffer.splice(t,1);t.call(this,new Error("operation has timed out"))},r),a=function(){i.io.clearTimeoutFn(o);for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(i,n)};a.withError=!0,this.acks[e]=a}emitWithAck(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new Promise((t,i)=>{const r=(e,n)=>e?i(e):t(n);r.withError=!0,n.push(r),this.emit(e,...n)})}_addToQueue(e){var t=this;let n;"function"===typeof e[e.length-1]&&(n=e.pop());const i={id:this._queueSeq++,tryCount:0,pending:!1,args:e,flags:Object.assign({fromQueue:!0},this.flags)};e.push(function(e){if(i!==t._queue[0])return;if(null!==e)i.tryCount>t._opts.retries&&(t._queue.shift(),n&&n(e));else if(t._queue.shift(),n){for(var r=arguments.length,o=new Array(r>1?r-1:0),a=1;a<r;a++)o[a-1]=arguments[a];n(null,...o)}return i.pending=!1,t._drainQueue()}),this._queue.push(i),this._drainQueue()}_drainQueue(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.connected||0===this._queue.length)return;const t=this._queue[0];t.pending&&!e||(t.pending=!0,t.tryCount++,this.flags=t.flags,this.emit.apply(this,t.args))}packet(e){e.nsp=this.nsp,this.io._packet(e)}onopen(){"function"==typeof this.auth?this.auth(e=>{this._sendConnectPacket(e)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(e){this.packet({type:so.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},e):e})}onerror(e){this.connected||this.emitReserved("connect_error",e)}onclose(e,t){this.connected=!1,delete this.id,this.emitReserved("disconnect",e,t),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(e=>{if(!this.sendBuffer.some(t=>String(t.id)===e)){const t=this.acks[e];delete this.acks[e],t.withError&&t.call(this,new Error("socket has been disconnected"))}})}onpacket(e){if(e.nsp===this.nsp)switch(e.type){case so.CONNECT:e.data&&e.data.sid?this.onconnect(e.data.sid,e.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case so.EVENT:case so.BINARY_EVENT:this.onevent(e);break;case so.ACK:case so.BINARY_ACK:this.onack(e);break;case so.DISCONNECT:this.ondisconnect();break;case so.CONNECT_ERROR:this.destroy();const t=new Error(e.data.message);t.data=e.data.data,this.emitReserved("connect_error",t)}}onevent(e){const t=e.data||[];null!=e.id&&t.push(this.ack(e.id)),this.connected?this.emitEvent(t):this.receiveBuffer.push(Object.freeze(t))}emitEvent(e){if(this._anyListeners&&this._anyListeners.length){const t=this._anyListeners.slice();for(const n of t)n.apply(this,e)}super.emit.apply(this,e),this._pid&&e.length&&"string"===typeof e[e.length-1]&&(this._lastOffset=e[e.length-1])}ack(e){const t=this;let n=!1;return function(){if(!n){n=!0;for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];t.packet({type:so.ACK,id:e,data:r})}}}onack(e){const t=this.acks[e.id];"function"===typeof t&&(delete this.acks[e.id],t.withError&&e.data.unshift(null),t.apply(this,e.data))}onconnect(e,t){this.id=e,this.recovered=t&&this._pid===t,this._pid=t,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(e=>this.emitEvent(e)),this.receiveBuffer=[],this.sendBuffer.forEach(e=>{this.notifyOutgoingListeners(e),this.packet(e)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(e=>e()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:so.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(e){return this.flags.compress=e,this}get volatile(){return this.flags.volatile=!0,this}timeout(e){return this.flags.timeout=e,this}onAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(e),this}prependAny(e){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(e),this}offAny(e){if(!this._anyListeners)return this;if(e){const t=this._anyListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(e),this}prependAnyOutgoing(e){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(e),this}offAnyOutgoing(e){if(!this._anyOutgoingListeners)return this;if(e){const t=this._anyOutgoingListeners;for(let n=0;n<t.length;n++)if(e===t[n])return t.splice(n,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(e){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const t=this._anyOutgoingListeners.slice();for(const n of t)n.apply(this,e.data)}}}function go(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0,this.attempts=0}go.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},go.prototype.reset=function(){this.attempts=0},go.prototype.setMin=function(e){this.ms=e},go.prototype.setMax=function(e){this.max=e},go.prototype.setJitter=function(e){this.jitter=e};class vo extends vr{constructor(e,t){var n;super(),this.nsps={},this.subs=[],e&&"object"===typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.opts=t,Tr(this,t),this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(n=t.randomizationFactor)&&void 0!==n?n:.5),this.backoff=new go({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this._readyState="closed",this.uri=e;const i=t.parser||r;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this._autoConnect=!1!==t.autoConnect,this._autoConnect&&this.open()}reconnection(e){return arguments.length?(this._reconnection=!!e,e||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(e){return void 0===e?this._reconnectionAttempts:(this._reconnectionAttempts=e,this)}reconnectionDelay(e){var t;return void 0===e?this._reconnectionDelay:(this._reconnectionDelay=e,null===(t=this.backoff)||void 0===t||t.setMin(e),this)}randomizationFactor(e){var t;return void 0===e?this._randomizationFactor:(this._randomizationFactor=e,null===(t=this.backoff)||void 0===t||t.setJitter(e),this)}reconnectionDelayMax(e){var t;return void 0===e?this._reconnectionDelayMax:(this._reconnectionDelayMax=e,null===(t=this.backoff)||void 0===t||t.setMax(e),this)}timeout(e){return arguments.length?(this._timeout=e,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(e){if(~this._readyState.indexOf("open"))return this;this.engine=new Jr(this.uri,this.opts);const t=this.engine,n=this;this._readyState="opening",this.skipReconnect=!1;const i=po(t,"open",function(){n.onopen(),e&&e()}),r=t=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",t),e?e(t):this.maybeReconnectOnOpen()},o=po(t,"error",r);if(!1!==this._timeout){const e=this._timeout,n=this.setTimeoutFn(()=>{i(),r(new Error("timeout")),t.close()},e);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}return this.subs.push(i),this.subs.push(o),this}connect(e){return this.open(e)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const e=this.engine;this.subs.push(po(e,"ping",this.onping.bind(this)),po(e,"data",this.ondata.bind(this)),po(e,"error",this.onerror.bind(this)),po(e,"close",this.onclose.bind(this)),po(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(e){try{this.decoder.add(e)}catch(So){this.onclose("parse error",So)}}ondecoded(e){yr(()=>{this.emitReserved("packet",e)},this.setTimeoutFn)}onerror(e){this.emitReserved("error",e)}socket(e,t){let n=this.nsps[e];return n?this._autoConnect&&!n.active&&n.connect():(n=new mo(this,e,t),this.nsps[e]=n),n}_destroy(e){const t=Object.keys(this.nsps);for(const n of t){if(this.nsps[n].active)return}this._close()}_packet(e){const t=this.encoder.encode(e);for(let n=0;n<t.length;n++)this.engine.write(t[n],e.options)}cleanup(){this.subs.forEach(e=>e()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(e,t){var n;this.cleanup(),null===(n=this.engine)||void 0===n||n.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",e,t),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const e=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const t=this.backoff.duration();this._reconnecting=!0;const n=this.setTimeoutFn(()=>{e.skipReconnect||(this.emitReserved("reconnect_attempt",e.backoff.attempts),e.skipReconnect||e.open(t=>{t?(e._reconnecting=!1,e.reconnect(),this.emitReserved("reconnect_error",t)):e.onreconnect()}))},t);this.opts.autoUnref&&n.unref(),this.subs.push(()=>{this.clearTimeoutFn(n)})}}onreconnect(){const e=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",e)}}const yo={};function bo(e,t){"object"===typeof e&&(t=e,e=void 0);const n=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=arguments.length>2?arguments[2]:void 0,i=e;n=n||"undefined"!==typeof location&&location,null==e&&(e=n.protocol+"//"+n.host),"string"===typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?n.protocol+e:n.host+e),/^(https?|wss?):\/\//.test(e)||(e="undefined"!==typeof n?n.protocol+"//"+e:"https://"+e),i=Vr(e)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";const r=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+r+":"+i.port+t,i.href=i.protocol+"://"+r+(n&&n.port===i.port?"":":"+i.port),i}(e,(t=t||{}).path||"/socket.io"),i=n.source,r=n.id,o=n.path,a=yo[r]&&o in yo[r].nsps;let s;return t.forceNew||t["force new connection"]||!1===t.multiplex||a?s=new vo(i,t):(yo[r]||(yo[r]=new vo(i,t)),s=yo[r]),n.query&&!t.query&&(t.query=n.queryKey),s.socket(n.path,t)}function ko(e,t){return t.forEach(function(t){t&&"string"!==typeof t&&!Array.isArray(t)&&Object.keys(t).forEach(function(n){if("default"!==n&&!(n in e)){var i=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,i.get?i:{enumerable:!0,get:function(){return t[n]}})}})}),Object.freeze(e)}Object.assign(bo,{Manager:vo,Socket:mo,io:bo,connect:bo});var So=Object.defineProperty,wo=(e,t,n)=>((e,t,n)=>t in e?So(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n)(e,"symbol"!=typeof t?t+"":t,n);class To{constructor(){wo(this,"_locking"),wo(this,"_locks"),this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){let e;this._locks+=1;const t=new Promise(t=>e=()=>{this._locks-=1,t()}),n=this._locking.then(()=>e);return this._locking=this._locking.then(()=>t),n}}function Co(e,t){if(!e)throw new Error(t)}function Eo(e){if("number"!==typeof e)throw new Error("invalid int 32: "+typeof e);if(!Number.isInteger(e)||e>2147483647||e<-2147483648)throw new Error("invalid int 32: "+e)}function Po(e){if("number"!==typeof e)throw new Error("invalid uint 32: "+typeof e);if(!Number.isInteger(e)||e>4294967295||e<0)throw new Error("invalid uint 32: "+e)}function Ro(e){if("number"!==typeof e)throw new Error("invalid float 32: "+typeof e);if(Number.isFinite(e)&&(e>34028234663852886e22||e<-34028234663852886e22))throw new Error("invalid float 32: "+e)}const _o=Symbol("@bufbuild/protobuf/enum-type");function Oo(e){const t=e[_o];return Co(t,"missing enum type on enum object"),t}function xo(e,t,n,i){e[_o]=Io(t,n.map(t=>({no:t.no,name:t.name,localName:e[t.no]})))}function Io(e,t,n){const i=Object.create(null),r=Object.create(null),o=[];for(const a of t){const e=Ao(a);o.push(e),i[a.name]=e,r[a.no]=e}return{typeName:e,values:o,findName:e=>i[e],findNumber:e=>r[e]}}function No(e,t,n){const i={};for(const r of t){const e=Ao(r);i[e.localName]=e.no,i[e.no]=e.localName}return xo(i,e,t),i}function Ao(e){return"localName"in e?e:Object.assign(Object.assign({},e),{localName:e.name})}class Do{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,t){const n=this.getType().runtime.bin,i=n.makeReadOptions(t);return n.readMessage(this,i.readerFactory(e),e.byteLength,i),this}fromJson(e,t){const n=this.getType(),i=n.runtime.json,r=i.makeReadOptions(t);return i.readMessage(n,e,r,this),this}fromJsonString(e,t){let n;try{n=JSON.parse(e)}catch(So){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(So instanceof Error?So.message:String(So)))}return this.fromJson(n,t)}toBinary(e){const t=this.getType().runtime.bin,n=t.makeWriteOptions(e),i=n.writerFactory();return t.writeMessage(this,i,n),i.finish()}toJson(e){const t=this.getType().runtime.json,n=t.makeWriteOptions(e);return t.writeMessage(this,n)}toJsonString(e){var t;const n=this.toJson(e);return JSON.stringify(n,null,null!==(t=null===e||void 0===e?void 0:e.prettySpaces)&&void 0!==t?t:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function Lo(){let e=0,t=0;for(let i=0;i<28;i+=7){let n=this.buf[this.pos++];if(e|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}let n=this.buf[this.pos++];if(e|=(15&n)<<28,t=(112&n)>>4,0==(128&n))return this.assertBounds(),[e,t];for(let i=3;i<=31;i+=7){let n=this.buf[this.pos++];if(t|=(127&n)<<i,0==(128&n))return this.assertBounds(),[e,t]}throw new Error("invalid varint")}function Mo(e,t,n){for(let o=0;o<28;o+=7){const i=e>>>o,r=!(i>>>7==0&&0==t),a=255&(r?128|i:i);if(n.push(a),!r)return}const i=e>>>28&15|(7&t)<<4,r=!(t>>3==0);if(n.push(255&(r?128|i:i)),r){for(let e=3;e<31;e+=7){const i=t>>>e,r=!(i>>>7==0),o=255&(r?128|i:i);if(n.push(o),!r)return}n.push(t>>>31&1)}}const jo=4294967296;function Uo(e){const t="-"===e[0];t&&(e=e.slice(1));const n=1e6;let i=0,r=0;function o(t,o){const a=Number(e.slice(t,o));r*=n,i=i*n+a,i>=jo&&(r+=i/jo|0,i%=jo)}return o(-24,-18),o(-18,-12),o(-12,-6),o(-6),t?zo(i,r):Bo(i,r)}function Fo(e,t){if(({lo:e,hi:t}=function(e,t){return{lo:e>>>0,hi:t>>>0}}(e,t)),t<=2097151)return String(jo*t+e);const n=16777215&(e>>>24|t<<8),i=t>>16&65535;let r=(16777215&e)+6777216*n+6710656*i,o=n+8147497*i,a=2*i;const s=1e7;return r>=s&&(o+=Math.floor(r/s),r%=s),o>=s&&(a+=Math.floor(o/s),o%=s),a.toString()+qo(o)+qo(r)}function Bo(e,t){return{lo:0|e,hi:0|t}}function zo(e,t){return t=~t,e?e=1+~e:t+=1,Bo(e,t)}const qo=e=>{const t=String(e);return"0000000".slice(t.length)+t};function Vo(e,t){if(e>=0){for(;e>127;)t.push(127&e|128),e>>>=7;t.push(e)}else{for(let n=0;n<9;n++)t.push(127&e|128),e>>=7;t.push(1)}}function Ho(){let e=this.buf[this.pos++],t=127&e;if(0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<7,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<14,0==(128&e))return this.assertBounds(),t;if(e=this.buf[this.pos++],t|=(127&e)<<21,0==(128&e))return this.assertBounds(),t;e=this.buf[this.pos++],t|=(15&e)<<28;for(let n=5;0!==(128&e)&&n<10;n++)e=this.buf[this.pos++];if(0!=(128&e))throw new Error("invalid varint");return this.assertBounds(),t>>>0}const Wo=function(){const e=new DataView(new ArrayBuffer(8));if("function"===typeof BigInt&&"function"===typeof e.getBigInt64&&"function"===typeof e.getBigUint64&&"function"===typeof e.setBigInt64&&"function"===typeof e.setBigUint64&&("object"!=typeof process||"1"!=={NODE_ENV:"production",PUBLIC_URL:"/video-chat",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_LIVEKIT_URL:"wss://video-chat-wfvq5jjj.livekit.cloud"}.BUF_BIGINT_DISABLE)){const t=BigInt("-9223372036854775808"),n=BigInt("9223372036854775807"),i=BigInt("0"),r=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(e){const i="bigint"==typeof e?e:BigInt(e);if(i>n||i<t)throw new Error("int64 invalid: ".concat(e));return i},uParse(e){const t="bigint"==typeof e?e:BigInt(e);if(t>r||t<i)throw new Error("uint64 invalid: ".concat(e));return t},enc(t){return e.setBigInt64(0,this.parse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},uEnc(t){return e.setBigInt64(0,this.uParse(t),!0),{lo:e.getInt32(0,!0),hi:e.getInt32(4,!0)}},dec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigInt64(0,!0)),uDec:(t,n)=>(e.setInt32(0,t,!0),e.setInt32(4,n,!0),e.getBigUint64(0,!0))}}const t=e=>Co(/^-?[0-9]+$/.test(e),"int64 invalid: ".concat(e)),n=e=>Co(/^[0-9]+$/.test(e),"uint64 invalid: ".concat(e));return{zero:"0",supported:!1,parse:e=>("string"!=typeof e&&(e=e.toString()),t(e),e),uParse:e=>("string"!=typeof e&&(e=e.toString()),n(e),e),enc:e=>("string"!=typeof e&&(e=e.toString()),t(e),Uo(e)),uEnc:e=>("string"!=typeof e&&(e=e.toString()),n(e),Uo(e)),dec:(e,t)=>function(e,t){let n=Bo(e,t);const i=2147483648&n.hi;i&&(n=zo(n.lo,n.hi));const r=Fo(n.lo,n.hi);return i?"-"+r:r}(e,t),uDec:(e,t)=>Fo(e,t)}}();var Ko,Go,Jo;function Qo(e,t,n){if(t===n)return!0;if(e==Ko.BYTES){if(!(t instanceof Uint8Array)||!(n instanceof Uint8Array))return!1;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e]!==n[e])return!1;return!0}switch(e){case Ko.UINT64:case Ko.FIXED64:case Ko.INT64:case Ko.SFIXED64:case Ko.SINT64:return t==n}return!1}function $o(e,t){switch(e){case Ko.BOOL:return!1;case Ko.UINT64:case Ko.FIXED64:case Ko.INT64:case Ko.SFIXED64:case Ko.SINT64:return 0==t?Wo.zero:"0";case Ko.DOUBLE:case Ko.FLOAT:return 0;case Ko.BYTES:return new Uint8Array(0);case Ko.STRING:return"";default:return 0}}function Yo(e,t){switch(e){case Ko.BOOL:return!1===t;case Ko.STRING:return""===t;case Ko.BYTES:return t instanceof Uint8Array&&!t.byteLength;default:return 0==t}}!function(e){e[e.DOUBLE=1]="DOUBLE",e[e.FLOAT=2]="FLOAT",e[e.INT64=3]="INT64",e[e.UINT64=4]="UINT64",e[e.INT32=5]="INT32",e[e.FIXED64=6]="FIXED64",e[e.FIXED32=7]="FIXED32",e[e.BOOL=8]="BOOL",e[e.STRING=9]="STRING",e[e.BYTES=12]="BYTES",e[e.UINT32=13]="UINT32",e[e.SFIXED32=15]="SFIXED32",e[e.SFIXED64=16]="SFIXED64",e[e.SINT32=17]="SINT32",e[e.SINT64=18]="SINT64"}(Ko||(Ko={})),function(e){e[e.BIGINT=0]="BIGINT",e[e.STRING=1]="STRING"}(Go||(Go={})),function(e){e[e.Varint=0]="Varint",e[e.Bit64=1]="Bit64",e[e.LengthDelimited=2]="LengthDelimited",e[e.StartGroup=3]="StartGroup",e[e.EndGroup=4]="EndGroup",e[e.Bit32=5]="Bit32"}(Jo||(Jo={}));class Xo{constructor(e){this.stack=[],this.textEncoder=null!==e&&void 0!==e?e:new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let i=0;i<this.chunks.length;i++)e+=this.chunks[i].length;let t=new Uint8Array(e),n=0;for(let i=0;i<this.chunks.length;i++)t.set(this.chunks[i],n),n+=this.chunks[i].length;return this.chunks=[],t}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),t=this.stack.pop();if(!t)throw new Error("invalid state, fork stack empty");return this.chunks=t.chunks,this.buf=t.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,t){return this.uint32((e<<3|t)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Po(e);e>127;)this.buf.push(127&e|128),e>>>=7;return this.buf.push(e),this}int32(e){return Eo(e),Vo(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let t=this.textEncoder.encode(e);return this.uint32(t.byteLength),this.raw(t)}float(e){Ro(e);let t=new Uint8Array(4);return new DataView(t.buffer).setFloat32(0,e,!0),this.raw(t)}double(e){let t=new Uint8Array(8);return new DataView(t.buffer).setFloat64(0,e,!0),this.raw(t)}fixed32(e){Po(e);let t=new Uint8Array(4);return new DataView(t.buffer).setUint32(0,e,!0),this.raw(t)}sfixed32(e){Eo(e);let t=new Uint8Array(4);return new DataView(t.buffer).setInt32(0,e,!0),this.raw(t)}sint32(e){return Eo(e),Vo(e=(e<<1^e>>31)>>>0,this.buf),this}sfixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=Wo.enc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}fixed64(e){let t=new Uint8Array(8),n=new DataView(t.buffer),i=Wo.uEnc(e);return n.setInt32(0,i.lo,!0),n.setInt32(4,i.hi,!0),this.raw(t)}int64(e){let t=Wo.enc(e);return Mo(t.lo,t.hi,this.buf),this}sint64(e){let t=Wo.enc(e),n=t.hi>>31;return Mo(t.lo<<1^n,(t.hi<<1|t.lo>>>31)^n,this.buf),this}uint64(e){let t=Wo.uEnc(e);return Mo(t.lo,t.hi,this.buf),this}}class Zo{constructor(e,t){this.varint64=Lo,this.uint32=Ho,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=null!==t&&void 0!==t?t:new TextDecoder}tag(){let e=this.uint32(),t=e>>>3,n=7&e;if(t<=0||n<0||n>5)throw new Error("illegal tag: field no "+t+" wire type "+n);return[t,n]}skip(e,t){let n=this.pos;switch(e){case Jo.Varint:for(;128&this.buf[this.pos++];);break;case Jo.Bit64:this.pos+=4;case Jo.Bit32:this.pos+=4;break;case Jo.LengthDelimited:let n=this.uint32();this.pos+=n;break;case Jo.StartGroup:for(;;){const[e,n]=this.tag();if(n===Jo.EndGroup){if(void 0!==t&&e!==t)throw new Error("invalid end group tag");break}this.skip(n,e)}break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return 0|this.uint32()}sint32(){let e=this.uint32();return e>>>1^-(1&e)}int64(){return Wo.dec(...this.varint64())}uint64(){return Wo.uDec(...this.varint64())}sint64(){let[e,t]=this.varint64(),n=-(1&e);return e=(e>>>1|(1&t)<<31)^n,t=t>>>1^n,Wo.dec(e,t)}bool(){let[e,t]=this.varint64();return 0!==e||0!==t}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return Wo.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return Wo.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),t=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(t,t+e)}string(){return this.textDecoder.decode(this.bytes())}}function ea(e){const t=e.field.localName,n=Object.create(null);return n[t]=function(e){const t=e.field;if(t.repeated)return[];if(void 0!==t.default)return t.default;switch(t.kind){case"enum":return t.T.values[0].no;case"scalar":return $o(t.T,t.L);case"message":const e=t.T,n=new e;return e.fieldWrapper?e.fieldWrapper.unwrapField(n):n;case"map":throw"map fields are not allowed to be extensions"}}(e),[n,()=>n[t]]}let ta="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),na=[];for(let If=0;If<ta.length;If++)na[ta[If].charCodeAt(0)]=If;na["-".charCodeAt(0)]=ta.indexOf("+"),na["_".charCodeAt(0)]=ta.indexOf("/");const ia={dec(e){let t=3*e.length/4;"="==e[e.length-2]?t-=2:"="==e[e.length-1]&&(t-=1);let n,i=new Uint8Array(t),r=0,o=0,a=0;for(let s=0;s<e.length;s++){if(n=na[e.charCodeAt(s)],void 0===n)switch(e[s]){case"=":o=0;case"\n":case"\r":case"\t":case" ":continue;default:throw Error("invalid base64 string.")}switch(o){case 0:a=n,o=1;break;case 1:i[r++]=a<<2|(48&n)>>4,a=n,o=2;break;case 2:i[r++]=(15&a)<<4|(60&n)>>2,a=n,o=3;break;case 3:i[r++]=(3&a)<<6|n,o=0}}if(1==o)throw Error("invalid base64 string.");return i.subarray(0,r)},enc(e){let t,n="",i=0,r=0;for(let o=0;o<e.length;o++)switch(t=e[o],i){case 0:n+=ta[t>>2],r=(3&t)<<4,i=1;break;case 1:n+=ta[r|t>>4],r=(15&t)<<2,i=2;break;case 2:n+=ta[r|t>>6],n+=ta[63&t],i=0}return i&&(n+=ta[r],n+="=",1==i&&(n+="=")),n}};function ra(e,t,n){sa(t,e);const i=t.runtime.bin.makeReadOptions(n),r=function(e,t){if(!t.repeated&&("enum"==t.kind||"scalar"==t.kind)){for(let n=e.length-1;n>=0;--n)if(e[n].no==t.no)return[e[n]];return[]}return e.filter(e=>e.no===t.no)}(e.getType().runtime.bin.listUnknownFields(e),t.field),[o,a]=ea(t);for(const s of r)t.runtime.bin.readField(o,i.readerFactory(s.data),t.field,s.wireType,i);return a()}function oa(e,t,n,i){sa(t,e);const r=t.runtime.bin.makeReadOptions(i),o=t.runtime.bin.makeWriteOptions(i);if(aa(e,t)){const n=e.getType().runtime.bin.listUnknownFields(e).filter(e=>e.no!=t.field.no);e.getType().runtime.bin.discardUnknownFields(e);for(const t of n)e.getType().runtime.bin.onUnknownField(e,t.no,t.wireType,t.data)}const a=o.writerFactory();let s=t.field;s.opt||s.repeated||"enum"!=s.kind&&"scalar"!=s.kind||(s=Object.assign(Object.assign({},t.field),{opt:!0})),t.runtime.bin.writeField(s,n,a,o);const c=r.readerFactory(a.finish());for(;c.pos<c.len;){const[t,n]=c.tag(),i=c.skip(n,t);e.getType().runtime.bin.onUnknownField(e,t,n,i)}}function aa(e,t){const n=e.getType();return t.extendee.typeName===n.typeName&&!!n.runtime.bin.listUnknownFields(e).find(e=>e.no==t.field.no)}function sa(e,t){Co(e.extendee.typeName==t.getType().typeName,"extension ".concat(e.typeName," can only be applied to message ").concat(e.extendee.typeName))}function ca(e,t){const n=e.localName;if(e.repeated)return t[n].length>0;if(e.oneof)return t[e.oneof.localName].case===n;switch(e.kind){case"enum":case"scalar":return e.opt||e.req?void 0!==t[n]:"enum"==e.kind?t[n]!==e.T.values[0].no:!Yo(e.T,t[n]);case"message":return void 0!==t[n];case"map":return Object.keys(t[n]).length>0}}function la(e,t){const n=e.localName,i=!e.opt&&!e.req;if(e.repeated)t[n]=[];else if(e.oneof)t[e.oneof.localName]={case:void 0};else switch(e.kind){case"map":t[n]={};break;case"enum":t[n]=i?e.T.values[0].no:void 0;break;case"scalar":t[n]=i?$o(e.T,e.L):void 0;break;case"message":t[n]=void 0}}function ua(e,t){if(null===e||"object"!=typeof e)return!1;if(!Object.getOwnPropertyNames(Do.prototype).every(t=>t in e&&"function"==typeof e[t]))return!1;const n=e.getType();return null!==n&&"function"==typeof n&&"typeName"in n&&"string"==typeof n.typeName&&(void 0===t||n.typeName==t.typeName)}function da(e,t){return ua(t)||!e.fieldWrapper?t:e.fieldWrapper.wrapField(t)}Ko.DOUBLE,Ko.FLOAT,Ko.INT64,Ko.UINT64,Ko.INT32,Ko.UINT32,Ko.BOOL,Ko.STRING,Ko.BYTES;const ha={ignoreUnknownFields:!1},pa={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function fa(e){return e?Object.assign(Object.assign({},ha),e):ha}function ma(e){return e?Object.assign(Object.assign({},pa),e):pa}const ga=Symbol(),va=Symbol();function ya(e){if(null===e)return"null";switch(typeof e){case"object":return Array.isArray(e)?"array":"object";case"string":return e.length>100?"string":'"'.concat(e.split('"').join('\\"'),'"');default:return String(e)}}function ba(e,t,n,i,r){let o=n.localName;if(n.repeated){if(Co("map"!=n.kind),null===t)return;if(!Array.isArray(t))throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ya(t)));const a=e[o];for(const e of t){if(null===e)throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ya(e)));switch(n.kind){case"message":a.push(n.T.fromJson(e,i));break;case"enum":const t=wa(n.T,e,i.ignoreUnknownFields,!0);t!==va&&a.push(t);break;case"scalar":try{a.push(Sa(n.T,e,n.L,!0))}catch(So){let i="cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ya(e));throw So instanceof Error&&So.message.length>0&&(i+=": ".concat(So.message)),new Error(i)}}}}else if("map"==n.kind){if(null===t)return;if("object"!=typeof t||Array.isArray(t))throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ya(t)));const a=e[o];for(const[e,o]of Object.entries(t)){if(null===o)throw new Error("cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: map value null"));let s;try{s=ka(n.K,e)}catch(So){let i="cannot decode map key for field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ya(t));throw So instanceof Error&&So.message.length>0&&(i+=": ".concat(So.message)),new Error(i)}switch(n.V.kind){case"message":a[s]=n.V.T.fromJson(o,i);break;case"enum":const e=wa(n.V.T,o,i.ignoreUnknownFields,!0);e!==va&&(a[s]=e);break;case"scalar":try{a[s]=Sa(n.V.T,o,Go.BIGINT,!0)}catch(So){let i="cannot decode map value for field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ya(t));throw So instanceof Error&&So.message.length>0&&(i+=": ".concat(So.message)),new Error(i)}}}}else switch(n.oneof&&(e=e[n.oneof.localName]={case:o},o="value"),n.kind){case"message":const a=n.T;if(null===t&&"google.protobuf.Value"!=a.typeName)return;let s=e[o];ua(s)?s.fromJson(t,i):(e[o]=s=a.fromJson(t,i),a.fieldWrapper&&!n.oneof&&(e[o]=a.fieldWrapper.unwrapField(s)));break;case"enum":const c=wa(n.T,t,i.ignoreUnknownFields,!1);switch(c){case ga:la(n,e);break;case va:break;default:e[o]=c}break;case"scalar":try{const i=Sa(n.T,t,n.L,!1);if(i===ga)la(n,e);else e[o]=i}catch(So){let i="cannot decode field ".concat(r.typeName,".").concat(n.name," from JSON: ").concat(ya(t));throw So instanceof Error&&So.message.length>0&&(i+=": ".concat(So.message)),new Error(i)}}}function ka(e,t){if(e===Ko.BOOL)switch(t){case"true":t=!0;break;case"false":t=!1}return Sa(e,t,Go.BIGINT,!0).toString()}function Sa(e,t,n,i){if(null===t)return i?$o(e,n):ga;switch(e){case Ko.DOUBLE:case Ko.FLOAT:if("NaN"===t)return Number.NaN;if("Infinity"===t)return Number.POSITIVE_INFINITY;if("-Infinity"===t)return Number.NEGATIVE_INFINITY;if(""===t)break;if("string"==typeof t&&t.trim().length!==t.length)break;if("string"!=typeof t&&"number"!=typeof t)break;const i=Number(t);if(Number.isNaN(i))break;if(!Number.isFinite(i))break;return e==Ko.FLOAT&&Ro(i),i;case Ko.INT32:case Ko.FIXED32:case Ko.SFIXED32:case Ko.SINT32:case Ko.UINT32:let r;if("number"==typeof t?r=t:"string"==typeof t&&t.length>0&&t.trim().length===t.length&&(r=Number(t)),void 0===r)break;return e==Ko.UINT32||e==Ko.FIXED32?Po(r):Eo(r),r;case Ko.INT64:case Ko.SFIXED64:case Ko.SINT64:if("number"!=typeof t&&"string"!=typeof t)break;const o=Wo.parse(t);return n?o.toString():o;case Ko.FIXED64:case Ko.UINT64:if("number"!=typeof t&&"string"!=typeof t)break;const a=Wo.uParse(t);return n?a.toString():a;case Ko.BOOL:if("boolean"!==typeof t)break;return t;case Ko.STRING:if("string"!==typeof t)break;try{encodeURIComponent(t)}catch(So){throw new Error("invalid UTF8")}return t;case Ko.BYTES:if(""===t)return new Uint8Array(0);if("string"!==typeof t)break;return ia.dec(t)}throw new Error}function wa(e,t,n,i){if(null===t)return"google.protobuf.NullValue"==e.typeName?0:i?e.values[0].no:ga;switch(typeof t){case"number":if(Number.isInteger(t))return t;break;case"string":const i=e.findName(t);if(void 0!==i)return i.no;if(n)return va}throw new Error("cannot decode enum ".concat(e.typeName," from JSON: ").concat(ya(t)))}function Ta(e){return!(!e.repeated&&"map"!=e.kind)||!e.oneof&&("message"!=e.kind&&(!e.opt&&!e.req))}function Ca(e,t,n){if("map"==e.kind){Co("object"==typeof t&&null!=t);const i={},r=Object.entries(t);switch(e.V.kind){case"scalar":for(const[n,o]of r)i[n.toString()]=Pa(e.V.T,o);break;case"message":for(const[e,o]of r)i[e.toString()]=o.toJson(n);break;case"enum":const t=e.V.T;for(const[e,o]of r)i[e.toString()]=Ea(t,o,n.enumAsInteger)}return n.emitDefaultValues||r.length>0?i:void 0}if(e.repeated){Co(Array.isArray(t));const i=[];switch(e.kind){case"scalar":for(let n=0;n<t.length;n++)i.push(Pa(e.T,t[n]));break;case"enum":for(let r=0;r<t.length;r++)i.push(Ea(e.T,t[r],n.enumAsInteger));break;case"message":for(let e=0;e<t.length;e++)i.push(t[e].toJson(n))}return n.emitDefaultValues||i.length>0?i:void 0}switch(e.kind){case"scalar":return Pa(e.T,t);case"enum":return Ea(e.T,t,n.enumAsInteger);case"message":return da(e.T,t).toJson(n)}}function Ea(e,t,n){var i;if(Co("number"==typeof t),"google.protobuf.NullValue"==e.typeName)return null;if(n)return t;const r=e.findNumber(t);return null!==(i=null===r||void 0===r?void 0:r.name)&&void 0!==i?i:t}function Pa(e,t){switch(e){case Ko.INT32:case Ko.SFIXED32:case Ko.SINT32:case Ko.FIXED32:case Ko.UINT32:return Co("number"==typeof t),t;case Ko.FLOAT:case Ko.DOUBLE:return Co("number"==typeof t),Number.isNaN(t)?"NaN":t===Number.POSITIVE_INFINITY?"Infinity":t===Number.NEGATIVE_INFINITY?"-Infinity":t;case Ko.STRING:return Co("string"==typeof t),t;case Ko.BOOL:return Co("boolean"==typeof t),t;case Ko.UINT64:case Ko.FIXED64:case Ko.INT64:case Ko.SFIXED64:case Ko.SINT64:return Co("bigint"==typeof t||"string"==typeof t||"number"==typeof t),t.toString();case Ko.BYTES:return Co(t instanceof Uint8Array),ia.enc(t)}}const Ra=Symbol("@bufbuild/protobuf/unknown-fields"),_a={readUnknownFields:!0,readerFactory:e=>new Zo(e)},Oa={writeUnknownFields:!0,writerFactory:()=>new Xo};function xa(e){return e?Object.assign(Object.assign({},_a),e):_a}function Ia(e){return e?Object.assign(Object.assign({},Oa),e):Oa}function Na(e,t,n,i,r){let{repeated:o,localName:a}=n;switch(n.oneof&&((e=e[n.oneof.localName]).case!=a&&delete e.value,e.case=a,a="value"),n.kind){case"scalar":case"enum":const s="enum"==n.kind?Ko.INT32:n.T;let c=La;if("scalar"==n.kind&&n.L>0&&(c=Da),o){let n=e[a];if(i==Jo.LengthDelimited&&s!=Ko.STRING&&s!=Ko.BYTES){let e=t.uint32()+t.pos;for(;t.pos<e;)n.push(c(t,s))}else n.push(c(t,s))}else e[a]=c(t,s);break;case"message":const l=n.T;o?e[a].push(Aa(t,new l,r,n)):ua(e[a])?Aa(t,e[a],r,n):(e[a]=Aa(t,new l,r,n),!l.fieldWrapper||n.oneof||n.repeated||(e[a]=l.fieldWrapper.unwrapField(e[a])));break;case"map":let[u,d]=function(e,t,n){const i=t.uint32(),r=t.pos+i;let o,a;for(;t.pos<r;){const[i]=t.tag();switch(i){case 1:o=La(t,e.K);break;case 2:switch(e.V.kind){case"scalar":a=La(t,e.V.T);break;case"enum":a=t.int32();break;case"message":a=Aa(t,new e.V.T,n,void 0)}}}void 0===o&&(o=$o(e.K,Go.BIGINT));"string"!=typeof o&&"number"!=typeof o&&(o=o.toString());if(void 0===a)switch(e.V.kind){case"scalar":a=$o(e.V.T,Go.BIGINT);break;case"enum":a=e.V.T.values[0].no;break;case"message":a=new e.V.T}return[o,a]}(n,t,r);e[a][u]=d}}function Aa(e,t,n,i){const r=t.getType().runtime.bin,o=null===i||void 0===i?void 0:i.delimited;return r.readMessage(t,e,o?i.no:e.uint32(),n,o),t}function Da(e,t){const n=La(e,t);return"bigint"==typeof n?n.toString():n}function La(e,t){switch(t){case Ko.STRING:return e.string();case Ko.BOOL:return e.bool();case Ko.DOUBLE:return e.double();case Ko.FLOAT:return e.float();case Ko.INT32:return e.int32();case Ko.INT64:return e.int64();case Ko.UINT64:return e.uint64();case Ko.FIXED64:return e.fixed64();case Ko.BYTES:return e.bytes();case Ko.FIXED32:return e.fixed32();case Ko.SFIXED32:return e.sfixed32();case Ko.SFIXED64:return e.sfixed64();case Ko.SINT64:return e.sint64();case Ko.UINT32:return e.uint32();case Ko.SINT32:return e.sint32()}}function Ma(e,t,n,i){Co(void 0!==t);const r=e.repeated;switch(e.kind){case"scalar":case"enum":let o="enum"==e.kind?Ko.INT32:e.T;if(r)if(Co(Array.isArray(t)),e.packed)!function(e,t,n,i){if(!i.length)return;e.tag(n,Jo.LengthDelimited).fork();let[,r]=Ba(t);for(let o=0;o<i.length;o++)e[r](i[o]);e.join()}(n,o,e.no,t);else for(const i of t)Fa(n,o,e.no,i);else Fa(n,o,e.no,t);break;case"message":if(r){Co(Array.isArray(t));for(const r of t)Ua(n,i,e,r)}else Ua(n,i,e,t);break;case"map":Co("object"==typeof t&&null!=t);for(const[r,a]of Object.entries(t))ja(n,i,e,r,a)}}function ja(e,t,n,i,r){e.tag(n.no,Jo.LengthDelimited),e.fork();let o=i;switch(n.K){case Ko.INT32:case Ko.FIXED32:case Ko.UINT32:case Ko.SFIXED32:case Ko.SINT32:o=Number.parseInt(i);break;case Ko.BOOL:Co("true"==i||"false"==i),o="true"==i}switch(Fa(e,n.K,1,o),n.V.kind){case"scalar":Fa(e,n.V.T,2,r);break;case"enum":Fa(e,Ko.INT32,2,r);break;case"message":Co(void 0!==r),e.tag(2,Jo.LengthDelimited).bytes(r.toBinary(t))}e.join()}function Ua(e,t,n,i){const r=da(n.T,i);n.delimited?e.tag(n.no,Jo.StartGroup).raw(r.toBinary(t)).tag(n.no,Jo.EndGroup):e.tag(n.no,Jo.LengthDelimited).bytes(r.toBinary(t))}function Fa(e,t,n,i){Co(void 0!==i);let[r,o]=Ba(t);e.tag(n,r)[o](i)}function Ba(e){let t=Jo.Varint;switch(e){case Ko.BYTES:case Ko.STRING:t=Jo.LengthDelimited;break;case Ko.DOUBLE:case Ko.FIXED64:case Ko.SFIXED64:t=Jo.Bit64;break;case Ko.FIXED32:case Ko.SFIXED32:case Ko.FLOAT:t=Jo.Bit32}return[t,Ko[e].toLowerCase()]}function za(e){if(void 0===e)return e;if(ua(e))return e.clone();if(e instanceof Uint8Array){const t=new Uint8Array(e.byteLength);return t.set(e),t}return e}function qa(e){return e instanceof Uint8Array?e:new Uint8Array(e)}class Va{constructor(e,t){this._fields=e,this._normalizer=t}findJsonName(e){if(!this.jsonNames){const e={};for(const t of this.list())e[t.jsonName]=e[t.name]=t;this.jsonNames=e}return this.jsonNames[e]}find(e){if(!this.numbers){const e={};for(const t of this.list())e[t.no]=t;this.numbers=e}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,t)=>e.no-t.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let t;for(const n of this.list())n.oneof?n.oneof!==t&&(t=n.oneof,e.push(t)):e.push(n)}return this.members}}function Ha(e,t){const n=Ka(e);return t?n:Ya($a(n))}const Wa=Ka;function Ka(e){let t=!1;const n=[];for(let i=0;i<e.length;i++){let r=e.charAt(i);switch(r){case"_":t=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(r),t=!1;break;default:t&&(t=!1,r=r.toUpperCase()),n.push(r)}}return n.join("")}const Ga=new Set(["constructor","toString","toJSON","valueOf"]),Ja=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),Qa=e=>"".concat(e,"$"),$a=e=>Ja.has(e)?Qa(e):e,Ya=e=>Ga.has(e)?Qa(e):e;class Xa{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.req=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=Ha(e,!1)}addField(e){Co(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let e=0;e<this.fields.length;e++)this._lookup[this.fields[e].localName]=this.fields[e]}return this._lookup[e]}}const Za=(es=e=>new Va(e,e=>function(e){var t,n,i,r,o,a;const s=[];let c;for(const l of"function"==typeof e?e():e){const e=l;if(e.localName=Ha(l.name,void 0!==l.oneof),e.jsonName=null!==(t=l.jsonName)&&void 0!==t?t:Wa(l.name),e.repeated=null!==(n=l.repeated)&&void 0!==n&&n,"scalar"==l.kind&&(e.L=null!==(i=l.L)&&void 0!==i?i:Go.BIGINT),e.delimited=null!==(r=l.delimited)&&void 0!==r&&r,e.req=null!==(o=l.req)&&void 0!==o&&o,e.opt=null!==(a=l.opt)&&void 0!==a&&a,void 0===l.packed&&(e.packed="enum"==l.kind||"scalar"==l.kind&&l.T!=Ko.BYTES&&l.T!=Ko.STRING),void 0!==l.oneof){const t="string"==typeof l.oneof?l.oneof:l.oneof.name;c&&c.name==t||(c=new Xa(t)),e.oneof=c,c.addField(e)}s.push(e)}return s}(e)),ts=e=>{for(const t of e.getType().fields.byMember()){if(t.opt)continue;const n=t.localName,i=e;if(t.repeated)i[n]=[];else switch(t.kind){case"oneof":i[n]={case:void 0};break;case"enum":i[n]=0;break;case"map":i[n]={};break;case"scalar":i[n]=$o(t.T,t.L)}}},{syntax:"proto3",json:{makeReadOptions:fa,makeWriteOptions:ma,readMessage(e,t,n,i){if(null==t||Array.isArray(t)||"object"!=typeof t)throw new Error("cannot decode message ".concat(e.typeName," from JSON: ").concat(ya(t)));i=null!==i&&void 0!==i?i:new e;const r=new Map,o=n.typeRegistry;for(const[a,s]of Object.entries(t)){const t=e.fields.findJsonName(a);if(t){if(t.oneof){if(null===s&&"scalar"==t.kind)continue;const n=r.get(t.oneof);if(void 0!==n)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: multiple keys for oneof "').concat(t.oneof.name,'" present: "').concat(n,'", "').concat(a,'"'));r.set(t.oneof,a)}ba(i,s,t,n,e)}else{let t=!1;if((null===o||void 0===o?void 0:o.findExtension)&&a.startsWith("[")&&a.endsWith("]")){const r=o.findExtension(a.substring(1,a.length-1));if(r&&r.extendee.typeName==e.typeName){t=!0;const[e,o]=ea(r);ba(e,s,r.field,n,r),oa(i,r,o(),n)}}if(!t&&!n.ignoreUnknownFields)throw new Error("cannot decode message ".concat(e.typeName,' from JSON: key "').concat(a,'" is unknown'))}}return i},writeMessage(e,t){const n=e.getType(),i={};let r;try{for(r of n.fields.byNumber()){if(!ca(r,e)){if(r.req)throw"required field not set";if(!t.emitDefaultValues)continue;if(!Ta(r))continue}const n=Ca(r,r.oneof?e[r.oneof.localName].value:e[r.localName],t);void 0!==n&&(i[t.useProtoFieldName?r.name:r.jsonName]=n)}const o=t.typeRegistry;if(null===o||void 0===o?void 0:o.findExtensionFor)for(const r of n.runtime.bin.listUnknownFields(e)){const a=o.findExtensionFor(n.typeName,r.no);if(a&&aa(e,a)){const n=ra(e,a,t),r=Ca(a.field,n,t);void 0!==r&&(i[a.field.jsonName]=r)}}}catch(So){const t=r?"cannot encode field ".concat(n.typeName,".").concat(r.name," to JSON"):"cannot encode message ".concat(n.typeName," to JSON"),i=So instanceof Error?So.message:String(So);throw new Error(t+(i.length>0?": ".concat(i):""))}return i},readScalar:(e,t,n)=>Sa(e,t,null!==n&&void 0!==n?n:Go.BIGINT,!0),writeScalar(e,t,n){if(void 0!==t)return n||Yo(e,t)?Pa(e,t):void 0},debug:ya},bin:{makeReadOptions:xa,makeWriteOptions:Ia,listUnknownFields(e){var t;return null!==(t=e[Ra])&&void 0!==t?t:[]},discardUnknownFields(e){delete e[Ra]},writeUnknownFields(e,t){const n=e[Ra];if(n)for(const i of n)t.tag(i.no,i.wireType).raw(i.data)},onUnknownField(e,t,n,i){const r=e;Array.isArray(r[Ra])||(r[Ra]=[]),r[Ra].push({no:t,wireType:n,data:i})},readMessage(e,t,n,i,r){const o=e.getType(),a=r?t.len:t.pos+n;let s,c;for(;t.pos<a&&([s,c]=t.tag(),!0!==r||c!=Jo.EndGroup);){const n=o.fields.find(s);if(!n){const n=t.skip(c,s);i.readUnknownFields&&this.onUnknownField(e,s,c,n);continue}Na(e,t,n,c,i)}if(r&&(c!=Jo.EndGroup||s!==n))throw new Error("invalid end group tag")},readField:Na,writeMessage(e,t,n){const i=e.getType();for(const r of i.fields.byNumber())if(ca(r,e))Ma(r,r.oneof?e[r.oneof.localName].value:e[r.localName],t,n);else if(r.req)throw new Error("cannot encode field ".concat(i.typeName,".").concat(r.name," to binary: required field not set"));return n.writeUnknownFields&&this.writeUnknownFields(e,t),t},writeField(e,t,n,i){void 0!==t&&Ma(e,t,n,i)}},util:Object.assign(Object.assign({},{setEnumType:xo,initPartial(e,t){if(void 0===e)return;const n=t.getType();for(const i of n.fields.byMember()){const n=i.localName,r=t,o=e;if(null!=o[n])switch(i.kind){case"oneof":const e=o[n].case;if(void 0===e)continue;const t=i.findField(e);let a=o[n].value;t&&"message"==t.kind&&!ua(a,t.T)?a=new t.T(a):t&&"scalar"===t.kind&&t.T===Ko.BYTES&&(a=qa(a)),r[n]={case:e,value:a};break;case"scalar":case"enum":let s=o[n];i.T===Ko.BYTES&&(s=i.repeated?s.map(qa):qa(s)),r[n]=s;break;case"map":switch(i.V.kind){case"scalar":case"enum":if(i.V.T===Ko.BYTES)for(const[t,i]of Object.entries(o[n]))r[n][t]=qa(i);else Object.assign(r[n],o[n]);break;case"message":const e=i.V.T;for(const t of Object.keys(o[n])){let i=o[n][t];e.fieldWrapper||(i=new e(i)),r[n][t]=i}}break;case"message":const c=i.T;if(i.repeated)r[n]=o[n].map(e=>ua(e,c)?e:new c(e));else{const e=o[n];c.fieldWrapper?"google.protobuf.BytesValue"===c.typeName?r[n]=qa(e):r[n]=e:r[n]=ua(e,c)?e:new c(e)}}}},equals:(e,t,n)=>t===n||!(!t||!n)&&e.fields.byMember().every(e=>{const i=t[e.localName],r=n[e.localName];if(e.repeated){if(i.length!==r.length)return!1;switch(e.kind){case"message":return i.every((t,n)=>e.T.equals(t,r[n]));case"scalar":return i.every((t,n)=>Qo(e.T,t,r[n]));case"enum":return i.every((e,t)=>Qo(Ko.INT32,e,r[t]))}throw new Error("repeated cannot contain ".concat(e.kind))}switch(e.kind){case"message":let t=i,n=r;return e.T.fieldWrapper&&(void 0===t||ua(t)||(t=e.T.fieldWrapper.wrapField(t)),void 0===n||ua(n)||(n=e.T.fieldWrapper.wrapField(n))),e.T.equals(t,n);case"enum":return Qo(Ko.INT32,i,r);case"scalar":return Qo(e.T,i,r);case"oneof":if(i.case!==r.case)return!1;const o=e.findField(i.case);if(void 0===o)return!0;switch(o.kind){case"message":return o.T.equals(i.value,r.value);case"enum":return Qo(Ko.INT32,i.value,r.value);case"scalar":return Qo(o.T,i.value,r.value)}throw new Error("oneof cannot contain ".concat(o.kind));case"map":const a=Object.keys(i).concat(Object.keys(r));switch(e.V.kind){case"message":const t=e.V.T;return a.every(e=>t.equals(i[e],r[e]));case"enum":return a.every(e=>Qo(Ko.INT32,i[e],r[e]));case"scalar":const n=e.V.T;return a.every(e=>Qo(n,i[e],r[e]))}}}),clone(e){const t=e.getType(),n=new t,i=n;for(const r of t.fields.byMember()){const t=e[r.localName];let n;if(r.repeated)n=t.map(za);else if("map"==r.kind){n=i[r.localName];for(const[e,i]of Object.entries(t))n[e]=za(i)}else n="oneof"==r.kind?r.findField(t.case)?{case:t.case,value:za(t.value)}:{case:void 0}:za(t);i[r.localName]=n}for(const r of t.runtime.bin.listUnknownFields(e))t.runtime.bin.onUnknownField(i,r.no,r.wireType,r.data);return n}}),{newFieldList:es,initFields:ts}),makeMessageType(e,t,n){return function(e,t,n,i){var r;const o=null!==(r=null===i||void 0===i?void 0:i.localName)&&void 0!==r?r:t.substring(t.lastIndexOf(".")+1),a={[o]:function(t){e.util.initFields(this),e.util.initPartial(t,this)}}[o];return Object.setPrototypeOf(a.prototype,new Do),Object.assign(a,{runtime:e,typeName:t,fields:e.util.newFieldList(n),fromBinary:(e,t)=>(new a).fromBinary(e,t),fromJson:(e,t)=>(new a).fromJson(e,t),fromJsonString:(e,t)=>(new a).fromJsonString(e,t),equals:(t,n)=>e.util.equals(a,t,n)}),a}(this,e,t,n)},makeEnum:No,makeEnumType:Io,getEnumType:Oo,makeExtension(e,t,n){return function(e,t,n,i){let r;return{typeName:t,extendee:n,get field(){if(!r){const n="function"==typeof i?i():i;n.name=t.split(".").pop(),n.jsonName="[".concat(t,"]"),r=e.util.newFieldList([n]).list()[0]}return r},runtime:e}}(this,e,t,n)}});var es,ts;class ns extends Do{constructor(e){super(),this.seconds=Wo.zero,this.nanos=0,Za.util.initPartial(e,this)}fromJson(e,t){if("string"!==typeof e)throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(Za.json.debug(e)));const n=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!n)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const i=Date.parse(n[1]+"-"+n[2]+"-"+n[3]+"T"+n[4]+":"+n[5]+":"+n[6]+(n[8]?n[8]:"Z"));if(Number.isNaN(i))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(i<Date.parse("0001-01-01T00:00:00Z")||i>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=Wo.parse(i/1e3),this.nanos=0,n[7]&&(this.nanos=parseInt("1"+n[7]+"0".repeat(9-n[7].length))-1e9),this}toJson(e){const t=1e3*Number(this.seconds);if(t<Date.parse("0001-01-01T00:00:00Z")||t>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let n="Z";if(this.nanos>0){const e=(this.nanos+1e9).toString().substring(1);n="000000"===e.substring(3)?"."+e.substring(0,3)+"Z":"000"===e.substring(6)?"."+e.substring(0,6)+"Z":"."+e+"Z"}return new Date(t).toISOString().replace(".000Z",n)}toDate(){return new Date(1e3*Number(this.seconds)+Math.ceil(this.nanos/1e6))}static now(){return ns.fromDate(new Date)}static fromDate(e){const t=e.getTime();return new ns({seconds:Wo.parse(Math.floor(t/1e3)),nanos:t%1e3*1e6})}static fromBinary(e,t){return(new ns).fromBinary(e,t)}static fromJson(e,t){return(new ns).fromJson(e,t)}static fromJsonString(e,t){return(new ns).fromJsonString(e,t)}static equals(e,t){return Za.util.equals(ns,e,t)}}ns.runtime=Za,ns.typeName="google.protobuf.Timestamp",ns.fields=Za.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);const is=Za.makeMessageType("livekit.MetricsBatch",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ns},{no:3,name:"str_data",kind:"scalar",T:9,repeated:!0},{no:4,name:"time_series",kind:"message",T:rs,repeated:!0},{no:5,name:"events",kind:"message",T:as,repeated:!0}]),rs=Za.makeMessageType("livekit.TimeSeriesMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"samples",kind:"message",T:os,repeated:!0},{no:5,name:"rid",kind:"scalar",T:13}]),os=Za.makeMessageType("livekit.MetricSample",()=>[{no:1,name:"timestamp_ms",kind:"scalar",T:3},{no:2,name:"normalized_timestamp",kind:"message",T:ns},{no:3,name:"value",kind:"scalar",T:2}]),as=Za.makeMessageType("livekit.EventMetric",()=>[{no:1,name:"label",kind:"scalar",T:13},{no:2,name:"participant_identity",kind:"scalar",T:13},{no:3,name:"track_sid",kind:"scalar",T:13},{no:4,name:"start_timestamp_ms",kind:"scalar",T:3},{no:5,name:"end_timestamp_ms",kind:"scalar",T:3,opt:!0},{no:6,name:"normalized_start_timestamp",kind:"message",T:ns},{no:7,name:"normalized_end_timestamp",kind:"message",T:ns,opt:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"rid",kind:"scalar",T:13}]),ss=Za.makeEnum("livekit.BackupCodecPolicy",[{no:0,name:"PREFER_REGRESSION"},{no:1,name:"SIMULCAST"},{no:2,name:"REGRESSION"}]),cs=Za.makeEnum("livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]),ls=Za.makeEnum("livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]),us=Za.makeEnum("livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]),ds=Za.makeEnum("livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]),hs=Za.makeEnum("livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]),ps=Za.makeEnum("livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"},{no:8,name:"MIGRATION"},{no:9,name:"SIGNAL_CLOSE"},{no:10,name:"ROOM_CLOSED"},{no:11,name:"USER_UNAVAILABLE"},{no:12,name:"USER_REJECTED"},{no:13,name:"SIP_TRUNK_FAILURE"},{no:14,name:"CONNECTION_TIMEOUT"},{no:15,name:"MEDIA_FAILURE"}]),fs=Za.makeEnum("livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]),ms=Za.makeEnum("livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]),gs=Za.makeEnum("livekit.AudioTrackFeature",[{no:0,name:"TF_STEREO"},{no:1,name:"TF_NO_DTX"},{no:2,name:"TF_AUTO_GAIN_CONTROL"},{no:3,name:"TF_ECHO_CANCELLATION"},{no:4,name:"TF_NOISE_SUPPRESSION"},{no:5,name:"TF_ENHANCED_NOISE_CANCELLATION"},{no:6,name:"TF_PRECONNECT_BUFFER"}]),vs=Za.makeMessageType("livekit.Room",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:14,name:"departure_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:15,name:"creation_time_ms",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:ys,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8},{no:13,name:"version",kind:"message",T:Xs}]),ys=Za.makeMessageType("livekit.Codec",()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]),bs=Za.makeMessageType("livekit.ParticipantPermission",()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:Za.getEnumType(ls),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8},{no:12,name:"can_subscribe_metrics",kind:"scalar",T:8}]),ks=Za.makeMessageType("livekit.ParticipantInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:Za.getEnumType(Ss)},{no:4,name:"tracks",kind:"message",T:Ps,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:17,name:"joined_at_ms",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:bs},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8},{no:14,name:"kind",kind:"enum",T:Za.getEnumType(ws)},{no:15,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:16,name:"disconnect_reason",kind:"enum",T:Za.getEnumType(ps)},{no:18,name:"kind_details",kind:"enum",T:Za.getEnumType(Ts),repeated:!0}]),Ss=Za.makeEnum("livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]),ws=Za.makeEnum("livekit.ParticipantInfo.Kind",[{no:0,name:"STANDARD"},{no:1,name:"INGRESS"},{no:2,name:"EGRESS"},{no:3,name:"SIP"},{no:4,name:"AGENT"},{no:7,name:"CONNECTOR"}]),Ts=Za.makeEnum("livekit.ParticipantInfo.KindDetail",[{no:0,name:"CLOUD_AGENT"},{no:1,name:"FORWARDED"}]),Cs=Za.makeEnum("livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]),Es=Za.makeMessageType("livekit.SimulcastCodecInfo",()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Rs,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:Za.getEnumType(_s)},{no:6,name:"sdp_cid",kind:"scalar",T:9}]),Ps=Za.makeMessageType("livekit.TrackInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:Za.getEnumType(cs)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:Za.getEnumType(ls)},{no:10,name:"layers",kind:"message",T:Rs,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:Es,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:Za.getEnumType(Cs)},{no:17,name:"stream",kind:"scalar",T:9},{no:18,name:"version",kind:"message",T:Xs},{no:19,name:"audio_features",kind:"enum",T:Za.getEnumType(gs),repeated:!0},{no:20,name:"backup_codec_policy",kind:"enum",T:Za.getEnumType(ss)}]),Rs=Za.makeMessageType("livekit.VideoLayer",()=>[{no:1,name:"quality",kind:"enum",T:Za.getEnumType(us)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13},{no:6,name:"spatial_layer",kind:"scalar",T:5},{no:7,name:"rid",kind:"scalar",T:9}]),_s=Za.makeEnum("livekit.VideoLayer.Mode",[{no:0,name:"MODE_UNUSED"},{no:1,name:"ONE_SPATIAL_LAYER_PER_STREAM"},{no:2,name:"MULTIPLE_SPATIAL_LAYERS_PER_STREAM"},{no:3,name:"ONE_SPATIAL_LAYER_PER_STREAM_INCOMPLETE_RTCP_SR"}]),Os=Za.makeMessageType("livekit.DataPacket",()=>[{no:1,name:"kind",kind:"enum",T:Za.getEnumType(xs)},{no:4,name:"participant_identity",kind:"scalar",T:9},{no:5,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:2,name:"user",kind:"message",T:Ls,oneof:"value"},{no:3,name:"speaker",kind:"message",T:As,oneof:"value"},{no:6,name:"sip_dtmf",kind:"message",T:Ms,oneof:"value"},{no:7,name:"transcription",kind:"message",T:js,oneof:"value"},{no:8,name:"metrics",kind:"message",T:is,oneof:"value"},{no:9,name:"chat_message",kind:"message",T:Fs,oneof:"value"},{no:10,name:"rpc_request",kind:"message",T:Bs,oneof:"value"},{no:11,name:"rpc_ack",kind:"message",T:zs,oneof:"value"},{no:12,name:"rpc_response",kind:"message",T:qs,oneof:"value"},{no:13,name:"stream_header",kind:"message",T:nc,oneof:"value"},{no:14,name:"stream_chunk",kind:"message",T:ic,oneof:"value"},{no:15,name:"stream_trailer",kind:"message",T:rc,oneof:"value"},{no:18,name:"encrypted_packet",kind:"message",T:Is,oneof:"value"},{no:16,name:"sequence",kind:"scalar",T:13},{no:17,name:"participant_sid",kind:"scalar",T:9}]),xs=Za.makeEnum("livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]),Is=Za.makeMessageType("livekit.EncryptedPacket",()=>[{no:1,name:"encryption_type",kind:"enum",T:Za.getEnumType(Cs)},{no:2,name:"iv",kind:"scalar",T:12},{no:3,name:"key_index",kind:"scalar",T:13},{no:4,name:"encrypted_value",kind:"scalar",T:12}]),Ns=Za.makeMessageType("livekit.EncryptedPacketPayload",()=>[{no:1,name:"user",kind:"message",T:Ls,oneof:"value"},{no:3,name:"chat_message",kind:"message",T:Fs,oneof:"value"},{no:4,name:"rpc_request",kind:"message",T:Bs,oneof:"value"},{no:5,name:"rpc_ack",kind:"message",T:zs,oneof:"value"},{no:6,name:"rpc_response",kind:"message",T:qs,oneof:"value"},{no:7,name:"stream_header",kind:"message",T:nc,oneof:"value"},{no:8,name:"stream_chunk",kind:"message",T:ic,oneof:"value"},{no:9,name:"stream_trailer",kind:"message",T:rc,oneof:"value"}]),As=Za.makeMessageType("livekit.ActiveSpeakerUpdate",()=>[{no:1,name:"speakers",kind:"message",T:Ds,repeated:!0}]),Ds=Za.makeMessageType("livekit.SpeakerInfo",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]),Ls=Za.makeMessageType("livekit.UserPacket",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0},{no:8,name:"id",kind:"scalar",T:9,opt:!0},{no:9,name:"start_time",kind:"scalar",T:4,opt:!0},{no:10,name:"end_time",kind:"scalar",T:4,opt:!0},{no:11,name:"nonce",kind:"scalar",T:12}]),Ms=Za.makeMessageType("livekit.SipDTMF",()=>[{no:3,name:"code",kind:"scalar",T:13},{no:4,name:"digit",kind:"scalar",T:9}]),js=Za.makeMessageType("livekit.Transcription",()=>[{no:2,name:"transcribed_participant_identity",kind:"scalar",T:9},{no:3,name:"track_id",kind:"scalar",T:9},{no:4,name:"segments",kind:"message",T:Us,repeated:!0}]),Us=Za.makeMessageType("livekit.TranscriptionSegment",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"text",kind:"scalar",T:9},{no:3,name:"start_time",kind:"scalar",T:4},{no:4,name:"end_time",kind:"scalar",T:4},{no:5,name:"final",kind:"scalar",T:8},{no:6,name:"language",kind:"scalar",T:9}]),Fs=Za.makeMessageType("livekit.ChatMessage",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"edit_timestamp",kind:"scalar",T:3,opt:!0},{no:4,name:"message",kind:"scalar",T:9},{no:5,name:"deleted",kind:"scalar",T:8},{no:6,name:"generated",kind:"scalar",T:8}]),Bs=Za.makeMessageType("livekit.RpcRequest",()=>[{no:1,name:"id",kind:"scalar",T:9},{no:2,name:"method",kind:"scalar",T:9},{no:3,name:"payload",kind:"scalar",T:9},{no:4,name:"response_timeout_ms",kind:"scalar",T:13},{no:5,name:"version",kind:"scalar",T:13}]),zs=Za.makeMessageType("livekit.RpcAck",()=>[{no:1,name:"request_id",kind:"scalar",T:9}]),qs=Za.makeMessageType("livekit.RpcResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:9,oneof:"value"},{no:3,name:"error",kind:"message",T:Vs,oneof:"value"}]),Vs=Za.makeMessageType("livekit.RpcError",()=>[{no:1,name:"code",kind:"scalar",T:13},{no:2,name:"message",kind:"scalar",T:9},{no:3,name:"data",kind:"scalar",T:9}]),Hs=Za.makeMessageType("livekit.ParticipantTracks",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]),Ws=Za.makeMessageType("livekit.ServerInfo",()=>[{no:1,name:"edition",kind:"enum",T:Za.getEnumType(Ks)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9},{no:7,name:"agent_protocol",kind:"scalar",T:5}]),Ks=Za.makeEnum("livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]),Gs=Za.makeMessageType("livekit.ClientInfo",()=>[{no:1,name:"sdk",kind:"enum",T:Za.getEnumType(Js)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9},{no:11,name:"other_sdks",kind:"scalar",T:9}]),Js=Za.makeEnum("livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"},{no:11,name:"UNITY_WEB"},{no:12,name:"NODE"},{no:13,name:"UNREAL"},{no:14,name:"ESP32"}]),Qs=Za.makeMessageType("livekit.ClientConfiguration",()=>[{no:1,name:"video",kind:"message",T:$s},{no:2,name:"screen",kind:"message",T:$s},{no:3,name:"resume_connection",kind:"enum",T:Za.getEnumType(hs)},{no:4,name:"disabled_codecs",kind:"message",T:Ys},{no:5,name:"force_relay",kind:"enum",T:Za.getEnumType(hs)}]),$s=Za.makeMessageType("livekit.VideoConfiguration",()=>[{no:1,name:"hardware_encoder",kind:"enum",T:Za.getEnumType(hs)}]),Ys=Za.makeMessageType("livekit.DisabledCodecs",()=>[{no:1,name:"codecs",kind:"message",T:ys,repeated:!0},{no:2,name:"publish",kind:"message",T:ys,repeated:!0}]),Xs=Za.makeMessageType("livekit.TimedVersion",()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]),Zs=Za.makeEnum("livekit.DataStream.OperationType",[{no:0,name:"CREATE"},{no:1,name:"UPDATE"},{no:2,name:"DELETE"},{no:3,name:"REACTION"}]),ec=Za.makeMessageType("livekit.DataStream.TextHeader",()=>[{no:1,name:"operation_type",kind:"enum",T:Za.getEnumType(Zs)},{no:2,name:"version",kind:"scalar",T:5},{no:3,name:"reply_to_stream_id",kind:"scalar",T:9},{no:4,name:"attached_stream_ids",kind:"scalar",T:9,repeated:!0},{no:5,name:"generated",kind:"scalar",T:8}],{localName:"DataStream_TextHeader"}),tc=Za.makeMessageType("livekit.DataStream.ByteHeader",()=>[{no:1,name:"name",kind:"scalar",T:9}],{localName:"DataStream_ByteHeader"}),nc=Za.makeMessageType("livekit.DataStream.Header",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"timestamp",kind:"scalar",T:3},{no:3,name:"topic",kind:"scalar",T:9},{no:4,name:"mime_type",kind:"scalar",T:9},{no:5,name:"total_length",kind:"scalar",T:4,opt:!0},{no:7,name:"encryption_type",kind:"enum",T:Za.getEnumType(Cs)},{no:8,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:9,name:"text_header",kind:"message",T:ec,oneof:"content_header"},{no:10,name:"byte_header",kind:"message",T:tc,oneof:"content_header"}],{localName:"DataStream_Header"}),ic=Za.makeMessageType("livekit.DataStream.Chunk",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"chunk_index",kind:"scalar",T:4},{no:3,name:"content",kind:"scalar",T:12},{no:4,name:"version",kind:"scalar",T:5},{no:5,name:"iv",kind:"scalar",T:12,opt:!0}],{localName:"DataStream_Chunk"}),rc=Za.makeMessageType("livekit.DataStream.Trailer",()=>[{no:1,name:"stream_id",kind:"scalar",T:9},{no:2,name:"reason",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}}],{localName:"DataStream_Trailer"}),oc=Za.makeMessageType("livekit.SubscribedAudioCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"enabled",kind:"scalar",T:8}]),ac=Za.makeEnum("livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]),sc=Za.makeEnum("livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]),cc=Za.makeEnum("livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]),lc=Za.makeMessageType("livekit.SignalRequest",()=>[{no:1,name:"offer",kind:"message",T:bc,oneof:"message"},{no:2,name:"answer",kind:"message",T:bc,oneof:"message"},{no:3,name:"trickle",kind:"message",T:pc,oneof:"message"},{no:4,name:"add_track",kind:"message",T:hc,oneof:"message"},{no:5,name:"mute",kind:"message",T:fc,oneof:"message"},{no:6,name:"subscription",kind:"message",T:Sc,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:wc,oneof:"message"},{no:8,name:"leave",kind:"message",T:Ec,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:Rc,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:zc,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:Hc,oneof:"message"},{no:13,name:"simulate",kind:"message",T:Gc,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:_c,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:Jc,oneof:"message"},{no:17,name:"update_audio_track",kind:"message",T:Tc,oneof:"message"},{no:18,name:"update_video_track",kind:"message",T:Cc,oneof:"message"}]),uc=Za.makeMessageType("livekit.SignalResponse",()=>[{no:1,name:"join",kind:"message",T:mc,oneof:"message"},{no:2,name:"answer",kind:"message",T:bc,oneof:"message"},{no:3,name:"offer",kind:"message",T:bc,oneof:"message"},{no:4,name:"trickle",kind:"message",T:pc,oneof:"message"},{no:5,name:"update",kind:"message",T:kc,oneof:"message"},{no:6,name:"track_published",kind:"message",T:vc,oneof:"message"},{no:8,name:"leave",kind:"message",T:Ec,oneof:"message"},{no:9,name:"mute",kind:"message",T:fc,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:xc,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Ic,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:Ac,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:Lc,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:Uc,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:qc,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:yc,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:gc,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:Qc,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:Xc,oneof:"message"},{no:22,name:"request_response",kind:"message",T:Zc,oneof:"message"},{no:23,name:"track_subscribed",kind:"message",T:tl,oneof:"message"},{no:24,name:"room_moved",kind:"message",T:Vc,oneof:"message"},{no:25,name:"media_sections_requirement",kind:"message",T:al,oneof:"message"},{no:26,name:"subscribed_audio_codec_update",kind:"message",T:Fc,oneof:"message"}]),dc=Za.makeMessageType("livekit.SimulcastCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Rs,repeated:!0},{no:5,name:"video_layer_mode",kind:"enum",T:Za.getEnumType(_s)}]),hc=Za.makeMessageType("livekit.AddTrackRequest",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:Za.getEnumType(cs)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:Za.getEnumType(ls)},{no:9,name:"layers",kind:"message",T:Rs,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:dc,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:Za.getEnumType(Cs)},{no:15,name:"stream",kind:"scalar",T:9},{no:16,name:"backup_codec_policy",kind:"enum",T:Za.getEnumType(ss)},{no:17,name:"audio_features",kind:"enum",T:Za.getEnumType(gs),repeated:!0}]),pc=Za.makeMessageType("livekit.TrickleRequest",()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:Za.getEnumType(ac)},{no:3,name:"final",kind:"scalar",T:8}]),fc=Za.makeMessageType("livekit.MuteTrackRequest",()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]),mc=Za.makeMessageType("livekit.JoinResponse",()=>[{no:1,name:"room",kind:"message",T:vs},{no:2,name:"participant",kind:"message",T:ks},{no:3,name:"other_participants",kind:"message",T:ks,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:Oc,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:Qs},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:Ws},{no:13,name:"sif_trailer",kind:"scalar",T:12},{no:14,name:"enabled_publish_codecs",kind:"message",T:ys,repeated:!0},{no:15,name:"fast_publish",kind:"scalar",T:8}]),gc=Za.makeMessageType("livekit.ReconnectResponse",()=>[{no:1,name:"ice_servers",kind:"message",T:Oc,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:Qs},{no:3,name:"server_info",kind:"message",T:Ws},{no:4,name:"last_message_seq",kind:"scalar",T:13}]),vc=Za.makeMessageType("livekit.TrackPublishedResponse",()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:Ps}]),yc=Za.makeMessageType("livekit.TrackUnpublishedResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),bc=Za.makeMessageType("livekit.SessionDescription",()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9},{no:3,name:"id",kind:"scalar",T:13},{no:4,name:"mid_to_track_id",kind:"map",K:9,V:{kind:"scalar",T:9}}]),kc=Za.makeMessageType("livekit.ParticipantUpdate",()=>[{no:1,name:"participants",kind:"message",T:ks,repeated:!0}]),Sc=Za.makeMessageType("livekit.UpdateSubscription",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:Hs,repeated:!0}]),wc=Za.makeMessageType("livekit.UpdateTrackSettings",()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:Za.getEnumType(us)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]),Tc=Za.makeMessageType("livekit.UpdateLocalAudioTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"features",kind:"enum",T:Za.getEnumType(gs),repeated:!0}]),Cc=Za.makeMessageType("livekit.UpdateLocalVideoTrack",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13}]),Ec=Za.makeMessageType("livekit.LeaveRequest",()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:Za.getEnumType(ps)},{no:3,name:"action",kind:"enum",T:Za.getEnumType(Pc)},{no:4,name:"regions",kind:"message",T:$c}]),Pc=Za.makeEnum("livekit.LeaveRequest.Action",[{no:0,name:"DISCONNECT"},{no:1,name:"RESUME"},{no:2,name:"RECONNECT"}]),Rc=Za.makeMessageType("livekit.UpdateVideoLayers",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Rs,repeated:!0}]),_c=Za.makeMessageType("livekit.UpdateParticipantMetadata",()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:4,name:"request_id",kind:"scalar",T:13}]),Oc=Za.makeMessageType("livekit.ICEServer",()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]),xc=Za.makeMessageType("livekit.SpeakersChanged",()=>[{no:1,name:"speakers",kind:"message",T:Ds,repeated:!0}]),Ic=Za.makeMessageType("livekit.RoomUpdate",()=>[{no:1,name:"room",kind:"message",T:vs}]),Nc=Za.makeMessageType("livekit.ConnectionQualityInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:Za.getEnumType(ds)},{no:3,name:"score",kind:"scalar",T:2}]),Ac=Za.makeMessageType("livekit.ConnectionQualityUpdate",()=>[{no:1,name:"updates",kind:"message",T:Nc,repeated:!0}]),Dc=Za.makeMessageType("livekit.StreamStateInfo",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:Za.getEnumType(sc)}]),Lc=Za.makeMessageType("livekit.StreamStateUpdate",()=>[{no:1,name:"stream_states",kind:"message",T:Dc,repeated:!0}]),Mc=Za.makeMessageType("livekit.SubscribedQuality",()=>[{no:1,name:"quality",kind:"enum",T:Za.getEnumType(us)},{no:2,name:"enabled",kind:"scalar",T:8}]),jc=Za.makeMessageType("livekit.SubscribedCodec",()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Mc,repeated:!0}]),Uc=Za.makeMessageType("livekit.SubscribedQualityUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Mc,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:jc,repeated:!0}]),Fc=Za.makeMessageType("livekit.SubscribedAudioCodecUpdate",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_audio_codecs",kind:"message",T:oc,repeated:!0}]),Bc=Za.makeMessageType("livekit.TrackPermission",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]),zc=Za.makeMessageType("livekit.SubscriptionPermission",()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:Bc,repeated:!0}]),qc=Za.makeMessageType("livekit.SubscriptionPermissionUpdate",()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]),Vc=Za.makeMessageType("livekit.RoomMovedResponse",()=>[{no:1,name:"room",kind:"message",T:vs},{no:2,name:"token",kind:"scalar",T:9},{no:3,name:"participant",kind:"message",T:ks},{no:4,name:"other_participants",kind:"message",T:ks,repeated:!0}]),Hc=Za.makeMessageType("livekit.SyncState",()=>[{no:1,name:"answer",kind:"message",T:bc},{no:2,name:"subscription",kind:"message",T:Sc},{no:3,name:"publish_tracks",kind:"message",T:vc,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Kc,repeated:!0},{no:5,name:"offer",kind:"message",T:bc},{no:6,name:"track_sids_disabled",kind:"scalar",T:9,repeated:!0},{no:7,name:"datachannel_receive_states",kind:"message",T:Wc,repeated:!0}]),Wc=Za.makeMessageType("livekit.DataChannelReceiveState",()=>[{no:1,name:"publisher_sid",kind:"scalar",T:9},{no:2,name:"last_seq",kind:"scalar",T:13}]),Kc=Za.makeMessageType("livekit.DataChannelInfo",()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:Za.getEnumType(ac)}]),Gc=Za.makeMessageType("livekit.SimulateScenario",()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:Za.getEnumType(cc),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"},{no:9,name:"leave_request_full_reconnect",kind:"scalar",T:8,oneof:"scenario"}]),Jc=Za.makeMessageType("livekit.Ping",()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]),Qc=Za.makeMessageType("livekit.Pong",()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]),$c=Za.makeMessageType("livekit.RegionSettings",()=>[{no:1,name:"regions",kind:"message",T:Yc,repeated:!0}]),Yc=Za.makeMessageType("livekit.RegionInfo",()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]),Xc=Za.makeMessageType("livekit.SubscriptionResponse",()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:Za.getEnumType(ms)}]),Zc=Za.makeMessageType("livekit.RequestResponse",()=>[{no:1,name:"request_id",kind:"scalar",T:13},{no:2,name:"reason",kind:"enum",T:Za.getEnumType(el)},{no:3,name:"message",kind:"scalar",T:9},{no:4,name:"trickle",kind:"message",T:pc,oneof:"request"},{no:5,name:"add_track",kind:"message",T:hc,oneof:"request"},{no:6,name:"mute",kind:"message",T:fc,oneof:"request"},{no:7,name:"update_metadata",kind:"message",T:_c,oneof:"request"},{no:8,name:"update_audio_track",kind:"message",T:Tc,oneof:"request"},{no:9,name:"update_video_track",kind:"message",T:Cc,oneof:"request"}]),el=Za.makeEnum("livekit.RequestResponse.Reason",[{no:0,name:"OK"},{no:1,name:"NOT_FOUND"},{no:2,name:"NOT_ALLOWED"},{no:3,name:"LIMIT_EXCEEDED"},{no:4,name:"QUEUED"},{no:5,name:"UNSUPPORTED_TYPE"},{no:6,name:"UNCLASSIFIED_ERROR"}]),tl=Za.makeMessageType("livekit.TrackSubscribed",()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]),nl=Za.makeMessageType("livekit.ConnectionSettings",()=>[{no:1,name:"auto_subscribe",kind:"scalar",T:8},{no:2,name:"adaptive_stream",kind:"scalar",T:8},{no:3,name:"subscriber_allow_pause",kind:"scalar",T:8,opt:!0},{no:4,name:"disable_ice_lite",kind:"scalar",T:8}]),il=Za.makeMessageType("livekit.JoinRequest",()=>[{no:1,name:"client_info",kind:"message",T:Gs},{no:2,name:"connection_settings",kind:"message",T:nl},{no:3,name:"metadata",kind:"scalar",T:9},{no:4,name:"participant_attributes",kind:"map",K:9,V:{kind:"scalar",T:9}},{no:5,name:"add_track_requests",kind:"message",T:hc,repeated:!0},{no:6,name:"publisher_offer",kind:"message",T:bc},{no:7,name:"reconnect",kind:"scalar",T:8},{no:8,name:"reconnect_reason",kind:"enum",T:Za.getEnumType(fs)},{no:9,name:"participant_sid",kind:"scalar",T:9},{no:10,name:"sync_state",kind:"message",T:Hc}]),rl=Za.makeMessageType("livekit.WrappedJoinRequest",()=>[{no:1,name:"compression",kind:"enum",T:Za.getEnumType(ol)},{no:2,name:"join_request",kind:"scalar",T:12}]),ol=Za.makeEnum("livekit.WrappedJoinRequest.Compression",[{no:0,name:"NONE"},{no:1,name:"GZIP"}]),al=Za.makeMessageType("livekit.MediaSectionsRequirement",()=>[{no:1,name:"num_audios",kind:"scalar",T:13},{no:2,name:"num_videos",kind:"scalar",T:13}]);function sl(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var cl,ll={exports:{}},ul=ll.exports;var dl,hl,pl=function(){return cl||(cl=1,e=ll,function(t,n){e.exports?e.exports=n():t.log=n()}(ul,function(){var e=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),i=["trace","debug","info","warn","error"],r={},o=null;function a(e,t){var n=e[t];if("function"===typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(So){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function s(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function c(){for(var n=this.getLevel(),r=0;r<i.length;r++){var o=i[r];this[o]=r<n?e:this.methodFactory(o,n,this.name)}if(this.log=this.debug,typeof console===t&&n<this.levels.SILENT)return"No console available for logging"}function l(e){return function(){typeof console!==t&&(c.call(this),this[e].apply(this,arguments))}}function u(i,r,o){return function(i){return"debug"===i&&(i="log"),typeof console!==t&&("trace"===i&&n?s:void 0!==console[i]?a(console,i):void 0!==console.log?a(console,"log"):e)}(i)||l.apply(this,arguments)}function d(e,n){var a,s,l,d=this,h="loglevel";function p(){var e;if(typeof window!==t&&h){try{e=window.localStorage[h]}catch(o){}if(typeof e===t)try{var n=window.document.cookie,i=encodeURIComponent(h),r=n.indexOf(i+"=");-1!==r&&(e=/^([^;]+)/.exec(n.slice(r+i.length+1))[1])}catch(o){}return void 0===d.levels[e]&&(e=void 0),e}}function f(e){var t=e;if("string"===typeof t&&void 0!==d.levels[t.toUpperCase()]&&(t=d.levels[t.toUpperCase()]),"number"===typeof t&&t>=0&&t<=d.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"===typeof e?h+=":"+e:"symbol"===typeof e&&(h=void 0),d.name=e,d.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},d.methodFactory=n||u,d.getLevel=function(){return null!=l?l:null!=s?s:a},d.setLevel=function(e,n){return l=f(e),!1!==n&&function(e){var n=(i[e]||"silent").toUpperCase();if(typeof window!==t&&h){try{return void(window.localStorage[h]=n)}catch(r){}try{window.document.cookie=encodeURIComponent(h)+"="+n+";"}catch(r){}}}(l),c.call(d)},d.setDefaultLevel=function(e){s=f(e),p()||d.setLevel(e,!1)},d.resetLevel=function(){l=null,function(){if(typeof window!==t&&h){try{window.localStorage.removeItem(h)}catch(e){}try{window.document.cookie=encodeURIComponent(h)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),c.call(d)},d.enableAll=function(e){d.setLevel(d.levels.TRACE,e)},d.disableAll=function(e){d.setLevel(d.levels.SILENT,e)},d.rebuild=function(){if(o!==d&&(a=f(o.getLevel())),c.call(d),o===d)for(var e in r)r[e].rebuild()},a=f(o?o.getLevel():"WARN");var m=p();null!=m&&(l=f(m)),c.call(d)}(o=new d).getLogger=function(e){if("symbol"!==typeof e&&"string"!==typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=r[e];return t||(t=r[e]=new d(e,o.methodFactory)),t};var h=typeof window!==t?window.log:void 0;return o.noConflict=function(){return typeof window!==t&&window.log===o&&(window.log=h),o},o.getLoggers=function(){return r},o.default=o,o})),ll.exports;var e}();!function(e){e[e.trace=0]="trace",e[e.debug=1]="debug",e[e.info=2]="info",e[e.warn=3]="warn",e[e.error=4]="error",e[e.silent=5]="silent"}(dl||(dl={})),function(e){e.Default="livekit",e.Room="livekit-room",e.TokenSource="livekit-token-source",e.Participant="livekit-participant",e.Track="livekit-track",e.Publication="livekit-track-publication",e.Engine="livekit-engine",e.Signal="livekit-signal",e.PCManager="livekit-pc-manager",e.PCTransport="livekit-pc-transport",e.E2EE="lk-e2ee"}(hl||(hl={}));let fl=pl.getLogger("livekit");Object.values(hl).map(e=>pl.getLogger(e));function ml(e){const t=pl.getLogger(e);return t.setDefaultLevel(fl.getLevel()),t}fl.setDefaultLevel(dl.info);const gl=pl.getLogger("lk-e2ee"),vl=7e3,yl=[0,300,1200,2700,4800,vl,vl,vl,vl,vl];function bl(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(e);r<i.length;r++)t.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(e,i[r])&&(n[i[r]]=e[i[r]])}return n}function kl(e,t,n,i){return new(n||(n=Promise))(function(r,o){function a(e){try{c(i.next(e))}catch(So){o(So)}}function s(e){try{c(i.throw(e))}catch(So){o(So)}}function c(e){e.done?r(e.value):function(e){return e instanceof n?e:new n(function(t){t(e)})}(e.value).then(a,s)}c((i=i.apply(e,t||[])).next())})}function Sl(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],i=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&i>=e.length&&(e=void 0),{value:e&&e[i++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function wl(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=Sl(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise(function(i,r){(function(e,t,n,i){Promise.resolve(i).then(function(t){e({value:t,done:n})},t)})(i,r,(t=e[n](t)).done,t.value)})}}}"function"===typeof SuppressedError&&SuppressedError;var Tl,Cl={exports:{}};var El=function(){if(Tl)return Cl.exports;Tl=1;var e,t="object"===typeof Reflect?Reflect:null,n=t&&"function"===typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};e=t&&"function"===typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var i=Number.isNaN||function(e){return e!==e};function r(){r.init.call(this)}Cl.exports=r,Cl.exports.once=function(e,t){return new Promise(function(n,i){function r(n){e.removeListener(t,o),i(n)}function o(){"function"===typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}f(e,t,o,{once:!0}),"error"!==t&&function(e,t,n){"function"===typeof e.on&&f(e,"error",t,n)}(e,r,{once:!0})})},r.EventEmitter=r,r.prototype._events=void 0,r.prototype._eventsCount=0,r.prototype._maxListeners=void 0;var o=10;function a(e){if("function"!==typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function s(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function c(e,t,n,i){var r,o,c;if(a(n),void 0===(o=e._events)?(o=e._events=Object.create(null),e._eventsCount=0):(void 0!==o.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),o=e._events),c=o[t]),void 0===c)c=o[t]=n,++e._eventsCount;else if("function"===typeof c?c=o[t]=i?[n,c]:[c,n]:i?c.unshift(n):c.push(n),(r=s(e))>0&&c.length>r&&!c.warned){c.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+c.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=c.length,function(e){console&&console.warn&&console.warn(e)}(l)}return e}function l(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=l.bind(i);return r.listener=n,i.wrapFn=r,r}function d(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"===typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):p(r,r.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"===typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function f(e,t,n,i){if("function"===typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!==typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function r(o){i.once&&e.removeEventListener(t,r),n(o)})}}return Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return o},set:function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");o=e}}),r.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},r.prototype.setMaxListeners=function(e){if("number"!==typeof e||e<0||i(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return s(this)},r.prototype.emit=function(e){for(var t=[],i=1;i<arguments.length;i++)t.push(arguments[i]);var r="error"===e,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var a;if(t.length>0&&(a=t[0]),a instanceof Error)throw a;var s=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw s.context=a,s}var c=o[e];if(void 0===c)return!1;if("function"===typeof c)n(c,this,t);else{var l=c.length,u=p(c,l);for(i=0;i<l;++i)n(u[i],this,t)}return!0},r.prototype.addListener=function(e,t){return c(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return c(this,e,t,!0)},r.prototype.once=function(e,t){return a(t),this.on(e,u(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){return a(t),this.prependListener(e,u(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,i,r,o,s;if(a(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!==typeof n){for(r=-1,o=n.length-1;o>=0;o--)if(n[o]===t||n[o].listener===t){s=n[o].listener,r=o;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,s||t)}return this},r.prototype.off=r.prototype.removeListener,r.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,o=Object.keys(n);for(i=0;i<o.length;++i)"removeListener"!==(r=o[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"===typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},r.prototype.listeners=function(e){return d(this,e,!0)},r.prototype.rawListeners=function(e){return d(this,e,!1)},r.listenerCount=function(e,t){return"function"===typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},r.prototype.listenerCount=h,r.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},Cl.exports}();let Pl=!0,Rl=!0;function _l(e,t,n){const i=e.match(t);return i&&i.length>=n&&parseFloat(i[n],10)}function Ol(e,t,n){if(!e.RTCPeerConnection)return;const i=e.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);const o=e=>{const t=n(e);t&&(i.handleEvent?i.handleEvent(t):i(t))};return this._eventMap=this._eventMap||{},this._eventMap[t]||(this._eventMap[t]=new Map),this._eventMap[t].set(i,o),r.apply(this,[e,o])};const o=i.removeEventListener;i.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[t])return o.apply(this,arguments);if(!this._eventMap[t].has(n))return o.apply(this,arguments);const i=this._eventMap[t].get(n);return this._eventMap[t].delete(n),0===this._eventMap[t].size&&delete this._eventMap[t],0===Object.keys(this._eventMap).length&&delete this._eventMap,o.apply(this,[e,i])},Object.defineProperty(i,"on"+t,{get(){return this["_on"+t]},set(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}function xl(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Pl=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function Il(e){return"boolean"!==typeof e?new Error("Argument type: "+typeof e+". Please use a boolean."):(Rl=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function Nl(){if("object"===typeof window){if(Pl)return;"undefined"!==typeof console&&"function"===typeof console.log&&console.log.apply(console,arguments)}}function Al(e,t){Rl&&console.warn(e+" is deprecated, please use "+t+" instead.")}function Dl(e){return"[object Object]"===Object.prototype.toString.call(e)}function Ll(e){return Dl(e)?Object.keys(e).reduce(function(t,n){const i=Dl(e[n]),r=i?Ll(e[n]):e[n],o=i&&!Object.keys(r).length;return void 0===r||o?t:Object.assign(t,{[n]:r})},{}):e}function Ml(e,t,n){t&&!n.has(t.id)&&(n.set(t.id,t),Object.keys(t).forEach(i=>{i.endsWith("Id")?Ml(e,e.get(t[i]),n):i.endsWith("Ids")&&t[i].forEach(t=>{Ml(e,e.get(t),n)})}))}function jl(e,t,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(null===t)return r;const o=[];return e.forEach(e=>{"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)}),o.forEach(t=>{e.forEach(n=>{n.type===i&&n.trackId===t.id&&Ml(e,n,r)})}),r}const Ul=Nl;function Fl(e,t){const n=e&&e.navigator;if(!n.mediaDevices)return;const i=function(e){if("object"!==typeof e||e.mandatory||e.optional)return e;const t={};return Object.keys(e).forEach(n=>{if("require"===n||"advanced"===n||"mediaSource"===n)return;const i="object"===typeof e[n]?e[n]:{ideal:e[n]};void 0!==i.exact&&"number"===typeof i.exact&&(i.min=i.max=i.exact);const r=function(e,t){return e?e+t.charAt(0).toUpperCase()+t.slice(1):"deviceId"===t?"sourceId":t};if(void 0!==i.ideal){t.optional=t.optional||[];let e={};"number"===typeof i.ideal?(e[r("min",n)]=i.ideal,t.optional.push(e),e={},e[r("max",n)]=i.ideal,t.optional.push(e)):(e[r("",n)]=i.ideal,t.optional.push(e))}void 0!==i.exact&&"number"!==typeof i.exact?(t.mandatory=t.mandatory||{},t.mandatory[r("",n)]=i.exact):["min","max"].forEach(e=>{void 0!==i[e]&&(t.mandatory=t.mandatory||{},t.mandatory[r(e,n)]=i[e])})}),e.advanced&&(t.optional=(t.optional||[]).concat(e.advanced)),t},r=function(e,r){if(t.version>=61)return r(e);if((e=JSON.parse(JSON.stringify(e)))&&"object"===typeof e.audio){const t=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};t((e=JSON.parse(JSON.stringify(e))).audio,"autoGainControl","googAutoGainControl"),t(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=i(e.audio)}if(e&&"object"===typeof e.video){let o=e.video.facingMode;o=o&&("object"===typeof o?o:{ideal:o});const a=t.version<66;if(o&&("user"===o.exact||"environment"===o.exact||"user"===o.ideal||"environment"===o.ideal)&&(!n.mediaDevices.getSupportedConstraints||!n.mediaDevices.getSupportedConstraints().facingMode||a)){let t;if(delete e.video.facingMode,"environment"===o.exact||"environment"===o.ideal?t=["back","rear"]:"user"!==o.exact&&"user"!==o.ideal||(t=["front"]),t)return n.mediaDevices.enumerateDevices().then(n=>{let a=(n=n.filter(e=>"videoinput"===e.kind)).find(e=>t.some(t=>e.label.toLowerCase().includes(t)));return!a&&n.length&&t.includes("back")&&(a=n[n.length-1]),a&&(e.video.deviceId=o.exact?{exact:a.deviceId}:{ideal:a.deviceId}),e.video=i(e.video),Ul("chrome: "+JSON.stringify(e)),r(e)})}e.video=i(e.video)}return Ul("chrome: "+JSON.stringify(e)),r(e)},o=function(e){return t.version>=64?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}};if(n.getUserMedia=function(e,t,i){r(e,e=>{n.webkitGetUserMedia(e,t,e=>{i&&i(o(e))})})}.bind(n),n.mediaDevices.getUserMedia){const e=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(t){return r(t,t=>e(t).then(e=>{if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length)throw e.getTracks().forEach(e=>{e.stop()}),new DOMException("","NotFoundError");return e},e=>Promise.reject(o(e))))}}}function Bl(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function zl(e){if("object"===typeof e&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=t=>{t.stream.addEventListener("addtrack",n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.track.id):{track:n.track};const r=new Event("track");r.track=n.track,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)}),t.stream.getTracks().forEach(n=>{let i;i=e.RTCPeerConnection.prototype.getReceivers?this.getReceivers().find(e=>e.track&&e.track.id===n.id):{track:n};const r=new Event("track");r.track=n,r.receiver=i,r.transceiver={receiver:i},r.streams=[t.stream],this.dispatchEvent(r)})},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}else Ol(e,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function ql(e){if("object"===typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){const t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,i){let r=n.apply(this,arguments);return r||(r=t(this,e),this._senders.push(r)),r};const i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){i.apply(this,arguments);const t=this._senders.indexOf(e);-1!==t&&this._senders.splice(t,1)}}const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._senders=this._senders||[],n.apply(this,[e]),e.getTracks().forEach(e=>{this._senders.push(t(this,e))})};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._senders=this._senders||[],i.apply(this,[e]),e.getTracks().forEach(e=>{const t=this._senders.find(t=>t.track===e);t&&this._senders.splice(this._senders.indexOf(t),1)})}}else if("object"===typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e},Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function Vl(e){if(!("object"===typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver))return;if(!("getStats"in e.RTCRtpSender.prototype)){const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>jl(t,e.track,!0))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),Ol(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){const e=this;return this._pc.getStats().then(t=>jl(t,e.track,!1))}}if(!("getStats"in e.RTCRtpSender.prototype)||!("getStats"in e.RTCRtpReceiver.prototype))return;const t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof e.MediaStreamTrack){const e=arguments[0];let t,n,i;return this.getSenders().forEach(n=>{n.track===e&&(t?i=!0:t=n)}),this.getReceivers().forEach(t=>(t.track===e&&(n?i=!0:n=t),t.track===e)),i||t&&n?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):t?t.getStats():n?n.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return t.apply(this,arguments)}}function Hl(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(e=>this._shimmedLocalStreams[e][0])};const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===this._shimmedLocalStreams[n.id].indexOf(i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};const n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{},e.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")});const t=this.getSenders();n.apply(this,arguments);const i=this.getSenders().filter(e=>-1===t.indexOf(e));this._shimmedLocalStreams[e.id]=[e].concat(i)};const i=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],i.apply(this,arguments)};const r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&Object.keys(this._shimmedLocalStreams).forEach(t=>{const n=this._shimmedLocalStreams[t].indexOf(e);-1!==n&&this._shimmedLocalStreams[t].splice(n,1),1===this._shimmedLocalStreams[t].length&&delete this._shimmedLocalStreams[t]}),r.apply(this,arguments)}}function Wl(e,t){if(!e.RTCPeerConnection)return;if(e.RTCPeerConnection.prototype.addTrack&&t.version>=65)return Hl(e);const n=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){const e=n.apply(this);return this._reverseStreams=this._reverseStreams||{},e.map(e=>this._reverseStreams[e.id])};const i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},t.getTracks().forEach(e=>{if(this.getSenders().find(t=>t.track===e))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[t.id]){const n=new e.MediaStream(t.getTracks());this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n}i.apply(this,[t])};const r=e.RTCPeerConnection.prototype.removeStream;function o(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(r.id,"g"),i.id)}),new RTCSessionDescription({type:t.type,sdp:n})}e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const i=[].slice.call(arguments,1);if(1!==i.length||!i[0].getTracks().find(e=>e===t))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(e=>e.track===t))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const r=this._streams[n.id];if(r)r.addTrack(t),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const i=new e.MediaStream([t]);this._streams[n.id]=i,this._reverseStreams[i.id]=n,this.addStream(i)}return this.getSenders().find(e=>e.track===t)},["createOffer","createAnswer"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){const e=arguments;return arguments.length&&"function"===typeof arguments[0]?n.apply(this,[t=>{const n=o(this,t);e[0].apply(null,[n])},t=>{e[1]&&e[1].apply(null,t)},arguments[2]]):n.apply(this,arguments).then(e=>o(this,e))}};e.RTCPeerConnection.prototype[t]=i[t]});const a=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=function(e,t){let n=t.sdp;return Object.keys(e._reverseStreams||[]).forEach(t=>{const i=e._reverseStreams[t],r=e._streams[i.id];n=n.replace(new RegExp(i.id,"g"),r.id)}),new RTCSessionDescription({type:t.type,sdp:n})}(this,arguments[0]),a.apply(this,arguments)):a.apply(this,arguments)};const s=Object.getOwnPropertyDescriptor(e.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(e.RTCPeerConnection.prototype,"localDescription",{get(){const e=s.get.apply(this);return""===e.type?e:o(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(e._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");let t;this._streams=this._streams||{},Object.keys(this._streams).forEach(n=>{this._streams[n].getTracks().find(t=>e.track===t)&&(t=this._streams[n])}),t&&(1===t.getTracks().length?this.removeStream(this._reverseStreams[t.id]):t.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Kl(e,t){!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection&&t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]})}function Gl(e,t){Ol(e,"negotiationneeded",e=>{const n=e.target;if(!(t.version<72||n.getConfiguration&&"plan-b"===n.getConfiguration().sdpSemantics)||"stable"===n.signalingState)return e})}var Jl=Object.freeze({__proto__:null,fixNegotiationNeeded:Gl,shimAddTrackRemoveTrack:Wl,shimAddTrackRemoveTrackWithNative:Hl,shimGetSendersWithDtmf:ql,shimGetUserMedia:Fl,shimMediaStream:Bl,shimOnTrack:zl,shimPeerConnection:Kl,shimSenderReceiverGetStats:Vl});function Ql(e,t){const n=e&&e.navigator,i=e&&e.MediaStreamTrack;if(n.getUserMedia=function(e,t,i){Al("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,i)},!(t.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const e=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},t=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(n){return"object"===typeof n&&"object"===typeof n.audio&&(n=JSON.parse(JSON.stringify(n)),e(n.audio,"autoGainControl","mozAutoGainControl"),e(n.audio,"noiseSuppression","mozNoiseSuppression")),t(n)},i&&i.prototype.getSettings){const t=i.prototype.getSettings;i.prototype.getSettings=function(){const n=t.apply(this,arguments);return e(n,"mozAutoGainControl","autoGainControl"),e(n,"mozNoiseSuppression","noiseSuppression"),n}}if(i&&i.prototype.applyConstraints){const t=i.prototype.applyConstraints;i.prototype.applyConstraints=function(n){return"audio"===this.kind&&"object"===typeof n&&(n=JSON.parse(JSON.stringify(n)),e(n,"autoGainControl","mozAutoGainControl"),e(n,"noiseSuppression","mozNoiseSuppression")),t.apply(this,[n])}}}}function $l(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Yl(e,t){if("object"!==typeof e||!e.RTCPeerConnection&&!e.mozRTCPeerConnection)return;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),t.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(t){const n=e.RTCPeerConnection.prototype[t],i={[t](){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}};e.RTCPeerConnection.prototype[t]=i[t]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){const[e,r,o]=arguments;return i.apply(this,[e||null]).then(e=>{if(t.version<53&&!r)try{e.forEach(e=>{e.type=n[e.type]||e.type})}catch(So){if("TypeError"!==So.name)throw So;e.forEach((t,i)=>{e.set(i,Object.assign({},t,{type:n[t.type]||t.type}))})}return e}).then(r,o)}}function Xl(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpSender.prototype)return;const t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e});const n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){const e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function Zl(e){if("object"!==typeof e||!e.RTCPeerConnection||!e.RTCRtpSender)return;if(e.RTCRtpSender&&"getStats"in e.RTCRtpReceiver.prototype)return;const t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){const e=t.apply(this,[]);return e.forEach(e=>e._pc=this),e}),Ol(e,"track",e=>(e.receiver._pc=e.srcElement,e)),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function eu(e){e.RTCPeerConnection&&!("removeStream"in e.RTCPeerConnection.prototype)&&(e.RTCPeerConnection.prototype.removeStream=function(e){Al("removeStream","removeTrack"),this.getSenders().forEach(t=>{t.track&&e.getTracks().includes(t.track)&&this.removeTrack(t)})})}function tu(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function nu(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.addTransceiver;t&&(e.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let e=arguments[1]&&arguments[1].sendEncodings;void 0===e&&(e=[]),e=[...e];const n=e.length>0;n&&e.forEach(e=>{if("rid"in e){if(!/^[a-z0-9]{0,16}$/i.test(e.rid))throw new TypeError("Invalid RID value provided.")}if("scaleResolutionDownBy"in e&&!(parseFloat(e.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in e&&!(parseFloat(e.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const i=t.apply(this,arguments);if(n){const{sender:t}=i,n=t.getParameters();(!("encodings"in n)||1===n.encodings.length&&0===Object.keys(n.encodings[0]).length)&&(n.encodings=e,t.sendEncodings=e,this.setParametersPromises.push(t.setParameters(n).then(()=>{delete t.sendEncodings}).catch(()=>{delete t.sendEncodings})))}return i})}function iu(e){if("object"!==typeof e||!e.RTCRtpSender)return;const t=e.RTCRtpSender.prototype.getParameters;t&&(e.RTCRtpSender.prototype.getParameters=function(){const e=t.apply(this,arguments);return"encodings"in e||(e.encodings=[].concat(this.sendEncodings||[{}])),e})}function ru(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}function ou(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype.createAnswer;e.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>t.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):t.apply(this,arguments)}}var au=Object.freeze({__proto__:null,shimAddTransceiver:nu,shimCreateAnswer:ou,shimCreateOffer:ru,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){if(!n||!n.video){const e=new DOMException("getDisplayMedia without video constraints is undefined");return e.name="NotFoundError",e.code=8,Promise.reject(e)}return!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)})},shimGetParameters:iu,shimGetUserMedia:Ql,shimOnTrack:$l,shimPeerConnection:Yl,shimRTCDataChannel:tu,shimReceiverGetStats:Zl,shimRemoveStream:eu,shimSenderGetStats:Xl});function su(e){if("object"===typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){const t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){this._localStreams||(this._localStreams=[]),this._localStreams.includes(e)||this._localStreams.push(e),e.getAudioTracks().forEach(n=>t.call(this,n,e)),e.getVideoTracks().forEach(n=>t.call(this,n,e))},e.RTCPeerConnection.prototype.addTrack=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return i&&i.forEach(e=>{this._localStreams?this._localStreams.includes(e)||this._localStreams.push(e):this._localStreams=[e]}),t.apply(this,arguments)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){this._localStreams||(this._localStreams=[]);const t=this._localStreams.indexOf(e);if(-1===t)return;this._localStreams.splice(t,1);const n=e.getTracks();this.getSenders().forEach(e=>{n.includes(e.track)&&this.removeTrack(e)})})}}function cu(e){if("object"===typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(e){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=e=>{e.streams.forEach(e=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(e))return;this._remoteStreams.push(e);const t=new Event("addstream");t.stream=e,this.dispatchEvent(t)})})}});const t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){const e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){t.streams.forEach(t=>{if(e._remoteStreams||(e._remoteStreams=[]),e._remoteStreams.indexOf(t)>=0)return;e._remoteStreams.push(t);const n=new Event("addstream");n.stream=t,e.dispatchEvent(n)})}),t.apply(e,arguments)}}}function lu(e){if("object"!==typeof e||!e.RTCPeerConnection)return;const t=e.RTCPeerConnection.prototype,n=t.createOffer,i=t.createAnswer,r=t.setLocalDescription,o=t.setRemoteDescription,a=t.addIceCandidate;t.createOffer=function(e,t){const i=arguments.length>=2?arguments[2]:arguments[0],r=n.apply(this,[i]);return t?(r.then(e,t),Promise.resolve()):r},t.createAnswer=function(e,t){const n=arguments.length>=2?arguments[2]:arguments[0],r=i.apply(this,[n]);return t?(r.then(e,t),Promise.resolve()):r};let s=function(e,t,n){const i=r.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i};t.setLocalDescription=s,s=function(e,t,n){const i=o.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.setRemoteDescription=s,s=function(e,t,n){const i=a.apply(this,[e]);return n?(i.then(t,n),Promise.resolve()):i},t.addIceCandidate=s}function uu(e){const t=e&&e.navigator;if(t.mediaDevices&&t.mediaDevices.getUserMedia){const e=t.mediaDevices,n=e.getUserMedia.bind(e);t.mediaDevices.getUserMedia=e=>n(du(e))}!t.getUserMedia&&t.mediaDevices&&t.mediaDevices.getUserMedia&&(t.getUserMedia=function(e,n,i){t.mediaDevices.getUserMedia(e).then(n,i)}.bind(t))}function du(e){return e&&void 0!==e.video?Object.assign({},e,{video:Ll(e.video)}):e}function hu(e){if(!e.RTCPeerConnection)return;const t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){const t=[];for(let n=0;n<e.iceServers.length;n++){let i=e.iceServers[n];void 0===i.urls&&i.url?(Al("RTCIceServer.url","RTCIceServer.urls"),i=JSON.parse(JSON.stringify(i)),i.urls=i.url,delete i.url,t.push(i)):t.push(e.iceServers[n])}e.iceServers=t}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in t&&Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:()=>t.generateCertificate})}function pu(e){"object"===typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function fu(e){const t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){"undefined"!==typeof e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);const t=this.getTransceivers().find(e=>"audio"===e.receiver.track.kind);!1===e.offerToReceiveAudio&&t?"sendrecv"===t.direction?t.setDirection?t.setDirection("sendonly"):t.direction="sendonly":"recvonly"===t.direction&&(t.setDirection?t.setDirection("inactive"):t.direction="inactive"):!0!==e.offerToReceiveAudio||t||this.addTransceiver("audio",{direction:"recvonly"}),"undefined"!==typeof e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo);const n=this.getTransceivers().find(e=>"video"===e.receiver.track.kind);!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video",{direction:"recvonly"})}return t.apply(this,arguments)}}function mu(e){"object"!==typeof e||e.AudioContext||(e.AudioContext=e.webkitAudioContext)}var gu,vu=Object.freeze({__proto__:null,shimAudioContext:mu,shimCallbacksAPI:lu,shimConstraints:du,shimCreateOfferLegacy:fu,shimGetUserMedia:uu,shimLocalStreamsAPI:su,shimRTCIceServerUrls:hu,shimRemoteStreamsAPI:cu,shimTrackEventTransceiver:pu}),yu={exports:{}};var bu=(gu||(gu=1,function(e){const t={generateIdentifier:function(){return Math.random().toString(36).substring(2,12)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){return e.trim().split("\n").map(e=>e.trim())},t.splitSections=function(e){return e.split("\nm=").map((e,t)=>(t>0?"m="+e:e).trim()+"\r\n")},t.getDescription=function(e){const n=t.splitSections(e);return n&&n[0]},t.getMediaSections=function(e){const n=t.splitSections(e);return n.shift(),n},t.matchPrefix=function(e,n){return t.splitLines(e).filter(e=>0===e.indexOf(n))},t.parseCandidate=function(e){let t;t=0===e.indexOf("a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" ");const n={foundation:t[0],component:{1:"rtp",2:"rtcp"}[t[1]]||t[1],protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],address:t[4],port:parseInt(t[5],10),type:t[7]};for(let i=8;i<t.length;i+=2)switch(t[i]){case"raddr":n.relatedAddress=t[i+1];break;case"rport":n.relatedPort=parseInt(t[i+1],10);break;case"tcptype":n.tcpType=t[i+1];break;case"ufrag":n.ufrag=t[i+1],n.usernameFragment=t[i+1];break;default:void 0===n[t[i]]&&(n[t[i]]=t[i+1])}return n},t.writeCandidate=function(e){const t=[];t.push(e.foundation);const n=e.component;"rtp"===n?t.push(1):"rtcp"===n?t.push(2):t.push(n),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);const i=e.type;return t.push("typ"),t.push(i),"host"!==i&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substring(14).split(" ")},t.parseRtpMap=function(e){let t=e.substring(9).split(" ");const n={payloadType:parseInt(t.shift(),10)};return t=t[0].split("/"),n.name=t[0],n.clockRate=parseInt(t[1],10),n.channels=3===t.length?parseInt(t[2],10):1,n.numChannels=n.channels,n},t.writeRtpMap=function(e){let t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);const n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){const t=e.substring(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1],attributes:t.slice(2).join(" ")}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+(e.attributes?" "+e.attributes:"")+"\r\n"},t.parseFmtp=function(e){const t={};let n;const i=e.substring(e.indexOf(" ")+1).split(";");for(let r=0;r<i.length;r++)n=i[r].trim().split("="),t[n[0].trim()]=n[1];return t},t.writeFmtp=function(e){let t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Object.keys(e.parameters).length){const i=[];Object.keys(e.parameters).forEach(t=>{void 0!==e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)}),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){const t=e.substring(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}},t.writeRtcpFb=function(e){let t="",n=e.payloadType;return void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&e.rtcpFeedback.forEach(e=>{t+="a=rtcp-fb:"+n+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"}),t},t.parseSsrcMedia=function(e){const t=e.indexOf(" "),n={ssrc:parseInt(e.substring(7,t),10)},i=e.indexOf(":",t);return i>-1?(n.attribute=e.substring(t+1,i),n.value=e.substring(i+1)):n.attribute=e.substring(t+1),n},t.parseSsrcGroup=function(e){const t=e.substring(13).split(" ");return{semantics:t.shift(),ssrcs:t.map(e=>parseInt(e,10))}},t.getMid=function(e){const n=t.matchPrefix(e,"a=mid:")[0];if(n)return n.substring(6)},t.parseFingerprint=function(e){const t=e.substring(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1].toUpperCase()}},t.getDtlsParameters=function(e,n){return{role:"auto",fingerprints:t.matchPrefix(e+n,"a=fingerprint:").map(t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){let n="a=setup:"+t+"\r\n";return e.fingerprints.forEach(e=>{n+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"}),n},t.parseCryptoLine=function(e){const t=e.substring(9).split(" ");return{tag:parseInt(t[0],10),cryptoSuite:t[1],keyParams:t[2],sessionParams:t.slice(3)}},t.writeCryptoLine=function(e){return"a=crypto:"+e.tag+" "+e.cryptoSuite+" "+("object"===typeof e.keyParams?t.writeCryptoKeyParams(e.keyParams):e.keyParams)+(e.sessionParams?" "+e.sessionParams.join(" "):"")+"\r\n"},t.parseCryptoKeyParams=function(e){if(0!==e.indexOf("inline:"))return null;const t=e.substring(7).split("|");return{keyMethod:"inline",keySalt:t[0],lifeTime:t[1],mkiValue:t[2]?t[2].split(":")[0]:void 0,mkiLength:t[2]?t[2].split(":")[1]:void 0}},t.writeCryptoKeyParams=function(e){return e.keyMethod+":"+e.keySalt+(e.lifeTime?"|"+e.lifeTime:"")+(e.mkiValue&&e.mkiLength?"|"+e.mkiValue+":"+e.mkiLength:"")},t.getCryptoParameters=function(e,n){return t.matchPrefix(e+n,"a=crypto:").map(t.parseCryptoLine)},t.getIceParameters=function(e,n){const i=t.matchPrefix(e+n,"a=ice-ufrag:")[0],r=t.matchPrefix(e+n,"a=ice-pwd:")[0];return i&&r?{usernameFragment:i.substring(12),password:r.substring(10)}:null},t.writeIceParameters=function(e){let t="a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n";return e.iceLite&&(t+="a=ice-lite\r\n"),t},t.parseRtpParameters=function(e){const n={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" ");n.profile=i[2];for(let o=3;o<i.length;o++){const r=i[o],a=t.matchPrefix(e,"a=rtpmap:"+r+" ")[0];if(a){const i=t.parseRtpMap(a),o=t.matchPrefix(e,"a=fmtp:"+r+" ");switch(i.parameters=o.length?t.parseFmtp(o[0]):{},i.rtcpFeedback=t.matchPrefix(e,"a=rtcp-fb:"+r+" ").map(t.parseRtcpFb),n.codecs.push(i),i.name.toUpperCase()){case"RED":case"ULPFEC":n.fecMechanisms.push(i.name.toUpperCase())}}}t.matchPrefix(e,"a=extmap:").forEach(e=>{n.headerExtensions.push(t.parseExtmap(e))});const r=t.matchPrefix(e,"a=rtcp-fb:* ").map(t.parseRtcpFb);return n.codecs.forEach(e=>{r.forEach(t=>{e.rtcpFeedback.find(e=>e.type===t.type&&e.parameter===t.parameter)||e.rtcpFeedback.push(t)})}),n},t.writeRtpDescription=function(e,n){let i="";i+="m="+e+" ",i+=n.codecs.length>0?"9":"0",i+=" "+(n.profile||"UDP/TLS/RTP/SAVPF")+" ",i+=n.codecs.map(e=>void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType).join(" ")+"\r\n",i+="c=IN IP4 0.0.0.0\r\n",i+="a=rtcp:9 IN IP4 0.0.0.0\r\n",n.codecs.forEach(e=>{i+=t.writeRtpMap(e),i+=t.writeFmtp(e),i+=t.writeRtcpFb(e)});let r=0;return n.codecs.forEach(e=>{e.maxptime>r&&(r=e.maxptime)}),r>0&&(i+="a=maxptime:"+r+"\r\n"),n.headerExtensions&&n.headerExtensions.forEach(e=>{i+=t.writeExtmap(e)}),i},t.parseRtpEncodingParameters=function(e){const n=[],i=t.parseRtpParameters(e),r=-1!==i.fecMechanisms.indexOf("RED"),o=-1!==i.fecMechanisms.indexOf("ULPFEC"),a=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute),s=a.length>0&&a[0].ssrc;let c;const l=t.matchPrefix(e,"a=ssrc-group:FID").map(e=>e.substring(17).split(" ").map(e=>parseInt(e,10)));l.length>0&&l[0].length>1&&l[0][0]===s&&(c=l[0][1]),i.codecs.forEach(e=>{if("RTX"===e.name.toUpperCase()&&e.parameters.apt){let t={ssrc:s,codecPayloadType:parseInt(e.parameters.apt,10)};s&&c&&(t.rtx={ssrc:c}),n.push(t),r&&(t=JSON.parse(JSON.stringify(t)),t.fec={ssrc:s,mechanism:o?"red+ulpfec":"red"},n.push(t))}}),0===n.length&&s&&n.push({ssrc:s});let u=t.matchPrefix(e,"b=");return u.length&&(u=0===u[0].indexOf("b=TIAS:")?parseInt(u[0].substring(7),10):0===u[0].indexOf("b=AS:")?1e3*parseInt(u[0].substring(5),10)*.95-16e3:void 0,n.forEach(e=>{e.maxBitrate=u})),n},t.parseRtcpParameters=function(e){const n={},i=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"cname"===e.attribute)[0];i&&(n.cname=i.value,n.ssrc=i.ssrc);const r=t.matchPrefix(e,"a=rtcp-rsize");n.reducedSize=r.length>0,n.compound=0===r.length;const o=t.matchPrefix(e,"a=rtcp-mux");return n.mux=o.length>0,n},t.writeRtcpParameters=function(e){let t="";return e.reducedSize&&(t+="a=rtcp-rsize\r\n"),e.mux&&(t+="a=rtcp-mux\r\n"),void 0!==e.ssrc&&e.cname&&(t+="a=ssrc:"+e.ssrc+" cname:"+e.cname+"\r\n"),t},t.parseMsid=function(e){let n;const i=t.matchPrefix(e,"a=msid:");if(1===i.length)return n=i[0].substring(7).split(" "),{stream:n[0],track:n[1]};const r=t.matchPrefix(e,"a=ssrc:").map(e=>t.parseSsrcMedia(e)).filter(e=>"msid"===e.attribute);return r.length>0?(n=r[0].value.split(" "),{stream:n[0],track:n[1]}):void 0},t.parseSctpDescription=function(e){const n=t.parseMLine(e),i=t.matchPrefix(e,"a=max-message-size:");let r;i.length>0&&(r=parseInt(i[0].substring(19),10)),isNaN(r)&&(r=65536);const o=t.matchPrefix(e,"a=sctp-port:");if(o.length>0)return{port:parseInt(o[0].substring(12),10),protocol:n.fmt,maxMessageSize:r};const a=t.matchPrefix(e,"a=sctpmap:");if(a.length>0){const e=a[0].substring(10).split(" ");return{port:parseInt(e[0],10),protocol:e[1],maxMessageSize:r}}},t.writeSctpDescription=function(e,t){let n=[];return n="DTLS/SCTP"!==e.protocol?["m="+e.kind+" 9 "+e.protocol+" "+t.protocol+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctp-port:"+t.port+"\r\n"]:["m="+e.kind+" 9 "+e.protocol+" "+t.port+"\r\n","c=IN IP4 0.0.0.0\r\n","a=sctpmap:"+t.port+" "+t.protocol+" 65535\r\n"],void 0!==t.maxMessageSize&&n.push("a=max-message-size:"+t.maxMessageSize+"\r\n"),n.join("")},t.generateSessionId=function(){return Math.random().toString().substr(2,22)},t.writeSessionBoilerplate=function(e,n,i){let r;const o=void 0!==n?n:2;return r=e||t.generateSessionId(),"v=0\r\no="+(i||"thisisadapterortc")+" "+r+" "+o+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.getDirection=function(e,n){const i=t.splitLines(e);for(let t=0;t<i.length;t++)switch(i[t]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return i[t].substring(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substring(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){const n=t.splitLines(e)[0].substring(2).split(" ");return{kind:n[0],port:parseInt(n[1],10),protocol:n[2],fmt:n.slice(3).join(" ")}},t.parseOLine=function(e){const n=t.matchPrefix(e,"o=")[0].substring(2).split(" ");return{username:n[0],sessionId:n[1],sessionVersion:parseInt(n[2],10),netType:n[3],addressType:n[4],address:n[5]}},t.isValidSDP=function(e){if("string"!==typeof e||0===e.length)return!1;const n=t.splitLines(e);for(let t=0;t<n.length;t++)if(n[t].length<2||"="!==n[t].charAt(1))return!1;return!0},e.exports=t}(yu)),yu.exports),ku=sl(bu),Su=ko({__proto__:null,default:ku},[bu]);function wu(e){if(!e.RTCIceCandidate||e.RTCIceCandidate&&"foundation"in e.RTCIceCandidate.prototype)return;const t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){if("object"===typeof e&&e.candidate&&0===e.candidate.indexOf("a=")&&((e=JSON.parse(JSON.stringify(e))).candidate=e.candidate.substring(2)),e.candidate&&e.candidate.length){const n=new t(e),i=ku.parseCandidate(e.candidate);for(const e in i)e in n||Object.defineProperty(n,e,{value:i[e]});return n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}},n}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,Ol(e,"icecandidate",t=>(t.candidate&&Object.defineProperty(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t))}function Tu(e){!e.RTCIceCandidate||e.RTCIceCandidate&&"relayProtocol"in e.RTCIceCandidate.prototype||Ol(e,"icecandidate",e=>{if(e.candidate){const t=ku.parseCandidate(e.candidate.candidate);"relay"===t.type&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[t.priority>>24])}return e})}function Cu(e,t){if(!e.RTCPeerConnection)return;"sctp"in e.RTCPeerConnection.prototype||Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp}});const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&t.version>=76){const{sdpSemantics:e}=this.getConfiguration();"plan-b"===e&&Object.defineProperty(this,"sctp",{get(){return"undefined"===typeof this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(function(e){if(!e||!e.sdp)return!1;const t=ku.splitSections(e.sdp);return t.shift(),t.some(e=>{const t=ku.parseMLine(e);return t&&"application"===t.kind&&-1!==t.protocol.indexOf("SCTP")})}(arguments[0])){const e=function(e){const t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(null===t||t.length<2)return-1;const n=parseInt(t[1],10);return n!==n?-1:n}(arguments[0]),n=function(e){let n=65536;return"firefox"===t.browser&&(n=t.version<57?-1===e?16384:2147483637:t.version<60?57===t.version?65535:65536:2147483637),n}(e),i=function(e,n){let i=65536;"firefox"===t.browser&&57===t.version&&(i=65535);const r=ku.matchPrefix(e.sdp,"a=max-message-size:");return r.length>0?i=parseInt(r[0].substring(19),10):"firefox"===t.browser&&-1!==n&&(i=2147483637),i}(arguments[0],e);let r;r=0===n&&0===i?Number.POSITIVE_INFINITY:0===n||0===i?Math.max(n,i):Math.min(n,i);const o={};Object.defineProperty(o,"maxMessageSize",{get:()=>r}),this._sctp=o}return n.apply(this,arguments)}}function Eu(e){if(!e.RTCPeerConnection||!("createDataChannel"in e.RTCPeerConnection.prototype))return;function t(e,t){const n=e.send;e.send=function(){const i=arguments[0],r=i.length||i.size||i.byteLength;if("open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}const n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){const e=n.apply(this,arguments);return t(e,this),e},Ol(e,"datachannel",e=>(t(e.channel,e.target),e))}function Pu(e){if(!e.RTCPeerConnection||"connectionState"in e.RTCPeerConnection.prototype)return;const t=e.RTCPeerConnection.prototype;Object.defineProperty(t,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(e=>{const n=t[e];t[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=e=>{const t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;const n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),n.apply(this,arguments)}})}function Ru(e,t){if(!e.RTCPeerConnection)return;if("chrome"===t.browser&&t.version>=71)return;if("safari"===t.browser&&t._safariVersion>=13.1)return;const n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(t){if(t&&t.sdp&&-1!==t.sdp.indexOf("\na=extmap-allow-mixed")){const n=t.sdp.split("\n").filter(e=>"a=extmap-allow-mixed"!==e.trim()).join("\n");e.RTCSessionDescription&&t instanceof e.RTCSessionDescription?arguments[0]=new e.RTCSessionDescription({type:t.type,sdp:n}):t.sdp=n}return n.apply(this,arguments)}}function _u(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.addIceCandidate;n&&0!==n.length&&(e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?("chrome"===t.browser&&t.version<78||"firefox"===t.browser&&t.version<68||"safari"===t.browser)&&arguments[0]&&""===arguments[0].candidate?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Ou(e,t){if(!e.RTCPeerConnection||!e.RTCPeerConnection.prototype)return;const n=e.RTCPeerConnection.prototype.setLocalDescription;n&&0!==n.length&&(e.RTCPeerConnection.prototype.setLocalDescription=function(){let e=arguments[0]||{};if("object"!==typeof e||e.type&&e.sdp)return n.apply(this,arguments);if(e={type:e.type,sdp:e.sdp},!e.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":e.type="offer";break;default:e.type="answer"}if(e.sdp||"offer"!==e.type&&"answer"!==e.type)return n.apply(this,[e]);return("offer"===e.type?this.createOffer:this.createAnswer).apply(this).then(e=>n.apply(this,[e]))})}var xu=Object.freeze({__proto__:null,removeExtmapAllowMixed:Ru,shimAddIceCandidateNullOrEmpty:_u,shimConnectionState:Pu,shimMaxMessageSize:Cu,shimParameterlessSetLocalDescription:Ou,shimRTCIceCandidate:wu,shimRTCIceCandidateRelayProtocol:Tu,shimSendThrowTypeError:Eu});!function(){let{window:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=Nl,i=function(e){const t={browser:null,version:null};if("undefined"===typeof e||!e.navigator||!e.navigator.userAgent)return t.browser="Not a browser.",t;const{navigator:n}=e;if(n.userAgentData&&n.userAgentData.brands){const e=n.userAgentData.brands.find(e=>"Chromium"===e.brand);if(e)return{browser:"chrome",version:parseInt(e.version,10)}}if(n.mozGetUserMedia)t.browser="firefox",t.version=parseInt(_l(n.userAgent,/Firefox\/(\d+)\./,1));else if(n.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection)t.browser="chrome",t.version=parseInt(_l(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2));else{if(!e.RTCPeerConnection||!n.userAgent.match(/AppleWebKit\/(\d+)\./))return t.browser="Not a supported browser.",t;t.browser="safari",t.version=parseInt(_l(n.userAgent,/AppleWebKit\/(\d+)\./,1)),t.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype,t._safariVersion=_l(n.userAgent,/Version\/(\d+(\.?\d+))/,1)}return t}(e),r={browserDetails:i,commonShim:xu,extractVersion:_l,disableLog:xl,disableWarnings:Il,sdp:Su};switch(i.browser){case"chrome":if(!Jl||!Kl||!t.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(null===i.version)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=Jl,_u(e,i),Ou(e),Fl(e,i),Bl(e),Kl(e,i),zl(e),Wl(e,i),ql(e),Vl(e),Gl(e,i),wu(e),Tu(e),Pu(e),Cu(e,i),Eu(e),Ru(e,i);break;case"firefox":if(!au||!Yl||!t.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=au,_u(e,i),Ou(e),Ql(e,i),Yl(e,i),$l(e),eu(e),Xl(e),Zl(e),tu(e),nu(e),iu(e),ru(e),ou(e),wu(e),Pu(e),Cu(e,i),Eu(e);break;case"safari":if(!vu||!t.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=vu,_u(e,i),Ou(e),hu(e),fu(e),lu(e),su(e),cu(e),pu(e),uu(e),mu(e),wu(e),Tu(e),Cu(e,i),Eu(e),Ru(e,i);break;default:n("Unsupported browser!")}}({window:"undefined"===typeof window?void 0:window});const Iu="lk_e2ee";var Nu,Au,Du,Lu;function Mu(){return"undefined"!==typeof window.RTCRtpSender&&"undefined"!==typeof window.RTCRtpSender.prototype.createEncodedStreams||ju()}function ju(){return"undefined"!==typeof window.RTCRtpScriptTransform}!function(e){e.SetKey="setKey",e.RatchetRequest="ratchetRequest",e.KeyRatcheted="keyRatcheted"}(Nu||(Nu={})),function(e){e.KeyRatcheted="keyRatcheted"}(Au||(Au={})),function(e){e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError"}(Du||(Du={})),function(e){e.Error="cryptorError"}(Lu||(Lu={}));El.EventEmitter;class Uu extends Error{constructor(e,t){super(t||"an error has occured"),this.name="LiveKitError",this.code=e}}var Fu,Bu,zu,qu,Vu,Hu,Wu,Ku;!function(e){e[e.NotAllowed=0]="NotAllowed",e[e.ServerUnreachable=1]="ServerUnreachable",e[e.InternalError=2]="InternalError",e[e.Cancelled=3]="Cancelled",e[e.LeaveRequest=4]="LeaveRequest",e[e.Timeout=5]="Timeout"}(Fu||(Fu={}));class Gu extends Uu{constructor(e,t,n,i){super(1,e),this.name="ConnectionError",this.status=n,this.reason=t,this.context=i,this.reasonName=Fu[t]}}class Ju extends Uu{constructor(e){super(21,null!==e&&void 0!==e?e:"device is unsupported"),this.name="DeviceUnsupportedError"}}class Qu extends Uu{constructor(e){super(20,null!==e&&void 0!==e?e:"track is invalid"),this.name="TrackInvalidError"}}class $u extends Uu{constructor(e){super(10,null!==e&&void 0!==e?e:"unsupported server"),this.name="UnsupportedServer"}}class Yu extends Uu{constructor(e){super(12,null!==e&&void 0!==e?e:"unexpected connection state"),this.name="UnexpectedConnectionState"}}class Xu extends Uu{constructor(e){super(13,null!==e&&void 0!==e?e:"unable to negotiate"),this.name="NegotiationError"}}class Zu extends Uu{constructor(e,t){super(15,e),this.name="PublishTrackError",this.status=t}}class ed extends Uu{constructor(e,t){super(15,e),this.reason=t,this.reasonName="string"===typeof t?t:el[t]}}!function(e){e[e.AlreadyOpened=0]="AlreadyOpened",e[e.AbnormalEnd=1]="AbnormalEnd",e[e.DecodeFailed=2]="DecodeFailed",e[e.LengthExceeded=3]="LengthExceeded",e[e.Incomplete=4]="Incomplete",e[e.HandlerAlreadyRegistered=7]="HandlerAlreadyRegistered",e[e.EncryptionTypeMismatch=8]="EncryptionTypeMismatch"}(Bu||(Bu={}));class td extends Uu{constructor(e,t){super(16,e),this.name="DataStreamError",this.reason=t,this.reasonName=Bu[t]}}!function(e){e.PermissionDenied="PermissionDenied",e.NotFound="NotFound",e.DeviceInUse="DeviceInUse",e.Other="Other"}(zu||(zu={})),function(e){e.getFailure=function(t){if(t&&"name"in t)return"NotFoundError"===t.name||"DevicesNotFoundError"===t.name?e.NotFound:"NotAllowedError"===t.name||"PermissionDeniedError"===t.name?e.PermissionDenied:"NotReadableError"===t.name||"TrackStartError"===t.name?e.DeviceInUse:e.Other}}(zu||(zu={})),function(e){e[e.InvalidKey=0]="InvalidKey",e[e.MissingKey=1]="MissingKey",e[e.InternalError=2]="InternalError"}(qu||(qu={}));function nd(e){return"undefined"===typeof e?e:"function"===typeof structuredClone?"object"===typeof e&&null!==e?structuredClone(Object.assign({},e)):structuredClone(e):JSON.parse(JSON.stringify(e))}!function(e){e.Connected="connected",e.Reconnecting="reconnecting",e.SignalReconnecting="signalReconnecting",e.Reconnected="reconnected",e.Disconnected="disconnected",e.ConnectionStateChanged="connectionStateChanged",e.Moved="moved",e.MediaDevicesChanged="mediaDevicesChanged",e.ParticipantConnected="participantConnected",e.ParticipantDisconnected="participantDisconnected",e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalAudioSilenceDetected="localAudioSilenceDetected",e.ActiveSpeakersChanged="activeSpeakersChanged",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.ParticipantAttributesChanged="participantAttributesChanged",e.ParticipantActive="participantActive",e.RoomMetadataChanged="roomMetadataChanged",e.DataReceived="dataReceived",e.SipDTMFReceived="sipDTMFReceived",e.TranscriptionReceived="transcriptionReceived",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.AudioPlaybackStatusChanged="audioPlaybackChanged",e.VideoPlaybackStatusChanged="videoPlaybackChanged",e.MediaDevicesError="mediaDevicesError",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.SignalConnected="signalConnected",e.RecordingStatusChanged="recordingStatusChanged",e.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",e.EncryptionError="encryptionError",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ActiveDeviceChanged="activeDeviceChanged",e.ChatMessage="chatMessage",e.LocalTrackSubscribed="localTrackSubscribed",e.MetricsReceived="metricsReceived"}(Vu||(Vu={})),function(e){e.TrackPublished="trackPublished",e.TrackSubscribed="trackSubscribed",e.TrackSubscriptionFailed="trackSubscriptionFailed",e.TrackUnpublished="trackUnpublished",e.TrackUnsubscribed="trackUnsubscribed",e.TrackMuted="trackMuted",e.TrackUnmuted="trackUnmuted",e.LocalTrackPublished="localTrackPublished",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalTrackCpuConstrained="localTrackCpuConstrained",e.LocalSenderCreated="localSenderCreated",e.ParticipantMetadataChanged="participantMetadataChanged",e.ParticipantNameChanged="participantNameChanged",e.DataReceived="dataReceived",e.SipDTMFReceived="sipDTMFReceived",e.TranscriptionReceived="transcriptionReceived",e.IsSpeakingChanged="isSpeakingChanged",e.ConnectionQualityChanged="connectionQualityChanged",e.TrackStreamStateChanged="trackStreamStateChanged",e.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",e.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",e.TrackCpuConstrained="trackCpuConstrained",e.MediaDevicesError="mediaDevicesError",e.AudioStreamAcquired="audioStreamAcquired",e.ParticipantPermissionsChanged="participantPermissionsChanged",e.PCTrackAdded="pcTrackAdded",e.AttributesChanged="attributesChanged",e.LocalTrackSubscribed="localTrackSubscribed",e.ChatMessage="chatMessage",e.Active="active"}(Hu||(Hu={})),function(e){e.TransportsCreated="transportsCreated",e.Connected="connected",e.Disconnected="disconnected",e.Resuming="resuming",e.Resumed="resumed",e.Restarting="restarting",e.Restarted="restarted",e.SignalResumed="signalResumed",e.SignalRestarted="signalRestarted",e.Closing="closing",e.MediaTrackAdded="mediaTrackAdded",e.ActiveSpeakersUpdate="activeSpeakersUpdate",e.DataPacketReceived="dataPacketReceived",e.RTPVideoMapUpdate="rtpVideoMapUpdate",e.DCBufferStatusChanged="dcBufferStatusChanged",e.ParticipantUpdate="participantUpdate",e.RoomUpdate="roomUpdate",e.SpeakersChanged="speakersChanged",e.StreamStateChanged="streamStateChanged",e.ConnectionQualityUpdate="connectionQualityUpdate",e.SubscriptionError="subscriptionError",e.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",e.RemoteMute="remoteMute",e.SubscribedQualityUpdate="subscribedQualityUpdate",e.LocalTrackUnpublished="localTrackUnpublished",e.LocalTrackSubscribed="localTrackSubscribed",e.Offline="offline",e.SignalRequestResponse="signalRequestResponse",e.SignalConnected="signalConnected",e.RoomMoved="roomMoved"}(Wu||(Wu={})),function(e){e.Message="message",e.Muted="muted",e.Unmuted="unmuted",e.Restarted="restarted",e.Ended="ended",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed",e.CpuConstrained="cpuConstrained",e.UpdateSettings="updateSettings",e.UpdateSubscription="updateSubscription",e.AudioPlaybackStarted="audioPlaybackStarted",e.AudioPlaybackFailed="audioPlaybackFailed",e.AudioSilenceDetected="audioSilenceDetected",e.VisibilityChanged="visibilityChanged",e.VideoDimensionsChanged="videoDimensionsChanged",e.VideoPlaybackStarted="videoPlaybackStarted",e.VideoPlaybackFailed="videoPlaybackFailed",e.ElementAttached="elementAttached",e.ElementDetached="elementDetached",e.UpstreamPaused="upstreamPaused",e.UpstreamResumed="upstreamResumed",e.SubscriptionPermissionChanged="subscriptionPermissionChanged",e.SubscriptionStatusChanged="subscriptionStatusChanged",e.SubscriptionFailed="subscriptionFailed",e.TrackProcessorUpdate="trackProcessorUpdate",e.AudioTrackFeatureUpdate="audioTrackFeatureUpdate",e.TranscriptionReceived="transcriptionReceived",e.TimeSyncUpdate="timeSyncUpdate",e.PreConnectBufferFlushed="preConnectBufferFlushed"}(Ku||(Ku={}));const id=/version\/(\d+(\.?_?\d+)+)/i;let rd;function od(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("undefined"===typeof e&&"undefined"===typeof navigator)return;const n=(null!==e&&void 0!==e?e:navigator.userAgent).toLowerCase();if(void 0===rd||t){const e=ad.find(e=>{let{test:t}=e;return t.test(n)});rd=null===e||void 0===e?void 0:e.describe(n)}return rd}const ad=[{test:/firefox|iceweasel|fxios/i,describe:e=>({name:"Firefox",version:sd(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("fxios")?"iOS":void 0,osVersion:cd(e)})},{test:/chrom|crios|crmo/i,describe:e=>({name:"Chrome",version:sd(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,e),os:e.toLowerCase().includes("crios")?"iOS":void 0,osVersion:cd(e)})},{test:/safari|applewebkit/i,describe:e=>({name:"Safari",version:sd(id,e),os:e.includes("mobile/")?"iOS":"macOS",osVersion:cd(e)})}];function sd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;const i=t.match(e);return i&&i.length>=n&&i[n]||""}function cd(e){return e.includes("mac os")?sd(/\(.+?(\d+_\d+(:?_\d+)?)/,e,1).replace(/_/g,"."):void 0}class ld{}ld.setTimeout=function(){return setTimeout(...arguments)},ld.setInterval=function(){return setInterval(...arguments)},ld.clearTimeout=function(){return clearTimeout(...arguments)},ld.clearInterval=function(){return clearInterval(...arguments)};const ud=[];var dd;!function(e){e[e.LOW=0]="LOW",e[e.MEDIUM=1]="MEDIUM",e[e.HIGH=2]="HIGH"}(dd||(dd={}));class hd extends El.EventEmitter{get streamState(){return this._streamState}setStreamState(e){this._streamState=e}constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var i;super(),this.attachedElements=[],this.isMuted=!1,this._streamState=hd.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=fl,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),"hidden"===document.visibilityState?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),5e3):this.handleAppVisibilityChanged()},this.log=ml(null!==(i=n.loggerName)&&void 0!==i?i:hl.Track),this.loggerContextCb=n.loggerContextCb,this.setMaxListeners(100),this.kind=t,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=hd.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),wh(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let t="audio";this.kind===hd.Kind.Video&&(t="video"),0===this.attachedElements.length&&this.kind===hd.Kind.Video&&this.addAppVisibilityListener(),e||("audio"===t&&(ud.forEach(t=>{null!==t.parentElement||e||(e=t)}),e&&ud.splice(ud.indexOf(e),1)),e||(e=document.createElement(t))),this.attachedElements.includes(e)||this.attachedElements.push(e),pd(this.mediaStreamTrack,e);const n=e.srcObject.getTracks(),i=n.some(e=>"audio"===e.kind);return e.play().then(()=>{this.emit(i?Ku.AudioPlaybackStarted:Ku.VideoPlaybackStarted)}).catch(t=>{"NotAllowedError"===t.name?this.emit(i?Ku.AudioPlaybackFailed:Ku.VideoPlaybackFailed,t):"AbortError"===t.name?fl.debug("".concat(i?"audio":"video"," playback aborted, likely due to new play request")):fl.warn("could not playback ".concat(i?"audio":"video"),t),i&&e&&n.some(e=>"video"===e.kind)&&"NotAllowedError"===t.name&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(Ku.ElementAttached,e),e}detach(e){try{if(e){fd(this.mediaStreamTrack,e);const t=this.attachedElements.indexOf(e);return t>=0&&(this.attachedElements.splice(t,1),this.recycleElement(e),this.emit(Ku.ElementDetached,e)),e}const t=[];return this.attachedElements.forEach(e=>{fd(this.mediaStreamTrack,e),t.push(e),this.recycleElement(e),this.emit(Ku.ElementDetached,e)}),this.attachedElements=[],t}finally{0===this.attachedElements.length&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval),this.timeSyncHandle&&cancelAnimationFrame(this.timeSyncHandle)}updateLoggerOptions(e){e.loggerName&&(this.log=ml(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let t=!0;e.pause(),ud.forEach(e=>{e.parentElement||(t=!1)}),t&&ud.push(e)}}handleAppVisibilityChanged(){return kl(this,void 0,void 0,function*(){this.isInBackground="hidden"===document.visibilityState,this.isInBackground||this.kind!==hd.Kind.Video||setTimeout(()=>this.attachedElements.forEach(e=>e.play().catch(()=>{})),0)})}addAppVisibilityListener(){Md()?(this.isInBackground="hidden"===document.visibilityState,document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Md()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function pd(e,t){let n,i;n=t.srcObject instanceof MediaStream?t.srcObject:new MediaStream,i="audio"===e.kind?n.getAudioTracks():n.getVideoTracks(),i.includes(e)||(i.forEach(e=>{n.removeTrack(e)}),n.addTrack(e)),Nd()&&t instanceof HTMLVideoElement||(t.autoplay=!0),t.muted=0===n.getAudioTracks().length,t instanceof HTMLVideoElement&&(t.playsInline=!0),t.srcObject!==n&&(t.srcObject=n,(Nd()||xd())&&t instanceof HTMLVideoElement&&setTimeout(()=>{t.srcObject=n,t.play().catch(()=>{})},0))}function fd(e,t){if(t.srcObject instanceof MediaStream){const n=t.srcObject;n.removeTrack(e),n.getTracks().length>0?t.srcObject=n:t.srcObject=null}}!function(e){let t,n,i;!function(e){e.Audio="audio",e.Video="video",e.Unknown="unknown"}(t=e.Kind||(e.Kind={})),function(e){e.Camera="camera",e.Microphone="microphone",e.ScreenShare="screen_share",e.ScreenShareAudio="screen_share_audio",e.Unknown="unknown"}(n=e.Source||(e.Source={})),function(e){e.Active="active",e.Paused="paused",e.Unknown="unknown"}(i=e.StreamState||(e.StreamState={})),e.kindToProto=function(e){switch(e){case t.Audio:return cs.AUDIO;case t.Video:return cs.VIDEO;default:return cs.DATA}},e.kindFromProto=function(e){switch(e){case cs.AUDIO:return t.Audio;case cs.VIDEO:return t.Video;default:return t.Unknown}},e.sourceToProto=function(e){switch(e){case n.Camera:return ls.CAMERA;case n.Microphone:return ls.MICROPHONE;case n.ScreenShare:return ls.SCREEN_SHARE;case n.ScreenShareAudio:return ls.SCREEN_SHARE_AUDIO;default:return ls.UNKNOWN}},e.sourceFromProto=function(e){switch(e){case ls.CAMERA:return n.Camera;case ls.MICROPHONE:return n.Microphone;case ls.SCREEN_SHARE:return n.ScreenShare;case ls.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}},e.streamStateFromProto=function(e){switch(e){case sc.ACTIVE:return i.Active;case sc.PAUSED:return i.Paused;default:return i.Unknown}}}(hd||(hd={}));class md{constructor(e,t,n,i,r){if("object"===typeof e)this.width=e.width,this.height=e.height,this.aspectRatio=e.aspectRatio,this.encoding={maxBitrate:e.maxBitrate,maxFramerate:e.maxFramerate,priority:e.priority};else{if(void 0===t||void 0===n)throw new TypeError("Unsupported options: provide at least width, height and maxBitrate");this.width=e,this.height=t,this.aspectRatio=e/t,this.encoding={maxBitrate:n,maxFramerate:i,priority:r}}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.aspectRatio}}}const gd=["vp8","h264"],vd=["vp8","h264","vp9","av1","h265"];const yd=function(e){return!!gd.find(t=>t===e)};var bd,kd;!function(e){e[e.PREFER_REGRESSION=0]="PREFER_REGRESSION",e[e.SIMULCAST=1]="SIMULCAST",e[e.REGRESSION=2]="REGRESSION"}(bd||(bd={})),function(e){e.telephone={maxBitrate:12e3},e.speech={maxBitrate:24e3},e.music={maxBitrate:48e3},e.musicStereo={maxBitrate:64e3},e.musicHighQuality={maxBitrate:96e3},e.musicHighQualityStereo={maxBitrate:128e3}}(kd||(kd={}));const Sd={h90:new md(160,90,9e4,20),h180:new md(320,180,16e4,20),h216:new md(384,216,18e4,20),h360:new md(640,360,45e4,20),h540:new md(960,540,8e5,25),h720:new md(1280,720,17e5,30),h1080:new md(1920,1080,3e6,30),h1440:new md(2560,1440,5e6,30),h2160:new md(3840,2160,8e6,30)},wd={h120:new md(160,120,7e4,20),h180:new md(240,180,125e3,20),h240:new md(320,240,14e4,20),h360:new md(480,360,33e4,20),h480:new md(640,480,5e5,20),h540:new md(720,540,6e5,25),h720:new md(960,720,13e5,30),h1080:new md(1440,1080,23e5,30),h1440:new md(1920,1440,38e5,30)},Td={h360fps3:new md(640,360,2e5,3,"medium"),h360fps15:new md(640,360,4e5,15,"medium"),h720fps5:new md(1280,720,8e5,5,"medium"),h720fps15:new md(1280,720,15e5,15,"medium"),h720fps30:new md(1280,720,2e6,30,"medium"),h1080fps15:new md(1920,1080,25e5,15,"medium"),h1080fps30:new md(1920,1080,5e6,30,"medium"),original:new md(0,0,7e6,30,"medium")},Cd="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function Ed(e){return kl(this,void 0,void 0,function*(){return new Promise(t=>ld.setTimeout(t,e))})}function Pd(){return"addTransceiver"in RTCPeerConnection.prototype}function Rd(){return"addTrack"in RTCPeerConnection.prototype}function _d(e){return"av1"===e||"vp9"===e}function Od(e){return!(!document||Ad())&&(e||(e=document.createElement("audio")),"setSinkId"in e)}function xd(){var e;return"Firefox"===(null===(e=od())||void 0===e?void 0:e.name)}function Id(){const e=od();return!!e&&"Chrome"===e.name&&"iOS"!==e.os}function Nd(){var e;return"Safari"===(null===(e=od())||void 0===e?void 0:e.name)}function Ad(){const e=od();return"Safari"===(null===e||void 0===e?void 0:e.name)||"iOS"===(null===e||void 0===e?void 0:e.os)}function Dd(){const e=od();return"Safari"===(null===e||void 0===e?void 0:e.name)&&e.version.startsWith("17.")||"iOS"===(null===e||void 0===e?void 0:e.os)&&!!(null===e||void 0===e?void 0:e.osVersion)&&qd(e.osVersion,"17")>=0}function Ld(){var e,t;return!!Md()&&(null!==(t=null===(e=navigator.userAgentData)||void 0===e?void 0:e.mobile)&&void 0!==t?t:/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent))}function Md(){return"undefined"!==typeof document}function jd(){return"ReactNative"==navigator.product}function Ud(e){return e.hostname.endsWith(".livekit.cloud")||e.hostname.endsWith(".livekit.run")}function Fd(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function Bd(){if(!jd())return;let e=Fd();return e?e.platform:void 0}function zd(){if(Md())return window.devicePixelRatio;if(jd()){let e=Fd();if(e)return e.devicePixelRatio}return 1}function qd(e,t){const n=e.split("."),i=t.split("."),r=Math.min(n.length,i.length);for(let o=0;o<r;++o){const e=parseInt(n[o],10),t=parseInt(i[o],10);if(e>t)return 1;if(e<t)return-1;if(o===r-1&&e===t)return 0}return""===e&&""!==t?-1:""===t?1:n.length==i.length?0:n.length<i.length?-1:1}function Vd(e){for(const t of e)t.target.handleResize(t)}function Hd(e){for(const t of e)t.target.handleVisibilityChanged(t)}let Wd=null;const Kd=()=>(Wd||(Wd=new ResizeObserver(Vd)),Wd);let Gd=null;const Jd=()=>(Gd||(Gd=new IntersectionObserver(Hd,{root:null,rootMargin:"0px"})),Gd);let Qd;function $d(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:16,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:16,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const r=document.createElement("canvas");r.width=e,r.height=t;const o=r.getContext("2d");null===o||void 0===o||o.fillRect(0,0,r.width,r.height),i&&o&&(o.beginPath(),o.arc(e/2,t/2,50,0,2*Math.PI,!0),o.closePath(),o.fillStyle="grey",o.fill());const a=r.captureStream(),[s]=a.getTracks();if(!s)throw Error("Could not get empty media stream video track");return s.enabled=n,s}function Yd(){if(!Qd){const e=new AudioContext,t=e.createOscillator(),n=e.createGain();n.gain.setValueAtTime(0,0);const i=e.createMediaStreamDestination();if(t.connect(n),n.connect(i),t.start(),[Qd]=i.stream.getAudioTracks(),!Qd)throw Error("Could not get empty media stream audio track");Qd.enabled=!1}return Qd.clone()}class Xd{get isResolved(){return this._isResolved}constructor(e,t){this._isResolved=!1,this.onFinally=t,this.promise=new Promise((t,n)=>kl(this,void 0,void 0,function*(){this.resolve=t,this.reject=n,e&&(yield e(t,n))})).finally(()=>{var e;this._isResolved=!0,null===(e=this.onFinally)||void 0===e||e.call(this)})}}function Zd(e){if("string"===typeof e||"number"===typeof e)return e;if(Array.isArray(e))return e[0];if(void 0!==e.exact)return Array.isArray(e.exact)?e.exact[0]:e.exact;if(void 0!==e.ideal)return Array.isArray(e.ideal)?e.ideal[0]:e.ideal;throw Error("could not unwrap constraint")}function eh(e){return e.startsWith("ws")?e.replace(/^(ws)/,"http"):e}function th(e){switch(e.reason){case Fu.LeaveRequest:return e.context;case Fu.Cancelled:return ps.CLIENT_INITIATED;case Fu.NotAllowed:return ps.USER_REJECTED;case Fu.ServerUnreachable:return ps.JOIN_FAILURE;default:return ps.UNKNOWN_REASON}}function nh(e){return void 0!==e?Number(e):void 0}function ih(e){return void 0!==e?BigInt(e):void 0}function rh(e){return!!e&&!(e instanceof MediaStreamTrack)&&e.isLocal}function oh(e){return!!e&&e.kind==hd.Kind.Audio}function ah(e){return!!e&&e.kind==hd.Kind.Video}function sh(e){return rh(e)&&ah(e)}function ch(e){return rh(e)&&oh(e)}function lh(e){return!!e&&!e.isLocal}function uh(e){return!!e&&!e.isLocal}function dh(e){return lh(e)&&ah(e)}function hh(e,t,n){var i,r,o,a;const{optionsWithoutProcessor:s,audioProcessor:c,videoProcessor:l}=Th(null!==e&&void 0!==e?e:{}),u=null===t||void 0===t?void 0:t.processor,d=null===n||void 0===n?void 0:n.processor,h=null!==s&&void 0!==s?s:{};return!0===h.audio&&(h.audio={}),!0===h.video&&(h.video={}),h.audio&&(ph(h.audio,t),null!==(i=(o=h.audio).deviceId)&&void 0!==i||(o.deviceId={ideal:"default"}),(c||u)&&(h.audio.processor=null!==c&&void 0!==c?c:u)),h.video&&(ph(h.video,n),null!==(r=(a=h.video).deviceId)&&void 0!==r||(a.deviceId={ideal:"default"}),(l||d)&&(h.video.processor=null!==l&&void 0!==l?l:d)),h}function ph(e,t){return Object.keys(t).forEach(n=>{void 0===e[n]&&(e[n]=t[n])}),e}function fh(e){var t,n,i,r;const o={};if(e.video)if("object"===typeof e.video){const n={},r=n,a=e.video;Object.keys(a).forEach(e=>{if("resolution"===e)ph(r,a.resolution);else r[e]=a[e]}),o.video=n,null!==(t=(i=o.video).deviceId)&&void 0!==t||(i.deviceId={ideal:"default"})}else o.video=!!e.video&&{deviceId:{ideal:"default"}};else o.video=!1;return e.audio?"object"===typeof e.audio?(o.audio=e.audio,null!==(n=(r=o.audio).deviceId)&&void 0!==n||(r.deviceId={ideal:"default"})):o.audio={deviceId:{ideal:"default"}}:o.audio=!1,o}function mh(e){return kl(this,arguments,void 0,function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:200;return function*(){const n=gh();if(n){const i=n.createAnalyser();i.fftSize=2048;const r=i.frequencyBinCount,o=new Uint8Array(r);n.createMediaStreamSource(new MediaStream([e.mediaStreamTrack])).connect(i),yield Ed(t),i.getByteTimeDomainData(o);const a=o.some(e=>128!==e&&0!==e);return n.close(),!a}return!1}()})}function gh(){var e;const t="undefined"!==typeof window&&(window.AudioContext||window.webkitAudioContext);if(t){const n=new t({latencyHint:"interactive"});if("suspended"===n.state&&"undefined"!==typeof window&&(null===(e=window.document)||void 0===e?void 0:e.body)){const e=()=>kl(this,void 0,void 0,function*(){var t;try{"suspended"===n.state&&(yield n.resume())}catch(So){console.warn("Error trying to auto-resume audio context",So)}finally{null===(t=window.document.body)||void 0===t||t.removeEventListener("click",e)}});n.addEventListener("statechange",()=>{var t;"closed"===n.state&&(null===(t=window.document.body)||void 0===t||t.removeEventListener("click",e))}),window.document.body.addEventListener("click",e)}return n}}function vh(e){return"audioinput"===e?hd.Source.Microphone:"videoinput"===e?hd.Source.Camera:hd.Source.Unknown}function yh(e){return e===hd.Source.Microphone?"audioinput":e===hd.Source.Camera?"videoinput":void 0}function bh(e){var t,n;let i=null===(t=e.video)||void 0===t||t;return e.resolution&&e.resolution.width>0&&e.resolution.height>0&&(i="boolean"===typeof i?{}:i,i=Nd()?Object.assign(Object.assign({},i),{width:{max:e.resolution.width},height:{max:e.resolution.height},frameRate:e.resolution.frameRate}):Object.assign(Object.assign({},i),{width:{ideal:e.resolution.width},height:{ideal:e.resolution.height},frameRate:e.resolution.frameRate})),{audio:null!==(n=e.audio)&&void 0!==n&&n,video:i,controller:e.controller,selfBrowserSurface:e.selfBrowserSurface,surfaceSwitching:e.surfaceSwitching,systemAudio:e.systemAudio,preferCurrentTab:e.preferCurrentTab}}function kh(e){return e.split("/")[1].toLowerCase()}function Sh(e){const t=[];return e.forEach(e=>{void 0!==e.track&&t.push(new vc({cid:e.track.mediaStreamID,track:e.trackInfo}))}),t}function wh(e){return"mediaStreamTrack"in e?{trackID:e.sid,source:e.source,muted:e.isMuted,enabled:e.mediaStreamTrack.enabled,kind:e.kind,streamID:e.mediaStreamID,streamTrackID:e.mediaStreamTrack.id}:{trackID:e.trackSid,enabled:e.isEnabled,muted:e.isMuted,trackInfo:Object.assign({mimeType:e.mimeType,name:e.trackName,encrypted:e.isEncrypted,kind:e.kind,source:e.source},e.track?wh(e.track):{})}}function Th(e){const t=Object.assign({},e);let n,i;return"object"===typeof t.audio&&t.audio.processor&&(n=t.audio.processor,t.audio=Object.assign(Object.assign({},t.audio),{processor:void 0})),"object"===typeof t.video&&t.video.processor&&(i=t.video.processor,t.video=Object.assign(Object.assign({},t.video),{processor:void 0})),{audioProcessor:n,videoProcessor:i,optionsWithoutProcessor:nd(t)}}function Ch(e,t){return e.width*e.height<t.width*t.height}class Eh extends El.EventEmitter{constructor(e,t){super(),this.decryptDataRequests=new Map,this.encryptDataRequests=new Map,this.onWorkerMessage=e=>{var t,n;const{kind:i,data:r}=e.data;switch(i){case"error":fl.error(r.error.message),this.emit(Du.EncryptionError,r.error);break;case"initAck":r.enabled&&this.keyProvider.getKeys().forEach(e=>{this.postKey(e)});break;case"enable":if(r.enabled&&this.keyProvider.getKeys().forEach(e=>{this.postKey(e)}),this.encryptionEnabled!==r.enabled&&r.participantIdentity===(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))this.emit(Du.ParticipantEncryptionStatusChanged,r.enabled,this.room.localParticipant),this.encryptionEnabled=r.enabled;else if(r.participantIdentity){const e=null===(n=this.room)||void 0===n?void 0:n.getParticipantByIdentity(r.participantIdentity);if(!e)throw TypeError("couldn't set encryption status, participant not found".concat(r.participantIdentity));this.emit(Du.ParticipantEncryptionStatusChanged,r.enabled,e)}break;case"ratchetKey":this.keyProvider.emit(Nu.KeyRatcheted,r.ratchetResult,r.participantIdentity,r.keyIndex);break;case"decryptDataResponse":const e=this.decryptDataRequests.get(r.uuid);(null===e||void 0===e?void 0:e.resolve)&&e.resolve(r);break;case"encryptDataResponse":const i=this.encryptDataRequests.get(r.uuid);(null===i||void 0===i?void 0:i.resolve)&&i.resolve(r)}},this.onWorkerError=e=>{fl.error("e2ee worker encountered an error:",{error:e.error}),this.emit(Du.EncryptionError,e.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1,this.dataChannelEncryptionEnabled=t}get isEnabled(){return this.encryptionEnabled}get isDataChannelEncryptionEnabled(){return this.isEnabled&&this.dataChannelEncryptionEnabled}setup(e){if(!Mu())throw new Ju("tried to setup end-to-end encryption on an unsupported browser");if(fl.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const t={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions(),loglevel:gl.getLevel()}};this.worker&&(fl.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(t))}}setParticipantCryptorEnabled(e,t){fl.debug("set e2ee to ".concat(e," for participant ").concat(t)),this.postEnable(e,t)}setSifTrailer(e){e&&0!==e.length?this.postSifTrailer(e):fl.warn("ignoring server sent trailer as it's empty")}setupEngine(e){e.on(Wu.RTPVideoMapUpdate,e=>{this.postRTPMap(e)})}setupEventListeners(e,t){e.on(Vu.TrackPublished,(e,t)=>this.setParticipantCryptorEnabled(e.trackInfo.encryption!==Cs.NONE,t.identity)),e.on(Vu.ConnectionStateChanged,t=>{t===hf.Connected&&e.remoteParticipants.forEach(e=>{e.trackPublications.forEach(t=>{this.setParticipantCryptorEnabled(t.trackInfo.encryption!==Cs.NONE,e.identity)})})}).on(Vu.TrackUnsubscribed,(e,t,n)=>{var i;const r={kind:"removeTransform",data:{participantIdentity:n.identity,trackId:e.mediaStreamID}};null===(i=this.worker)||void 0===i||i.postMessage(r)}).on(Vu.TrackSubscribed,(e,t,n)=>{this.setupE2EEReceiver(e,n.identity,t.trackInfo)}).on(Vu.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");t.getKeys().forEach(e=>{this.postKey(e)}),this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity)}),e.localParticipant.on(Hu.LocalSenderCreated,(e,t)=>kl(this,void 0,void 0,function*(){this.setupE2EESender(t,e)})),e.localParticipant.on(Hu.LocalTrackPublished,e=>{if(!ah(e.track)||!Ad())return;const t={kind:"updateCodec",data:{trackId:e.track.mediaStreamID,codec:kh(e.trackInfo.codecs[0].mimeType),participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(t)}),t.on(Nu.SetKey,e=>this.postKey(e)).on(Nu.RatchetRequest,(e,t)=>this.postRatchetRequest(e,t))}encryptData(e){return kl(this,void 0,void 0,function*(){if(!this.worker)throw Error("could not encrypt data, worker is missing");const t=crypto.randomUUID(),n={kind:"encryptDataRequest",data:{uuid:t,payload:e,participantIdentity:this.room.localParticipant.identity}},i=new Xd;return i.onFinally=()=>{this.encryptDataRequests.delete(t)},this.encryptDataRequests.set(t,i),this.worker.postMessage(n),i.promise})}handleEncryptedData(e,t,n,i){if(!this.worker)throw Error("could not handle encrypted data, worker is missing");const r=crypto.randomUUID(),o={kind:"decryptDataRequest",data:{uuid:r,payload:e,iv:t,participantIdentity:n,keyIndex:i}},a=new Xd;return a.onFinally=()=>{this.decryptDataRequests.delete(r)},this.decryptDataRequests.set(r,a),this.worker.postMessage(o),a.promise}postRatchetRequest(e,t){if(!this.worker)throw Error("could not ratchet key, worker is missing");const n={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:t}};this.worker.postMessage(n)}postKey(e){let{key:t,participantIdentity:n,keyIndex:i}=e;var r;if(!this.worker)throw Error("could not set key, worker is missing");const o={kind:"setKey",data:{participantIdentity:n,isPublisher:n===(null===(r=this.room)||void 0===r?void 0:r.localParticipant.identity),key:t,keyIndex:i}};this.worker.postMessage(o)}postEnable(e,t){if(!this.worker)throw new ReferenceError("failed to enable e2ee, worker is not ready");{const n={kind:"enable",data:{enabled:e,participantIdentity:t}};this.worker.postMessage(n)}}postRTPMap(e){var t;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(null===(t=this.room)||void 0===t?void 0:t.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const n={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(n)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const t={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(t)}setupE2EEReceiver(e,t,n){if(e.receiver){if(!(null===n||void 0===n?void 0:n.mimeType)||""===n.mimeType)throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,t,"video"===e.kind?kh(n.mimeType):void 0)}}setupE2EESender(e,t){rh(e)&&t?this.handleSender(t,e.mediaStreamID,void 0):t||fl.warn("early return because sender is not ready")}handleReceiver(e,t,n,i){return kl(this,void 0,void 0,function*(){if(this.worker){if(ju()&&!Id()){const r={kind:"decode",participantIdentity:n,trackId:t,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,r)}else{if(Iu in e&&i){const e={kind:"updateCodec",data:{trackId:t,codec:i,participantIdentity:n}};return void this.worker.postMessage(e)}let r=e.writableStream,o=e.readableStream;if(!r||!o){const t=e.createEncodedStreams();e.writableStream=t.writable,r=t.writable,e.readableStream=t.readable,o=t.readable}const a={kind:"decode",data:{readableStream:o,writableStream:r,trackId:t,codec:i,participantIdentity:n,isReuse:Iu in e}};this.worker.postMessage(a,[o,r])}e[Iu]=!0}})}handleSender(e,t,n){var i;if(!(Iu in e)&&this.worker){if(!(null===(i=this.room)||void 0===i?void 0:i.localParticipant.identity)||""===this.room.localParticipant.identity)throw TypeError("local identity needs to be known in order to set up encrypted sender");if(ju()&&!Id()){fl.info("initialize script transform");const i={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:t,codec:n};e.transform=new RTCRtpScriptTransform(this.worker,i)}else{fl.info("initialize encoded streams");const i=e.createEncodedStreams(),r={kind:"encode",data:{readableStream:i.readable,writableStream:i.writable,codec:n,trackId:t,participantIdentity:this.room.localParticipant.identity,isReuse:!1}};this.worker.postMessage(r,[i.readable,i.writable])}e[Iu]=!0}}}const Ph="default";class Rh{constructor(){this._previousDevices=[]}static getInstance(){return void 0===this.instance&&(this.instance=new Rh),this.instance}get previousDevices(){return this._previousDevices}getDevices(e){return kl(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var i;if((null===(i=Rh.userMediaPromiseMap)||void 0===i?void 0:i.size)>0){fl.debug("awaiting getUserMedia promise");try{e?yield Rh.userMediaPromiseMap.get(e):yield Promise.all(Rh.userMediaPromiseMap.values())}catch(So){fl.warn("error waiting for media permissons")}}let r=yield navigator.mediaDevices.enumerateDevices();if(n&&(!Nd()||!t.hasDeviceInUse(e))){if(0===r.filter(t=>t.kind===e).length||r.some(t=>{const n=""===t.label,i=!e||t.kind===e;return n&&i})){const t={video:"audioinput"!==e&&"audiooutput"!==e,audio:"videoinput"!==e&&{deviceId:{ideal:"default"}}},n=yield navigator.mediaDevices.getUserMedia(t);r=yield navigator.mediaDevices.enumerateDevices(),n.getTracks().forEach(e=>{e.stop()})}}return t._previousDevices=r,e&&(r=r.filter(t=>t.kind===e)),r}()})}normalizeDeviceId(e,t,n){return kl(this,void 0,void 0,function*(){if(t!==Ph)return t;const i=yield this.getDevices(e),r=i.find(e=>e.deviceId===Ph);if(!r)return void fl.warn("could not reliably determine default device");const o=i.find(e=>e.deviceId!==Ph&&e.groupId===(null!==n&&void 0!==n?n:r.groupId));if(o)return null===o||void 0===o?void 0:o.deviceId;fl.warn("could not reliably determine default device")})}hasDeviceInUse(e){return e?Rh.userMediaPromiseMap.has(e):Rh.userMediaPromiseMap.size>0}}var _h;Rh.mediaDeviceKinds=["audioinput","audiooutput","videoinput"],Rh.userMediaPromiseMap=new Map,function(e){e[e.WAITING=0]="WAITING",e[e.RUNNING=1]="RUNNING",e[e.COMPLETED=2]="COMPLETED"}(_h||(_h={}));class Oh{constructor(){this.pendingTasks=new Map,this.taskMutex=new To,this.nextTaskIndex=0}run(e){return kl(this,void 0,void 0,function*(){const t={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:_h.WAITING};this.pendingTasks.set(t.id,t);const n=yield this.taskMutex.lock();try{return t.executedAt=Date.now(),t.status=_h.RUNNING,yield e()}finally{t.status=_h.COMPLETED,this.pendingTasks.delete(t.id),n()}})}flush(){return kl(this,void 0,void 0,function*(){return this.run(()=>kl(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}class xh{get readyState(){return this.ws.readyState}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n,i;if(null===(n=t.signal)||void 0===n?void 0:n.aborted)throw new DOMException("This operation was aborted","AbortError");this.url=e;const r=new WebSocket(e,null!==(i=t.protocols)&&void 0!==i?i:[]);r.binaryType="arraybuffer",this.ws=r;const o=function(){let{closeCode:e,reason:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return r.close(e,t)};this.opened=new Promise((e,t)=>{r.onopen=()=>{e({readable:new ReadableStream({start(e){r.onmessage=t=>{let{data:n}=t;return e.enqueue(n)},r.onerror=t=>e.error(t)},cancel:o}),writable:new WritableStream({write(e){r.send(e)},abort(){r.close()},close:o}),protocol:r.protocol,extensions:r.extensions}),r.removeEventListener("error",t)},r.addEventListener("error",t)}),this.closed=new Promise((e,t)=>{const n=()=>kl(this,void 0,void 0,function*(){const n=new Promise(e=>{r.readyState!==WebSocket.CLOSED&&r.addEventListener("close",t=>{e(t)},{once:!0})}),i=yield Promise.race([Ed(250),n]);i?e(i):t(new Error("Encountered unspecified websocket error without a timely close event"))});r.onclose=t=>{let{code:i,reason:o}=t;e({closeCode:i,reason:o}),r.removeEventListener("error",n)},r.addEventListener("error",n)}),t.signal&&(t.signal.onabort=()=>r.close()),this.close=o}}function Ih(e,t){return e.pathname="".concat(function(e){return e.endsWith("/")?e:"".concat(e,"/")}(e.pathname)).concat(t),e.toString()}function Nh(e){if("string"===typeof e)return uc.fromJson(JSON.parse(e),{ignoreUnknownFields:!0});if(e instanceof ArrayBuffer)return uc.fromBinary(new Uint8Array(e));throw new Error("could not decode websocket message: ".concat(typeof e))}const Ah=["syncState","trickle","offer","answer","simulate","leave"];var Dh;!function(e){e[e.CONNECTING=0]="CONNECTING",e[e.CONNECTED=1]="CONNECTED",e[e.RECONNECTING=2]="RECONNECTING",e[e.DISCONNECTING=3]="DISCONNECTING",e[e.DISCONNECTED=4]="DISCONNECTED"}(Dh||(Dh={}));class Lh{get currentState(){return this.state}get isDisconnected(){return this.state===Dh.DISCONNECTING||this.state===Dh.DISCONNECTED}get isEstablishingConnection(){return this.state===Dh.CONNECTING||this.state===Dh.RECONNECTING}getNextRequestId(){return this._requestId+=1,this._requestId}constructor(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;this.rtt=0,this.state=Dh.DISCONNECTED,this.log=fl,this._requestId=0,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0,this.onMediaSectionsRequirement=void 0},this.log=ml(null!==(n=t.loggerName)&&void 0!==n?n:hl.Signal),this.loggerContextCb=t.loggerContextCb,this.useJSON=e,this.requestQueue=new Oh,this.queuedRequests=[],this.closingLock=new To,this.connectionLock=new To,this.state=Dh.DISCONNECTED}get logContext(){var e,t;return null!==(t=null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this))&&void 0!==t?t:{}}join(e,t,n,i){return kl(this,void 0,void 0,function*(){this.state=Dh.CONNECTING,this.options=n;return yield this.connect(e,t,n,i)})}reconnect(e,t,n,i){return kl(this,void 0,void 0,function*(){if(!this.options)return void this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);this.state=Dh.RECONNECTING,this.clearPingInterval();return yield this.connect(e,t,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:n,reconnectReason:i}))})}connect(e,t,n,i){return kl(this,void 0,void 0,function*(){const r=yield this.connectionLock.lock();this.connectOptions=n;const o=function(){var e;const t=new Gs({sdk:Js.JS,protocol:16,version:"2.15.13"});return jd()&&(t.os=null!==(e=Bd())&&void 0!==e?e:""),t}(),a=n.singlePeerConnection?function(e,t,n){const i=new URLSearchParams;i.set("access_token",e);const r=new il({clientInfo:t,connectionSettings:new nl({autoSubscribe:!!n.autoSubscribe,adaptiveStream:!!n.adaptiveStream}),reconnect:!!n.reconnect,participantSid:n.sid?n.sid:void 0});n.reconnectReason&&(r.reconnectReason=n.reconnectReason);const o=new rl({joinRequest:r.toBinary()});return i.set("join_request",btoa(new TextDecoder("utf-8").decode(o.toBinary()))),i}(t,o,n):function(e,t,n){var i;const r=new URLSearchParams;r.set("access_token",e),n.reconnect&&(r.set("reconnect","1"),n.sid&&r.set("sid",n.sid));r.set("auto_subscribe",n.autoSubscribe?"1":"0"),r.set("sdk",jd()?"reactnative":"js"),r.set("version",t.version),r.set("protocol",t.protocol.toString()),t.deviceModel&&r.set("device_model",t.deviceModel);t.os&&r.set("os",t.os);t.osVersion&&r.set("os_version",t.osVersion);t.browser&&r.set("browser",t.browser);t.browserVersion&&r.set("browser_version",t.browserVersion);n.adaptiveStream&&r.set("adaptive_stream","1");n.reconnectReason&&r.set("reconnect_reason",n.reconnectReason.toString());(null===(i=navigator.connection)||void 0===i?void 0:i.type)&&r.set("network",navigator.connection.type);return r}(t,o,n),s=function(e,t){const n=new URL(function(e){return e.startsWith("http")?e.replace(/^(http)/,"ws"):e}(e));return t.forEach((e,t)=>{n.searchParams.set(t,e)}),Ih(n,"rtc")}(e,a),c=Ih(new URL(eh(s)),"validate");return new Promise((e,t)=>kl(this,void 0,void 0,function*(){var o,a;try{let r=!1;const l=e=>kl(this,void 0,void 0,function*(){if(r)return;r=!0;const n=e instanceof Event?e.currentTarget:e,i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Unknown reason";if(!(e instanceof AbortSignal))return t;const n=e.reason;switch(typeof n){case"string":return n;case"object":return n instanceof Error?n.message:t;default:return"toString"in n?n.toString():t}}(n,"Abort handler called");this.streamWriter&&!this.isDisconnected?this.sendLeave().then(()=>this.close(i)).catch(e=>{this.log.error(e),this.close()}):this.close(),u(),t(n instanceof AbortSignal?n.reason:n)});null===i||void 0===i||i.addEventListener("abort",l);const u=()=>{clearTimeout(d),null===i||void 0===i||i.removeEventListener("abort",l)},d=setTimeout(()=>{l(new Gu("room connection has timed out (signal)",Fu.ServerUnreachable))},n.websocketTimeout),h=(e,t)=>{this.handleSignalConnected(e,d,t)},p=new URL(s);p.searchParams.has("access_token")&&p.searchParams.set("access_token","<redacted>"),this.log.debug("connecting to ".concat(p),Object.assign({reconnect:n.reconnect,reconnectReason:n.reconnectReason},this.logContext)),this.ws&&(yield this.close(!1)),this.ws=new xh(s);try{this.ws.closed.then(e=>{this.isEstablishingConnection&&t(new Gu("Websocket got closed during a (re)connection attempt: ".concat(e.reason),Fu.InternalError)),1e3!==e.closeCode&&this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:e.reason,code:e.closeCode,wasClean:1e3===e.closeCode,state:this.state}))}).catch(e=>{this.isEstablishingConnection&&t(new Gu("Websocket error during a (re)connection attempt: ".concat(e),Fu.InternalError))});const i=yield this.ws.opened.catch(e=>kl(this,void 0,void 0,function*(){if(this.state!==Dh.CONNECTED){this.state=Dh.DISCONNECTED,clearTimeout(d);const n=yield this.handleConnectionError(e,c);return void t(n)}this.handleWSError(e),t(e)}));if(clearTimeout(d),!i)return;const r=i.readable.getReader();this.streamWriter=i.writable.getWriter();const s=yield r.read();if(r.releaseLock(),!s.value)throw new Gu("no message received as first message",Fu.InternalError);const l=Nh(s.value),u=this.validateFirstMessage(l,null!==(o=n.reconnect)&&void 0!==o&&o);if(!u.isValid)return void t(u.error);"join"===(null===(a=l.message)||void 0===a?void 0:a.case)&&(this.pingTimeoutDuration=l.message.value.pingTimeout,this.pingIntervalDuration=l.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})));h(i,u.shouldProcessFirstMessage?l:void 0),e(u.response)}catch(So){t(So)}finally{u()}}finally{r()}}))})}startReadingLoop(e,t){return kl(this,void 0,void 0,function*(){for(t&&this.handleSignalResponse(t);;){this.signalLatency&&(yield Ed(this.signalLatency));const{done:t,value:n}=yield e.read();if(t)break;const i=Nh(n);this.handleSignalResponse(i)}})}close(){return kl(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Close method called on signal client";return function*(){const i=yield e.closingLock.lock();try{if(e.clearPingInterval(),t&&(e.state=Dh.DISCONNECTING),e.ws){e.ws.close({closeCode:1e3,reason:n});const t=e.ws.closed;e.ws=void 0,e.streamWriter=void 0,yield Promise.race([t,Ed(250)])}}catch(So){e.log.debug("websocket error while closing",Object.assign(Object.assign({},e.logContext),{error:So}))}finally{t&&(e.state=Dh.DISCONNECTED),i()}}()})}sendOffer(e,t){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:jh(e,t)})}sendAnswer(e,t){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:jh(e,t)})}sendIceCandidate(e,t){return this.log.debug("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new pc({candidateInit:JSON.stringify(e),target:t})})}sendMuteTrack(e,t){return this.sendRequest({case:"mute",value:new fc({sid:e,muted:t})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,t){return kl(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return function*(){const r=n.getNextRequestId();return yield n.sendRequest({case:"updateMetadata",value:new _c({requestId:r,metadata:e,name:t,attributes:i})}),r}()})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,t){return this.sendRequest({case:"updateLayers",value:new Rc({trackSid:e,layers:t})})}sendUpdateSubscriptionPermissions(e,t){return this.sendRequest({case:"subscriptionPermission",value:new zc({allParticipants:e,trackPermissions:t})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:Wo.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new Jc({timestamp:Wo.parse(Date.now()),rtt:Wo.parse(this.rtt)})})])}sendUpdateLocalAudioTrack(e,t){return this.sendRequest({case:"updateAudioTrack",value:new Tc({trackSid:e,features:t})})}sendLeave(){return this.sendRequest({case:"leave",value:new Ec({reason:ps.CLIENT_INITIATED,action:Pc.DISCONNECT})})}sendRequest(e){return kl(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function*(){const i=!n&&!function(e){const t=Ah.indexOf(e.case)>=0;return fl.trace("request allowed to bypass queue:",{canPass:t,req:e}),t}(e);if(i&&t.state===Dh.RECONNECTING)return void t.queuedRequests.push(()=>kl(t,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));if(n||(yield t.requestQueue.flush()),t.signalLatency&&(yield Ed(t.signalLatency)),t.isDisconnected)return void t.log.debug("skipping signal request (type: ".concat(e.case,") - SignalClient disconnected"));if(!t.streamWriter)return void t.log.error("cannot send signal request before connected, type: ".concat(null===e||void 0===e?void 0:e.case),t.logContext);const r=new lc({message:e});try{t.useJSON?yield t.streamWriter.write(r.toJsonString()):yield t.streamWriter.write(r.toBinary())}catch(So){t.log.error("error sending signal message",Object.assign(Object.assign({},t.logContext),{error:So}))}}()})}handleSignalResponse(e){var t,n;const i=e.message;if(void 0==i)return void this.log.debug("received unsupported message",this.logContext);let r=!1;if("answer"===i.case){const e=Mh(i.value);this.onAnswer&&this.onAnswer(e,i.value.id,i.value.midToTrackId)}else if("offer"===i.case){const e=Mh(i.value);this.onOffer&&this.onOffer(e,i.value.id,i.value.midToTrackId)}else if("trickle"===i.case){const e=JSON.parse(i.value.candidateInit);this.onTrickle&&this.onTrickle(e,i.value.target)}else"update"===i.case?this.onParticipantUpdate&&this.onParticipantUpdate(null!==(t=i.value.participants)&&void 0!==t?t:[]):"trackPublished"===i.case?this.onLocalTrackPublished&&this.onLocalTrackPublished(i.value):"speakersChanged"===i.case?this.onSpeakersChanged&&this.onSpeakersChanged(null!==(n=i.value.speakers)&&void 0!==n?n:[]):"leave"===i.case?this.onLeave&&this.onLeave(i.value):"mute"===i.case?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(i.value.sid,i.value.muted):"roomUpdate"===i.case?this.onRoomUpdate&&i.value.room&&this.onRoomUpdate(i.value.room):"connectionQuality"===i.case?this.onConnectionQuality&&this.onConnectionQuality(i.value):"streamStateUpdate"===i.case?this.onStreamStateUpdate&&this.onStreamStateUpdate(i.value):"subscribedQualityUpdate"===i.case?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(i.value):"subscriptionPermissionUpdate"===i.case?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(i.value):"refreshToken"===i.case?this.onTokenRefresh&&this.onTokenRefresh(i.value):"trackUnpublished"===i.case?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(i.value):"subscriptionResponse"===i.case?this.onSubscriptionError&&this.onSubscriptionError(i.value):"pong"===i.case||("pongResp"===i.case?(this.rtt=Date.now()-Number.parseInt(i.value.lastPingTimestamp.toString()),this.resetPingTimeout(),r=!0):"requestResponse"===i.case?this.onRequestResponse&&this.onRequestResponse(i.value):"trackSubscribed"===i.case?this.onLocalTrackSubscribed&&this.onLocalTrackSubscribed(i.value.trackSid):"roomMoved"===i.case?(this.onTokenRefresh&&this.onTokenRefresh(i.value.token),this.onRoomMoved&&this.onRoomMoved(i.value)):"mediaSectionsRequirement"===i.case?this.onMediaSectionsRequirement&&this.onMediaSectionsRequirement(i.value):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:i.case})));r||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return kl(this,void 0,void 0,function*(){if(this.state===Dh.DISCONNECTED)return;const t=this.onClose;yield this.close(void 0,e),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),t&&t(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){this.clearPingTimeout(),this.pingTimeoutDuration?this.pingTimeout=ld.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-1e3*this.pingTimeoutDuration).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},1e3*this.pingTimeoutDuration):this.log.warn("ping timeout duration not set",this.logContext)}clearPingTimeout(){this.pingTimeout&&ld.clearTimeout(this.pingTimeout)}startPingInterval(){this.clearPingInterval(),this.resetPingTimeout(),this.pingIntervalDuration?(this.log.debug("start ping interval",this.logContext),this.pingInterval=ld.setInterval(()=>{this.sendPing()},1e3*this.pingIntervalDuration)):this.log.warn("ping interval duration not set",this.logContext)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&ld.clearInterval(this.pingInterval)}handleSignalConnected(e,t,n){this.state=Dh.CONNECTED,clearTimeout(t),this.startPingInterval(),this.startReadingLoop(e.readable.getReader(),n)}validateFirstMessage(e,t){var n,i,r,o,a;return"join"===(null===(n=e.message)||void 0===n?void 0:n.case)?{isValid:!0,response:e.message.value}:this.state===Dh.RECONNECTING&&"leave"!==(null===(i=e.message)||void 0===i?void 0:i.case)?"reconnect"===(null===(r=e.message)||void 0===r?void 0:r.case)?{isValid:!0,response:e.message.value}:(this.log.debug("declaring signal reconnected without reconnect response received",this.logContext),{isValid:!0,response:void 0,shouldProcessFirstMessage:!0}):this.isEstablishingConnection&&"leave"===(null===(o=e.message)||void 0===o?void 0:o.case)?{isValid:!1,error:new Gu("Received leave request while trying to (re)connect",Fu.LeaveRequest,void 0,e.message.value.reason)}:t?{isValid:!1,error:new Gu("Unexpected first message",Fu.InternalError)}:{isValid:!1,error:new Gu("did not receive join response, got ".concat(null===(a=e.message)||void 0===a?void 0:a.case," instead"),Fu.InternalError)}}handleConnectionError(e,t){return kl(this,void 0,void 0,function*(){try{const n=yield fetch(t);if(n.status.toFixed(0).startsWith("4")){const e=yield n.text();return new Gu(e,Fu.NotAllowed,n.status)}return e instanceof Gu?e:new Gu("Encountered unknown websocket error during connection: ".concat(e),Fu.InternalError,n.status)}catch(So){return So instanceof Gu?So:new Gu(So instanceof Error?So.message:"server was not reachable",Fu.ServerUnreachable)}})}}function Mh(e){const t={type:"offer",sdp:e.sdp};switch(e.type){case"answer":case"offer":case"pranswer":case"rollback":t.type=e.type}return t}function jh(e,t){return new bc({sdp:e.sdp,type:e.type,id:t})}class Uh{constructor(){this.buffer=[],this._totalSize=0}push(e){this.buffer.push(e),this._totalSize+=e.data.byteLength}pop(){const e=this.buffer.shift();return e&&(this._totalSize-=e.data.byteLength),e}getAll(){return this.buffer.slice()}popToSequence(e){for(;this.buffer.length>0;){if(!(this.buffer[0].sequence<=e))break;this.pop()}}alignBufferedAmount(e){for(;this.buffer.length>0;){const t=this.buffer[0];if(this._totalSize-t.data.byteLength<=e)break;this.pop()}}get length(){return this.buffer.length}}class Fh{constructor(e){this._map=new Map,this._lastCleanup=0,this.ttl=e}set(e,t){const n=Date.now();n-this._lastCleanup>this.ttl/2&&this.cleanup();const i=n+this.ttl;return this._map.set(e,{value:t,expiresAt:i}),this}get(e){const t=this._map.get(e);if(t){if(!(t.expiresAt<Date.now()))return t.value;this._map.delete(e)}}has(e){const t=this._map.get(e);return!!t&&(!(t.expiresAt<Date.now())||(this._map.delete(e),!1))}delete(e){return this._map.delete(e)}clear(){this._map.clear()}cleanup(){const e=Date.now();for(const[t,n]of this._map.entries())n.expiresAt<e&&this._map.delete(t);this._lastCleanup=e}get size(){return this.cleanup(),this._map.size}forEach(e){this.cleanup();for(const[t,n]of this._map.entries())n.expiresAt>=Date.now()&&e(n.value,t,this.asValueMap())}map(e){this.cleanup();const t=[],n=this.asValueMap();for(const[i,r]of n.entries())t.push(e(r,i,n));return t}asValueMap(){const e=new Map;for(const[t,n]of this._map.entries())n.expiresAt>=Date.now()&&e.set(t,n.value);return e}}var Bh,zh,qh,Vh,Hh,Wh={},Kh={},Gh={exports:{}};function Jh(){if(Bh)return Gh.exports;Bh=1;var e=Gh.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(e){return"extmap:%d"+(e.direction?"/%s":"%v")+(e["encrypt-uri"]?" %s":"%v")+" %s"+(e.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t+=null!=e["network-id"]?" network-id %d":"%v",t+=null!=e["network-cost"]?" network-cost %d":"%v"}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(e){var t="ssrc:%d";return null!=e.attribute&&(t+=" %s",null!=e.value&&(t+=":%s")),t}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(e){return null!=e.maxMessageSize?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(e){return e.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(e){return"imageattr:%s %s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(e){return"simulcast:%s %s"+(e.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(e){return"ts-refclk:%s"+(null!=e.clksrcExt?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(e){var t="mediaclk:";return t+=null!=e.id?"id=%s %s":"%v%s",t+=null!=e.mediaClockValue?"=%s":"",t+=null!=e.rateNumerator?" rate=%s":"",t+=null!=e.rateDenominator?"/%s":""}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};return Object.keys(e).forEach(function(t){e[t].forEach(function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")})}),Gh.exports}function Qh(){return zh||(zh=1,function(e){var t=function(e){return String(Number(e))===e?Number(e):e},n=function(e,n,i){var r=e.name&&e.names;e.push&&!n[e.push]?n[e.push]=[]:r&&!n[e.name]&&(n[e.name]={});var o=e.push?{}:r?n[e.name]:n;!function(e,n,i,r){if(r&&!i)n[r]=t(e[1]);else for(var o=0;o<i.length;o+=1)null!=e[o+1]&&(n[i[o]]=t(e[o+1]))}(i.match(e.reg),o,e.names,e.name),e.push&&n[e.push].push(o)},i=Jh(),r=RegExp.prototype.test.bind(/^([a-z])=(.*)/);e.parse=function(e){var t={},o=[],a=t;return e.split(/(\r\n|\r|\n)/).filter(r).forEach(function(e){var t=e[0],r=e.slice(2);"m"===t&&(o.push({rtp:[],fmtp:[]}),a=o[o.length-1]);for(var s=0;s<(i[t]||[]).length;s+=1){var c=i[t][s];if(c.reg.test(r))return n(c,a,r)}}),t.media=o,t};var o=function(e,n){var i=n.split(/=(.+)/,2);return 2===i.length?e[i[0]]=t(i[1]):1===i.length&&n.length>1&&(e[i[0]]=void 0),e};e.parseParams=function(e){return e.split(/;\s?/).reduce(o,{})},e.parseFmtpConfig=e.parseParams,e.parsePayloads=function(e){return e.toString().split(" ").map(Number)},e.parseRemoteCandidates=function(e){for(var n=[],i=e.split(" ").map(t),r=0;r<i.length;r+=3)n.push({component:i[r],ip:i[r+1],port:i[r+2]});return n},e.parseImageAttributes=function(e){return e.split(" ").map(function(e){return e.substring(1,e.length-1).split(",").reduce(o,{})})},e.parseSimulcastStreamList=function(e){return e.split(";").map(function(e){return e.split(",").map(function(e){var n,i=!1;return"~"!==e[0]?n=t(e):(n=t(e.substring(1,e.length)),i=!0),{scid:n,paused:i}})})}}(Kh)),Kh}function $h(){if(Vh)return qh;Vh=1;var e=Jh(),t=/%[sdv%]/g,n=function(e){var n=1,i=arguments,r=i.length;return e.replace(t,function(e){if(n>=r)return e;var t=i[n];switch(n+=1,e){case"%%":return"%";case"%s":return String(t);case"%d":return Number(t);case"%v":return""}})},i=function(e,t,i){var r=[e+"="+(t.format instanceof Function?t.format(t.push?i:i[t.name]):t.format)];if(t.names)for(var o=0;o<t.names.length;o+=1){var a=t.names[o];t.name?r.push(i[t.name][a]):r.push(i[t.names[o]])}else r.push(i[t.name]);return n.apply(null,r)},r=["v","o","s","i","u","e","p","c","b","t","r","z","a"],o=["i","c","b","a"];return qh=function(t,n){n=n||{},null==t.version&&(t.version=0),null==t.name&&(t.name=" "),t.media.forEach(function(e){null==e.payloads&&(e.payloads="")});var a=n.outerOrder||r,s=n.innerOrder||o,c=[];return a.forEach(function(n){e[n].forEach(function(e){e.name in t&&null!=t[e.name]?c.push(i(n,e,t)):e.push in t&&null!=t[e.push]&&t[e.push].forEach(function(t){c.push(i(n,e,t))})})}),t.media.forEach(function(t){c.push(i("m",e.m[0],t)),s.forEach(function(n){e[n].forEach(function(e){e.name in t&&null!=t[e.name]?c.push(i(n,e,t)):e.push in t&&null!=t[e.push]&&t[e.push].forEach(function(t){c.push(i(n,e,t))})})})}),c.join("\r\n")+"\r\n"},qh}var Yh=function(){if(Hh)return Wh;Hh=1;var e=Qh(),t=$h(),n=Jh();return Wh.grammar=n,Wh.write=t,Wh.parse=e.parse,Wh.parseParams=e.parseParams,Wh.parseFmtpConfig=e.parseFmtpConfig,Wh.parsePayloads=e.parsePayloads,Wh.parseRemoteCandidates=e.parseRemoteCandidates,Wh.parseImageAttributes=e.parseImageAttributes,Wh.parseSimulcastStreamList=e.parseSimulcastStreamList,Wh}();function Xh(e,t,n){var i,r,o;void 0===t&&(t=50),void 0===n&&(n={});var a=null!=(i=n.isImmediate)&&i,s=null!=(r=n.callback)&&r,c=n.maxWait,l=Date.now(),u=[];function d(){if(void 0!==c){var e=Date.now()-l;if(e+t>=c)return c-e}return t}var h=function(){var t=[].slice.call(arguments),n=this;return new Promise(function(i,r){var c=a&&void 0===o;if(void 0!==o&&clearTimeout(o),o=setTimeout(function(){if(o=void 0,l=Date.now(),!a){var i=e.apply(n,t);s&&s(i),u.forEach(function(e){return(0,e.resolve)(i)}),u=[]}},d()),c){var h=e.apply(n,t);return s&&s(h),i(h)}u.push({resolve:i,reject:r})})};return h.cancel=function(e){void 0!==o&&clearTimeout(o),u.forEach(function(t){return(0,t.reject)(e)}),u=[]},h}const Zh="negotiationStarted",ep="negotiationComplete",tp="rtpVideoPayloadTypes";class np extends El.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};var n;super(),this.log=fl,this.ddExtID=0,this.latestOfferId=0,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=Xh(e=>kl(this,void 0,void 0,function*(){this.emit(Zh);try{yield this.createAndSendOffer()}catch(So){if(!e)throw So;e(So)}}),20),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=ml(null!==(n=t.loggerName)&&void 0!==n?n:hl.PCTransport),this.loggerOptions=t,this.config=e,this._pc=this.createPC(),this.offerLock=new To}createPC(){const e=new RTCPeerConnection(this.config);return e.onicecandidate=e=>{var t;e.candidate&&(null===(t=this.onIceCandidate)||void 0===t||t.call(this,e.candidate))},e.onicecandidateerror=e=>{var t;null===(t=this.onIceCandidateError)||void 0===t||t.call(this,e)},e.oniceconnectionstatechange=()=>{var t;null===(t=this.onIceConnectionStateChange)||void 0===t||t.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var t;null===(t=this.onSignalingStatechange)||void 0===t||t.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var t;null===(t=this.onConnectionStateChange)||void 0===t||t.call(this,e.connectionState)},e.ondatachannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},e.ontrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},e}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}get isICEConnected(){return null!==this._pc&&("connected"===this.pc.iceConnectionState||"completed"===this.pc.iceConnectionState)}addIceCandidate(e){return kl(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e,t){return kl(this,void 0,void 0,function*(){var n;if("answer"===e.type&&this.latestOfferId>0&&t>0&&t!==this.latestOfferId)return this.log.warn("ignoring answer for old offer",Object.assign(Object.assign({},this.logContext),{offerId:t,latestOfferId:this.latestOfferId})),!1;let i;if("offer"===e.type){let{stereoMids:t,nackMids:n}=function(e){var t;const n=[],i=[],r=Yh.parse(null!==(t=e.sdp)&&void 0!==t?t:"");let o=0;return r.media.forEach(e=>{var t;const r=op(e.mid);"audio"===e.type&&(e.rtp.some(e=>"opus"===e.codec&&(o=e.payload,!0)),(null===(t=e.rtcpFb)||void 0===t?void 0:t.some(e=>e.payload===o&&"nack"===e.type))&&i.push(r),e.fmtp.some(e=>e.payload===o&&(e.config.includes("sprop-stereo=1")&&n.push(r),!0)))}),{stereoMids:n,nackMids:i}}(e);this.remoteStereoMids=t,this.remoteNackMids=n}else if("answer"===e.type){const t=Yh.parse(null!==(n=e.sdp)&&void 0!==n?n:"");t.media.forEach(e=>{const t=op(e.mid);"audio"===e.type&&this.trackBitrates.some(n=>{if(!n.transceiver||t!=n.transceiver.mid)return!1;let i=0;if(e.rtp.some(e=>e.codec.toUpperCase()===n.codec.toUpperCase()&&(i=e.payload,!0)),0===i)return!0;let r=!1;for(const t of e.fmtp)if(t.payload===i){t.config=t.config.split(";").filter(e=>!e.includes("maxaveragebitrate")).join(";"),n.maxbr>0&&(t.config+=";maxaveragebitrate=".concat(1e3*n.maxbr)),r=!0;break}return r||n.maxbr>0&&e.fmtp.push({payload:i,config:"maxaveragebitrate=".concat(1e3*n.maxbr)}),!0})}),i=Yh.write(t)}if(yield this.setMungedSDP(e,i,!0),this.pendingCandidates.forEach(e=>{this.pc.addIceCandidate(e)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate)this.renegotiate=!1,yield this.createAndSendOffer();else if("answer"===e.type&&(this.emit(ep),e.sdp)){Yh.parse(e.sdp).media.forEach(e=>{"video"===e.type&&this.emit(tp,e.rtp)})}return!0})}createAndSendOffer(e){return kl(this,void 0,void 0,function*(){var t;const n=yield this.offerLock.lock();try{if(void 0===this.onOffer)return;if((null===e||void 0===e?void 0:e.iceRestart)&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&"have-local-offer"===this._pc.signalingState){const t=this._pc.remoteDescription;if(!(null===e||void 0===e?void 0:e.iceRestart)||!t)return void(this.renegotiate=!0);yield this._pc.setRemoteDescription(t)}else if(!this._pc||"closed"===this._pc.signalingState)return void this.log.warn("could not createOffer with closed peer connection",this.logContext);this.log.debug("starting to negotiate",this.logContext);const n=this.latestOfferId+1;this.latestOfferId=n;const i=yield this.pc.createOffer(e);this.log.debug("original offer",Object.assign({sdp:i.sdp},this.logContext));const r=Yh.parse(null!==(t=i.sdp)&&void 0!==t?t:"");if(r.media.forEach(e=>{rp(e),"audio"===e.type?ip(e,["all"],[]):"video"===e.type&&this.trackBitrates.some(t=>{if(!e.msid||!t.cid||!e.msid.includes(t.cid))return!1;let n=0;if(e.rtp.some(e=>e.codec.toUpperCase()===t.codec.toUpperCase()&&(n=e.payload,!0)),0===n)return!0;if(_d(t.codec)&&!Nd()&&this.ensureVideoDDExtensionForSVC(e,r),"av1"!==t.codec)return!0;const i=Math.round(.7*t.maxbr);for(const r of e.fmtp)if(r.payload===n){r.config.includes("x-google-start-bitrate")||(r.config+=";x-google-start-bitrate=".concat(i));break}return!0})}),this.latestOfferId>n)return void this.log.warn("latestOfferId mismatch",Object.assign(Object.assign({},this.logContext),{latestOfferId:this.latestOfferId,offerId:n}));yield this.setMungedSDP(i,Yh.write(r)),this.onOffer(i,this.latestOfferId)}finally{n()}})}createAndSetAnswer(){return kl(this,void 0,void 0,function*(){var e;const t=yield this.pc.createAnswer(),n=Yh.parse(null!==(e=t.sdp)&&void 0!==e?e:"");return n.media.forEach(e=>{rp(e),"audio"===e.type&&ip(e,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(t,Yh.write(n)),t})}createDataChannel(e,t){return this.pc.createDataChannel(e,t)}addTransceiver(e,t){return this.pc.addTransceiver(e,t)}addTransceiverOfKind(e,t){return this.pc.addTransceiver(e,t)}addTrack(e){if(!this._pc)throw new Yu("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var t;if(!this._pc)throw new Yu("PC closed, cannot configure");return null===(t=this._pc)||void 0===t?void 0:t.setConfiguration(e)}canRemoveTrack(){var e;return!!(null===(e=this._pc)||void 0===e?void 0:e.removeTrack)}removeTrack(e){var t;return null===(t=this._pc)||void 0===t?void 0:t.removeTrack(e)}getConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.connectionState)&&void 0!==t?t:"closed"}getICEConnectionState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.iceConnectionState)&&void 0!==t?t:"closed"}getSignallingState(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.signalingState)&&void 0!==t?t:"closed"}getTransceivers(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getTransceivers())&&void 0!==t?t:[]}getSenders(){var e,t;return null!==(t=null===(e=this._pc)||void 0===e?void 0:e.getSenders())&&void 0!==t?t:[]}getLocalDescription(){var e;return null===(e=this._pc)||void 0===e?void 0:e.localDescription}getRemoteDescription(){var e;return null===(e=this.pc)||void 0===e?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){return kl(this,void 0,void 0,function*(){var e;if(!this._pc)return;let t="";const n=new Map,i=new Map;if((yield this._pc.getStats()).forEach(e=>{switch(e.type){case"transport":t=e.selectedCandidatePairId;break;case"candidate-pair":""===t&&e.selected&&(t=e.id),n.set(e.id,e);break;case"remote-candidate":i.set(e.id,"".concat(e.address,":").concat(e.port))}}),""===t)return;const r=null===(e=n.get(t))||void 0===e?void 0:e.remoteCandidateId;return void 0!==r?i.get(r):void 0})}setMungedSDP(e,t,n){return kl(this,void 0,void 0,function*(){if(t){const i=e.sdp;e.sdp=t;try{return this.log.debug("setting munged ".concat(n?"remote":"local"," description"),this.logContext),void(n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e))}catch(So){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:So,sdp:t})),e.sdp=i}}try{n?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(So){let i="unknown error";So instanceof Error?i=So.message:"string"===typeof So&&(i=So);const r={error:i,sdp:e.sdp};throw!n&&this.pc.remoteDescription&&(r.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:r})),new Xu(i)}})}ensureVideoDDExtensionForSVC(e,t){var n,i;if(!(null===(n=e.ext)||void 0===n?void 0:n.some(e=>e.uri===Cd))){if(0===this.ddExtID){let e=0;t.media.forEach(t=>{var n;"video"===t.type&&(null===(n=t.ext)||void 0===n||n.forEach(t=>{t.value>e&&(e=t.value)}))}),this.ddExtID=e+1}null===(i=e.ext)||void 0===i||i.push({value:this.ddExtID,uri:Cd})}}}function ip(e,t,n){const i=op(e.mid);let r=0;e.rtp.some(e=>"opus"===e.codec&&(r=e.payload,!0)),r>0&&(e.rtcpFb||(e.rtcpFb=[]),n.includes(i)&&!e.rtcpFb.some(e=>e.payload===r&&"nack"===e.type)&&e.rtcpFb.push({payload:r,type:"nack"}),(t.includes(i)||1===t.length&&"all"===t[0])&&e.fmtp.some(e=>e.payload===r&&(e.config.includes("stereo=1")||(e.config+=";stereo=1"),!0)))}function rp(e){if(e.connection){const t=e.connection.ip.indexOf(":")>=0;(4===e.connection.version&&t||6===e.connection.version&&!t)&&(e.connection.ip="0.0.0.0",e.connection.version=4)}}function op(e){return"number"===typeof e?e.toFixed(0):e}const ap="vp8",sp={audioPreset:kd.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:Td.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:ap,backupCodec:!0,preConnectBuffer:!1},cp={deviceId:{ideal:"default"},autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0,voiceIsolation:!0},lp={deviceId:{ideal:"default"},resolution:Sd.h720.resolution},up={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new class{constructor(e){this._retryDelays=void 0!==e?[...e]:yl}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const t=this._retryDelays[e.retryCount];return e.retryCount<=1?t:t+1e3*Math.random()}},disconnectOnPageLeave:!0,webAudioMix:!1,singlePeerConnection:!1},dp={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var hp;!function(e){e[e.NEW=0]="NEW",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.FAILED=3]="FAILED",e[e.CLOSING=4]="CLOSING",e[e.CLOSED=5]="CLOSED"}(hp||(hp={}));class pp{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,t,n){var i;this.peerConnectionTimeout=dp.peerConnectionTimeout,this.log=fl,this.updateState=()=>{var e,t;const n=this.state,i=this.requiredTransports.map(e=>e.getConnectionState());i.every(e=>"connected"===e)?this.state=hp.CONNECTED:i.some(e=>"failed"===e)?this.state=hp.FAILED:i.some(e=>"connecting"===e)?this.state=hp.CONNECTING:i.every(e=>"closed"===e)?this.state=hp.CLOSED:i.some(e=>"closed"===e)?this.state=hp.CLOSING:i.every(e=>"new"===e)&&(this.state=hp.NEW),n!==this.state&&(this.log.debug("pc state change: from ".concat(hp[n]," to ").concat(hp[this.state]),this.logContext),null===(e=this.onStateChange)||void 0===e||e.call(this,this.state,this.publisher.getConnectionState(),null===(t=this.subscriber)||void 0===t?void 0:t.getConnectionState()))},this.log=ml(null!==(i=n.loggerName)&&void 0!==i?i:hl.PCManager),this.loggerOptions=n,this.isPublisherConnectionRequired="subscriber-primary"!==t,this.isSubscriberConnectionRequired="subscriber-primary"===t,this.publisher=new np(e,n),"publisher-only"!==t&&(this.subscriber=new np(e,n),this.subscriber.onConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.subscriber.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,ac.SUBSCRIBER)},this.subscriber.onDataChannel=e=>{var t;null===(t=this.onDataChannel)||void 0===t||t.call(this,e)},this.subscriber.onTrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)}),this.publisher.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=e=>{var t;null===(t=this.onIceCandidate)||void 0===t||t.call(this,e,ac.PUBLISHER)},this.publisher.onTrack=e=>{var t;null===(t=this.onTrack)||void 0===t||t.call(this,e)},this.publisher.onOffer=(e,t)=>{var n;null===(n=this.onPublisherOffer)||void 0===n||n.call(this,e,t)},this.state=hp.NEW,this.connectionLock=new To,this.remoteOfferLock=new To}get logContext(){var e,t;return Object.assign({},null===(t=(e=this.loggerOptions).loggerContextCb)||void 0===t?void 0:t.call(e))}requirePublisher(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.isPublisherConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e,t){return this.publisher.setRemoteDescription(e,t)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return kl(this,void 0,void 0,function*(){var e;if(this.publisher&&"closed"!==this.publisher.getSignallingState()){const e=this.publisher;for(const t of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(t)}catch(So){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:So}))}}yield Promise.all([this.publisher.close(),null===(e=this.subscriber)||void 0===e?void 0:e.close()]),this.updateState()})}triggerIceRestart(){return kl(this,void 0,void 0,function*(){this.subscriber&&(this.subscriber.restartingIce=!0),this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,t){return kl(this,void 0,void 0,function*(){var n;t===ac.PUBLISHER?yield this.publisher.addIceCandidate(e):yield null===(n=this.subscriber)||void 0===n?void 0:n.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e,t){return kl(this,void 0,void 0,function*(){var n,i,r;this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:null===(n=this.subscriber)||void 0===n?void 0:n.getSignallingState().toString()}));const o=yield this.remoteOfferLock.lock();try{if(!(yield null===(i=this.subscriber)||void 0===i?void 0:i.setRemoteDescription(e,t)))return;return yield null===(r=this.subscriber)||void 0===r?void 0:r.createAndSetAnswer()}finally{o()}})}updateConfiguration(e,t){var n;this.publisher.setConfiguration(e),null===(n=this.subscriber)||void 0===n||n.setConfiguration(e),t&&this.triggerIceRestart()}ensurePCTransportConnection(e,t){return kl(this,void 0,void 0,function*(){var n;const i=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&"connected"!==this.publisher.getConnectionState()&&"connecting"!==this.publisher.getConnectionState()&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all(null===(n=this.requiredTransports)||void 0===n?void 0:n.map(n=>this.ensureTransportConnected(n,e,t)))}finally{i()}})}negotiate(e){return kl(this,void 0,void 0,function*(){return new Promise((t,n)=>kl(this,void 0,void 0,function*(){const i=setTimeout(()=>{n("negotiation timed out")},this.peerConnectionTimeout);e.signal.addEventListener("abort",()=>{clearTimeout(i),n("negotiation aborted")}),this.publisher.once(Zh,()=>{e.signal.aborted||this.publisher.once(ep,()=>{clearTimeout(i),t()})}),yield this.publisher.negotiate(e=>{clearTimeout(i),n(e)})}))})}addPublisherTransceiver(e,t){return this.publisher.addTransceiver(e,t)}addPublisherTransceiverOfKind(e,t){return this.publisher.addTransceiverOfKind(e,t)}getMidForReceiver(e){const t=(this.subscriber?this.subscriber.getTransceivers():this.publisher.getTransceivers()).find(t=>t.receiver===e);return null===t||void 0===t?void 0:t.mid}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,t){return this.publisher.createDataChannel(e,t)}getConnectedAddress(e){return e===ac.PUBLISHER||e===ac.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&this.subscriber&&e.push(this.subscriber),e}ensureTransportConnected(e,t){return kl(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.peerConnectionTimeout;return function*(){if("connected"!==e.getConnectionState())return new Promise((e,r)=>kl(n,void 0,void 0,function*(){const n=()=>{this.log.warn("abort transport connection",this.logContext),ld.clearTimeout(o),r(new Gu("room connection has been cancelled",Fu.Cancelled))};(null===t||void 0===t?void 0:t.signal.aborted)&&n(),null===t||void 0===t||t.signal.addEventListener("abort",n);const o=ld.setTimeout(()=>{null===t||void 0===t||t.signal.removeEventListener("abort",n),r(new Gu("could not establish pc connection",Fu.InternalError))},i);for(;this.state!==hp.CONNECTED;)if(yield Ed(50),null===t||void 0===t?void 0:t.signal.aborted)return void r(new Gu("room connection has been cancelled",Fu.Cancelled));ld.clearTimeout(o),null===t||void 0===t||t.signal.removeEventListener("abort",n),e()}))}()})}}class fp extends Error{constructor(e,t,n){super(t),this.code=e,this.message=gp(t,fp.MAX_MESSAGE_BYTES),this.data=n?gp(n,fp.MAX_DATA_BYTES):void 0}static fromProto(e){return new fp(e.code,e.message,e.data)}toProto(){return new Vs({code:this.code,message:this.message,data:this.data})}static builtIn(e,t){return new fp(fp.ErrorCode[e],fp.ErrorMessage[e],t)}}fp.MAX_MESSAGE_BYTES=256,fp.MAX_DATA_BYTES=15360,fp.ErrorCode={APPLICATION_ERROR:1500,CONNECTION_TIMEOUT:1501,RESPONSE_TIMEOUT:1502,RECIPIENT_DISCONNECTED:1503,RESPONSE_PAYLOAD_TOO_LARGE:1504,SEND_FAILED:1505,UNSUPPORTED_METHOD:1400,RECIPIENT_NOT_FOUND:1401,REQUEST_PAYLOAD_TOO_LARGE:1402,UNSUPPORTED_SERVER:1403,UNSUPPORTED_VERSION:1404},fp.ErrorMessage={APPLICATION_ERROR:"Application error in method handler",CONNECTION_TIMEOUT:"Connection timeout",RESPONSE_TIMEOUT:"Response timeout",RECIPIENT_DISCONNECTED:"Recipient disconnected",RESPONSE_PAYLOAD_TOO_LARGE:"Response payload too large",SEND_FAILED:"Failed to send",UNSUPPORTED_METHOD:"Method not supported at destination",RECIPIENT_NOT_FOUND:"Recipient not found",REQUEST_PAYLOAD_TOO_LARGE:"Request payload too large",UNSUPPORTED_SERVER:"RPC not supported by server",UNSUPPORTED_VERSION:"Unsupported RPC version"};function mp(e){return(new TextEncoder).encode(e).length}function gp(e,t){if(mp(e)<=t)return e;let n=0,i=e.length;const r=new TextEncoder;for(;n<i;){const o=Math.floor((n+i+1)/2);r.encode(e.slice(0,o)).length<=t?n=o:i=o-1}return e.slice(0,n)}const vp=2e3;function yp(e,t){if(!t)return 0;let n,i;return"bytesReceived"in e?(n=e.bytesReceived,i=t.bytesReceived):"bytesSent"in e&&(n=e.bytesSent,i=t.bytesSent),void 0===n||void 0===i||void 0===e.timestamp||void 0===t.timestamp?0:8*(n-i)*1e3/(e.timestamp-t.timestamp)}const bp="undefined"!==typeof MediaRecorder;const kp=bp?MediaRecorder:class{constructor(){throw new Error("MediaRecorder is not available in this environment")}};class Sp extends kp{constructor(e,t){if(!bp)throw new Error("MediaRecorder is not available in this environment");let n,i;super(new MediaStream([e.mediaStreamTrack]),t);const r=()=>{this.removeEventListener("dataavailable",n),this.removeEventListener("stop",r),this.removeEventListener("error",o),null===i||void 0===i||i.close(),i=void 0},o=e=>{null===i||void 0===i||i.error(e),this.removeEventListener("dataavailable",n),this.removeEventListener("stop",r),this.removeEventListener("error",o),i=void 0};this.byteStream=new ReadableStream({start:e=>{i=e,n=t=>kl(this,void 0,void 0,function*(){let n;if(t.data.arrayBuffer){const e=yield t.data.arrayBuffer();n=new Uint8Array(e)}else{if(!t.data.byteArray)throw new Error("no data available!");n=t.data.byteArray}void 0!==i&&e.enqueue(n)}),this.addEventListener("dataavailable",n)},cancel:()=>{r()}}),this.addEventListener("stop",r),this.addEventListener("error",o)}}class wp extends hd{get sender(){return this._sender}set sender(e){this._sender=e}get constraints(){return this._constraints}get hasPreConnectBuffer(){return!!this.localTrackRecorder}constructor(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];super(e,t,arguments.length>4?arguments[4]:void 0),this.manuallyStopped=!1,this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=Xh(()=>kl(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>kl(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(Ku.Ended,this)},this.reacquireTrack=!1,this.providedByUser=i,this.muteLock=new To,this.pauseUpstreamLock=new To,this.trackChangeLock=new To,this.trackChangeLock.lock().then(t=>kl(this,void 0,void 0,function*(){try{yield this.setMediaStreamTrack(e,!0)}finally{t()}})),this._constraints=e.getConstraints(),n&&(this._constraints=n)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==hd.Kind.Video)return;const{width:e,height:t}=this._mediaStreamTrack.getSettings();return e&&t?{width:e,height:t}:void 0}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,t;return null!==(t=null===(e=this.processor)||void 0===e?void 0:e.processedTrack)&&void 0!==t?t:this._mediaStreamTrack}get isLocal(){return!0}getSourceTrackSettings(){return this._mediaStreamTrack.getSettings()}setMediaStreamTrack(e,t){return kl(this,void 0,void 0,function*(){var n;if(e===this._mediaStreamTrack&&!t)return;let i;if(this._mediaStreamTrack&&(this.attachedElements.forEach(e=>{fd(this._mediaStreamTrack,e)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints()),this.processor&&e){if(this.log.debug("restarting processor",this.logContext),"unknown"===this.kind)throw TypeError("cannot set processor on track of unknown kind");this.processorElement&&(pd(e,this.processorElement),this.processorElement.muted=!0),yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}this.sender&&"closed"!==(null===(n=this.sender.transport)||void 0===n?void 0:n.state)&&(yield this.sender.replaceTrack(null!==i&&void 0!==i?i:e)),this.providedByUser||this._mediaStreamTrack===e||this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(t=>{pd(null!==i&&void 0!==i?i:e,t)}))})}waitForDimensions(){return kl(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3;return function*(){var n;if(e.kind===hd.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");"iOS"===(null===(n=od())||void 0===n?void 0:n.os)&&(yield Ed(10));const i=Date.now();for(;Date.now()-i<t;){const t=e.dimensions;if(t)return t;yield Ed(50)}throw new Qu("unable to get track dimensions after timeout")}()})}setDeviceId(e){return kl(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Zd(e)||(this._constraints.deviceId=e,!!this.isMuted||(yield this.restartTrack(),Zd(e)===this._mediaStreamTrack.getSettings().deviceId))})}getDeviceId(){return kl(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){if(e.source===hd.Source.ScreenShare)return;const{deviceId:n,groupId:i}=e._mediaStreamTrack.getSettings(),r=e.kind===hd.Kind.Audio?"audioinput":"videoinput";return t?Rh.getInstance().normalizeDeviceId(r,n,i):n}()})}mute(){return kl(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return kl(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e,t){return kl(this,void 0,void 0,function*(){const n=yield this.trackChangeLock.lock();try{if(!this.sender)throw new Qu("unable to replace an unpublished track");let n,i;return"boolean"===typeof t?n=t:void 0!==t&&(n=t.userProvidedTrack,i=t.stopProcessor),this.providedByUser=null===n||void 0===n||n,this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),i&&this.processor&&(yield this.internalStopProcessor()),this}finally{n()}})}restart(e){return kl(this,void 0,void 0,function*(){this.manuallyStopped=!1;const t=yield this.trackChangeLock.lock();try{e||(e=this._constraints);const{deviceId:t,facingMode:n}=e,i=bl(e,["deviceId","facingMode"]);this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const r={audio:!1,video:!1};this.kind===hd.Kind.Video?r.video=!t&&!n||{deviceId:t,facingMode:n}:r.audio=!t||Object.assign({deviceId:t},i),this.attachedElements.forEach(e=>{fd(this.mediaStreamTrack,e)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const o=(yield navigator.mediaDevices.getUserMedia(r)).getTracks()[0];return this.kind===hd.Kind.Video&&(yield o.applyConstraints(i)),o.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(o),this._constraints=e,this.emit(Ku.Restarted,this),this.manuallyStopped&&(this.log.warn("track was stopped during a restart, stopping restarted track",this.logContext),this.stop()),this}finally{t()}})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),this.isMuted===e&&this._mediaStreamTrack.enabled!==e||(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?Ku.Muted:Ku.Unmuted,this))}get needsReAcquisition(){return"live"!==this._mediaStreamTrack.readyState||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return kl(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Ld()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),this.isInBackground||!this.needsReAcquisition||this.isUserProvided||this.isMuted||(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;this.manuallyStopped=!0,super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),null===(e=this.processor)||void 0===e||e.destroy(),this.processor=void 0}pauseUpstream(){return kl(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(!0===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to pause upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!0,this.emit(Ku.UpstreamPaused,this);const t=od();if("Safari"===(null===t||void 0===t?void 0:t.name)&&qd(t.version,"12.0")<0)throw new Ju("pauseUpstream is not supported on Safari < 12.");"closed"!==(null===(e=this.sender.transport)||void 0===e?void 0:e.state)&&(yield this.sender.replaceTrack(null))}finally{t()}})}resumeUpstream(){return kl(this,void 0,void 0,function*(){var e;const t=yield this.pauseUpstreamLock.lock();try{if(!1===this._isUpstreamPaused)return;if(!this.sender)return void this.log.warn("unable to resume upstream for an unpublished track",this.logContext);this._isUpstreamPaused=!1,this.emit(Ku.UpstreamResumed,this),"closed"!==(null===(e=this.sender.transport)||void 0===e?void 0:e.state)&&(yield this.sender.replaceTrack(this.mediaStreamTrack))}finally{t()}})}getRTCStatsReport(){return kl(this,void 0,void 0,function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;return yield this.sender.getStats()})}setProcessor(e){return kl(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var i;const r=yield t.trackChangeLock.lock();try{t.log.debug("setting up processor",t.logContext);const r=document.createElement(t.kind),o={kind:t.kind,track:t._mediaStreamTrack,element:r,audioContext:t.audioContext};if(yield e.init(o),t.log.debug("processor initialized",t.logContext),t.processor&&(yield t.internalStopProcessor()),"unknown"===t.kind)throw TypeError("cannot set processor on track of unknown kind");if(pd(t._mediaStreamTrack,r),r.muted=!0,r.play().catch(e=>{e instanceof DOMException&&"AbortError"===e.name?(t.log.warn("failed to play processor element, retrying",Object.assign(Object.assign({},t.logContext),{error:e})),setTimeout(()=>{r.play().catch(e=>{t.log.error("failed to play processor element",Object.assign(Object.assign({},t.logContext),{err:e}))})},100)):t.log.error("failed to play processor element",Object.assign(Object.assign({},t.logContext),{error:e}))}),t.processor=e,t.processorElement=r,t.processor.processedTrack){for(const e of t.attachedElements)e!==t.processorElement&&n&&(fd(t._mediaStreamTrack,e),pd(t.processor.processedTrack,e));yield null===(i=t.sender)||void 0===i?void 0:i.replaceTrack(t.processor.processedTrack)}t.emit(Ku.TrackProcessorUpdate,t.processor)}finally{r()}}()})}getProcessor(){return this.processor}stopProcessor(){return kl(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){const n=yield e.trackChangeLock.lock();try{yield e.internalStopProcessor(t)}finally{n()}}()})}internalStopProcessor(){return kl(this,arguments,void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){var n,i;e.processor&&(e.log.debug("stopping processor",e.logContext),null===(n=e.processor.processedTrack)||void 0===n||n.stop(),yield e.processor.destroy(),e.processor=void 0,t||(null===(i=e.processorElement)||void 0===i||i.remove(),e.processorElement=void 0),yield e._mediaStreamTrack.applyConstraints(e._constraints),yield e.setMediaStreamTrack(e._mediaStreamTrack,!0),e.emit(Ku.TrackProcessorUpdate))}()})}startPreConnectBuffer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;if(bp)if(this.localTrackRecorder)this.log.warn("preconnect buffer already started");else{{let e="audio/webm;codecs=opus";MediaRecorder.isTypeSupported(e)||(e="video/mp4"),this.localTrackRecorder=new Sp(this,{mimeType:e})}this.localTrackRecorder.start(e),this.autoStopPreConnectBuffer=setTimeout(()=>{this.log.warn("preconnect buffer timed out, stopping recording automatically",this.logContext),this.stopPreConnectBuffer()},1e4)}else this.log.warn("MediaRecorder is not available, cannot start preconnect buffer",this.logContext)}stopPreConnectBuffer(){clearTimeout(this.autoStopPreConnectBuffer),this.localTrackRecorder&&(this.localTrackRecorder.stop(),this.localTrackRecorder=void 0)}getPreConnectBuffer(){var e;return null===(e=this.localTrackRecorder)||void 0===e?void 0:e.byteStream}getPreConnectBufferMimeType(){var e;return null===(e=this.localTrackRecorder)||void 0===e?void 0:e.mimeType}}class Tp extends wp{get enhancedNoiseCancellation(){return this.isKrispNoiseFilterEnabled}constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;super(e,hd.Kind.Audio,t,n,r),this.stopOnMute=!1,this.isKrispNoiseFilterEnabled=!1,this.monitorSender=()=>kl(this,void 0,void 0,function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(So){return void this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:So}))}e&&this.prevStats&&(this._currentBitrate=yp(e,this.prevStats)),this.prevStats=e}),this.handleKrispNoiseFilterEnable=()=>{this.isKrispNoiseFilterEnabled=!0,this.log.debug("Krisp noise filter enabled",this.logContext),this.emit(Ku.AudioTrackFeatureUpdate,this,gs.TF_ENHANCED_NOISE_CANCELLATION,!0)},this.handleKrispNoiseFilterDisable=()=>{this.isKrispNoiseFilterEnabled=!1,this.log.debug("Krisp noise filter disabled",this.logContext),this.emit(Ku.AudioTrackFeatureUpdate,this,gs.TF_ENHANCED_NOISE_CANCELLATION,!1)},this.audioContext=i,this.checkForSilence()}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return kl(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source===hd.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return kl(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{if(!this.isMuted)return this.log.debug("Track already unmuted",this.logContext),this;const t=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Zd(this._constraints.deviceId);return this.source!==hd.Source.Microphone||!this.stopOnMute&&"ended"!==this._mediaStreamTrack.readyState&&!t||this.isUserProvided||(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{t()}})}restartTrack(e){return kl(this,void 0,void 0,function*(){let t;if(e){const n=fh({audio:e});"boolean"!==typeof n.audio&&(t=n.audio)}yield this.restart(t)})}restart(e){const t=Object.create(null,{restart:{get:()=>super.restart}});return kl(this,void 0,void 0,function*(){const n=yield t.restart.call(this,e);return this.checkForSilence(),n})}startMonitor(){Md()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},vp)))}setProcessor(e){return kl(this,void 0,void 0,function*(){var t;const n=yield this.trackChangeLock.lock();try{if(!jd()&&!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");this.processor&&(yield this.internalStopProcessor());const n={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(n),this.processor=e,this.processor.processedTrack&&(yield null===(t=this.sender)||void 0===t?void 0:t.replaceTrack(this.processor.processedTrack),this.processor.processedTrack.addEventListener("enable-lk-krisp-noise-filter",this.handleKrispNoiseFilterEnable),this.processor.processedTrack.addEventListener("disable-lk-krisp-noise-filter",this.handleKrispNoiseFilterDisable)),this.emit(Ku.TrackProcessorUpdate,this.processor)}finally{n()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){return kl(this,void 0,void 0,function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return;let t;return(yield this.sender.getStats()).forEach(e=>{"outbound-rtp"===e.type&&(t={type:"audio",streamId:e.id,packetsSent:e.packetsSent,packetsLost:e.packetsLost,bytesSent:e.bytesSent,timestamp:e.timestamp,roundTripTime:e.roundTripTime,jitter:e.jitter})}),t})}checkForSilence(){return kl(this,void 0,void 0,function*(){const e=yield mh(this);return e&&(this.isMuted||this.log.debug("silence detected on local audio track",this.logContext),this.emit(Ku.AudioSilenceDetected)),e})}}const Cp=Object.values(Sd),Ep=Object.values(wd),Pp=Object.values(Td),Rp=[Sd.h180,Sd.h360],_p=[wd.h180,wd.h360],Op=["q","h","f"];function xp(e,t,n,i){var r,o;let a=null===i||void 0===i?void 0:i.videoEncoding;e&&(a=null===i||void 0===i?void 0:i.screenShareEncoding);const s=null===i||void 0===i?void 0:i.simulcast,c=null===i||void 0===i?void 0:i.scalabilityMode,l=null===i||void 0===i?void 0:i.videoCodec;if(!a&&!s&&!c||!t||!n)return[{}];a||(a=function(e,t,n,i){const r=function(e,t,n){if(e)return Pp;const i=t>n?t/n:n/t;if(Math.abs(i-16/9)<Math.abs(i-4/3))return Cp;return Ep}(e,t,n);let{encoding:o}=r[0];const a=Math.max(t,n);for(let s=0;s<r.length;s+=1){const e=r[s];if(o=e.encoding,e.width>=a)break}if(i)switch(i){case"av1":case"h265":o=Object.assign({},o),o.maxBitrate=.7*o.maxBitrate;break;case"vp9":o=Object.assign({},o),o.maxBitrate=.85*o.maxBitrate}return o}(e,t,n,l),fl.debug("using video encoding",a));const u=a.maxFramerate,d=new md(t,n,a.maxBitrate,a.maxFramerate,a.priority);if(c&&_d(l)){const e=new Dp(c),t=[];if(e.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(c));const n=od();if(Ad()||jd()||"Chrome"===(null===n||void 0===n?void 0:n.name)&&qd(null===n||void 0===n?void 0:n.version,"113")<0){const i="h"==e.suffix?2:3,r=function(e){return e||(e=od()),"Safari"===(null===e||void 0===e?void 0:e.name)&&qd(e.version,"18.3")>0||"iOS"===(null===e||void 0===e?void 0:e.os)&&!!(null===e||void 0===e?void 0:e.osVersion)&&qd(e.osVersion,"18.3")>0}(n);for(let n=0;n<e.spatial;n+=1)t.push({rid:Op[2-n],maxBitrate:a.maxBitrate/Math.pow(i,n),maxFramerate:d.encoding.maxFramerate,scaleResolutionDownBy:r?Math.pow(2,n):void 0});t[0].scalabilityMode=c}else t.push({maxBitrate:a.maxBitrate,maxFramerate:d.encoding.maxFramerate,scalabilityMode:c});return d.encoding.priority&&(t[0].priority=d.encoding.priority,t[0].networkPriority=d.encoding.priority),fl.debug("using svc encoding",{encodings:t}),t}if(!s)return[a];let h,p=[];if(p=e?null!==(r=Ap(null===i||void 0===i?void 0:i.screenShareSimulcastLayers))&&void 0!==r?r:Ip(e,d):null!==(o=Ap(null===i||void 0===i?void 0:i.videoSimulcastLayers))&&void 0!==o?o:Ip(e,d),p.length>0){const e=p[0];p.length>1&&([,h]=p);const i=Math.max(t,n);if(i>=960&&h)return Np(t,n,[e,h,d],u);if(i>=480)return Np(t,n,[e,d],u)}return Np(t,n,[d])}function Ip(e,t){if(e)return[{scaleResolutionDownBy:2,fps:(n=t).encoding.maxFramerate}].map(e=>{var t,i;return new md(Math.floor(n.width/e.scaleResolutionDownBy),Math.floor(n.height/e.scaleResolutionDownBy),Math.max(15e4,Math.floor(n.encoding.maxBitrate/(Math.pow(e.scaleResolutionDownBy,2)*((null!==(t=n.encoding.maxFramerate)&&void 0!==t?t:30)/(null!==(i=e.fps)&&void 0!==i?i:30))))),e.fps,n.encoding.priority)});var n;const{width:i,height:r}=t,o=i>r?i/r:r/i;return Math.abs(o-16/9)<Math.abs(o-4/3)?Rp:_p}function Np(e,t,n,i){const r=[];if(n.forEach((n,o)=>{if(o>=Op.length)return;const a=Math.min(e,t),s={rid:Op[o],scaleResolutionDownBy:Math.max(1,a/Math.min(n.width,n.height)),maxBitrate:n.encoding.maxBitrate},c=i&&n.encoding.maxFramerate?Math.min(i,n.encoding.maxFramerate):n.encoding.maxFramerate;c&&(s.maxFramerate=c);const l=xd()||0===o;n.encoding.priority&&l&&(s.priority=n.encoding.priority,s.networkPriority=n.encoding.priority),r.push(s)}),jd()&&"ios"===Bd()){let e;r.forEach(t=>{e?t.maxFramerate&&t.maxFramerate>e&&(e=t.maxFramerate):e=t.maxFramerate});let t=!0;r.forEach(n=>{var i;n.maxFramerate!=e&&(t&&(t=!1,fl.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),fl.info('Setting framerate of encoding "'.concat(null!==(i=n.rid)&&void 0!==i?i:"",'" to ').concat(e)),n.maxFramerate=e)})}return r}function Ap(e){if(e)return e.sort((e,t)=>{const{encoding:n}=e,{encoding:i}=t;return n.maxBitrate>i.maxBitrate?1:n.maxBitrate<i.maxBitrate?-1:n.maxBitrate===i.maxBitrate&&n.maxFramerate&&i.maxFramerate?n.maxFramerate>i.maxFramerate?1:-1:0})}class Dp{constructor(e){const t=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!t)throw new Error("invalid scalability mode");if(this.spatial=parseInt(t[1]),this.temporal=parseInt(t[2]),t.length>3)switch(t[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=t[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat(null!==(e=this.suffix)&&void 0!==e?e:"")}}class Lp extends wp{get sender(){return this._sender}set sender(e){this._sender=e,this.degradationPreference&&this.setDegradationPreference(this.degradationPreference)}constructor(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=arguments.length>3?arguments[3]:void 0;super(e,hd.Kind.Video,t,n,i),this.simulcastCodecs=new Map,this.degradationPreference="balanced",this.isCpuConstrained=!1,this.optimizeForPerformance=!1,this.monitorSender=()=>kl(this,void 0,void 0,function*(){if(!this.sender)return void(this._currentBitrate=0);let e;try{e=yield this.getSenderStats()}catch(So){return void this.log.error("could not get video sender stats",Object.assign(Object.assign({},this.logContext),{error:So}))}const t=new Map(e.map(e=>[e.rid,e])),n=e.some(e=>"cpu"===e.qualityLimitationReason);if(n!==this.isCpuConstrained&&(this.isCpuConstrained=n,this.isCpuConstrained&&this.emit(Ku.CpuConstrained)),this.prevStats){let e=0;t.forEach((t,n)=>{var i;const r=null===(i=this.prevStats)||void 0===i?void 0:i.get(n);e+=yp(t,r)}),this._currentBitrate=e}this.prevStats=t}),this.senderLock=new To}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var t;if(this.signalClient=e,!Md())return;const n=null===(t=this.sender)||void 0===t?void 0:t.getParameters();n&&(this.encodings=n.encodings),this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},vp))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});return kl(this,void 0,void 0,function*(){var t,n,i,r,o;yield e.pauseUpstream.call(this);try{for(var a,s=!0,c=wl(this.simulcastCodecs.values());!(t=(a=yield c.next()).done);s=!0){r=a.value,s=!1;const e=r;yield null===(o=e.sender)||void 0===o?void 0:o.replaceTrack(null)}}catch(l){n={error:l}}finally{try{s||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});return kl(this,void 0,void 0,function*(){var t,n,i,r,o;yield e.resumeUpstream.call(this);try{for(var a,s=!0,c=wl(this.simulcastCodecs.values());!(t=(a=yield c.next()).done);s=!0){r=a.value,s=!1;const e=r;yield null===(o=e.sender)||void 0===o?void 0:o.replaceTrack(e.mediaStreamTrack)}}catch(l){n={error:l}}finally{try{s||t||!(i=c.return)||(yield i.call(c))}finally{if(n)throw n.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return kl(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.log.debug("Track already muted",this.logContext),this):(this.source!==hd.Source.Camera||this.isUserProvided||(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this)}finally{t()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return kl(this,void 0,void 0,function*(){const t=yield this.muteLock.lock();try{return this.isMuted?(this.source!==hd.Source.Camera||this.isUserProvided||(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this):(this.log.debug("Track already unmuted",this.logContext),this)}finally{t()}})}setTrackMuted(e){super.setTrackMuted(e);for(const t of this.simulcastCodecs.values())t.mediaStreamTrack.enabled=!e}getSenderStats(){return kl(this,void 0,void 0,function*(){var e;if(!(null===(e=this.sender)||void 0===e?void 0:e.getStats))return[];const t=[],n=yield this.sender.getStats();return n.forEach(e=>{var i;if("outbound-rtp"===e.type){const r={type:"video",streamId:e.id,frameHeight:e.frameHeight,frameWidth:e.frameWidth,framesPerSecond:e.framesPerSecond,framesSent:e.framesSent,firCount:e.firCount,pliCount:e.pliCount,nackCount:e.nackCount,packetsSent:e.packetsSent,bytesSent:e.bytesSent,qualityLimitationReason:e.qualityLimitationReason,qualityLimitationDurations:e.qualityLimitationDurations,qualityLimitationResolutionChanges:e.qualityLimitationResolutionChanges,rid:null!==(i=e.rid)&&void 0!==i?i:e.id,retransmittedPacketsSent:e.retransmittedPacketsSent,targetBitrate:e.targetBitrate,timestamp:e.timestamp},o=n.get(e.remoteId);o&&(r.jitter=o.jitter,r.packetsLost=o.packetsLost,r.roundTripTime=o.roundTripTime),t.push(r)}}),t.sort((e,t)=>{var n,i;return(null!==(n=t.frameWidth)&&void 0!==n?n:0)-(null!==(i=e.frameWidth)&&void 0!==i?i:0)}),t})}setPublishingQuality(e){const t=[];for(let n=dd.LOW;n<=dd.HIGH;n+=1)t.push(new Mc({quality:n,enabled:n<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(_d(this.codec),t)}restartTrack(e){return kl(this,void 0,void 0,function*(){var t,n,i,r,o;let a;if(e){const t=fh({video:e});"boolean"!==typeof t.video&&(a=t.video)}yield this.restart(a),this.isCpuConstrained=!1;try{for(var s,c=!0,l=wl(this.simulcastCodecs.values());!(t=(s=yield l.next()).done);c=!0){r=s.value,c=!1;const e=r;e.sender&&"closed"!==(null===(o=e.sender.transport)||void 0===o?void 0:o.state)&&(e.mediaStreamTrack=this.mediaStreamTrack.clone(),yield e.sender.replaceTrack(e.mediaStreamTrack))}}catch(u){n={error:u}}finally{try{c||t||!(i=l.return)||(yield i.call(l))}finally{if(n)throw n.error}}})}setProcessor(e){const t=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});return kl(this,arguments,void 0,function(e){var n=this;let i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){var r,o,a,s,c,l;if(yield t.setProcessor.call(n,e,i),null===(c=n.processor)||void 0===c?void 0:c.processedTrack)try{for(var u,d=!0,h=wl(n.simulcastCodecs.values());!(r=(u=yield h.next()).done);d=!0){s=u.value,d=!1;const e=s;yield null===(l=e.sender)||void 0===l?void 0:l.replaceTrack(n.processor.processedTrack)}}catch(p){o={error:p}}finally{try{d||r||!(a=h.return)||(yield a.call(h))}finally{if(o)throw o.error}}}()})}setDegradationPreference(e){return kl(this,void 0,void 0,function*(){if(this.degradationPreference=e,this.sender)try{this.log.debug("setting degradationPreference to ".concat(e),this.logContext);const t=this.sender.getParameters();t.degradationPreference=e,this.sender.setParameters(t)}catch(So){this.log.warn("failed to set degradationPreference",Object.assign({error:So},this.logContext))}})}addSimulcastTrack(e,t){if(this.simulcastCodecs.has(e))return void this.log.error("".concat(e," already added, skipping adding simulcast codec"),this.logContext);const n={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:t};return this.simulcastCodecs.set(e,n),n}setSimulcastTrackSender(e,t){const n=this.simulcastCodecs.get(e);n&&(n.sender=t,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},5e3))}setPublishingCodecs(e){return kl(this,void 0,void 0,function*(){var t,n,i,r,o,a,s;if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(_d(e[0].codec),e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(t=!0,n=wl(e);!(r=(i=yield n.next()).done);t=!0){s=i.value,t=!1;const e=s;if(this.codec&&this.codec!==e.codec){const t=this.simulcastCodecs.get(e.codec);if(this.log.debug("try setPublishingCodec for ".concat(e.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:t})),t&&t.sender)t.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(e.codec),this.logContext),yield Mp(t.sender,t.encodings,e.qualities,this.senderLock,_d(e.codec),this.log,this.logContext));else for(const n of e.qualities)if(n.enabled){c.push(e.codec);break}}else yield this.setPublishingLayers(_d(e.codec),e.qualities)}}catch(l){o={error:l}}finally{try{t||r||!(a=n.return)||(yield a.call(n))}finally{if(o)throw o.error}}return c})}setPublishingLayers(e,t){return kl(this,void 0,void 0,function*(){this.optimizeForPerformance?this.log.info("skipping setPublishingLayers due to optimized publishing performance",Object.assign(Object.assign({},this.logContext),{qualities:t})):(this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:t})),this.sender&&this.encodings&&(yield Mp(this.sender,this.encodings,t,this.senderLock,e,this.log,this.logContext)))})}prioritizePerformance(){return kl(this,void 0,void 0,function*(){if(!this.sender)throw new Error("sender not found");const e=yield this.senderLock.lock();try{this.optimizeForPerformance=!0;const e=this.sender.getParameters();e.encodings=e.encodings.map((e,t)=>{var n;return Object.assign(Object.assign({},e),{active:0===t,scaleResolutionDownBy:Math.max(1,Math.ceil((null!==(n=this.mediaStreamTrack.getSettings().height)&&void 0!==n?n:360)/360)),scalabilityMode:0===t&&_d(this.codec)?"L1T3":void 0,maxFramerate:0===t?15:0,maxBitrate:0===t?e.maxBitrate:0})}),this.log.debug("setting performance optimised encodings",Object.assign(Object.assign({},this.logContext),{encodings:e.encodings})),this.encodings=e.encodings,yield this.sender.setParameters(e)}catch(So){this.log.error("failed to set performance optimised encodings",Object.assign(Object.assign({},this.logContext),{error:So})),this.optimizeForPerformance=!1}finally{e()}})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return kl(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),Ld()&&this.isInBackground&&this.source===hd.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function Mp(e,t,n,i,r,o,a){return kl(this,void 0,void 0,function*(){const s=yield i.lock();o.debug("setPublishingLayersForSender",Object.assign(Object.assign({},a),{sender:e,qualities:n,senderEncodings:t}));try{const i=e.getParameters(),{encodings:s}=i;if(!s)return;if(s.length!==t.length)return void o.warn("cannot set publishing layers, encodings mismatch",Object.assign(Object.assign({},a),{encodings:s,senderEncodings:t}));let c=!1;if(!1&&s[0].scalabilityMode);else{if(r){n.some(e=>e.enabled)&&n.forEach(e=>e.enabled=!0)}s.forEach((e,i)=>{var r;let s=null!==(r=e.rid)&&void 0!==r?r:"";""===s&&(s="q");const l=jp(s),u=n.find(e=>e.quality===l);u&&e.active!==u.enabled&&(c=!0,e.active=u.enabled,o.debug("setting layer ".concat(u.quality," to ").concat(e.active?"enabled":"disabled"),a),xd()&&(u.enabled?(e.scaleResolutionDownBy=t[i].scaleResolutionDownBy,e.maxBitrate=t[i].maxBitrate,e.maxFrameRate=t[i].maxFrameRate):(e.scaleResolutionDownBy=4,e.maxBitrate=10,e.maxFrameRate=2)))})}c&&(i.encodings=s,o.debug("setting encodings",Object.assign(Object.assign({},a),{encodings:i.encodings})),yield e.setParameters(i))}finally{s()}})}function jp(e){switch(e){case"f":default:return dd.HIGH;case"h":return dd.MEDIUM;case"q":return dd.LOW}}function Up(e,t,n,i){if(!n)return[new Rs({quality:dd.HIGH,width:e,height:t,bitrate:0,ssrc:0})];if(i){const i=n[0].scalabilityMode,r=new Dp(i),o=[],a="h"==r.suffix?1.5:2,s="h"==r.suffix?2:3;for(let c=0;c<r.spatial;c+=1)o.push(new Rs({quality:Math.min(dd.HIGH,r.spatial-1)-c,width:Math.ceil(e/Math.pow(a,c)),height:Math.ceil(t/Math.pow(a,c)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(s,c)):0,ssrc:0}));return o}return n.map(n=>{var i,r,o;const a=null!==(i=n.scaleResolutionDownBy)&&void 0!==i?i:1;let s=jp(null!==(r=n.rid)&&void 0!==r?r:"");return new Rs({quality:s,width:Math.ceil(e/a),height:Math.ceil(t/a),bitrate:null!==(o=n.maxBitrate)&&void 0!==o?o:0,ssrc:0})})}const Fp="_lossy",Bp="_reliable",zp="leave-reconnect";var qp;!function(e){e[e.New=0]="New",e[e.Connected=1]="Connected",e[e.Disconnected=2]="Disconnected",e[e.Reconnecting=3]="Reconnecting",e[e.Closed=4]="Closed"}(qp||(qp={}));class Vp extends El.EventEmitter{get isClosed(){return this._isClosed}get pendingReconnect(){return!!this.reconnectTimeout}constructor(e){var t;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=dp.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.latestRemoteOfferId=0,this.subscriberPrimary=!1,this.pcState=qp.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=fl,this.reliableDataSequence=1,this.reliableMessageBuffer=new Uh,this.reliableReceivedState=new Fh(3e4),this.midToTrackId={},this.handleDataChannel=e=>kl(this,[e],void 0,function(e){var t=this;let{channel:n}=e;return function*(){if(n){if(n.label===Bp)t.reliableDCSub=n;else{if(n.label!==Fp)return;t.lossyDCSub=n}t.log.debug("on data channel ".concat(n.id,", ").concat(n.label),t.logContext),n.onmessage=t.handleDataMessage}}()}),this.handleDataMessage=e=>kl(this,void 0,void 0,function*(){var t,n,i,r,o;const a=yield this.dataProcessLock.lock();try{let a;if(e.data instanceof ArrayBuffer)a=e.data;else{if(!(e.data instanceof Blob))return void this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:e.data}));a=yield e.data.arrayBuffer()}const s=Os.fromBinary(new Uint8Array(a));if(s.sequence>0&&""!==s.participantSid){const e=this.reliableReceivedState.get(s.participantSid);if(e&&s.sequence<=e)return;this.reliableReceivedState.set(s.participantSid,s.sequence)}if("speaker"===(null===(t=s.value)||void 0===t?void 0:t.case))this.emit(Wu.ActiveSpeakersUpdate,s.value.value.speakers);else if("encryptedPacket"===(null===(n=s.value)||void 0===n?void 0:n.case)){if(!this.e2eeManager)return void this.log.error("Received encrypted packet but E2EE not set up",this.logContext);const e=yield null===(i=this.e2eeManager)||void 0===i?void 0:i.handleEncryptedData(s.value.value.encryptedValue,s.value.value.iv,s.participantIdentity,s.value.value.keyIndex),t=Ns.fromBinary(e.payload),n=new Os({value:t.value,participantIdentity:s.participantIdentity,participantSid:s.participantSid});"user"===(null===(r=n.value)||void 0===r?void 0:r.case)&&Wp(n,n.value.value),this.emit(Wu.DataPacketReceived,n,s.value.value.encryptionType)}else"user"===(null===(o=s.value)||void 0===o?void 0:o.case)&&Wp(s,s.value.value),this.emit(Wu.DataPacketReceived,s,Cs.NONE)}finally{a()}}),this.handleDataError=e=>{const t=0===e.currentTarget.maxRetransmits?"lossy":"reliable";if(e instanceof ErrorEvent&&e.error){const{error:n}=e.error;this.log.error("DataChannel error on ".concat(t,": ").concat(e.message),Object.assign(Object.assign({},this.logContext),{error:n}))}else this.log.error("Unknown DataChannel error on ".concat(t),Object.assign(Object.assign({},this.logContext),{event:e}))},this.handleBufferedAmountLow=e=>{const t=0===e.currentTarget.maxRetransmits?xs.LOSSY:xs.RELIABLE;this.updateAndEmitDCBufferStatus(t)},this.handleDisconnect=(e,t)=>{if(this._isClosed)return;this.log.warn("".concat(e," disconnected"),this.logContext),0===this.reconnectAttempts&&(this.reconnectStart=Date.now());const n=e=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(e,"ms. giving up"),this.logContext),this.emit(Wu.Disconnected),this.close()},i=Date.now()-this.reconnectStart;let r=this.getNextRetryDelay({elapsedMs:i,retryCount:this.reconnectAttempts});null!==r?(e===zp&&(r=0),this.log.debug("reconnecting in ".concat(r,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=ld.setTimeout(()=>this.attemptReconnect(t).finally(()=>this.reconnectTimeout=void 0),r)):n(i)},this.waitForRestarted=()=>new Promise((e,t)=>{this.pcState===qp.Connected&&e();const n=()=>{this.off(Wu.Disconnected,i),e()},i=()=>{this.off(Wu.Restarted,n),t()};this.once(Wu.Restarted,n),this.once(Wu.Disconnected,i)}),this.updateAndEmitDCBufferStatus=e=>{const t=this.isBufferStatusLow(e);"undefined"!==typeof t&&t!==this.dcBufferStatus.get(e)&&(this.dcBufferStatus.set(e,t),this.emit(Wu.DCBufferStatusChanged,t,e))},this.isBufferStatusLow=e=>{const t=this.dataChannelForKind(e);if(t)return e===xs.RELIABLE&&this.reliableMessageBuffer.alignBufferedAmount(t.bufferedAmount),t.bufferedAmount<=t.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===Dh.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(fs.RR_SIGNAL_DISCONNECTED))},this.log=ml(null!==(t=e.loggerName)&&void 0!==t?t:hl.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Lh(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.closingLock=new To,this.dataProcessLock=new To,this.dcBufferStatus=new Map([[xs.LOSSY,!0],[xs.RELIABLE,!0]]),this.client.onParticipantUpdate=e=>this.emit(Wu.ParticipantUpdate,e),this.client.onConnectionQuality=e=>this.emit(Wu.ConnectionQualityUpdate,e),this.client.onRoomUpdate=e=>this.emit(Wu.RoomUpdate,e),this.client.onSubscriptionError=e=>this.emit(Wu.SubscriptionError,e),this.client.onSubscriptionPermissionUpdate=e=>this.emit(Wu.SubscriptionPermissionUpdate,e),this.client.onSpeakersChanged=e=>this.emit(Wu.SpeakersChanged,e),this.client.onStreamStateUpdate=e=>this.emit(Wu.StreamStateChanged,e),this.client.onRequestResponse=e=>this.emit(Wu.SignalRequestResponse,e)}get logContext(){var e,t,n,i,r,o;return{room:null===(t=null===(e=this.latestJoinResponse)||void 0===e?void 0:e.room)||void 0===t?void 0:t.name,roomID:null===(i=null===(n=this.latestJoinResponse)||void 0===n?void 0:n.room)||void 0===i?void 0:i.sid,participant:null===(o=null===(r=this.latestJoinResponse)||void 0===r?void 0:r.participant)||void 0===o?void 0:o.identity,pID:this.participantSid}}join(e,t,n,i){return kl(this,void 0,void 0,function*(){this.url=e,this.token=t,this.signalOpts=n,this.maxJoinAttempts=n.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const r=yield this.client.join(e,t,n,i);return this._isClosed=!1,this.latestJoinResponse=r,this.subscriberPrimary=r.subscriberPrimary,this.pcManager||(yield this.configure(r)),this.subscriberPrimary&&!r.fastPublish||this.negotiate().catch(e=>{fl.error(e,this.logContext)}),this.registerOnLineListener(),this.clientConfiguration=r.clientConfiguration,this.emit(Wu.SignalConnected,r),r}catch(So){if(So instanceof Gu&&So.reason===Fu.ServerUnreachable&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,t,n,i);throw So}})}close(){return kl(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed)e();else try{this._isClosed=!0,this.joinAttempts=0,this.emit(Wu.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){return kl(this,void 0,void 0,function*(){var e;yield null===(e=this.pcManager)||void 0===e?void 0:e.close(),this.pcManager=void 0;const t=e=>{e&&(e.close(),e.onbufferedamountlow=null,e.onclose=null,e.onclosing=null,e.onerror=null,e.onmessage=null,e.onopen=null)};t(this.lossyDC),t(this.lossyDCSub),t(this.reliableDC),t(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0,this.reliableMessageBuffer=new Uh,this.reliableDataSequence=1,this.reliableReceivedState.clear()})}cleanupClient(){return kl(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new Qu("a track with the same ID has already been published");return new Promise((t,n)=>{const i=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],n(new Gu("publication of local track timed out, no response from server",Fu.Timeout))},1e4);this.pendingTrackResolvers[e.cid]={resolve:e=>{clearTimeout(i),t(e)},reject:()=>{clearTimeout(i),n(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:t}=this.pendingTrackResolvers[e.track.id];t&&t(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(So){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:So}))}return!1}updateMuteStatus(e,t){this.client.sendMuteTrack(e,t)}get dataSubscriberReadyState(){var e;return null===(e=this.reliableDCSub)||void 0===e?void 0:e.readyState}getConnectedServerAddress(){return kl(this,void 0,void 0,function*(){var e;return null===(e=this.pcManager)||void 0===e?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){return kl(this,void 0,void 0,function*(){var t,n;if(this.pcManager&&this.pcManager.currentState!==hp.NEW)return;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid;const i=this.makeRTCConfiguration(e);this.pcManager=new pp(i,this.options.singlePeerConnection?"publisher-only":e.subscriberPrimary?"subscriber-primary":"publisher-primary",this.loggerOptions),this.emit(Wu.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(e,t)=>{this.client.sendIceCandidate(e,t)},this.pcManager.onPublisherOffer=(e,t)=>{this.client.sendOffer(e,t)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(t,n,i)=>kl(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(t),this.logContext),["closed","disconnected","failed"].includes(n)&&(this.publisherConnectionPromise=void 0),t===hp.CONNECTED){const t=this.pcState===qp.New;this.pcState=qp.Connected,t&&this.emit(Wu.Connected,e)}else t===hp.FAILED&&(this.pcState!==qp.Connected&&this.pcState!==qp.Reconnecting||(this.pcState=qp.Disconnected,this.handleDisconnect("peerconnection failed","failed"===i?fs.RR_SUBSCRIBER_FAILED:fs.RR_PUBLISHER_FAILED)));const r=this.client.isDisconnected||this.client.currentState===Dh.RECONNECTING,o=[hp.FAILED,hp.CLOSING,hp.CLOSED].includes(t);r&&o&&!this._isClosed&&this.emit(Wu.Offline)}),this.pcManager.onTrack=e=>{0!==e.streams.length&&this.emit(Wu.MediaTrackAdded,e.track,e.streams[0],e.receiver)},function(e){return void 0!==e&&e>13}(null===(n=e.serverInfo)||void 0===n?void 0:n.protocol)||this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=(e,t,n)=>kl(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,midToTrackId:n})),this.midToTrackId=n,yield this.pcManager.setPublisherAnswer(e,t))}),this.client.onTrickle=(e,t)=>{this.pcManager&&(this.log.debug("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:t})),this.pcManager.addIceCandidate(e,t))},this.client.onOffer=(e,t,n)=>kl(this,void 0,void 0,function*(){if(this.latestRemoteOfferId=t,!this.pcManager)return;this.midToTrackId=n;const i=yield this.pcManager.createSubscriberAnswerFromOffer(e,t);i&&this.client.sendAnswer(i,t)}),this.client.onLocalTrackPublished=e=>{var t;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:null===(t=e.track)||void 0===t?void 0:t.sid})),!this.pendingTrackResolvers[e.cid])return void this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));const{resolve:n}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],n(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(Wu.LocalTrackUnpublished,e)},this.client.onLocalTrackSubscribed=e=>{this.emit(Wu.LocalTrackSubscribed,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,t)=>{this.emit(Wu.RemoteMute,e,t)},this.client.onSubscribedQualityUpdate=e=>{this.emit(Wu.SubscribedQualityUpdate,e)},this.client.onRoomMoved=e=>{var t;this.participantSid=null===(t=e.participant)||void 0===t?void 0:t.sid,this.latestJoinResponse&&(this.latestJoinResponse.room=e.room),this.emit(Wu.RoomMoved,e)},this.client.onMediaSectionsRequirement=e=>{var t,n;const i={direction:"recvonly"};for(let r=0;r<e.numAudios;r++)null===(t=this.pcManager)||void 0===t||t.addPublisherTransceiverOfKind("audio",i);for(let r=0;r<e.numVideos;r++)null===(n=this.pcManager)||void 0===n||n.addPublisherTransceiverOfKind("video",i);this.negotiate()},this.client.onClose=()=>{this.handleDisconnect("signal",fs.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{switch(this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:null===e||void 0===e?void 0:e.reason})),e.regions&&this.regionUrlProvider&&(this.log.debug("updating regions",this.logContext),this.regionUrlProvider.setServerReportedRegions(e.regions)),e.action){case Pc.DISCONNECT:this.emit(Wu.Disconnected,null===e||void 0===e?void 0:e.reason),this.close();break;case Pc.RECONNECT:this.fullReconnectOnNext=!0,this.handleDisconnect(zp);break;case Pc.RESUME:this.handleDisconnect(zp)}}}makeRTCConfiguration(e){var t;const n=Object.assign({},this.rtcConfig);if((null===(t=this.signalOpts)||void 0===t?void 0:t.e2eeEnabled)&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),n.encodedInsertableStreams=!0),e.iceServers&&!n.iceServers){const t=[];e.iceServers.forEach(e=>{const n={urls:e.urls};e.username&&(n.username=e.username),e.credential&&(n.credential=e.credential),t.push(n)}),n.iceServers=t}return e.clientConfiguration&&e.clientConfiguration.forceRelay===hs.ENABLED&&(n.iceTransportPolicy="relay"),n.sdpSemantics="unified-plan",n.continualGatheringPolicy="gather_continually",n}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(Fp,{ordered:!1,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Bp,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}createSender(e,t,n){return kl(this,void 0,void 0,function*(){if(Pd()){return yield this.createTransceiverRTCRtpSender(e,t,n)}if(Rd()){this.log.warn("using add-track fallback",this.logContext);return yield this.createRTCRtpSender(e.mediaStreamTrack)}throw new Yu("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,t,n,i){return kl(this,void 0,void 0,function*(){if(Pd())return this.createSimulcastTransceiverSender(e,t,n,i);if(Rd())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Yu("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,t,n){return kl(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yu("publisher is closed");const i=[];e.mediaStream&&i.push(e.mediaStream),ah(e)&&(e.codec=t.videoCodec);const r={direction:"sendonly",streams:i};n&&(r.sendEncodings=n);return(yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,r)).sender})}createSimulcastTransceiverSender(e,t,n,i){return kl(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yu("publisher is closed");const r={direction:"sendonly"};i&&(r.sendEncodings=i);const o=yield this.pcManager.addPublisherTransceiver(t.mediaStreamTrack,r);if(n.videoCodec)return e.setSimulcastTrackSender(n.videoCodec,o.sender),o.sender})}createRTCRtpSender(e){return kl(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yu("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){return kl(this,void 0,void 0,function*(){var t,n,i;if(!this._isClosed)if(this.attemptingReconnect)fl.warn("already attempting reconnect, returning early",this.logContext);else{(null===(t=this.clientConfiguration)||void 0===t?void 0:t.resumeConnection)!==hs.DISABLED&&(null!==(i=null===(n=this.pcManager)||void 0===n?void 0:n.currentState)&&void 0!==i?i:hp.NEW)!==hp.NEW||(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(So){this.reconnectAttempts+=1;let t=!0;So instanceof Yu?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:So})),t=!1):So instanceof Hp||(this.fullReconnectOnNext=!0),t?this.handleDisconnect("reconnect",fs.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(Wu.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(So){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:So}))}return null}restartConnection(e){return kl(this,void 0,void 0,function*(){var t,n,i;try{if(!this.url||!this.token)throw new Yu("could not reconnect, url or token not saved");let n;this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(Wu.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new Hp;n=yield this.join(null!==e&&void 0!==e?e:this.url,this.token,this.signalOpts)}catch(So){if(So instanceof Gu&&So.reason===Fu.NotAllowed)throw new Yu("could not reconnect, token might be expired");throw new Hp}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(Wu.SignalRestarted,n),yield this.waitForPCReconnected(),this.client.currentState!==Dh.CONNECTED)throw new Hp("Signal connection got severed during reconnect");null===(t=this.regionUrlProvider)||void 0===t||t.resetAttempts(),this.emit(Wu.Restarted)}catch(r){const e=yield null===(n=this.regionUrlProvider)||void 0===n?void 0:n.getNextBestRegionUrl();if(e)return void(yield this.restartConnection(e));throw null===(i=this.regionUrlProvider)||void 0===i||i.resetAttempts(),r}})}resumeConnection(e){return kl(this,void 0,void 0,function*(){var t;if(!this.url||!this.token)throw new Yu("could not reconnect, url or token not saved");if(!this.pcManager)throw new Yu("publisher and subscriber connections unset");let n;this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(Wu.Resuming);try{this.setupSignalClientCallbacks(),n=yield this.client.reconnect(this.url,this.token,this.participantSid,e)}catch(i){let e="";if(i instanceof Error&&(e=i.message,this.log.error(i.message,Object.assign(Object.assign({},this.logContext),{error:i}))),i instanceof Gu&&i.reason===Fu.NotAllowed)throw new Yu("could not reconnect, token might be expired");if(i instanceof Gu&&i.reason===Fu.LeaveRequest)throw i;throw new Hp(e)}if(this.emit(Wu.SignalResumed),n){const e=this.makeRTCConfiguration(n);this.pcManager.updateConfiguration(e),this.latestJoinResponse&&(this.latestJoinResponse.serverInfo=n.serverInfo)}else this.log.warn("Did not receive reconnect response",this.logContext);if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==Dh.CONNECTED)throw new Hp("Signal connection got severed during reconnect");this.client.setReconnected(),"open"===(null===(t=this.reliableDC)||void 0===t?void 0:t.readyState)&&null===this.reliableDC.id&&this.createDataChannels(),(null===n||void 0===n?void 0:n.lastMessageSeq)&&this.resendReliableMessagesForResume(n.lastMessageSeq),this.emit(Wu.Resumed)})}waitForPCInitialConnection(e,t){return kl(this,void 0,void 0,function*(){if(!this.pcManager)throw new Yu("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(t,e)})}waitForPCReconnected(){return kl(this,void 0,void 0,function*(){this.pcState=qp.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield Ed(2e3),!this.pcManager)throw new Yu("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=qp.Connected}catch(So){throw this.pcState=qp.Disconnected,new Gu("could not establish PC connection, ".concat(So.message),Fu.InternalError)}})}publishRpcResponse(e,t,n,i){return kl(this,void 0,void 0,function*(){const r=new Os({destinationIdentities:[e],kind:xs.RELIABLE,value:{case:"rpcResponse",value:new qs({requestId:t,value:i?{case:"error",value:i.toProto()}:{case:"payload",value:null!==n&&void 0!==n?n:""}})}});yield this.sendDataPacket(r,xs.RELIABLE)})}publishRpcAck(e,t){return kl(this,void 0,void 0,function*(){const n=new Os({destinationIdentities:[e],kind:xs.RELIABLE,value:{case:"rpcAck",value:new zs({requestId:t})}});yield this.sendDataPacket(n,xs.RELIABLE)})}sendDataPacket(e,t){return kl(this,void 0,void 0,function*(){if(yield this.ensurePublisherConnected(t),this.e2eeManager&&this.e2eeManager.isDataChannelEncryptionEnabled){const t=function(e){var t,n,i,r,o;if("sipDtmf"!==(null===(t=e.value)||void 0===t?void 0:t.case)&&"metrics"!==(null===(n=e.value)||void 0===n?void 0:n.case)&&"speaker"!==(null===(i=e.value)||void 0===i?void 0:i.case)&&"transcription"!==(null===(r=e.value)||void 0===r?void 0:r.case)&&"encryptedPacket"!==(null===(o=e.value)||void 0===o?void 0:o.case))return new Ns({value:e.value})}(e);if(t){const n=yield this.e2eeManager.encryptData(t.toBinary());e.value={case:"encryptedPacket",value:new Is({encryptedValue:n.payload,iv:n.iv,keyIndex:n.keyIndex})}}}t===xs.RELIABLE&&(e.sequence=this.reliableDataSequence,this.reliableDataSequence+=1);const n=e.toBinary(),i=this.dataChannelForKind(t);if(i){if(t===xs.RELIABLE&&this.reliableMessageBuffer.push({data:n,sequence:e.sequence}),this.attemptingReconnect)return;i.send(n)}this.updateAndEmitDCBufferStatus(t)})}resendReliableMessagesForResume(e){return kl(this,void 0,void 0,function*(){yield this.ensurePublisherConnected(xs.RELIABLE);const t=this.dataChannelForKind(xs.RELIABLE);t&&(this.reliableMessageBuffer.popToSequence(e),this.reliableMessageBuffer.getAll().forEach(e=>{t.send(e.data)})),this.updateAndEmitDCBufferStatus(xs.RELIABLE)})}waitForBufferStatusLow(e){return new Promise((t,n)=>kl(this,void 0,void 0,function*(){if(this.isBufferStatusLow(e))t();else{const i=()=>n("Engine closed");for(this.once(Wu.Closing,i);!this.dcBufferStatus.get(e);)yield Ed(10);this.off(Wu.Closing,i),t()}}))}ensureDataTransportConnected(e){return kl(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.subscriberPrimary;return function*(){var i;if(!t.pcManager)throw new Yu("PC manager is closed");const r=n?t.pcManager.subscriber:t.pcManager.publisher,o=n?"Subscriber":"Publisher";if(!r)throw new Gu("".concat(o," connection not set"),Fu.InternalError);let a=!1;n||t.dataChannelForKind(e,n)||(t.createDataChannels(),a=!0),a||n||t.pcManager.publisher.isICEConnected||"checking"===t.pcManager.publisher.getICEConnectionState()||(a=!0),a&&t.negotiate().catch(e=>{fl.error(e,t.logContext)});const s=t.dataChannelForKind(e,n);if("open"===(null===s||void 0===s?void 0:s.readyState))return;const c=(new Date).getTime()+t.peerConnectionTimeout;for(;(new Date).getTime()<c;){if(r.isICEConnected&&"open"===(null===(i=t.dataChannelForKind(e,n))||void 0===i?void 0:i.readyState))return;yield Ed(50)}throw new Gu("could not establish ".concat(o," connection, state: ").concat(r.getICEConnectionState()),Fu.InternalError)}()})}ensurePublisherConnected(e){return kl(this,void 0,void 0,function*(){this.publisherConnectionPromise||(this.publisherConnectionPromise=this.ensureDataTransportConnected(e,!1)),yield this.publisherConnectionPromise})}verifyTransport(){return!!this.pcManager&&(this.pcManager.currentState===hp.CONNECTED&&!(!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED))}negotiate(){return kl(this,void 0,void 0,function*(){return new Promise((e,t)=>kl(this,void 0,void 0,function*(){if(!this.pcManager)return void t(new Xu("PC manager is closed"));this.pcManager.requirePublisher(),0!=this.pcManager.publisher.getTransceivers().length||this.lossyDC||this.reliableDC||this.createDataChannels();const n=new AbortController,i=()=>{n.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&t("cannot negotiate on closed engine"),this.on(Wu.Closing,i),this.pcManager.publisher.once(tp,e=>{const t=new Map;e.forEach(e=>{const n=e.codec.toLowerCase();var i;i=n,vd.includes(i)&&t.set(e.payload,n)}),this.emit(Wu.RTPVideoMapUpdate,t)});try{yield this.pcManager.negotiate(n),e()}catch(So){So instanceof Xu&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",fs.RR_UNKNOWN),t(So)}finally{this.off(Wu.Closing,i)}}))})}dataChannelForKind(e,t){if(t){if(e===xs.LOSSY)return this.lossyDCSub;if(e===xs.RELIABLE)return this.reliableDCSub}else{if(e===xs.LOSSY)return this.lossyDC;if(e===xs.RELIABLE)return this.reliableDC}}sendSyncState(e,t){var n,i,r,o;if(!this.pcManager)return void this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);const a=this.pcManager.publisher.getLocalDescription(),s=this.pcManager.publisher.getRemoteDescription(),c=null===(n=this.pcManager.subscriber)||void 0===n?void 0:n.getRemoteDescription(),l=null===(i=this.pcManager.subscriber)||void 0===i?void 0:i.getLocalDescription(),u=null===(o=null===(r=this.signalOpts)||void 0===r?void 0:r.autoSubscribe)||void 0===o||o,d=new Array,h=new Array;e.forEach(e=>{e.isDesired!==u&&d.push(e.trackSid),e.isEnabled||h.push(e.trackSid)}),this.client.sendSyncState(new Hc({answer:this.options.singlePeerConnection?s?jh({sdp:s.sdp,type:s.type}):void 0:l?jh({sdp:l.sdp,type:l.type}):void 0,offer:this.options.singlePeerConnection?a?jh({sdp:a.sdp,type:a.type}):void 0:c?jh({sdp:c.sdp,type:c.type}):void 0,subscription:new Sc({trackSids:d,subscribe:!u,participantTracks:[]}),publishTracks:Sh(t),dataChannels:this.dataChannelsInfo(),trackSidsDisabled:h,datachannelReceiveStates:this.reliableReceivedState.map((e,t)=>new Wc({publisherSid:t,lastSeq:e}))}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],t=(t,n)=>{void 0!==(null===t||void 0===t?void 0:t.id)&&null!==t.id&&e.push(new Kc({label:t.label,id:t.id,target:n}))};return t(this.dataChannelForKind(xs.LOSSY),ac.PUBLISHER),t(this.dataChannelForKind(xs.RELIABLE),ac.PUBLISHER),t(this.dataChannelForKind(xs.LOSSY,!0),ac.SUBSCRIBER),t(this.dataChannelForKind(xs.RELIABLE,!0),ac.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&ld.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Md()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Md()&&window.removeEventListener("online",this.handleBrowserOnLine)}getTrackIdForReceiver(e){var t;const n=null===(t=this.pcManager)||void 0===t?void 0:t.getMidForReceiver(e);if(n){const e=Object.entries(this.midToTrackId).find(e=>{let[t]=e;return t===n});if(e)return e[1]}}}class Hp extends Error{}function Wp(e,t){const n=e.participantIdentity?e.participantIdentity:t.participantIdentity;e.participantIdentity=n,t.participantIdentity=n;const i=0!==e.destinationIdentities.length?e.destinationIdentities:t.destinationIdentities;e.destinationIdentities=i,t.destinationIdentities=i}class Kp{constructor(e,t){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=t}updateToken(e){this.token=e}isCloud(){return Ud(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return kl(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const t=this.regionSettings.regions.filter(e=>!this.attemptedRegions.find(t=>t.url===e.url));if(t.length>0){const e=t[0];return this.attemptedRegions.push(e),fl.debug("next region: ".concat(e.region)),e.url}return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return kl(this,void 0,void 0,function*(){const t=yield fetch("".concat((n=this.serverUrl,"".concat(n.protocol.replace("ws","http"),"//").concat(n.host,"/settings")),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});var n;if(t.ok){const e=yield t.json();return this.lastUpdateAt=Date.now(),e}throw new Gu("Could not fetch region settings: ".concat(t.statusText),401===t.status?Fu.NotAllowed:Fu.InternalError,t.status)})}setServerReportedRegions(e){this.regionSettings=e,this.lastUpdateAt=Date.now()}}class Gp{get info(){return this._info}validateBytesReceived(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("number"===typeof this.totalByteSize&&0!==this.totalByteSize){if(e&&this.bytesReceived<this.totalByteSize)throw new td("Not enough chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, only received ").concat(this.bytesReceived," bytes"),Bu.Incomplete);if(this.bytesReceived>this.totalByteSize)throw new td("Extra chunk(s) received - expected ".concat(this.totalByteSize," bytes of data total, received ").concat(this.bytesReceived," bytes"),Bu.LengthExceeded)}}constructor(e,t,n,i){this.reader=t,this.totalByteSize=n,this._info=e,this.bytesReceived=0,this.outOfBandFailureRejectingFuture=i}}class Jp extends Gp{handleChunkReceived(e){var t;this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const n=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null===(t=this.onProgress)||void 0===t||t.call(this,n)}[Symbol.asyncIterator](){const e=this.reader.getReader();let t=new Xd,n=null,i=null;if(this.signal){const e=this.signal;i=()=>{var n;null===(n=t.reject)||void 0===n||n.call(t,e.reason)},e.addEventListener("abort",i),n=e}const r=()=>{e.releaseLock(),n&&i&&n.removeEventListener("abort",i),this.signal=void 0};return{next:()=>kl(this,void 0,void 0,function*(){var n,i;try{const{done:r,value:o}=yield Promise.race([e.read(),t.promise,null!==(i=null===(n=this.outOfBandFailureRejectingFuture)||void 0===n?void 0:n.promise)&&void 0!==i?i:new Promise(()=>{})]);return r?(this.validateBytesReceived(!0),{done:!0,value:void 0}):(this.handleChunkReceived(o),{done:!1,value:o.content})}catch(xf){throw r(),xf}}),return(){return kl(this,void 0,void 0,function*(){return r(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return kl(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){var n,i,r,o;let a=new Set;const s=t.signal?e.withAbortSignal(t.signal):e;try{for(var c,l=!0,u=wl(s);!(n=(c=yield u.next()).done);l=!0){o=c.value,l=!1;const e=o;a.add(e)}}catch(d){i={error:d}}finally{try{l||n||!(r=u.return)||(yield r.call(u))}finally{if(i)throw i.error}}return Array.from(a)}()})}}class Qp extends Gp{constructor(e,t,n,i){super(e,t,n,i),this.receivedChunks=new Map}handleChunkReceived(e){var t;const n=nh(e.chunkIndex),i=this.receivedChunks.get(n);if(i&&i.version>e.version)return;this.receivedChunks.set(n,e),this.bytesReceived+=e.content.byteLength,this.validateBytesReceived();const r=this.totalByteSize?this.bytesReceived/this.totalByteSize:void 0;null===(t=this.onProgress)||void 0===t||t.call(this,r)}[Symbol.asyncIterator](){const e=this.reader.getReader(),t=new TextDecoder("utf-8",{fatal:!0});let n=new Xd,i=null,r=null;if(this.signal){const e=this.signal;r=()=>{var t;null===(t=n.reject)||void 0===t||t.call(n,e.reason)},e.addEventListener("abort",r),i=e}const o=()=>{e.releaseLock(),i&&r&&i.removeEventListener("abort",r),this.signal=void 0};return{next:()=>kl(this,void 0,void 0,function*(){var i,r;try{const{done:o,value:a}=yield Promise.race([e.read(),n.promise,null!==(r=null===(i=this.outOfBandFailureRejectingFuture)||void 0===i?void 0:i.promise)&&void 0!==r?r:new Promise(()=>{})]);if(o)return this.validateBytesReceived(!0),{done:!0,value:void 0};{let e;this.handleChunkReceived(a);try{e=t.decode(a.content)}catch(xf){throw new td("Cannot decode datastream chunk ".concat(a.chunkIndex," as text: ").concat(xf),Bu.DecodeFailed)}return{done:!1,value:e}}}catch(xf){throw o(),xf}}),return(){return kl(this,void 0,void 0,function*(){return o(),{done:!0,value:void 0}})}}}withAbortSignal(e){return this.signal=e,this}readAll(){return kl(this,arguments,void 0,function(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function*(){var n,i,r,o;let a="";const s=t.signal?e.withAbortSignal(t.signal):e;try{for(var c,l=!0,u=wl(s);!(n=(c=yield u.next()).done);l=!0){o=c.value,l=!1;a+=o}}catch(d){i={error:d}}finally{try{l||n||!(r=u.return)||(yield r.call(u))}finally{if(i)throw i.error}}return a}()})}}class $p{constructor(){this.log=fl,this.byteStreamControllers=new Map,this.textStreamControllers=new Map,this.byteStreamHandlers=new Map,this.textStreamHandlers=new Map}registerTextStreamHandler(e,t){if(this.textStreamHandlers.has(e))throw new td('A text stream handler for topic "'.concat(e,'" has already been set.'),Bu.HandlerAlreadyRegistered);this.textStreamHandlers.set(e,t)}unregisterTextStreamHandler(e){this.textStreamHandlers.delete(e)}registerByteStreamHandler(e,t){if(this.byteStreamHandlers.has(e))throw new td('A byte stream handler for topic "'.concat(e,'" has already been set.'),Bu.HandlerAlreadyRegistered);this.byteStreamHandlers.set(e,t)}unregisterByteStreamHandler(e){this.byteStreamHandlers.delete(e)}clearHandlersAndControllers(){this.byteStreamControllers.clear(),this.textStreamControllers.clear(),this.byteStreamHandlers.clear(),this.textStreamHandlers.clear()}validateParticipantHasNoActiveDataStreams(e){var t,n,i,r;const o=Array.from(this.textStreamControllers.entries()).filter(t=>t[1].sendingParticipantIdentity===e),a=Array.from(this.byteStreamControllers.entries()).filter(t=>t[1].sendingParticipantIdentity===e);if(o.length>0||a.length>0){const s=new td("Participant ".concat(e," unexpectedly disconnected in the middle of sending data"),Bu.AbnormalEnd);for(const[e,i]of a)null===(n=(t=i.outOfBandFailureRejectingFuture).reject)||void 0===n||n.call(t,s),this.byteStreamControllers.delete(e);for(const[e,t]of o)null===(r=(i=t.outOfBandFailureRejectingFuture).reject)||void 0===r||r.call(i,s),this.textStreamControllers.delete(e)}}handleDataStreamPacket(e,t){return kl(this,void 0,void 0,function*(){switch(e.value.case){case"streamHeader":return this.handleStreamHeader(e.value.value,e.participantIdentity,t);case"streamChunk":return this.handleStreamChunk(e.value.value,t);case"streamTrailer":return this.handleStreamTrailer(e.value.value,t);default:throw new Error('DataPacket of value "'.concat(e.value.case,'" is not data stream related!'))}})}handleStreamHeader(e,t,n){return kl(this,void 0,void 0,function*(){var i;if("byteHeader"===e.contentHeader.case){const r=this.byteStreamHandlers.get(e.topic);if(!r)return void this.log.debug("ignoring incoming byte stream due to no handler for topic",e.topic);let o;const a=new Xd;a.promise.catch(e=>{this.log.error(e)});const s={id:e.streamId,name:null!==(i=e.contentHeader.value.name)&&void 0!==i?i:"unknown",mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:nh(e.timestamp),attributes:e.attributes,encryptionType:n},c=new ReadableStream({start:n=>{if(o=n,this.textStreamControllers.has(e.streamId))throw new td("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Bu.AlreadyOpened);this.byteStreamControllers.set(e.streamId,{info:s,controller:o,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:a})}});r(new Jp(s,c,nh(e.totalLength),a),{identity:t})}else if("textHeader"===e.contentHeader.case){const i=this.textStreamHandlers.get(e.topic);if(!i)return void this.log.debug("ignoring incoming text stream due to no handler for topic",e.topic);let r;const o=new Xd;o.promise.catch(e=>{this.log.error(e)});const a={id:e.streamId,mimeType:e.mimeType,size:e.totalLength?Number(e.totalLength):void 0,topic:e.topic,timestamp:Number(e.timestamp),attributes:e.attributes,encryptionType:n},s=new ReadableStream({start:n=>{if(r=n,this.textStreamControllers.has(e.streamId))throw new td("A data stream read is already in progress for a stream with id ".concat(e.streamId,"."),Bu.AlreadyOpened);this.textStreamControllers.set(e.streamId,{info:a,controller:r,startTime:Date.now(),sendingParticipantIdentity:t,outOfBandFailureRejectingFuture:o})}});i(new Qp(a,s,nh(e.totalLength),o),{identity:t})}})}handleStreamChunk(e,t){const n=this.byteStreamControllers.get(e.streamId);n&&(n.info.encryptionType!==t?(n.controller.error(new td("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(n.info.encryptionType),Bu.EncryptionTypeMismatch)),this.byteStreamControllers.delete(e.streamId)):e.content.length>0&&n.controller.enqueue(e));const i=this.textStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==t?(i.controller.error(new td("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(i.info.encryptionType),Bu.EncryptionTypeMismatch)),this.textStreamControllers.delete(e.streamId)):e.content.length>0&&i.controller.enqueue(e))}handleStreamTrailer(e,t){const n=this.textStreamControllers.get(e.streamId);n&&(n.info.encryptionType!==t?n.controller.error(new td("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(n.info.encryptionType),Bu.EncryptionTypeMismatch)):(n.info.attributes=Object.assign(Object.assign({},n.info.attributes),e.attributes),n.controller.close(),this.textStreamControllers.delete(e.streamId)));const i=this.byteStreamControllers.get(e.streamId);i&&(i.info.encryptionType!==t?i.controller.error(new td("Encryption type mismatch for stream ".concat(e.streamId,". Expected ").concat(t,", got ").concat(i.info.encryptionType),Bu.EncryptionTypeMismatch)):(i.info.attributes=Object.assign(Object.assign({},i.info.attributes),e.attributes),i.controller.close()),this.byteStreamControllers.delete(e.streamId))}}class Yp{constructor(e,t,n){this.writableStream=e,this.defaultWriter=e.getWriter(),this.onClose=n,this.info=t}write(e){return this.defaultWriter.write(e)}close(){return kl(this,void 0,void 0,function*(){var e;yield this.defaultWriter.close(),this.defaultWriter.releaseLock(),null===(e=this.onClose)||void 0===e||e.call(this)})}}class Xp extends Yp{}class Zp extends Yp{}class ef{constructor(e,t){this.engine=e,this.log=t}setupEngine(e){this.engine=e}sendText(e,t){return kl(this,void 0,void 0,function*(){var n;const i=crypto.randomUUID(),r=(new TextEncoder).encode(e).byteLength,o=null===(n=null===t||void 0===t?void 0:t.attachments)||void 0===n?void 0:n.map(()=>crypto.randomUUID()),a=new Array(o?o.length+1:1).fill(0),s=(e,n)=>{var i;a[n]=e;const r=a.reduce((e,t)=>e+t,0);null===(i=null===t||void 0===t?void 0:t.onProgress)||void 0===i||i.call(t,r)},c=yield this.streamText({streamId:i,totalSize:r,destinationIdentities:null===t||void 0===t?void 0:t.destinationIdentities,topic:null===t||void 0===t?void 0:t.topic,attachedStreamIds:o,attributes:null===t||void 0===t?void 0:t.attributes});return yield c.write(e),s(1,0),yield c.close(),(null===t||void 0===t?void 0:t.attachments)&&o&&(yield Promise.all(t.attachments.map((e,n)=>kl(this,void 0,void 0,function*(){return this._sendFile(o[n],e,{topic:t.topic,mimeType:e.type,onProgress:e=>{s(e,n+1)}})})))),c.info})}streamText(e){return kl(this,void 0,void 0,function*(){var t,n,i;const r=null!==(t=null===e||void 0===e?void 0:e.streamId)&&void 0!==t?t:crypto.randomUUID(),o={id:r,mimeType:"text/plain",timestamp:Date.now(),topic:null!==(n=null===e||void 0===e?void 0:e.topic)&&void 0!==n?n:"",size:null===e||void 0===e?void 0:e.totalSize,attributes:null===e||void 0===e?void 0:e.attributes,encryptionType:(null===(i=this.engine.e2eeManager)||void 0===i?void 0:i.isDataChannelEncryptionEnabled)?Cs.GCM:Cs.NONE},a=new nc({streamId:r,mimeType:o.mimeType,topic:o.topic,timestamp:ih(o.timestamp),totalLength:ih(null===e||void 0===e?void 0:e.totalSize),attributes:o.attributes,contentHeader:{case:"textHeader",value:new ec({version:null===e||void 0===e?void 0:e.version,attachedStreamIds:null===e||void 0===e?void 0:e.attachedStreamIds,replyToStreamId:null===e||void 0===e?void 0:e.replyToStreamId,operationType:"update"===(null===e||void 0===e?void 0:e.type)?Zs.UPDATE:Zs.CREATE})}}),s=null===e||void 0===e?void 0:e.destinationIdentities,c=new Os({destinationIdentities:s,value:{case:"streamHeader",value:a}});yield this.engine.sendDataPacket(c,xs.RELIABLE);let l=0;const u=this.engine,d=new WritableStream({write(e){return kl(this,void 0,void 0,function*(){for(const t of function(e,t){const n=[];let i=(new TextEncoder).encode(e);for(;i.length>t;){let e=t;for(;e>0;){const t=i[e];if(void 0!==t&&128!==(192&t))break;e--}n.push(i.slice(0,e)),i=i.slice(e)}return i.length>0&&n.push(i),n}(e,15e3)){yield u.waitForBufferStatusLow(xs.RELIABLE);const e=new ic({content:t,streamId:r,chunkIndex:ih(l)}),n=new Os({destinationIdentities:s,value:{case:"streamChunk",value:e}});yield u.sendDataPacket(n,xs.RELIABLE),l+=1}})},close(){return kl(this,void 0,void 0,function*(){const e=new rc({streamId:r}),t=new Os({destinationIdentities:s,value:{case:"streamTrailer",value:e}});yield u.sendDataPacket(t,xs.RELIABLE)})},abort(e){console.log("Sink error:",e)}});let h=()=>kl(this,void 0,void 0,function*(){yield p.close()});u.once(Wu.Closing,h);const p=new Xp(d,o,()=>this.engine.off(Wu.Closing,h));return p})}sendFile(e,t){return kl(this,void 0,void 0,function*(){const n=crypto.randomUUID();return yield this._sendFile(n,e,t),{id:n}})}_sendFile(e,t,n){return kl(this,void 0,void 0,function*(){var i;const r=yield this.streamBytes({streamId:e,totalSize:t.size,name:t.name,mimeType:null!==(i=null===n||void 0===n?void 0:n.mimeType)&&void 0!==i?i:t.type,topic:null===n||void 0===n?void 0:n.topic,destinationIdentities:null===n||void 0===n?void 0:n.destinationIdentities}),o=t.stream().getReader();for(;;){const{done:e,value:t}=yield o.read();if(e)break;yield r.write(t)}return yield r.close(),r.info})}streamBytes(e){return kl(this,void 0,void 0,function*(){var t,n,i,r,o,a;const s=null!==(t=null===e||void 0===e?void 0:e.streamId)&&void 0!==t?t:crypto.randomUUID(),c=null===e||void 0===e?void 0:e.destinationIdentities,l={id:s,mimeType:null!==(n=null===e||void 0===e?void 0:e.mimeType)&&void 0!==n?n:"application/octet-stream",topic:null!==(i=null===e||void 0===e?void 0:e.topic)&&void 0!==i?i:"",timestamp:Date.now(),attributes:null===e||void 0===e?void 0:e.attributes,size:null===e||void 0===e?void 0:e.totalSize,name:null!==(r=null===e||void 0===e?void 0:e.name)&&void 0!==r?r:"unknown",encryptionType:(null===(o=this.engine.e2eeManager)||void 0===o?void 0:o.isDataChannelEncryptionEnabled)?Cs.GCM:Cs.NONE},u=new nc({totalLength:ih(null!==(a=l.size)&&void 0!==a?a:0),mimeType:l.mimeType,streamId:s,topic:l.topic,timestamp:ih(Date.now()),attributes:l.attributes,contentHeader:{case:"byteHeader",value:new tc({name:l.name})}}),d=new Os({destinationIdentities:c,value:{case:"streamHeader",value:u}});yield this.engine.sendDataPacket(d,xs.RELIABLE);let h=0;const p=new To,f=this.engine,m=this.log,g=new WritableStream({write(e){return kl(this,void 0,void 0,function*(){const t=yield p.lock();let n=0;try{for(;n<e.byteLength;){const t=e.slice(n,n+15e3);yield f.waitForBufferStatusLow(xs.RELIABLE);const i=new Os({destinationIdentities:c,value:{case:"streamChunk",value:new ic({content:t,streamId:s,chunkIndex:ih(h)})}});yield f.sendDataPacket(i,xs.RELIABLE),h+=1,n+=t.byteLength}}finally{t()}})},close(){return kl(this,void 0,void 0,function*(){const e=new rc({streamId:s}),t=new Os({destinationIdentities:c,value:{case:"streamTrailer",value:e}});yield f.sendDataPacket(t,xs.RELIABLE)})},abort(e){m.error("Sink error:",e)}});return new Zp(g,l)})}}class tf extends hd{constructor(e,t,n,i,r){super(e,n,r),this.sid=t,this.receiver=i}get isLocal(){return!1}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?Ku.Muted:Ku.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const t=n=>{n.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",t),this.receiver&&"playoutDelayHint"in this.receiver&&(this.receiver.playoutDelayHint=void 0),this.receiver=void 0,this._currentBitrate=0,this.emit(Ku.Ended,this))};e.addEventListener("removetrack",t)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){return kl(this,void 0,void 0,function*(){var e;if(!(null===(e=this.receiver)||void 0===e?void 0:e.getStats))return;return yield this.receiver.getStats()})}setPlayoutDelay(e){this.receiver?"playoutDelayHint"in this.receiver?this.receiver.playoutDelayHint=e:this.log.warn("Playout delay not supported in this browser"):this.log.warn("Cannot set playout delay, track already ended")}getPlayoutDelay(){if(this.receiver){if("playoutDelayHint"in this.receiver)return this.receiver.playoutDelayHint;this.log.warn("Playout delay not supported in this browser")}else this.log.warn("Cannot get playout delay, track already ended");return 0}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),vp)),"undefined"!==typeof RTCRtpReceiver&&"getSynchronizationSources"in RTCRtpReceiver&&this.registerTimeSyncUpdate()}registerTimeSyncUpdate(){const e=()=>{var t;this.timeSyncHandle=requestAnimationFrame(()=>e());const n=null===(t=this.receiver)||void 0===t?void 0:t.getSynchronizationSources()[0];if(n){const{timestamp:e,rtpTimestamp:t}=n;t&&this.rtpTimestamp!==t&&(this.emit(Ku.TimeSyncUpdate,{timestamp:e,rtpTimestamp:t}),this.rtpTimestamp=t)}};e()}}class nf extends tf{constructor(e,t,n,i,r,o){super(e,t,hd.Kind.Audio,n,o),this.monitorReceiver=()=>kl(this,void 0,void 0,function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=yp(e,this.prevStats)),this.prevStats=e}),this.audioContext=i,this.webAudioPluginNodes=[],r&&(this.sinkId=r.deviceId)}setVolume(e){var t;for(const n of this.attachedElements)this.audioContext?null===(t=this.gainNode)||void 0===t||t.gain.setTargetAtTime(e,0,.1):n.volume=e;jd()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if(jd())return 1;let e=0;return this.attachedElements.forEach(t=>{t.volume>e&&(e=t.volume)}),e}setSinkId(e){return kl(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(t=>{if(Od(t))return t.setSinkId(e)}))})}attach(e){const t=0===this.attachedElements.length;return e?super.attach(e):e=super.attach(),this.sinkId&&Od(e)&&e.setSinkId(this.sinkId).catch(e=>{this.log.error("Failed to set sink id on remote audio track",e,this.logContext)}),this.audioContext&&t&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let t;return e?(t=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(t=super.detach(),this.disconnectWebAudio()),t}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,t){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(t.srcObject);let n=this.sourceNode;this.webAudioPluginNodes.forEach(e=>{n.connect(e),n=e}),this.gainNode=e.createGain(),n.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),"running"!==e.state&&e.resume().then(()=>{"running"!==e.state&&this.emit(Ku.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(e=>{this.emit(Ku.AudioPlaybackFailed,e)})}disconnectWebAudio(){var e,t;null===(e=this.gainNode)||void 0===e||e.disconnect(),null===(t=this.sourceNode)||void 0===t||t.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return kl(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;let e;return(yield this.receiver.getStats()).forEach(t=>{"inbound-rtp"===t.type&&(e={type:"audio",streamId:t.id,timestamp:t.timestamp,jitter:t.jitter,bytesReceived:t.bytesReceived,concealedSamples:t.concealedSamples,concealmentEvents:t.concealmentEvents,silentConcealedSamples:t.silentConcealedSamples,silentConcealmentEvents:t.silentConcealmentEvents,totalAudioEnergy:t.totalAudioEnergy,totalSamplesDuration:t.totalSamplesDuration})}),e})}}class rf extends tf{constructor(e,t,n,i,r){super(e,t,hd.Kind.Video,n,r),this.elementInfos=[],this.monitorReceiver=()=>kl(this,void 0,void 0,function*(){if(!this.receiver)return void(this._currentBitrate=0);const e=yield this.getReceiverStats();e&&this.prevStats&&this.receiver&&(this._currentBitrate=yp(e,this.prevStats)),this.prevStats=e}),this.debouncedHandleResize=Xh(()=>{this.updateDimensions()},100),this.adaptiveStreamSettings=i}get isAdaptiveStream(){return void 0!==this.adaptiveStreamSettings}setStreamState(e){super.setStreamState(e),console.log("setStreamState",e),e===hd.StreamState.Active&&this.updateVisibility()}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(t=>{e?fd(this._mediaStreamTrack,t):pd(this._mediaStreamTrack,t)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&void 0===this.elementInfos.find(t=>t.element===e)){const t=new of(e);this.observeElementInfo(t)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&void 0===this.elementInfos.find(t=>t===e)?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream)return void this.log.warn("stopObservingElementInfo ignored",this.logContext);const t=this.elementInfos.filter(t=>t===e);for(const n of t)n.stopObserving();this.elementInfos=this.elementInfos.filter(t=>t!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let t=[];if(e)return this.stopObservingElement(e),super.detach(e);t=super.detach();for(const n of t)this.stopObservingElement(n);return t}getDecoderImplementation(){var e;return null===(e=this.prevStats)||void 0===e?void 0:e.decoderImplementation}getReceiverStats(){return kl(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let t,n="",i=new Map;return e.forEach(e=>{"inbound-rtp"===e.type?(n=e.codecId,t={type:"video",streamId:e.id,framesDecoded:e.framesDecoded,framesDropped:e.framesDropped,framesReceived:e.framesReceived,packetsReceived:e.packetsReceived,packetsLost:e.packetsLost,frameWidth:e.frameWidth,frameHeight:e.frameHeight,pliCount:e.pliCount,firCount:e.firCount,nackCount:e.nackCount,jitter:e.jitter,timestamp:e.timestamp,bytesReceived:e.bytesReceived,decoderImplementation:e.decoderImplementation}):"codec"===e.type&&i.set(e.id,e)}),t&&""!==n&&i.get(n)&&(t.mimeType=i.get(n).mimeType),t})}stopObservingElement(e){const t=this.elementInfos.filter(t=>t.element===e);for(const n of t)this.stopObservingElementInfo(n)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return kl(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(e){var t,n;const i=this.elementInfos.reduce((e,t)=>Math.max(e,t.visibilityChangedAt||0),0),r=!(null!==(n=null===(t=this.adaptiveStreamSettings)||void 0===t?void 0:t.pauseVideoInBackground)&&void 0!==n&&!n)&&this.isInBackground,o=this.elementInfos.some(e=>e.pictureInPicture),a=this.elementInfos.some(e=>e.visible)&&!r||o;(this.lastVisible!==a||e)&&(!a&&Date.now()-i<100?ld.setTimeout(()=>{this.updateVisibility()},100):(this.lastVisible=a,this.emit(Ku.VisibilityChanged,a,this)))}updateDimensions(){var e,t;let n=0,i=0;const r=this.getPixelDensity();for(const o of this.elementInfos){const e=o.width()*r,t=o.height()*r;e+t>n+i&&(n=e,i=t)}(null===(e=this.lastDimensions)||void 0===e?void 0:e.width)===n&&(null===(t=this.lastDimensions)||void 0===t?void 0:t.height)===i||(this.lastDimensions={width:n,height:i},this.emit(Ku.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const t=null===(e=this.adaptiveStreamSettings)||void 0===e?void 0:e.pixelDensity;if("screen"===t)return zd();if(!t){return zd()>2?2:1}return t}}class of{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,t){this.onVisibilityChanged=e=>{var t;const{target:n,isIntersecting:i}=e;n===this.element&&(this.isIntersecting=i,this.isPiP=af(this.element),this.visibilityChangedAt=Date.now(),null===(t=this.handleVisibilityChanged)||void 0===t||t.call(this))},this.onEnterPiP=()=>{var e,t,n;null===(t=null===(e=window.documentPictureInPicture)||void 0===e?void 0:e.window)||void 0===t||t.addEventListener("pagehide",this.onLeavePiP),this.isPiP=af(this.element),null===(n=this.handleVisibilityChanged)||void 0===n||n.call(this)},this.onLeavePiP=()=>{var e;this.isPiP=af(this.element),null===(e=this.handleVisibilityChanged)||void 0===e||e.call(this)},this.element=e,this.isIntersecting=null!==t&&void 0!==t?t:sf(e),this.isPiP=Md()&&af(e),this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){var e,t,n;this.isIntersecting=sf(this.element),this.isPiP=af(this.element),this.element.handleResize=()=>{var e;null===(e=this.handleResize)||void 0===e||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,Jd().observe(this.element),Kd().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP),null===(e=window.documentPictureInPicture)||void 0===e||e.addEventListener("enter",this.onEnterPiP),null===(n=null===(t=window.documentPictureInPicture)||void 0===t?void 0:t.window)||void 0===n||n.addEventListener("pagehide",this.onLeavePiP)}stopObserving(){var e,t,n,i,r;null===(e=Jd())||void 0===e||e.unobserve(this.element),null===(t=Kd())||void 0===t||t.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP),null===(n=window.documentPictureInPicture)||void 0===n||n.removeEventListener("enter",this.onEnterPiP),null===(r=null===(i=window.documentPictureInPicture)||void 0===i?void 0:i.window)||void 0===r||r.removeEventListener("pagehide",this.onLeavePiP)}}function af(e){var t,n;return document.pictureInPictureElement===e||!!(null===(t=window.documentPictureInPicture)||void 0===t?void 0:t.window)&&sf(e,null===(n=window.documentPictureInPicture)||void 0===n?void 0:n.window)}function sf(e,t){const n=t||window;let i=e.offsetTop,r=e.offsetLeft;const o=e.offsetWidth,a=e.offsetHeight,{hidden:s}=e,{display:c}=getComputedStyle(e);for(;e.offsetParent;)i+=(e=e.offsetParent).offsetTop,r+=e.offsetLeft;return i<n.pageYOffset+n.innerHeight&&r<n.pageXOffset+n.innerWidth&&i+a>n.pageYOffset&&r+o>n.pageXOffset&&!s&&"none"!==c}class cf extends El.EventEmitter{constructor(e,t,n,i){var r;super(),this.metadataMuted=!1,this.encryption=Cs.NONE,this.log=fl,this.handleMuted=()=>{this.emit(Ku.Muted)},this.handleUnmuted=()=>{this.emit(Ku.Unmuted)},this.log=ml(null!==(r=null===i||void 0===i?void 0:i.loggerName)&&void 0!==r?r:hl.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=t,this.trackName=n,this.source=hd.Source.Unknown}setTrack(e){this.track&&(this.track.off(Ku.Muted,this.handleMuted),this.track.off(Ku.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(Ku.Muted,this.handleMuted),e.on(Ku.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},null===(e=this.loggerContextCb)||void 0===e?void 0:e.call(this)),wh(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return void 0!==this.track}get isEncrypted(){return this.encryption!==Cs.NONE}get audioTrack(){if(oh(this.track))return this.track}get videoTrack(){if(ah(this.track))return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=hd.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===hd.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}!function(e){var t,n;(t=e.SubscriptionStatus||(e.SubscriptionStatus={})).Desired="desired",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",(n=e.PermissionStatus||(e.PermissionStatus={})).Allowed="allowed",n.NotAllowed="not_allowed"}(cf||(cf={}));class lf extends cf{get isUpstreamPaused(){var e;return null===(e=this.track)||void 0===e?void 0:e.isUpstreamPaused}constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.handleTrackEnded=()=>{this.emit(Ku.Ended)},this.handleCpuConstrained=()=>{this.track&&ah(this.track)&&this.emit(Ku.CpuConstrained,this.track)},this.updateInfo(t),this.setTrack(n)}setTrack(e){this.track&&(this.track.off(Ku.Ended,this.handleTrackEnded),this.track.off(Ku.CpuConstrained,this.handleCpuConstrained)),super.setTrack(e),e&&(e.on(Ku.Ended,this.handleTrackEnded),e.on(Ku.CpuConstrained,this.handleCpuConstrained))}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}get isLocal(){return!0}mute(){return kl(this,void 0,void 0,function*(){var e;return null===(e=this.track)||void 0===e?void 0:e.mute()})}unmute(){return kl(this,void 0,void 0,function*(){var e;return null===(e=this.track)||void 0===e?void 0:e.unmute()})}pauseUpstream(){return kl(this,void 0,void 0,function*(){var e;yield null===(e=this.track)||void 0===e?void 0:e.pauseUpstream()})}resumeUpstream(){return kl(this,void 0,void 0,function*(){var e;yield null===(e=this.track)||void 0===e?void 0:e.resumeUpstream()})}getTrackFeatures(){var e;if(oh(this.track)){const t=this.track.getSourceTrackSettings(),n=new Set;return t.autoGainControl&&n.add(gs.TF_AUTO_GAIN_CONTROL),t.echoCancellation&&n.add(gs.TF_ECHO_CANCELLATION),t.noiseSuppression&&n.add(gs.TF_NOISE_SUPPRESSION),t.channelCount&&t.channelCount>1&&n.add(gs.TF_STEREO),(null===(e=this.options)||void 0===e?void 0:e.dtx)||n.add(gs.TF_NO_DTX),this.track.enhancedNoiseCancellation&&n.add(gs.TF_ENHANCED_NOISE_CANCELLATION),Array.from(n.values())}return[]}}function uf(e,t){return kl(this,void 0,void 0,function*(){null!==e&&void 0!==e||(e={});let n=!1;const{audioProcessor:i,videoProcessor:r,optionsWithoutProcessor:o}=Th(e);let a=o.audio,s=o.video;if(i&&"object"===typeof o.audio&&(o.audio.processor=i),r&&"object"===typeof o.video&&(o.video.processor=r),e.audio&&"object"===typeof o.audio&&"string"===typeof o.audio.deviceId){const e=o.audio.deviceId;o.audio.deviceId={exact:e},n=!0,a=Object.assign(Object.assign({},o.audio),{deviceId:{ideal:e}})}if(o.video&&"object"===typeof o.video&&"string"===typeof o.video.deviceId){const e=o.video.deviceId;o.video.deviceId={exact:e},n=!0,s=Object.assign(Object.assign({},o.video),{deviceId:{ideal:e}})}(!0===o.audio||"object"===typeof o.audio&&!o.audio.deviceId)&&(o.audio={deviceId:"default"}),!0===o.video?o.video={deviceId:"default"}:"object"!==typeof o.video||o.video.deviceId||(o.video.deviceId="default");const c=hh(o,cp,lp),l=fh(c),u=navigator.mediaDevices.getUserMedia(l);o.audio&&(Rh.userMediaPromiseMap.set("audioinput",u),u.catch(()=>Rh.userMediaPromiseMap.delete("audioinput"))),o.video&&(Rh.userMediaPromiseMap.set("videoinput",u),u.catch(()=>Rh.userMediaPromiseMap.delete("videoinput")));try{const e=yield u;return yield Promise.all(e.getTracks().map(n=>kl(this,void 0,void 0,function*(){const o="audio"===n.kind;let a,s=o?c.audio:c.video;"boolean"!==typeof s&&s||(s={});const u=o?l.audio:l.video;"boolean"!==typeof u&&(a=u);const d=n.getSettings().deviceId;(null===a||void 0===a?void 0:a.deviceId)&&Zd(a.deviceId)!==d?a.deviceId=d:a||(a={deviceId:d});const h=function(e,t,n){switch(e.kind){case"audio":return new Tp(e,t,!1,void 0,n);case"video":return new Lp(e,t,!1,n);default:throw new Qu("unsupported track type: ".concat(e.kind))}}(n,a,t);return h.kind===hd.Kind.Video?h.source=hd.Source.Camera:h.kind===hd.Kind.Audio&&(h.source=hd.Source.Microphone),h.mediaStream=e,oh(h)&&i?yield h.setProcessor(i):ah(h)&&r&&(yield h.setProcessor(r)),h})))}catch(So){if(!n)throw So;return uf(Object.assign(Object.assign({},e),{audio:a,video:s}),t)}})}var df,hf;!function(e){e.Excellent="excellent",e.Good="good",e.Poor="poor",e.Lost="lost",e.Unknown="unknown"}(df||(df={}));class pf extends El.EventEmitter{get logContext(){var e,t;return Object.assign({},null===(t=null===(e=this.loggerOptions)||void 0===e?void 0:e.loggerContextCb)||void 0===t?void 0:t.call(e))}get isEncrypted(){return this.trackPublications.size>0&&Array.from(this.trackPublications.values()).every(e=>e.isEncrypted)}get isAgent(){var e;return(null===(e=this.permissions)||void 0===e?void 0:e.agent)||this.kind===ws.AGENT}get isActive(){var e;return(null===(e=this.participantInfo)||void 0===e?void 0:e.state)===Ss.ACTIVE}get kind(){return this._kind}get attributes(){return Object.freeze(Object.assign({},this._attributes))}constructor(e,t,n,i,r,o){let a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ws.STANDARD;var s;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=df.Unknown,this.log=fl,this.log=ml(null!==(s=null===o||void 0===o?void 0:o.loggerName)&&void 0!==s?s:hl.Participant),this.loggerOptions=o,this.setMaxListeners(100),this.sid=e,this.identity=t,this.name=n,this.metadata=i,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this._kind=a,this._attributes=null!==r&&void 0!==r?r:{}}getTrackPublications(){return Array.from(this.trackPublications.values())}getTrackPublication(e){for(const[,t]of this.trackPublications)if(t.source===e)return t}getTrackPublicationByName(e){for(const[,t]of this.trackPublications)if(t.trackName===e)return t}waitUntilActive(){return this.isActive?Promise.resolve():(this.activeFuture||(this.activeFuture=new Xd,this.once(Hu.Active,()=>{var e,t;null===(t=null===(e=this.activeFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.activeFuture=void 0})),this.activeFuture.promise)}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const t=this.getTrackPublication(hd.Source.Camera);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isMicrophoneEnabled(){var e;const t=this.getTrackPublication(hd.Source.Microphone);return!(null===(e=null===t||void 0===t?void 0:t.isMuted)||void 0===e||e)}get isScreenShareEnabled(){return!!this.getTrackPublication(hd.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(1e3*Number.parseInt(this.participantInfo.joinedAt.toString())):new Date}updateInfo(e){var t;return!(this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version)&&(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),this._setAttributes(e.attributes),e.state===Ss.ACTIVE&&(null===(t=this.participantInfo)||void 0===t?void 0:t.state)!==Ss.ACTIVE&&this.emit(Hu.Active),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,!0)}_setMetadata(e){const t=this.metadata!==e,n=this.metadata;this.metadata=e,t&&this.emit(Hu.ParticipantMetadataChanged,n)}_setName(e){const t=this.name!==e;this.name=e,t&&this.emit(Hu.ParticipantNameChanged,e)}_setAttributes(e){const t=function(e,t){var n;void 0===e&&(e={}),void 0===t&&(t={});const i=[...Object.keys(t),...Object.keys(e)],r={};for(const o of i)e[o]!==t[o]&&(r[o]=null!==(n=t[o])&&void 0!==n?n:"");return r}(this.attributes,e);this._attributes=e,Object.keys(t).length>0&&this.emit(Hu.AttributesChanged,t)}setPermissions(e){var t,n,i,r,o,a;const s=this.permissions,c=e.canPublish!==(null===(t=this.permissions)||void 0===t?void 0:t.canPublish)||e.canSubscribe!==(null===(n=this.permissions)||void 0===n?void 0:n.canSubscribe)||e.canPublishData!==(null===(i=this.permissions)||void 0===i?void 0:i.canPublishData)||e.hidden!==(null===(r=this.permissions)||void 0===r?void 0:r.hidden)||e.recorder!==(null===(o=this.permissions)||void 0===o?void 0:o.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((e,t)=>{var n;return e!==(null===(n=this.permissions)||void 0===n?void 0:n.canPublishSources[t])})||e.canSubscribeMetrics!==(null===(a=this.permissions)||void 0===a?void 0:a.canSubscribeMetrics);return this.permissions=e,c&&this.emit(Hu.ParticipantPermissionsChanged,s),c}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Hu.IsSpeakingChanged,e))}setConnectionQuality(e){const t=this._connectionQuality;this._connectionQuality=function(e){switch(e){case ds.EXCELLENT:return df.Excellent;case ds.GOOD:return df.Good;case ds.POOR:return df.Poor;case ds.LOST:return df.Lost;default:return df.Unknown}}(e),t!==this._connectionQuality&&this.emit(Hu.ConnectionQualityChanged,this._connectionQuality)}setDisconnected(){var e,t;this.activeFuture&&(null===(t=(e=this.activeFuture).reject)||void 0===t||t.call(e,new Error("Participant disconnected")),this.activeFuture=void 0)}setAudioContext(e){this.audioContext=e,this.audioTrackPublications.forEach(t=>oh(t.track)&&t.track.setAudioContext(e))}addTrackPublication(e){e.on(Ku.Muted,()=>{this.emit(Hu.TrackMuted,e)}),e.on(Ku.Unmuted,()=>{this.emit(Hu.TrackUnmuted,e)});const t=e;switch(t.track&&(t.track.sid=e.trackSid),this.trackPublications.set(e.trackSid,e),e.kind){case hd.Kind.Audio:this.audioTrackPublications.set(e.trackSid,e);break;case hd.Kind.Video:this.videoTrackPublications.set(e.trackSid,e)}}}class ff extends pf{constructor(e,t,n,i,r,o){super(e,t,void 0,void 0,void 0,{loggerName:i.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=Cs.NONE,this.enabledPublishVideoCodecs=[],this.pendingAcks=new Map,this.pendingResponses=new Map,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new Xd)},this.handleReconnected=()=>{var e,t;null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.resolve)||void 0===t||t.call(e),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleClosing=()=>{var e,t,n,i,r,o;this.reconnectFuture&&(this.reconnectFuture.promise.catch(e=>this.log.warn(e.message,this.logContext)),null===(t=null===(e=this.reconnectFuture)||void 0===e?void 0:e.reject)||void 0===t||t.call(e,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0),this.signalConnectedFuture&&(null===(i=(n=this.signalConnectedFuture).reject)||void 0===i||i.call(n,"Got disconnected without signal connected"),this.signalConnectedFuture=void 0),null===(o=null===(r=this.activeAgentFuture)||void 0===r?void 0:r.reject)||void 0===o||o.call(r,"Got disconnected without active agent present"),this.activeAgentFuture=void 0,this.firstActiveAgent=void 0},this.handleSignalConnected=e=>{var t,n;e.participant&&this.updateInfo(e.participant),this.signalConnectedFuture||(this.signalConnectedFuture=new Xd),null===(n=(t=this.signalConnectedFuture).resolve)||void 0===n||n.call(t)},this.handleSignalRequestResponse=e=>{const{requestId:t,reason:n,message:i}=e,r=this.pendingSignalRequests.get(t);r&&(n!==el.OK&&r.reject(new ed(i,n)),this.pendingSignalRequests.delete(t))},this.handleDataPacket=e=>{switch(e.value.case){case"rpcResponse":let t=e.value.value,n=null,i=null;"payload"===t.value.case?n=t.value.value:"error"===t.value.case&&(i=fp.fromProto(t.value.value)),this.handleIncomingRpcResponse(t.requestId,n,i);break;case"rpcAck":let r=e.value.value;this.handleIncomingRpcAck(r.requestId)}},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(e=>function(e){var t,n,i;if(!e.participantSid&&!e.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new Bc({participantIdentity:null!==(t=e.participantIdentity)&&void 0!==t?t:"",participantSid:null!==(n=e.participantSid)&&void 0!==n?n:"",allTracks:null!==(i=e.allowAll)&&void 0!==i&&i,trackSids:e.allowedTrackSids||[]})}(e)))},this.onTrackUnmuted=e=>{this.onTrackMuted(e,e.isUpstreamPaused)},this.onTrackMuted=(e,t)=>{void 0===t&&(t=!0),e.sid?this.engine.updateMuteStatus(e.sid,t):this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),wh(e)))},this.onTrackUpstreamPaused=e=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),wh(e))),this.onTrackMuted(e,!0)},this.onTrackUpstreamResumed=e=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),wh(e))),this.onTrackMuted(e,e.isMuted)},this.onTrackFeatureUpdate=e=>{const t=this.audioTrackPublications.get(e.sid);t?this.engine.client.sendUpdateLocalAudioTrack(t.trackSid,t.getTrackFeatures()):this.log.warn("Could not update local audio track settings, missing publication for track ".concat(e.sid),this.logContext)},this.onTrackCpuConstrained=(e,t)=>{this.log.debug("track cpu constrained",Object.assign(Object.assign({},this.logContext),wh(t))),this.emit(Hu.LocalTrackCpuConstrained,e,t)},this.handleSubscribedQualityUpdate=e=>kl(this,void 0,void 0,function*(){var t,n,i,r,o;if(!(null===(o=this.roomOptions)||void 0===o?void 0:o.dynacast))return;const a=this.videoTrackPublications.get(e.trackSid);if(!a)return void this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}));if(!a.videoTrack)return;const s=yield a.videoTrack.setPublishingCodecs(e.subscribedCodecs);try{for(var c,l=!0,u=wl(s);!(t=(c=yield u.next()).done);l=!0){r=c.value,l=!1;const e=r;yd(e)&&(this.log.debug("publish ".concat(e," for ").concat(a.videoTrack.sid),Object.assign(Object.assign({},this.logContext),wh(a))),yield this.publishAdditionalCodecForTrack(a.videoTrack,e,a.options))}}catch(d){n={error:d}}finally{try{l||t||!(i=u.return)||(yield i.call(u))}finally{if(n)throw n.error}}}),this.handleLocalTrackUnpublished=e=>{const t=this.trackPublications.get(e.trackSid);t?this.unpublishTrack(t.track):this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:e.trackSid}))},this.handleTrackEnded=e=>kl(this,void 0,void 0,function*(){if(e.source===hd.Source.ScreenShare||e.source===hd.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),wh(e))),this.unpublishTrack(e);else if(e.isUserProvided)yield e.mute();else if(ch(e)||sh(e))try{if(Md())try{const t=yield null===navigator||void 0===navigator?void 0:navigator.permissions.query({name:e.source===hd.Source.Camera?"camera":"microphone"});if(t&&"denied"===t.state)throw this.log.warn("user has revoked access to ".concat(e.source),Object.assign(Object.assign({},this.logContext),wh(e))),t.onchange=()=>{"denied"!==t.state&&(e.isMuted||e.restartTrack(),t.onchange=null)},new Error("GetUserMedia Permission denied")}catch(So){}e.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),wh(e))),ch(e)?yield e.restartTrack({deviceId:"default"}):yield e.restartTrack())}catch(So){this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),wh(e))),yield e.mute()}}),this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.trackPublications=new Map,this.engine=n,this.roomOptions=i,this.setupEngine(n),this.activeDeviceMap=new Map([["audioinput","default"],["videoinput","default"],["audiooutput","default"]]),this.pendingSignalRequests=new Map,this.rpcHandlers=r,this.roomOutgoingDataStreamManager=o}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==Cs.NONE}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setupEngine(e){var t;this.engine=e,this.engine.on(Wu.RemoteMute,(e,t)=>{const n=this.trackPublications.get(e);n&&n.track&&(t?n.mute():n.unmute())}),(null===(t=this.signalConnectedFuture)||void 0===t?void 0:t.isResolved)&&(this.signalConnectedFuture=void 0),this.engine.on(Wu.Connected,this.handleReconnected).on(Wu.SignalConnected,this.handleSignalConnected).on(Wu.SignalRestarted,this.handleReconnected).on(Wu.SignalResumed,this.handleReconnected).on(Wu.Restarting,this.handleReconnecting).on(Wu.Resuming,this.handleReconnecting).on(Wu.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(Wu.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(Wu.Closing,this.handleClosing).on(Wu.SignalRequestResponse,this.handleSignalRequestResponse).on(Wu.DataPacketReceived,this.handleDataPacket)}setMetadata(e){return kl(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({metadata:e})})}setName(e){return kl(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({name:e})})}setAttributes(e){return kl(this,void 0,void 0,function*(){yield this.requestMetadataUpdate({attributes:e})})}requestMetadataUpdate(e){return kl(this,arguments,void 0,function(e){var t=this;let{metadata:n,name:i,attributes:r}=e;return function*(){return new Promise((e,o)=>kl(t,void 0,void 0,function*(){var t,a;try{let s=!1;const c=yield this.engine.client.sendUpdateLocalMetadata(null!==(t=null!==n&&void 0!==n?n:this.metadata)&&void 0!==t?t:"",null!==(a=null!==i&&void 0!==i?i:this.name)&&void 0!==a?a:"",r),l=performance.now();for(this.pendingSignalRequests.set(c,{resolve:e,reject:e=>{o(e),s=!0},values:{name:i,metadata:n,attributes:r}});performance.now()-l<5e3&&!s;){if((!i||this.name===i)&&(!n||this.metadata===n)&&(!r||Object.entries(r).every(e=>{let[t,n]=e;return this.attributes[t]===n||""===n&&!this.attributes[t]})))return this.pendingSignalRequests.delete(c),void e();yield Ed(50)}o(new ed("Request to update local metadata timed out","TimeoutError"))}catch(So){So instanceof Error&&o(So)}}))}()})}setCameraEnabled(e,t,n){return this.setTrackEnabled(hd.Source.Camera,e,t,n)}setMicrophoneEnabled(e,t,n){return this.setTrackEnabled(hd.Source.Microphone,e,t,n)}setScreenShareEnabled(e,t,n){return this.setTrackEnabled(hd.Source.ScreenShare,e,t,n)}setE2EEEnabled(e){return kl(this,void 0,void 0,function*(){this.encryptionType=e?Cs.GCM:Cs.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,t,n,i){return kl(this,void 0,void 0,function*(){var r,o;this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:t})),this.republishPromise&&(yield this.republishPromise);let a=this.getTrackPublication(e);if(t)if(a)yield a.unmute();else{let t;if(this.pendingPublishing.has(e)){const t=yield this.waitForPendingPublicationOfSource(e);return t||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e})),yield null===t||void 0===t?void 0:t.unmute(),t}this.pendingPublishing.add(e);try{switch(e){case hd.Source.Camera:t=yield this.createTracks({video:null===(r=n)||void 0===r||r});break;case hd.Source.Microphone:t=yield this.createTracks({audio:null===(o=n)||void 0===o||o});break;case hd.Source.ScreenShare:t=yield this.createScreenTracks(Object.assign({},n));break;default:throw new Qu(e)}}catch(So){throw null===t||void 0===t||t.forEach(e=>{e.stop()}),So instanceof Error&&this.emit(Hu.MediaDevicesError,So,yh(e)),this.pendingPublishing.delete(e),So}for(const i of t){const t=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);e===hd.Source.Microphone&&oh(i)&&t.preConnectBuffer&&(this.log.info("starting preconnect buffer for microphone",Object.assign({},this.logContext)),i.startPreConnectBuffer())}try{const e=[];for(const r of t)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),wh(r))),e.push(this.publishTrack(r,i));const n=yield Promise.all(e);[a]=n}catch(So){throw null===t||void 0===t||t.forEach(e=>{e.stop()}),So}finally{this.pendingPublishing.delete(e)}}else if(!(null===a||void 0===a?void 0:a.track)&&this.pendingPublishing.has(e)&&(a=yield this.waitForPendingPublicationOfSource(e),a||this.log.info("waiting for pending publication promise timed out",Object.assign(Object.assign({},this.logContext),{source:e}))),a&&a.track)if(e===hd.Source.ScreenShare){a=yield this.unpublishTrack(a.track);const e=this.getTrackPublication(hd.Source.ScreenShareAudio);e&&e.track&&this.unpublishTrack(e.track)}else yield a.mute();return a})}enableCameraAndMicrophone(){return kl(this,void 0,void 0,function*(){if(!this.pendingPublishing.has(hd.Source.Camera)&&!this.pendingPublishing.has(hd.Source.Microphone)){this.pendingPublishing.add(hd.Source.Camera),this.pendingPublishing.add(hd.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(e=>this.publishTrack(e)))}finally{this.pendingPublishing.delete(hd.Source.Camera),this.pendingPublishing.delete(hd.Source.Microphone)}}})}createTracks(e){return kl(this,void 0,void 0,function*(){var t,n;null!==e&&void 0!==e||(e={});const i=hh(e,null===(t=this.roomOptions)||void 0===t?void 0:t.audioCaptureDefaults,null===(n=this.roomOptions)||void 0===n?void 0:n.videoCaptureDefaults);try{const e=yield uf(i,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return e.map(e=>(oh(e)&&(this.microphoneError=void 0,e.setAudioContext(this.audioContext),e.source=hd.Source.Microphone,this.emit(Hu.AudioStreamAcquired)),ah(e)&&(this.cameraError=void 0,e.source=hd.Source.Camera),e))}catch(xf){throw xf instanceof Error&&(e.audio&&(this.microphoneError=xf),e.video&&(this.cameraError=xf)),xf}})}createScreenTracks(e){return kl(this,void 0,void 0,function*(){if(void 0===e&&(e={}),void 0===navigator.mediaDevices.getDisplayMedia)throw new Ju("getDisplayMedia not supported");void 0!==e.resolution||Dd()||(e.resolution=Td.h1080fps30.resolution);const t=bh(e),n=yield navigator.mediaDevices.getDisplayMedia(t),i=n.getVideoTracks();if(0===i.length)throw new Qu("no video track found");const r=new Lp(i[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});r.source=hd.Source.ScreenShare,e.contentHint&&(r.mediaStreamTrack.contentHint=e.contentHint);const o=[r];if(n.getAudioTracks().length>0){this.emit(Hu.AudioStreamAcquired);const e=new Tp(n.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e.source=hd.Source.ScreenShareAudio,o.push(e)}return o})}publishTrack(e,t){return kl(this,void 0,void 0,function*(){return this.publishOrRepublishTrack(e,t)})}publishOrRepublishTrack(e,t){return kl(this,arguments,void 0,function(e,t){var n=this;let i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){var r,o,a,s;let c,l;if(ch(e)&&e.setAudioContext(n.audioContext),yield null===(r=n.reconnectFuture)||void 0===r?void 0:r.promise,n.republishPromise&&!i&&(yield n.republishPromise),rh(e)&&n.pendingPublishPromises.has(e)&&(yield n.pendingPublishPromises.get(e)),e instanceof MediaStreamTrack)c=e.getConstraints();else{let t;switch(c=e.constraints,e.source){case hd.Source.Microphone:t="audioinput";break;case hd.Source.Camera:t="videoinput"}t&&n.activeDeviceMap.has(t)&&(c=Object.assign(Object.assign({},c),{deviceId:n.activeDeviceMap.get(t)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new Tp(e,c,!0,n.audioContext,{loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});break;case"video":e=new Lp(e,c,!0,{loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});break;default:throw new Qu("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:n.roomOptions.loggerName,loggerContextCb:()=>n.logContext});if(n.trackPublications.forEach(t=>{t.track&&t.track===e&&(l=t)}),l)return n.log.warn("track has already been published, skipping",Object.assign(Object.assign({},n.logContext),wh(l))),l;const u=Object.assign(Object.assign({},n.roomOptions.publishDefaults),t),d="channelCount"in e.mediaStreamTrack.getSettings()&&2===e.mediaStreamTrack.getSettings().channelCount||2===e.mediaStreamTrack.getConstraints().channelCount,h=null!==(o=u.forceStereo)&&void 0!==o?o:d;h&&(void 0===u.dtx&&n.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},n.logContext),wh(e))),void 0===u.red&&n.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),null!==(a=u.dtx)&&void 0!==a||(u.dtx=!1),null!==(s=u.red)&&void 0!==s||(u.red=!1)),!function(){const e=od(),t="17.2";if(e)return"Safari"!==e.name&&"iOS"!==e.os||!!("iOS"===e.os&&e.osVersion&&qd(e.osVersion,t)>=0)||"Safari"===e.name&&qd(e.version,t)>=0}()&&n.roomOptions.e2ee&&(n.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari versions and iOS browsers running iOS < v17.2",Object.assign({},n.logContext)),u.simulcast=!1),u.source&&(e.source=u.source);const p=new Promise((t,i)=>kl(n,void 0,void 0,function*(){try{if(this.engine.client.currentState!==Dh.CONNECTED){this.log.debug("deferring track publication until signal is connected",Object.assign(Object.assign({},this.logContext),{track:wh(e)}));const n=setTimeout(()=>{i(new Zu("publishing rejected as engine not connected within timeout",408))},15e3);yield this.waitUntilEngineConnected(),clearTimeout(n);const r=yield this.publish(e,u,h);t(r)}else try{const n=yield this.publish(e,u,h);t(n)}catch(So){i(So)}}catch(So){i(So)}}));n.pendingPublishPromises.set(e,p);try{return yield p}catch(So){throw So}finally{n.pendingPublishPromises.delete(e)}}()})}waitUntilEngineConnected(){return this.signalConnectedFuture||(this.signalConnectedFuture=new Xd),this.signalConnectedFuture.promise}hasPermissionsToPublish(e){if(!this.permissions)return this.log.warn("no permissions present for publishing track",Object.assign(Object.assign({},this.logContext),wh(e))),!1;const{canPublish:t,canPublishSources:n}=this.permissions;return!(!t||0!==n.length&&!n.map(e=>function(e){switch(e){case ls.CAMERA:return hd.Source.Camera;case ls.MICROPHONE:return hd.Source.Microphone;case ls.SCREEN_SHARE:return hd.Source.ScreenShare;case ls.SCREEN_SHARE_AUDIO:return hd.Source.ScreenShareAudio;default:return hd.Source.Unknown}}(e)).includes(e.source))||(this.log.warn("insufficient permissions to publish",Object.assign(Object.assign({},this.logContext),wh(e))),!1)}publish(e,t,n){return kl(this,void 0,void 0,function*(){var i,r,o,a,s,c,l,u,d,h;if(!this.hasPermissionsToPublish(e))throw new Zu("failed to publish track, insufficient permissions",403);Array.from(this.trackPublications.values()).find(t=>rh(e)&&t.source===e.source)&&e.source!==hd.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),wh(e))),t.stopMicTrackOnMute&&oh(e)&&(e.stopOnMute=!0),e.source===hd.Source.ScreenShare&&xd()&&(t.simulcast=!1),"av1"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(Nd()||xd())return!1;const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/av1"===n.mimeType.toLowerCase()){t=!0;break}return t}()||(t.videoCodec=void 0),"vp9"!==t.videoCodec||function(){if(!("getCapabilities"in RTCRtpSender))return!1;if(xd())return!1;if(Nd()){const e=od();if((null===e||void 0===e?void 0:e.version)&&qd(e.version,"16")<0)return!1;if("iOS"===(null===e||void 0===e?void 0:e.os)&&(null===e||void 0===e?void 0:e.osVersion)&&qd(e.osVersion,"16")<0)return!1}const e=RTCRtpSender.getCapabilities("video");let t=!1;if(e)for(const n of e.codecs)if("video/vp9"===n.mimeType.toLowerCase()){t=!0;break}return t}()||(t.videoCodec=void 0),void 0===t.videoCodec&&(t.videoCodec=ap),this.enabledPublishVideoCodecs.length>0&&(this.enabledPublishVideoCodecs.some(e=>t.videoCodec===kh(e.mime))||(t.videoCodec=kh(this.enabledPublishVideoCodecs[0].mime)));const p=t.videoCodec;e.on(Ku.Muted,this.onTrackMuted),e.on(Ku.Unmuted,this.onTrackUnmuted),e.on(Ku.Ended,this.handleTrackEnded),e.on(Ku.UpstreamPaused,this.onTrackUpstreamPaused),e.on(Ku.UpstreamResumed,this.onTrackUpstreamResumed),e.on(Ku.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate);const f=[],m=!(null===(i=t.dtx)||void 0===i||i),g=e.getSourceTrackSettings();g.autoGainControl&&f.push(gs.TF_AUTO_GAIN_CONTROL),g.echoCancellation&&f.push(gs.TF_ECHO_CANCELLATION),g.noiseSuppression&&f.push(gs.TF_NOISE_SUPPRESSION),g.channelCount&&g.channelCount>1&&f.push(gs.TF_STEREO),m&&f.push(gs.TF_NO_DTX),ch(e)&&e.hasPreConnectBuffer&&f.push(gs.TF_PRECONNECT_BUFFER);const v=new hc({cid:e.mediaStreamTrack.id,name:t.name,type:hd.kindToProto(e.kind),muted:e.isMuted,source:hd.sourceToProto(e.source),disableDtx:m,encryption:this.encryptionType,stereo:n,disableRed:this.isE2EEEnabled||!(null===(r=t.red)||void 0===r||r),stream:null===t||void 0===t?void 0:t.stream,backupCodecPolicy:null===t||void 0===t?void 0:t.backupCodecPolicy,audioFeatures:f});let y;if(e.kind===hd.Kind.Video){let n={width:0,height:0};try{n=yield e.waitForDimensions()}catch(So){const i=null!==(a=null===(o=this.roomOptions.videoCaptureDefaults)||void 0===o?void 0:o.resolution)&&void 0!==a?a:Sd.h720.resolution;n={width:i.width,height:i.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),wh(e)),{dims:n}))}v.width=n.width,v.height=n.height,sh(e)&&(_d(p)&&(e.source===hd.Source.ScreenShare&&(t.scalabilityMode="L1T3","contentHint"in e.mediaStreamTrack&&(e.mediaStreamTrack.contentHint="motion",this.log.info("forcing contentHint to motion for screenshare with SVC codecs",Object.assign(Object.assign({},this.logContext),wh(e))))),t.scalabilityMode=null!==(s=t.scalabilityMode)&&void 0!==s?s:"L3T3_KEY"),v.simulcastCodecs=[new dc({codec:p,cid:e.mediaStreamTrack.id})],!0===t.backupCodec&&(t.backupCodec={codec:ap}),t.backupCodec&&p!==t.backupCodec.codec&&v.encryption===Cs.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),v.simulcastCodecs.push(new dc({codec:t.backupCodec.codec,cid:""})))),y=xp(e.source===hd.Source.ScreenShare,v.width,v.height,t),v.layers=Up(v.width,v.height,y,_d(t.videoCodec))}else e.kind===hd.Kind.Audio&&(y=[{maxBitrate:null===(c=t.audioPreset)||void 0===c?void 0:c.maxBitrate,priority:null!==(u=null===(l=t.audioPreset)||void 0===l?void 0:l.priority)&&void 0!==u?u:"high",networkPriority:null!==(h=null===(d=t.audioPreset)||void 0===d?void 0:d.priority)&&void 0!==h?h:"high"}]);if(!this.engine||this.engine.isClosed)throw new Yu("cannot publish track when not connected");const b=()=>kl(this,void 0,void 0,function*(){var n,i,r;if(!this.engine.pcManager)throw new Yu("pcManager is not ready");if(e.sender=yield this.engine.createSender(e,t,y),this.emit(Hu.LocalSenderCreated,e.sender,e),sh(e)&&(null!==(n=t.degradationPreference)&&void 0!==n||(t.degradationPreference=function(e){return e.source===hd.Source.ScreenShare||e.constraints.height&&Zd(e.constraints.height)>=1080?"maintain-resolution":"balanced"}(e)),e.setDegradationPreference(t.degradationPreference)),y)if(xd()&&e.kind===hd.Kind.Audio){let t;for(const n of this.engine.pcManager.publisher.getTransceivers())if(n.sender===e.sender){t=n;break}t&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:t,codec:"opus",maxbr:(null===(i=y[0])||void 0===i?void 0:i.maxBitrate)?y[0].maxBitrate/1e3:0})}else e.codec&&_d(e.codec)&&(null===(r=y[0])||void 0===r?void 0:r.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:v.cid,codec:e.codec,maxbr:y[0].maxBitrate/1e3});yield this.engine.negotiate()});let k;const S=new Promise((t,n)=>kl(this,void 0,void 0,function*(){var i;try{k=yield this.engine.addTrack(v),t(k)}catch(xf){e.sender&&(null===(i=this.engine.pcManager)||void 0===i?void 0:i.publisher)&&(this.engine.pcManager.publisher.removeTrack(e.sender),yield this.engine.negotiate().catch(t=>{this.log.error("failed to negotiate after removing track due to failed add track request",Object.assign(Object.assign(Object.assign({},this.logContext),wh(e)),{error:t}))})),n(xf)}}));if(this.enabledPublishVideoCodecs.length>0){const e=yield Promise.all([S,b()]);k=e[0]}else{let n;if(k=yield S,k.codecs.forEach(e=>{void 0===n&&(n=e.mimeType)}),n&&e.kind===hd.Kind.Video){const i=kh(n);i!==p&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),wh(e)),{codec:i})),t.videoCodec=i,y=xp(e.source===hd.Source.ScreenShare,v.width,v.height,t))}yield b()}const w=new lf(e.kind,k,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(w.on(Ku.CpuConstrained,e=>this.onTrackCpuConstrained(e,w)),w.options=t,e.sid=k.sid,this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:y,trackInfo:k})),sh(e)?e.startMonitor(this.engine.client):ch(e)&&e.startMonitor(),this.addTrackPublication(w),this.emit(Hu.LocalTrackPublished,w),ch(e)&&k.audioFeatures.includes(gs.TF_PRECONNECT_BUFFER)){const t=e.getPreConnectBuffer(),n=e.getPreConnectBufferMimeType();if(this.on(Hu.LocalTrackSubscribed,t=>{if(t.trackSid===k.sid){if(!e.hasPreConnectBuffer)return void this.log.warn("subscribe event came to late, buffer already closed",this.logContext);this.log.debug("finished recording preconnect buffer",Object.assign(Object.assign({},this.logContext),wh(e))),e.stopPreConnectBuffer()}}),t){const i=new Promise((i,r)=>kl(this,void 0,void 0,function*(){var o,a,s,c,l,u;try{this.log.debug("waiting for agent",Object.assign(Object.assign({},this.logContext),wh(e)));const m=setTimeout(()=>{r(new Error("agent not active within 10 seconds"))},1e4),v=yield this.waitUntilActiveAgentPresent();clearTimeout(m),this.log.debug("sending preconnect buffer",Object.assign(Object.assign({},this.logContext),wh(e)));const y=yield this.streamBytes({name:"preconnect-buffer",mimeType:n,topic:"lk.agent.pre-connect-audio-buffer",destinationIdentities:[v.identity],attributes:{trackId:w.trackSid,sampleRate:String(null!==(l=g.sampleRate)&&void 0!==l?l:"48000"),channels:String(null!==(u=g.channelCount)&&void 0!==u?u:"1")}});try{for(var d,h=!0,p=wl(t);!(o=(d=yield p.next()).done);h=!0){c=d.value,h=!1;const e=c;yield y.write(e)}}catch(f){a={error:f}}finally{try{h||o||!(s=p.return)||(yield s.call(p))}finally{if(a)throw a.error}}yield y.close(),i()}catch(So){r(So)}}));i.then(()=>{this.log.debug("preconnect buffer sent successfully",Object.assign(Object.assign({},this.logContext),wh(e)))}).catch(t=>{this.log.error("error sending preconnect buffer",Object.assign(Object.assign(Object.assign({},this.logContext),wh(e)),{error:t}))})}}return w})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,t,n){return kl(this,void 0,void 0,function*(){var i;if(this.encryptionType!==Cs.NONE)return;let r;if(this.trackPublications.forEach(t=>{t.track&&t.track===e&&(r=t)}),!r)throw new Qu("track is not published");if(!sh(e))throw new Qu("track is not a video track");const o=Object.assign(Object.assign({},null===(i=this.roomOptions)||void 0===i?void 0:i.publishDefaults),n),a=function(e,t,n){var i,r,o,a;if(!n.backupCodec||!0===n.backupCodec||n.backupCodec.codec===n.videoCodec)return;t!==n.backupCodec.codec&&fl.warn("requested a different codec than specified as backup",{serverRequested:t,backup:n.backupCodec.codec}),n.videoCodec=t,n.videoEncoding=n.backupCodec.encoding;const s=e.mediaStreamTrack.getSettings(),c=null!==(i=s.width)&&void 0!==i?i:null===(r=e.dimensions)||void 0===r?void 0:r.width,l=null!==(o=s.height)&&void 0!==o?o:null===(a=e.dimensions)||void 0===a?void 0:a.height;return e.source===hd.Source.ScreenShare&&n.simulcast&&(n.simulcast=!1),xp(e.source===hd.Source.ScreenShare,c,l,n)}(e,t,o);if(!a)return void this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),wh(e)));const s=e.addSimulcastTrack(t,a);if(!s)return;const c=new hc({cid:s.mediaStreamTrack.id,type:hd.kindToProto(e.kind),muted:e.isMuted,source:hd.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:o.videoCodec,cid:s.mediaStreamTrack.id}]});if(c.layers=Up(c.width,c.height,a),!this.engine||this.engine.isClosed)throw new Yu("cannot publish track when not connected");const l=(yield Promise.all([this.engine.addTrack(c),(()=>kl(this,void 0,void 0,function*(){yield this.engine.createSimulcastSender(e,s,o,a),yield this.engine.negotiate()}))()]))[0];this.log.debug("published ".concat(t," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:a,trackInfo:l}))})}unpublishTrack(e,t){return kl(this,void 0,void 0,function*(){var n,i;if(rh(e)){const t=this.pendingPublishPromises.get(e);t&&(this.log.info("awaiting publish promise before attempting to unpublish",Object.assign(Object.assign({},this.logContext),wh(e))),yield t)}const r=this.getPublicationForTrack(e),o=r?wh(r):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),o)),!r||!r.track)return void this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),o));(e=r.track).off(Ku.Muted,this.onTrackMuted),e.off(Ku.Unmuted,this.onTrackUnmuted),e.off(Ku.Ended,this.handleTrackEnded),e.off(Ku.UpstreamPaused,this.onTrackUpstreamPaused),e.off(Ku.UpstreamResumed,this.onTrackUpstreamResumed),e.off(Ku.AudioTrackFeatureUpdate,this.onTrackFeatureUpdate),void 0===t&&(t=null===(i=null===(n=this.roomOptions)||void 0===n?void 0:n.stopLocalTrackOnUnpublish)||void 0===i||i),t?e.stop():e.stopMonitor();let a=!1;const s=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<hp.FAILED&&s)try{for(const e of this.engine.pcManager.publisher.getTransceivers())e.sender===s&&(e.direction="inactive",a=!0);if(this.engine.removeTrack(s)&&(a=!0),sh(e)){for(const[,t]of e.simulcastCodecs)t.sender&&(this.engine.removeTrack(t.sender)&&(a=!0),t.sender=void 0);e.simulcastCodecs.clear()}}catch(So){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),o),{error:So}))}switch(this.trackPublications.delete(r.trackSid),r.kind){case hd.Kind.Audio:this.audioTrackPublications.delete(r.trackSid);break;case hd.Kind.Video:this.videoTrackPublications.delete(r.trackSid)}return this.emit(Hu.LocalTrackUnpublished,r),r.setTrack(void 0),a&&(yield this.engine.negotiate()),r})}unpublishTracks(e){return kl(this,void 0,void 0,function*(){return(yield Promise.all(e.map(e=>this.unpublishTrack(e)))).filter(e=>!!e)})}republishAllTracks(e){return kl(this,arguments,void 0,function(e){var t=this;let n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return function*(){t.republishPromise&&(yield t.republishPromise),t.republishPromise=new Promise((i,r)=>kl(t,void 0,void 0,function*(){try{const t=[];this.trackPublications.forEach(n=>{n.track&&(e&&(n.options=Object.assign(Object.assign({},n.options),e)),t.push(n))}),yield Promise.all(t.map(e=>kl(this,void 0,void 0,function*(){const t=e.track;yield this.unpublishTrack(t,!1),!n||t.isMuted||t.source===hd.Source.ScreenShare||t.source===hd.Source.ScreenShareAudio||!ch(t)&&!sh(t)||t.isUserProvided||(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:e.trackSid})),yield t.restartTrack()),yield this.publishOrRepublishTrack(t,e.options,!0)}))),i()}catch(t){r(t)}finally{this.republishPromise=void 0}})),yield t.republishPromise}()})}publishData(e){return kl(this,arguments,void 0,function(e){var t=this;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function*(){const i=n.reliable?xs.RELIABLE:xs.LOSSY,r=n.destinationIdentities,o=n.topic;let a=new Ls({participantIdentity:t.identity,payload:e,destinationIdentities:r,topic:o});const s=new Os({kind:i,value:{case:"user",value:a}});yield t.engine.sendDataPacket(s,i)}()})}publishDtmf(e,t){return kl(this,void 0,void 0,function*(){const n=new Os({kind:xs.RELIABLE,value:{case:"sipDtmf",value:new Ms({code:e,digit:t})}});yield this.engine.sendDataPacket(n,xs.RELIABLE)})}sendChatMessage(e,t){return kl(this,void 0,void 0,function*(){const n={id:crypto.randomUUID(),message:e,timestamp:Date.now(),attachedFiles:null===t||void 0===t?void 0:t.attachments},i=new Os({value:{case:"chatMessage",value:new Fs(Object.assign(Object.assign({},n),{timestamp:Wo.parse(n.timestamp)}))}});return yield this.engine.sendDataPacket(i,xs.RELIABLE),this.emit(Hu.ChatMessage,n),n})}editChatMessage(e,t){return kl(this,void 0,void 0,function*(){const n=Object.assign(Object.assign({},t),{message:e,editTimestamp:Date.now()}),i=new Os({value:{case:"chatMessage",value:new Fs(Object.assign(Object.assign({},n),{timestamp:Wo.parse(n.timestamp),editTimestamp:Wo.parse(n.editTimestamp)}))}});return yield this.engine.sendDataPacket(i,xs.RELIABLE),this.emit(Hu.ChatMessage,n),n})}sendText(e,t){return kl(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendText(e,t)})}streamText(e){return kl(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamText(e)})}sendFile(e,t){return kl(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.sendFile(e,t)})}streamBytes(e){return kl(this,void 0,void 0,function*(){return this.roomOutgoingDataStreamManager.streamBytes(e)})}performRpc(e){return kl(this,arguments,void 0,function(e){var t=this;let{destinationIdentity:n,method:i,payload:r,responseTimeout:o=15e3}=e;return function*(){return new Promise((e,a)=>kl(t,void 0,void 0,function*(){var t,s,c,l;if(mp(r)>15360)return void a(fp.builtIn("REQUEST_PAYLOAD_TOO_LARGE"));if((null===(s=null===(t=this.engine.latestJoinResponse)||void 0===t?void 0:t.serverInfo)||void 0===s?void 0:s.version)&&qd(null===(l=null===(c=this.engine.latestJoinResponse)||void 0===c?void 0:c.serverInfo)||void 0===l?void 0:l.version,"1.8.0")<0)return void a(fp.builtIn("UNSUPPORTED_SERVER"));const u=Math.max(o,8e3),d=crypto.randomUUID();yield this.publishRpcRequest(n,d,i,r,u);const h=setTimeout(()=>{this.pendingAcks.delete(d),a(fp.builtIn("CONNECTION_TIMEOUT")),this.pendingResponses.delete(d),clearTimeout(p)},7e3);this.pendingAcks.set(d,{resolve:()=>{clearTimeout(h)},participantIdentity:n});const p=setTimeout(()=>{this.pendingResponses.delete(d),a(fp.builtIn("RESPONSE_TIMEOUT"))},o);this.pendingResponses.set(d,{resolve:(t,n)=>{clearTimeout(p),this.pendingAcks.has(d)&&(console.warn("RPC response received before ack",d),this.pendingAcks.delete(d),clearTimeout(h)),n?a(n):e(null!==t&&void 0!==t?t:"")},participantIdentity:n})}))}()})}registerRpcMethod(e,t){this.rpcHandlers.has(e)&&this.log.warn("you're overriding the RPC handler for method ".concat(e,", in the future this will throw an error")),this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setTrackSubscriptionPermissions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];this.participantTrackPermissions=t,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}handleIncomingRpcAck(e){const t=this.pendingAcks.get(e);t?(t.resolve(),this.pendingAcks.delete(e)):console.error("Ack received for unexpected RPC request",e)}handleIncomingRpcResponse(e,t,n){const i=this.pendingResponses.get(e);i?(i.resolve(t,n),this.pendingResponses.delete(e)):console.error("Response received for unexpected RPC request",e)}publishRpcRequest(e,t,n,i,r){return kl(this,void 0,void 0,function*(){const o=new Os({destinationIdentities:[e],kind:xs.RELIABLE,value:{case:"rpcRequest",value:new Bs({id:t,method:n,payload:i,responseTimeoutMs:r,version:1})}});yield this.engine.sendDataPacket(o,xs.RELIABLE)})}handleParticipantDisconnected(e){for(const[t,{participantIdentity:n}]of this.pendingAcks)n===e&&this.pendingAcks.delete(t);for(const[t,{participantIdentity:n,resolve:i}]of this.pendingResponses)n===e&&(i(null,fp.builtIn("RECIPIENT_DISCONNECTED")),this.pendingResponses.delete(t))}setEnabledPublishCodecs(e){this.enabledPublishVideoCodecs=e.filter(e=>"video"===e.mime.split("/")[0].toLowerCase())}updateInfo(e){return!!super.updateInfo(e)&&(e.tracks.forEach(e=>{var t,n;const i=this.trackPublications.get(e.sid);if(i){const r=i.isMuted||null!==(n=null===(t=i.track)||void 0===t?void 0:t.isUpstreamPaused)&&void 0!==n&&n;r!==e.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),wh(i)),{mutedOnServer:r})),this.engine.client.sendMuteTrack(e.sid,r))}}),!0)}setActiveAgent(e){var t,n,i,r;this.firstActiveAgent=e,e&&!this.firstActiveAgent&&(this.firstActiveAgent=e),e?null===(n=null===(t=this.activeAgentFuture)||void 0===t?void 0:t.resolve)||void 0===n||n.call(t,e):null===(r=null===(i=this.activeAgentFuture)||void 0===i?void 0:i.reject)||void 0===r||r.call(i,"Agent disconnected"),this.activeAgentFuture=void 0}waitUntilActiveAgentPresent(){return this.firstActiveAgent?Promise.resolve(this.firstActiveAgent):(this.activeAgentFuture||(this.activeAgentFuture=new Xd),this.activeAgentFuture.promise)}getPublicationForTrack(e){let t;return this.trackPublications.forEach(n=>{const i=n.track;i&&(e instanceof MediaStreamTrack?(ch(i)||sh(i))&&i.mediaStreamTrack===e&&(t=n):e===i&&(t=n))}),t}waitForPendingPublicationOfSource(e){return kl(this,void 0,void 0,function*(){const t=Date.now();for(;Date.now()<t+1e4;){const t=Array.from(this.pendingPublishPromises.entries()).find(t=>{let[n]=t;return n.source===e});if(t)return t[1];yield Ed(20)}})}}class mf extends cf{constructor(e,t,n,i){super(e,t.sid,t.name,i),this.track=void 0,this.allowed=!0,this.requestedDisabled=void 0,this.visible=!0,this.handleEnded=e=>{this.setTrack(void 0),this.emit(Ku.Ended,e)},this.handleVisibilityChange=e=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(e),this.logContext),this.visible=e,this.emitTrackUpdate()},this.handleVideoDimensionsChange=e=>{this.log.debug("adaptivestream video dimensions ".concat(e.width,"x").concat(e.height),this.logContext),this.videoDimensionsAdaptiveStream=e,this.emitTrackUpdate()},this.subscribed=n,this.updateInfo(t)}setSubscribed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const i=new Sc({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new Hs({participantSid:"",trackSids:[this.trackSid]})]});this.emit(Ku.UpdateSubscription,i),this.emitSubscriptionUpdateIfChanged(t),this.emitPermissionUpdateIfChanged(n)}get subscriptionStatus(){return!1===this.subscribed?cf.SubscriptionStatus.Unsubscribed:super.isSubscribed?cf.SubscriptionStatus.Subscribed:cf.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?cf.PermissionStatus.Allowed:cf.PermissionStatus.NotAllowed}get isSubscribed(){return!1!==this.subscribed&&super.isSubscribed}get isDesired(){return!1!==this.subscribed}get isEnabled(){return void 0!==this.requestedDisabled?!this.requestedDisabled:!this.isAdaptiveStream||this.visible}get isLocal(){return!1}setEnabled(e){this.isManualOperationAllowed()&&this.requestedDisabled!==!e&&(this.requestedDisabled=!e,this.emitTrackUpdate())}setVideoQuality(e){this.isManualOperationAllowed()&&this.requestedMaxQuality!==e&&(this.requestedMaxQuality=e,this.requestedVideoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var t,n;this.isManualOperationAllowed()&&((null===(t=this.requestedVideoDimensions)||void 0===t?void 0:t.width)===e.width&&(null===(n=this.requestedVideoDimensions)||void 0===n?void 0:n.height)===e.height||(dh(this.track)&&(this.requestedVideoDimensions=e),this.requestedMaxQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&dh(this.track)&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){var e;return null!==(e=this.requestedMaxQuality)&&void 0!==e?e:dd.HIGH}setTrack(e){const t=this.subscriptionStatus,n=this.permissionStatus,i=this.track;i!==e&&(i&&(i.off(Ku.VideoDimensionsChanged,this.handleVideoDimensionsChange),i.off(Ku.VisibilityChanged,this.handleVisibilityChange),i.off(Ku.Ended,this.handleEnded),i.detach(),i.stopMonitor(),this.emit(Ku.Unsubscribed,i)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(Ku.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(Ku.VisibilityChanged,this.handleVisibilityChange),e.on(Ku.Ended,this.handleEnded),this.emit(Ku.Subscribed,e)),this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t))}setAllowed(e){const t=this.subscriptionStatus,n=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(n),this.emitSubscriptionUpdateIfChanged(t)}setSubscriptionError(e){this.emit(Ku.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const t=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):t!==e.muted&&this.emit(e.muted?Ku.Muted:Ku.Unmuted)}emitSubscriptionUpdateIfChanged(e){const t=this.subscriptionStatus;e!==t&&this.emit(Ku.SubscriptionStatusChanged,t,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(Ku.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return!!this.isDesired||(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return dh(this.track)&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new wc({trackSids:[this.trackSid],disabled:!this.isEnabled,fps:this.fps});if(this.kind===hd.Kind.Video){let t=this.requestedVideoDimensions;if(void 0!==this.videoDimensionsAdaptiveStream)if(t){Ch(this.videoDimensionsAdaptiveStream,t)&&(this.log.debug("using adaptive stream dimensions instead of requested",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream)}else if(void 0!==this.requestedMaxQuality&&this.trackInfo){const e=function(e,t){var n;return null===(n=e.layers)||void 0===n?void 0:n.find(e=>e.quality===t)}(this.trackInfo,this.requestedMaxQuality);e&&Ch(this.videoDimensionsAdaptiveStream,e)&&(this.log.debug("using adaptive stream dimensions instead of max quality layer",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream)}else this.log.debug("using adaptive stream dimensions",Object.assign(Object.assign({},this.logContext),this.videoDimensionsAdaptiveStream)),t=this.videoDimensionsAdaptiveStream;t?(e.width=Math.ceil(t.width),e.height=Math.ceil(t.height)):void 0!==this.requestedMaxQuality?(this.log.debug("using requested max quality",Object.assign(Object.assign({},this.logContext),{quality:this.requestedMaxQuality})),e.quality=this.requestedMaxQuality):(this.log.debug("using default quality",Object.assign(Object.assign({},this.logContext),{quality:dd.HIGH})),e.quality=dd.HIGH)}this.emit(Ku.UpdateSettings,e)}}class gf extends pf{static fromParticipantInfo(e,t,n){return new gf(e,t.sid,t.identity,t.name,t.metadata,t.attributes,n,t.kind)}get logContext(){return Object.assign(Object.assign({},super.logContext),{rpID:this.sid,remoteParticipant:this.identity})}constructor(e,t,n,i,r,o,a){super(t,n||"",i,r,o,a,arguments.length>7&&void 0!==arguments[7]?arguments[7]:ws.STANDARD),this.signalClient=e,this.trackPublications=new Map,this.audioTrackPublications=new Map,this.videoTrackPublications=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(Ku.UpdateSettings,t=>{this.log.debug("send update settings",Object.assign(Object.assign(Object.assign({},this.logContext),wh(e)),{settings:t})),this.signalClient.sendUpdateTrackSettings(t)}),e.on(Ku.UpdateSubscription,e=>{e.participantTracks.forEach(e=>{e.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(e)}),e.on(Ku.SubscriptionPermissionChanged,t=>{this.emit(Hu.TrackSubscriptionPermissionChanged,e,t)}),e.on(Ku.SubscriptionStatusChanged,t=>{this.emit(Hu.TrackSubscriptionStatusChanged,e,t)}),e.on(Ku.Subscribed,t=>{this.emit(Hu.TrackSubscribed,t,e)}),e.on(Ku.Unsubscribed,t=>{this.emit(Hu.TrackUnsubscribed,t,e)}),e.on(Ku.SubscriptionFailed,t=>{this.emit(Hu.TrackSubscriptionFailed,e.trackSid,t)})}getTrackPublication(e){const t=super.getTrackPublication(e);if(t)return t}getTrackPublicationByName(e){const t=super.getTrackPublicationByName(e);if(t)return t}setVolume(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hd.Source.Microphone;this.volumeMap.set(t,e);const n=this.getTrackPublication(t);n&&n.track&&n.track.setVolume(e)}getVolume(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hd.Source.Microphone;const t=this.getTrackPublication(e);return t&&t.track?t.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,t,n,i,r,o){let a=this.getTrackPublicationBySid(t);if(a||t.startsWith("TR")||this.trackPublications.forEach(t=>{a||e.kind!==t.kind.toString()||(a=t)}),!a)return 0===o?(this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:t})),void this.emit(Hu.TrackSubscriptionFailed,t)):(void 0===o&&(o=20),void setTimeout(()=>{this.addSubscribedMediaTrack(e,t,n,i,r,o-1)},150));if("ended"===e.readyState)return this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),wh(a))),void this.emit(Hu.TrackSubscriptionFailed,t);let s;return s="video"===e.kind?new rf(e,t,i,r):new nf(e,t,i,this.audioContext,this.audioOutput),s.source=a.source,s.isMuted=a.isMuted,s.setMediaStream(n),s.start(),a.setTrack(s),this.volumeMap.has(a.source)&&lh(s)&&oh(s)&&s.setVolume(this.volumeMap.get(a.source)),a}get hasMetadata(){return!!this.participantInfo}getTrackPublicationBySid(e){return this.trackPublications.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const t=new Map,n=new Map;return e.tracks.forEach(e=>{var i,r;let o=this.getTrackPublicationBySid(e.sid);if(o)o.updateInfo(e);else{const t=hd.kindFromProto(e.type);if(!t)return;o=new mf(t,e,null===(i=this.signalClient.connectOptions)||void 0===i?void 0:i.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:null===(r=this.loggerOptions)||void 0===r?void 0:r.loggerName}),o.updateInfo(e),n.set(e.sid,o);const a=Array.from(this.trackPublications.values()).find(e=>e.source===(null===o||void 0===o?void 0:o.source));a&&o.source!==hd.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(o.source),Object.assign(Object.assign({},this.logContext),{oldTrack:wh(a),newTrack:wh(o)})),this.addTrackPublication(o)}t.set(e.sid,o)}),this.trackPublications.forEach(e=>{t.has(e.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),wh(e))),this.unpublishTrack(e.trackSid,!0))}),n.forEach(e=>{this.emit(Hu.TrackPublished,e)}),!0}unpublishTrack(e,t){const n=this.trackPublications.get(e);if(!n)return;const{track:i}=n;switch(i&&(i.stop(),n.setTrack(void 0)),this.trackPublications.delete(e),n.kind){case hd.Kind.Audio:this.audioTrackPublications.delete(e);break;case hd.Kind.Video:this.videoTrackPublications.delete(e)}t&&this.emit(Hu.TrackUnpublished,n)}setAudioOutput(e){return kl(this,void 0,void 0,function*(){this.audioOutput=e;const t=[];this.audioTrackPublications.forEach(n=>{var i;oh(n.track)&&lh(n.track)&&t.push(n.track.setSinkId(null!==(i=e.deviceId)&&void 0!==i?i:"default"))}),yield Promise.all(t)})}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:n})),super.emit(e,...n)}}!function(e){e.Disconnected="disconnected",e.Connecting="connecting",e.Connected="connected",e.Reconnecting="reconnecting",e.SignalReconnecting="signalReconnecting"}(hf||(hf={}));class vf extends El.EventEmitter{get hasE2EESetup(){return void 0!==this.e2eeManager}constructor(e){var t,n,i,r;if(super(),t=this,this.state=hf.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=fl,this.bufferedEvents=[],this.isResuming=!1,this.rpcHandlers=new Map,this.connect=(e,t,n)=>kl(this,void 0,void 0,function*(){var i;if("undefined"===typeof RTCPeerConnection||!Pd()&&!Rd())throw jd()?Error("WebRTC isn't detected, have you called registerGlobals?"):Error("LiveKit doesn't seem to be supported on this browser. Try to update your browser and make sure no browser extensions are disabling webRTC.");const r=yield this.disconnectLock.lock();if(this.state===hf.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),r(),Promise.resolve();if(this.connectFuture)return r(),this.connectFuture.promise;this.setAndEmitConnectionState(hf.Connecting),(null===(i=this.regionUrlProvider)||void 0===i?void 0:i.getServerUrl().toString())!==e&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Ud(new URL(e))&&(void 0===this.regionUrlProvider?this.regionUrlProvider=new Kp(e,t):this.regionUrlProvider.updateToken(t),this.regionUrlProvider.fetchRegionSettings().then(e=>{var t;null===(t=this.regionUrlProvider)||void 0===t||t.setServerReportedRegions(e)}).catch(e=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:e}))}));const o=(i,a,s)=>kl(this,void 0,void 0,function*(){var c,l;this.abortController&&this.abortController.abort();const u=new AbortController;this.abortController=u,null===r||void 0===r||r();try{yield this.attemptConnection(null!==s&&void 0!==s?s:e,t,n,u),this.abortController=void 0,i()}catch(So){if(this.regionUrlProvider&&So instanceof Gu&&So.reason!==Fu.Cancelled&&So.reason!==Fu.NotAllowed){let t=null;try{t=yield this.regionUrlProvider.getNextBestRegionUrl(null===(c=this.abortController)||void 0===c?void 0:c.signal)}catch(d){if(d instanceof Gu&&(401===d.status||d.reason===Fu.Cancelled))return this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),void a(d)}t&&!(null===(l=this.abortController)||void 0===l?void 0:l.signal.aborted)?(this.log.info("Initial connection failed with ConnectionError: ".concat(So.message,". Retrying with another region: ").concat(t),this.logContext),this.recreateEngine(),yield o(i,a,t)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,th(So)),a(So))}else{let t=ps.UNKNOWN_REASON;So instanceof Gu&&(t=th(So)),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,t),a(So)}}}),a=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new Xd((e,t)=>{o(e,t,a)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(e,t,n,i,r,o)=>kl(this,void 0,void 0,function*(){var a,s,c;const l=yield n.join(e,t,{autoSubscribe:i.autoSubscribe,adaptiveStream:"object"===typeof r.adaptiveStream||r.adaptiveStream,maxRetries:i.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:i.websocketTimeout,singlePeerConnection:r.singlePeerConnection},o.signal);let u=l.serverInfo;if(u||(u={version:l.serverVersion,region:l.serverRegion}),this.serverInfo=u,this.log.debug("connected to Livekit Server ".concat(Object.entries(u).map(e=>{let[t,n]=e;return"".concat(t,": ").concat(n)}).join(", ")),{room:null===(a=l.room)||void 0===a?void 0:a.name,roomSid:null===(s=l.room)||void 0===s?void 0:s.sid,identity:null===(c=l.participant)||void 0===c?void 0:c.identity}),!u.version)throw new $u("unknown server version");return"0.15.1"===u.version&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),r.dynacast=!1),l}),this.applyJoinResponse=e=>{const t=e.participant;if(this.localParticipant.sid=t.sid,this.localParticipant.identity=t.identity,this.localParticipant.setEnabledPublishCodecs(e.enabledPublishCodecs),this.e2eeManager)try{this.e2eeManager.setSifTrailer(e.sifTrailer)}catch(So){this.log.error(So instanceof Error?So.message:"Could not set SifTrailer",Object.assign(Object.assign({},this.logContext),{error:So}))}this.handleParticipantUpdates([t,...e.otherParticipants]),e.room&&this.handleRoomUpdate(e.room)},this.attemptConnection=(e,t,n,i)=>kl(this,void 0,void 0,function*(){var r,o;this.state===hf.Reconnecting||this.isResuming||(null===(r=this.engine)||void 0===r?void 0:r.pendingReconnect)?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),(null===(o=this.regionUrlProvider)||void 0===o?void 0:o.isCloud())&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},dp),n),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const n=yield this.connectSignal(e,t,this.engine,this.connOptions,this.options,i);this.applyJoinResponse(n),this.setupLocalParticipantEvents(),this.emit(Vu.SignalConnected)}catch(xf){yield this.engine.close(),this.recreateEngine();const t=new Gu("could not establish signal connection",Fu.ServerUnreachable);throw xf instanceof Error&&(t.message="".concat(t.message,": ").concat(xf.message)),xf instanceof Gu&&(t.reason=xf.reason,t.status=xf.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:xf})),t}if(i.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new Gu("Connection attempt aborted",Fu.Cancelled);try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,i)}catch(So){throw yield this.engine.close(),this.recreateEngine(),So}Md()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Md()&&document.addEventListener("freeze",this.onPageLeave),this.setAndEmitConnectionState(hf.Connected),this.emit(Vu.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return kl(t,[...n],void 0,function(){var e=this;let t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return function*(){var n,i,r,o;const a=yield e.disconnectLock.lock();try{if(e.state===hf.Disconnected)return void e.log.debug("already disconnected",e.logContext);if(e.log.info("disconnect from room",Object.assign({},e.logContext)),e.state===hf.Connecting||e.state===hf.Reconnecting||e.isResuming){const t="Abort connection attempt due to user initiated disconnect";e.log.warn(t,e.logContext),null===(n=e.abortController)||void 0===n||n.abort(t),null===(r=null===(i=e.connectFuture)||void 0===i?void 0:i.reject)||void 0===r||r.call(i,new Gu("Client initiated disconnect",Fu.Cancelled)),e.connectFuture=void 0}(null===(o=e.engine)||void 0===o?void 0:o.client.isDisconnected)||(yield e.engine.client.sendLeave()),e.engine&&(yield e.engine.close()),e.handleDisconnect(t,ps.CLIENT_INITIATED),e.engine=void 0}finally{a()}}()})},this.onPageLeave=()=>kl(this,void 0,void 0,function*(){this.log.info("Page leave detected, disconnecting",this.logContext),yield this.disconnect()}),this.startAudio=()=>kl(this,void 0,void 0,function*(){const e=[],t=od();if(t&&"iOS"===t.os){const t="livekit-dummy-audio-el";let n=document.getElementById(t);if(!n){n=document.createElement("audio"),n.id=t,n.autoplay=!0,n.hidden=!0;const e=Yd();e.enabled=!0;const i=new MediaStream([e]);n.srcObject=i,document.addEventListener("visibilitychange",()=>{n&&(n.srcObject=document.hidden?null:i,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(n),this.once(Vu.Disconnected,()=>{null===n||void 0===n||n.remove(),n=null})}e.push(n)}this.remoteParticipants.forEach(t=>{t.audioTrackPublications.forEach(t=>{t.track&&t.track.attachedElements.forEach(t=>{e.push(t)})})});try{yield Promise.all([this.acquireAudioContext(),...e.map(e=>(e.muted=!1,e.play()))]),this.handleAudioPlaybackStarted()}catch(xf){throw this.handleAudioPlaybackFailed(xf),xf}}),this.startVideo=()=>kl(this,void 0,void 0,function*(){const e=[];for(const t of this.remoteParticipants.values())t.videoTrackPublications.forEach(t=>{var n;null===(n=t.track)||void 0===n||n.attachedElements.forEach(t=>{e.includes(t)||e.push(t)})});yield Promise.all(e.map(e=>e.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(e=>{"NotAllowedError"===e.name?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile(),this.isResuming=!1;for(const e of this.remoteParticipants.values())this.handleParticipantDisconnected(e.identity,e);this.setAndEmitConnectionState(hf.Reconnecting)&&this.emit(Vu.Reconnecting)},this.handleSignalRestarted=e=>kl(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(e.serverRegion),Object.assign(Object.assign({},this.logContext),{region:e.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(e);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(t){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:t}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:e.serverRegion}))}catch(n){return}this.setAndEmitConnectionState(hf.Connected),this.emit(Vu.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=e=>{e.forEach(e=>{var t;if(e.identity===this.localParticipant.identity)return void this.localParticipant.updateInfo(e);""===e.identity&&(e.identity=null!==(t=this.sidToIdentity.get(e.sid))&&void 0!==t?t:"");let n=this.remoteParticipants.get(e.identity);e.state===Ss.DISCONNECTED?this.handleParticipantDisconnected(e.identity,n):n=this.getOrCreateParticipant(e.identity,e)})},this.handleActiveSpeakersUpdate=e=>{const t=[],n={};e.forEach(e=>{if(n[e.sid]=!0,e.sid===this.localParticipant.sid)this.localParticipant.audioLevel=e.level,this.localParticipant.setIsSpeaking(!0),t.push(this.localParticipant);else{const n=this.getRemoteParticipantBySid(e.sid);n&&(n.audioLevel=e.level,n.setIsSpeaking(!0),t.push(n))}}),n[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.remoteParticipants.forEach(e=>{n[e.sid]||(e.audioLevel=0,e.setIsSpeaking(!1))}),this.activeSpeakers=t,this.emitWhenConnected(Vu.ActiveSpeakersChanged,t)},this.handleSpeakersChanged=e=>{const t=new Map;this.activeSpeakers.forEach(e=>{const n=this.remoteParticipants.get(e.identity);n&&n.sid!==e.sid||t.set(e.sid,e)}),e.forEach(e=>{let n=this.getRemoteParticipantBySid(e.sid);e.sid===this.localParticipant.sid&&(n=this.localParticipant),n&&(n.audioLevel=e.level,n.setIsSpeaking(e.active),e.active?t.set(e.sid,n):t.delete(e.sid))});const n=Array.from(t.values());n.sort((e,t)=>t.audioLevel-e.audioLevel),this.activeSpeakers=n,this.emitWhenConnected(Vu.ActiveSpeakersChanged,n)},this.handleStreamStateUpdate=e=>{e.streamStates.forEach(e=>{const t=this.getRemoteParticipantBySid(e.participantSid);if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);if(!n||!n.track)return;const i=hd.streamStateFromProto(e.state);n.track.setStreamState(i),i!==n.track.streamState&&(t.emit(Hu.TrackStreamStateChanged,n,n.track.streamState),this.emitWhenConnected(Vu.TrackStreamStateChanged,n,n.track.streamState,t))})},this.handleSubscriptionPermissionUpdate=e=>{const t=this.getRemoteParticipantBySid(e.participantSid);if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);n&&n.setAllowed(e.allowed)},this.handleSubscriptionError=e=>{const t=Array.from(this.remoteParticipants.values()).find(t=>t.trackPublications.has(e.trackSid));if(!t)return;const n=t.getTrackPublicationBySid(e.trackSid);n&&n.setSubscriptionError(e.err)},this.handleDataPacket=(e,t)=>{const n=this.remoteParticipants.get(e.participantIdentity);if("user"===e.value.case)this.handleUserPacket(n,e.value.value,e.kind,t);else if("transcription"===e.value.case)this.handleTranscription(n,e.value.value);else if("sipDtmf"===e.value.case)this.handleSipDtmf(n,e.value.value);else if("chatMessage"===e.value.case)this.handleChatMessage(n,e.value.value);else if("metrics"===e.value.case)this.handleMetrics(e.value.value,n);else if("streamHeader"===e.value.case||"streamChunk"===e.value.case||"streamTrailer"===e.value.case)this.handleDataStream(e,t);else if("rpcRequest"===e.value.case){const t=e.value.value;this.handleIncomingRpcRequest(e.participantIdentity,t.id,t.method,t.payload,t.responseTimeoutMs,t.version)}},this.handleUserPacket=(e,t,n,i)=>{this.emit(Vu.DataReceived,t.payload,e,n,t.topic,i),null===e||void 0===e||e.emit(Hu.DataReceived,t.payload,n,i)},this.handleSipDtmf=(e,t)=>{this.emit(Vu.SipDTMFReceived,t,e),null===e||void 0===e||e.emit(Hu.SipDTMFReceived,t)},this.handleTranscription=(e,t)=>{const n=t.transcribedParticipantIdentity===this.localParticipant.identity?this.localParticipant:this.getParticipantByIdentity(t.transcribedParticipantIdentity),i=null===n||void 0===n?void 0:n.trackPublications.get(t.trackId),r=function(e,t){return e.segments.map(e=>{let{id:n,text:i,language:r,startTime:o,endTime:a,final:s}=e;var c;const l=null!==(c=t.get(n))&&void 0!==c?c:Date.now(),u=Date.now();return s?t.delete(n):t.set(n,l),{id:n,text:i,startTime:Number.parseInt(o.toString()),endTime:Number.parseInt(a.toString()),final:s,language:r,firstReceivedTime:l,lastReceivedTime:u}})}(t,this.transcriptionReceivedTimes);null===i||void 0===i||i.emit(Ku.TranscriptionReceived,r),null===n||void 0===n||n.emit(Hu.TranscriptionReceived,r,i),this.emit(Vu.TranscriptionReceived,r,n,i)},this.handleChatMessage=(e,t)=>{const n=function(e){const{id:t,timestamp:n,message:i,editTimestamp:r}=e;return{id:t,timestamp:Number.parseInt(n.toString()),editTimestamp:r?Number.parseInt(r.toString()):void 0,message:i}}(t);this.emit(Vu.ChatMessage,n,e)},this.handleMetrics=(e,t)=>{this.emit(Vu.MetricsReceived,e,t)},this.handleDataStream=(e,t)=>{this.incomingDataStreamManager.handleDataStreamPacket(e,t)},this.bufferedSegments=new Map,this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(Vu.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=e=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:e})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(Vu.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(Vu.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(Vu.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>kl(this,void 0,void 0,function*(){var e;"iOS"!==(null===(e=od())||void 0===e?void 0:e.os)&&(yield this.selectDefaultDevices()),this.emit(Vu.MediaDevicesChanged)}),this.handleRoomUpdate=e=>{const t=this.roomInfo;this.roomInfo=e,t&&t.metadata!==e.metadata&&this.emitWhenConnected(Vu.RoomMetadataChanged,e.metadata),(null===t||void 0===t?void 0:t.activeRecording)!==e.activeRecording&&this.emitWhenConnected(Vu.RecordingStatusChanged,e.activeRecording)},this.handleConnectionQualityUpdate=e=>{e.updates.forEach(e=>{if(e.participantSid===this.localParticipant.sid)return void this.localParticipant.setConnectionQuality(e.quality);const t=this.getRemoteParticipantBySid(e.participantSid);t&&t.setConnectionQuality(e.quality)})},this.onLocalParticipantMetadataChanged=e=>{this.emit(Vu.ParticipantMetadataChanged,e,this.localParticipant)},this.onLocalParticipantNameChanged=e=>{this.emit(Vu.ParticipantNameChanged,e,this.localParticipant)},this.onLocalAttributesChanged=e=>{this.emit(Vu.ParticipantAttributesChanged,e,this.localParticipant)},this.onLocalTrackMuted=e=>{this.emit(Vu.TrackMuted,e,this.localParticipant)},this.onLocalTrackUnmuted=e=>{this.emit(Vu.TrackUnmuted,e,this.localParticipant)},this.onTrackProcessorUpdate=e=>{var t;null===(t=null===e||void 0===e?void 0:e.onPublish)||void 0===t||t.call(e,this)},this.onLocalTrackPublished=e=>kl(this,void 0,void 0,function*(){var t,n,i,r,o,a;if(null===(t=e.track)||void 0===t||t.on(Ku.TrackProcessorUpdate,this.onTrackProcessorUpdate),null===(n=e.track)||void 0===n||n.on(Ku.Restarted,this.onLocalTrackRestarted),null===(o=null===(r=null===(i=e.track)||void 0===i?void 0:i.getProcessor())||void 0===r?void 0:r.onPublish)||void 0===o||o.call(r,this),this.emit(Vu.LocalTrackPublished,e,this.localParticipant),ch(e.track)){(yield e.track.checkForSilence())&&this.emit(Vu.LocalAudioSilenceDetected,e)}const s=yield null===(a=e.track)||void 0===a?void 0:a.getDeviceId(!1),c=yh(e.source);c&&s&&s!==this.localParticipant.activeDeviceMap.get(c)&&(this.localParticipant.activeDeviceMap.set(c,s),this.emit(Vu.ActiveDeviceChanged,c,s))}),this.onLocalTrackUnpublished=e=>{var t,n;null===(t=e.track)||void 0===t||t.off(Ku.TrackProcessorUpdate,this.onTrackProcessorUpdate),null===(n=e.track)||void 0===n||n.off(Ku.Restarted,this.onLocalTrackRestarted),this.emit(Vu.LocalTrackUnpublished,e,this.localParticipant)},this.onLocalTrackRestarted=e=>kl(this,void 0,void 0,function*(){const t=yield e.getDeviceId(!1),n=yh(e.source);n&&t&&t!==this.localParticipant.activeDeviceMap.get(n)&&(this.log.debug("local track restarted, setting ".concat(n," ").concat(t," active"),this.logContext),this.localParticipant.activeDeviceMap.set(n,t),this.emit(Vu.ActiveDeviceChanged,n,t))}),this.onLocalConnectionQualityChanged=e=>{this.emit(Vu.ConnectionQualityChanged,e,this.localParticipant)},this.onMediaDevicesError=(e,t)=>{this.emit(Vu.MediaDevicesError,e,t)},this.onLocalParticipantPermissionsChanged=e=>{this.emit(Vu.ParticipantPermissionsChanged,e,this.localParticipant)},this.onLocalChatMessageSent=e=>{this.emit(Vu.ChatMessage,e,this.localParticipant)},this.setMaxListeners(100),this.remoteParticipants=new Map,this.sidToIdentity=new Map,this.options=Object.assign(Object.assign({},up),e),this.log=ml(null!==(n=this.options.loggerName)&&void 0!==n?n:hl.Room),this.transcriptionReceivedTimes=new Map,this.options.audioCaptureDefaults=Object.assign(Object.assign({},cp),null===e||void 0===e?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},lp),null===e||void 0===e?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},sp),null===e||void 0===e?void 0:e.publishDefaults),this.maybeCreateEngine(),this.incomingDataStreamManager=new $p,this.outgoingDataStreamManager=new ef(this.engine,this.log),this.disconnectLock=new To,this.localParticipant=new ff("","",this.engine,this.options,this.rpcHandlers,this.outgoingDataStreamManager),(this.options.e2ee||this.options.encryption)&&this.setupE2EE(),this.engine.e2eeManager=this.e2eeManager,this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Zd(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Zd(this.options.audioCaptureDefaults.deviceId)),(null===(i=this.options.audioOutput)||void 0===i?void 0:i.deviceId)&&this.switchActiveDevice("audiooutput",Zd(this.options.audioOutput.deviceId)).catch(e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext)),Md()){const e=new AbortController;null===(r=navigator.mediaDevices)||void 0===r||r.addEventListener("devicechange",this.handleDeviceChange,{signal:e.signal}),vf.cleanupRegistry&&vf.cleanupRegistry.register(this,()=>{e.abort()})}}registerTextStreamHandler(e,t){return this.incomingDataStreamManager.registerTextStreamHandler(e,t)}unregisterTextStreamHandler(e){return this.incomingDataStreamManager.unregisterTextStreamHandler(e)}registerByteStreamHandler(e,t){return this.incomingDataStreamManager.registerByteStreamHandler(e,t)}unregisterByteStreamHandler(e){return this.incomingDataStreamManager.unregisterByteStreamHandler(e)}registerRpcMethod(e,t){if(this.rpcHandlers.has(e))throw Error("RPC handler already registered for method ".concat(e,", unregisterRpcMethod before trying to register again"));this.rpcHandlers.set(e,t)}unregisterRpcMethod(e){this.rpcHandlers.delete(e)}setE2EEEnabled(e){return kl(this,void 0,void 0,function*(){if(!this.e2eeManager)throw Error("e2ee not configured, please set e2ee settings within the room options");yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),""!==this.localParticipant.identity&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity)})}setupE2EE(){var e;const t=!!this.options.encryption,n=this.options.encryption||this.options.e2ee;n&&("e2eeManager"in n?(this.e2eeManager=n.e2eeManager,this.e2eeManager.isDataChannelEncryptionEnabled=t):this.e2eeManager=new Eh(n,t),this.e2eeManager.on(Du.ParticipantEncryptionStatusChanged,(e,t)=>{t.isLocal&&(this.isE2EEEnabled=e),this.emit(Vu.ParticipantEncryptionStatusChanged,e,t)}),this.e2eeManager.on(Du.EncryptionError,e=>this.emit(Vu.EncryptionError,e)),null===(e=this.e2eeManager)||void 0===e||e.setup(this))}get logContext(){var e;return{room:this.name,roomID:null===(e=this.roomInfo)||void 0===e?void 0:e.sid,participant:this.localParticipant.identity,pID:this.localParticipant.sid}}get isRecording(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.activeRecording)&&void 0!==t&&t}getSid(){return kl(this,void 0,void 0,function*(){return this.state===hf.Disconnected?"":this.roomInfo&&""!==this.roomInfo.sid?this.roomInfo.sid:new Promise((e,t)=>{const n=t=>{""!==t.sid&&(this.engine.off(Wu.RoomUpdate,n),e(t.sid))};this.engine.on(Wu.RoomUpdate,n),this.once(Vu.Disconnected,()=>{this.engine.off(Wu.RoomUpdate,n),t("Room disconnected before room server id was available")})})})}get name(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.name)&&void 0!==t?t:""}get metadata(){var e;return null===(e=this.roomInfo)||void 0===e?void 0:e.metadata}get numParticipants(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numParticipants)&&void 0!==t?t:0}get numPublishers(){var e,t;return null!==(t=null===(e=this.roomInfo)||void 0===e?void 0:e.numPublishers)&&void 0!==t?t:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new Vp(this.options),this.engine.e2eeManager=this.e2eeManager,this.engine.on(Wu.ParticipantUpdate,this.handleParticipantUpdates).on(Wu.RoomUpdate,this.handleRoomUpdate).on(Wu.SpeakersChanged,this.handleSpeakersChanged).on(Wu.StreamStateChanged,this.handleStreamStateUpdate).on(Wu.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(Wu.SubscriptionError,this.handleSubscriptionError).on(Wu.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(Wu.MediaTrackAdded,(e,t,n)=>{this.onTrackAdded(e,t,n)}).on(Wu.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(Wu.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(Wu.DataPacketReceived,this.handleDataPacket).on(Wu.Resuming,()=>{this.clearConnectionReconcile(),this.isResuming=!0,this.log.info("Resuming signal connection",this.logContext),this.setAndEmitConnectionState(hf.SignalReconnecting)&&this.emit(Vu.SignalReconnecting)}).on(Wu.Resumed,()=>{this.registerConnectionReconcile(),this.isResuming=!1,this.log.info("Resumed signal connection",this.logContext),this.updateSubscriptions(),this.emitBufferedEvents(),this.setAndEmitConnectionState(hf.Connected)&&this.emit(Vu.Reconnected)}).on(Wu.SignalResumed,()=>{this.bufferedEvents=[],(this.state===hf.Reconnecting||this.isResuming)&&this.sendSyncState()}).on(Wu.Restarting,this.handleRestarting).on(Wu.SignalRestarted,this.handleSignalRestarted).on(Wu.Offline,()=>{this.setAndEmitConnectionState(hf.Reconnecting)&&this.emit(Vu.Reconnecting)}).on(Wu.DCBufferStatusChanged,(e,t)=>{this.emit(Vu.DCBufferStatusChanged,e,t)}).on(Wu.LocalTrackSubscribed,e=>{const t=this.localParticipant.getTrackPublications().find(t=>{let{trackSid:n}=t;return n===e});t?(this.localParticipant.emit(Hu.LocalTrackSubscribed,t),this.emitWhenConnected(Vu.LocalTrackSubscribed,t,this.localParticipant)):this.log.warn("could not find local track subscription for subscribed event",this.logContext)}).on(Wu.RoomMoved,e=>{this.log.debug("room moved",e),e.room&&this.handleRoomUpdate(e.room),this.remoteParticipants.forEach((e,t)=>{this.handleParticipantDisconnected(t,e)}),this.emit(Vu.Moved,e.room.name),e.participant?this.handleParticipantUpdates([e.participant,...e.otherParticipants]):this.handleParticipantUpdates(e.otherParticipants)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine),this.outgoingDataStreamManager&&this.outgoingDataStreamManager.setupEngine(this.engine))}static getLocalDevices(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Rh.getInstance().getDevices(e,t)}prepareConnection(e,t){return kl(this,void 0,void 0,function*(){if(this.state===hf.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Ud(new URL(e))&&t){this.regionUrlProvider=new Kp(e,t);const n=yield this.regionUrlProvider.getNextBestRegionUrl();n&&this.state===hf.Disconnected&&(this.regionUrl=n,yield fetch(eh(n),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(n),this.logContext))}else yield fetch(eh(e),{method:"HEAD"})}catch(So){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:So}))}}})}getParticipantByIdentity(e){return this.localParticipant.identity===e?this.localParticipant:this.remoteParticipants.get(e)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,t){return kl(this,void 0,void 0,function*(){let n,i=()=>kl(this,void 0,void 0,function*(){});switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":n=new Gc({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":n=new Gc({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":n=new Gc({scenario:{case:"serverLeave",value:!0}});break;case"migration":n=new Gc({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":i=()=>kl(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),n=new Gc({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":i=()=>kl(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),n=new Gc({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":n=new Gc({scenario:{case:"switchCandidateProtocol",value:"force-tls"===e?2:1}}),i=()=>kl(this,void 0,void 0,function*(){const e=this.engine.client.onLeave;e&&e(new Ec({reason:ps.CLIENT_INITIATED,action:Pc.RECONNECT}))});break;case"subscriber-bandwidth":if(void 0===t||"number"!==typeof t)throw new Error("subscriber-bandwidth requires a number as argument");n=new Gc({scenario:{case:"subscriberBandwidth",value:ih(t)}});break;case"leave-full-reconnect":n=new Gc({scenario:{case:"leaveRequestFullReconnect",value:!0}})}n&&(yield this.engine.client.sendSimulateScenario(n),yield i())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,t){return kl(this,arguments,void 0,function(e,t){var n=this;let i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return function*(){var r,o,a,s,c,l,u;let d=!0,h=!1;const p=i?{exact:t}:t;if("audioinput"===e){h=0===n.localParticipant.audioTrackPublications.size;const t=null!==(r=n.getActiveDevice(e))&&void 0!==r?r:n.options.audioCaptureDefaults.deviceId;n.options.audioCaptureDefaults.deviceId=p;const i=Array.from(n.localParticipant.audioTrackPublications.values()).filter(e=>e.source===hd.Source.Microphone);try{d=(yield Promise.all(i.map(e=>{var t;return null===(t=e.audioTrack)||void 0===t?void 0:t.setDeviceId(p)}))).every(e=>!0===e)}catch(So){throw n.options.audioCaptureDefaults.deviceId=t,So}const o=i.some(e=>{var t,n;return null!==(n=null===(t=e.track)||void 0===t?void 0:t.isMuted)&&void 0!==n&&n});d&&o&&(h=!0)}else if("videoinput"===e){h=0===n.localParticipant.videoTrackPublications.size;const t=null!==(o=n.getActiveDevice(e))&&void 0!==o?o:n.options.videoCaptureDefaults.deviceId;n.options.videoCaptureDefaults.deviceId=p;const i=Array.from(n.localParticipant.videoTrackPublications.values()).filter(e=>e.source===hd.Source.Camera);try{d=(yield Promise.all(i.map(e=>{var t;return null===(t=e.videoTrack)||void 0===t?void 0:t.setDeviceId(p)}))).every(e=>!0===e)}catch(So){throw n.options.videoCaptureDefaults.deviceId=t,So}const r=i.some(e=>{var t,n;return null!==(n=null===(t=e.track)||void 0===t?void 0:t.isMuted)&&void 0!==n&&n});d&&r&&(h=!0)}else if("audiooutput"===e){if(h=!0,!Od()&&!n.options.webAudioMix||n.options.webAudioMix&&n.audioContext&&!("setSinkId"in n.audioContext))throw new Error("cannot switch audio output, the current browser does not support it");n.options.webAudioMix&&(t=null!==(a=yield Rh.getInstance().normalizeDeviceId("audiooutput",t))&&void 0!==a?a:""),null!==(s=(u=n.options).audioOutput)&&void 0!==s||(u.audioOutput={});const i=null!==(c=n.getActiveDevice(e))&&void 0!==c?c:n.options.audioOutput.deviceId;n.options.audioOutput.deviceId=t;try{n.options.webAudioMix&&(null===(l=n.audioContext)||void 0===l||l.setSinkId(t)),yield Promise.all(Array.from(n.remoteParticipants.values()).map(e=>e.setAudioOutput({deviceId:t})))}catch(So){throw n.options.audioOutput.deviceId=i,So}}return h&&(n.localParticipant.activeDeviceMap.set(e,t),n.emit(Vu.ActiveDeviceChanged,e,t)),d}()})}setupLocalParticipantEvents(){this.localParticipant.on(Hu.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Hu.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Hu.AttributesChanged,this.onLocalAttributesChanged).on(Hu.TrackMuted,this.onLocalTrackMuted).on(Hu.TrackUnmuted,this.onLocalTrackUnmuted).on(Hu.LocalTrackPublished,this.onLocalTrackPublished).on(Hu.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Hu.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Hu.MediaDevicesError,this.onMediaDevicesError).on(Hu.AudioStreamAcquired,this.startAudio).on(Hu.ChatMessage,this.onLocalChatMessageSent).on(Hu.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;null===(e=this.engine)||void 0===e||e.close(),this.engine=void 0,this.isResuming=!1,this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,t,n){if(this.state===hf.Connecting||this.state===hf.Reconnecting){const i=()=>{this.log.debug("deferring on track for later",{mediaTrackId:e.id,mediaStreamId:t.id,tracksInStream:t.getTracks().map(e=>e.id)}),this.onTrackAdded(e,t,n),r()},r=()=>{this.off(Vu.Reconnected,i),this.off(Vu.Connected,i),this.off(Vu.Disconnected,r)};return this.once(Vu.Reconnected,i),this.once(Vu.Connected,i),void this.once(Vu.Disconnected,r)}if(this.state===hf.Disconnected)return void this.log.warn("skipping incoming track after Room disconnected",this.logContext);if("ended"===e.readyState)return void this.log.info("skipping incoming track as it already ended",this.logContext);const i=function(e){const t=e.split("|");return t.length>1?[t[0],e.substr(t[0].length+1)]:[e,""]}(t.id),r=i[0];let o=i[1],a=e.id;if(o&&o.startsWith("TR")&&(a=o),r===this.localParticipant.sid)return void this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);const s=Array.from(this.remoteParticipants.values()).find(e=>e.sid===r);if(!s)return void this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(r),this.logContext);if(!a.startsWith("TR")){const e=this.engine.getTrackIdForReceiver(n);if(!e)return void this.log.error("Tried to add a track whose 'sid' could not be found for a participant, that's not present. Sid: ".concat(r),this.logContext);a=e}let c;a.startsWith("TR")||this.log.warn("Tried to add a track whose 'sid' could not be determined for a participant, that's not present. Sid: ".concat(r,", streamId: ").concat(o,", trackId: ").concat(a),Object.assign(Object.assign({},this.logContext),{rpID:r,streamId:o,trackId:a})),this.options.adaptiveStream&&(c="object"===typeof this.options.adaptiveStream?this.options.adaptiveStream:{});const l=s.addSubscribedMediaTrack(e,a,t,n,c);(null===l||void 0===l?void 0:l.isEncrypted)&&!this.e2eeManager&&this.emit(Vu.EncryptionError,new Error("Encrypted ".concat(l.source," track received from participant ").concat(s.sid,", but room does not have encryption enabled!")))}handleDisconnect(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;var n;if(this.clearConnectionReconcile(),this.isResuming=!1,this.bufferedEvents=[],this.transcriptionReceivedTimes.clear(),this.incomingDataStreamManager.clearHandlersAndControllers(),this.state!==hf.Disconnected){this.regionUrl=void 0;try{this.remoteParticipants.forEach(e=>{e.trackPublications.forEach(t=>{e.unpublishTrack(t.trackSid)})}),this.localParticipant.trackPublications.forEach(t=>{var n,i,r;t.track&&this.localParticipant.unpublishTrack(t.track,e),e?(null===(n=t.track)||void 0===n||n.detach(),null===(i=t.track)||void 0===i||i.stop()):null===(r=t.track)||void 0===r||r.stopMonitor()}),this.localParticipant.off(Hu.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Hu.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Hu.AttributesChanged,this.onLocalAttributesChanged).off(Hu.TrackMuted,this.onLocalTrackMuted).off(Hu.TrackUnmuted,this.onLocalTrackUnmuted).off(Hu.LocalTrackPublished,this.onLocalTrackPublished).off(Hu.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Hu.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Hu.MediaDevicesError,this.onMediaDevicesError).off(Hu.AudioStreamAcquired,this.startAudio).off(Hu.ChatMessage,this.onLocalChatMessageSent).off(Hu.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.trackPublications.clear(),this.localParticipant.videoTrackPublications.clear(),this.localParticipant.audioTrackPublications.clear(),this.remoteParticipants.clear(),this.sidToIdentity.clear(),this.activeSpeakers=[],this.audioContext&&"boolean"===typeof this.options.webAudioMix&&(this.audioContext.close(),this.audioContext=void 0),Md()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),null===(n=navigator.mediaDevices)||void 0===n||n.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(hf.Disconnected),this.emit(Vu.Disconnected,t)}}}handleParticipantDisconnected(e,t){var n;this.remoteParticipants.delete(e),t&&(this.incomingDataStreamManager.validateParticipantHasNoActiveDataStreams(e),t.trackPublications.forEach(e=>{t.unpublishTrack(e.trackSid,!0)}),this.emit(Vu.ParticipantDisconnected,t),t.setDisconnected(),null===(n=this.localParticipant)||void 0===n||n.handleParticipantDisconnected(t.identity))}handleIncomingRpcRequest(e,t,n,i,r,o){return kl(this,void 0,void 0,function*(){if(yield this.engine.publishRpcAck(e,t),1!==o)return void(yield this.engine.publishRpcResponse(e,t,null,fp.builtIn("UNSUPPORTED_VERSION")));const a=this.rpcHandlers.get(n);if(!a)return void(yield this.engine.publishRpcResponse(e,t,null,fp.builtIn("UNSUPPORTED_METHOD")));let s=null,c=null;try{const o=yield a({requestId:t,callerIdentity:e,payload:i,responseTimeout:r});mp(o)>15360?(s=fp.builtIn("RESPONSE_PAYLOAD_TOO_LARGE"),console.warn("RPC Response payload too large for ".concat(n))):c=o}catch(l){l instanceof fp?s=l:(console.warn("Uncaught error returned by RPC handler for ".concat(n,". Returning APPLICATION_ERROR instead."),l),s=fp.builtIn("APPLICATION_ERROR"))}yield this.engine.publishRpcResponse(e,t,c,s)})}selectDefaultDevices(){return kl(this,void 0,void 0,function*(){var e,t,n;const i=Rh.getInstance().previousDevices,r=yield Rh.getInstance().getDevices(void 0,!1),o=od();if("Chrome"===(null===o||void 0===o?void 0:o.name)&&"iOS"!==o.os)for(let s of r){const e=i.find(e=>e.deviceId===s.deviceId);e&&""!==e.label&&e.kind===s.kind&&e.label!==s.label&&"default"===this.getActiveDevice(s.kind)&&this.emit(Vu.ActiveDeviceChanged,s.kind,s.deviceId)}const a=["audiooutput","audioinput","videoinput"];for(let s of a){const o=vh(s),a=this.localParticipant.getTrackPublication(o);if(a&&(null===(e=a.track)||void 0===e?void 0:e.isUserProvided))continue;const c=r.filter(e=>e.kind===s),l=this.getActiveDevice(s);l===(null===(t=i.filter(e=>e.kind===s)[0])||void 0===t?void 0:t.deviceId)&&c.length>0&&(null===(n=c[0])||void 0===n?void 0:n.deviceId)!==l?yield this.switchActiveDevice(s,c[0].deviceId):"audioinput"===s&&!Ad()||"videoinput"===s||!(c.length>0)||c.find(e=>e.deviceId===this.getActiveDevice(s))||"audiooutput"===s&&Ad()||(yield this.switchActiveDevice(s,c[0].deviceId))}})}acquireAudioContext(){return kl(this,void 0,void 0,function*(){var e,t;if("boolean"!==typeof this.options.webAudioMix&&this.options.webAudioMix.audioContext?this.audioContext=this.options.webAudioMix.audioContext:this.audioContext&&"closed"!==this.audioContext.state||(this.audioContext=null!==(e=gh())&&void 0!==e?e:void 0),this.options.webAudioMix&&this.remoteParticipants.forEach(e=>e.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext),this.audioContext&&"suspended"===this.audioContext.state)try{yield Promise.race([this.audioContext.resume(),Ed(200)])}catch(So){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:So}))}const n="running"===(null===(t=this.audioContext)||void 0===t?void 0:t.state);n!==this.canPlaybackAudio&&(this.audioEnabled=n,this.emit(Vu.AudioPlaybackStatusChanged,n))})}createParticipant(e,t){var n;let i;return i=t?gf.fromParticipantInfo(this.engine.client,t,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}):new gf(this.engine.client,"",e,void 0,void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.webAudioMix&&i.setAudioContext(this.audioContext),(null===(n=this.options.audioOutput)||void 0===n?void 0:n.deviceId)&&i.setAudioOutput(this.options.audioOutput).catch(e=>this.log.warn("Could not set audio output: ".concat(e.message),this.logContext)),i}getOrCreateParticipant(e,t){if(this.remoteParticipants.has(e)){const n=this.remoteParticipants.get(e);if(t){n.updateInfo(t)&&this.sidToIdentity.set(t.sid,t.identity)}return n}const n=this.createParticipant(e,t);return this.remoteParticipants.set(e,n),this.sidToIdentity.set(t.sid,t.identity),this.emitWhenConnected(Vu.ParticipantConnected,n),n.on(Hu.TrackPublished,e=>{this.emitWhenConnected(Vu.TrackPublished,e,n)}).on(Hu.TrackSubscribed,(e,t)=>{e.kind===hd.Kind.Audio?(e.on(Ku.AudioPlaybackStarted,this.handleAudioPlaybackStarted),e.on(Ku.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):e.kind===hd.Kind.Video&&(e.on(Ku.VideoPlaybackFailed,this.handleVideoPlaybackFailed),e.on(Ku.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(Vu.TrackSubscribed,e,t,n)}).on(Hu.TrackUnpublished,e=>{this.emit(Vu.TrackUnpublished,e,n)}).on(Hu.TrackUnsubscribed,(e,t)=>{this.emit(Vu.TrackUnsubscribed,e,t,n)}).on(Hu.TrackMuted,e=>{this.emitWhenConnected(Vu.TrackMuted,e,n)}).on(Hu.TrackUnmuted,e=>{this.emitWhenConnected(Vu.TrackUnmuted,e,n)}).on(Hu.ParticipantMetadataChanged,e=>{this.emitWhenConnected(Vu.ParticipantMetadataChanged,e,n)}).on(Hu.ParticipantNameChanged,e=>{this.emitWhenConnected(Vu.ParticipantNameChanged,e,n)}).on(Hu.AttributesChanged,e=>{this.emitWhenConnected(Vu.ParticipantAttributesChanged,e,n)}).on(Hu.ConnectionQualityChanged,e=>{this.emitWhenConnected(Vu.ConnectionQualityChanged,e,n)}).on(Hu.ParticipantPermissionsChanged,e=>{this.emitWhenConnected(Vu.ParticipantPermissionsChanged,e,n)}).on(Hu.TrackSubscriptionStatusChanged,(e,t)=>{this.emitWhenConnected(Vu.TrackSubscriptionStatusChanged,e,t,n)}).on(Hu.TrackSubscriptionFailed,(e,t)=>{this.emit(Vu.TrackSubscriptionFailed,e,n,t)}).on(Hu.TrackSubscriptionPermissionChanged,(e,t)=>{this.emitWhenConnected(Vu.TrackSubscriptionPermissionChanged,e,t,n)}).on(Hu.Active,()=>{this.emitWhenConnected(Vu.ParticipantActive,n),n.kind===ws.AGENT&&this.localParticipant.setActiveAgent(n)}),t&&n.updateInfo(t),n}sendSyncState(){const e=Array.from(this.remoteParticipants.values()).reduce((e,t)=>(e.push(...t.getTrackPublications()),e),[]),t=this.localParticipant.getTrackPublications();this.engine.sendSyncState(e,t)}updateSubscriptions(){for(const e of this.remoteParticipants.values())for(const t of e.videoTrackPublications.values())t.isSubscribed&&uh(t)&&t.emitTrackUpdate()}getRemoteParticipantBySid(e){const t=this.sidToIdentity.get(e);if(t)return this.remoteParticipants.get(t)}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=ld.setInterval(()=>{this.engine&&!this.engine.isClosed&&this.engine.verifyTransport()?e=0:(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:this.engine?{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}:void 0})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,ps.STATE_MISMATCH)))},4e3)}clearConnectionReconcile(){this.connectionReconcileInterval&&ld.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e!==this.state&&(this.state=e,this.emit(Vu.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[t,n]=e;this.emit(t,...n)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(this.state===hf.Reconnecting||this.isResuming||!this.engine||this.engine.pendingReconnect)this.bufferedEvents.push([e,n]);else if(this.state===hf.Connected)return this.emit(e,...n);return!1}simulateParticipants(e){return kl(this,void 0,void 0,function*(){var t,n;const i=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),r=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new vs({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:Wo.parse((new Date).getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new ks({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(Vu.SignalConnected),this.emit(Vu.Connected),this.setAndEmitConnectionState(hf.Connected),i.video){const e=new lf(hd.Kind.Video,new Ps({source:ls.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:cs.AUDIO,name:"video-dummy"}),new Lp(i.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:$d(160*(null!==(t=r.aspectRatios[0])&&void 0!==t?t:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(Hu.LocalTrackPublished,e)}if(i.audio){const e=new lf(hd.Kind.Audio,new Ps({source:ls.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:cs.AUDIO}),new Tp(i.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:Yd(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(e),this.localParticipant.emit(Hu.LocalTrackPublished,e)}for(let e=0;e<r.count-1;e+=1){let t=new ks({sid:Math.floor(1e4*Math.random()).toString(),identity:"simulated-".concat(e),state:Ss.ACTIVE,tracks:[],joinedAt:Wo.parse(Date.now())});const i=this.getOrCreateParticipant(t.identity,t);if(r.video){const o=$d(160*(null!==(n=r.aspectRatios[e%r.aspectRatios.length])&&void 0!==n?n:1),160,!1,!0),a=new Ps({source:ls.CAMERA,sid:Math.floor(1e4*Math.random()).toString(),type:cs.AUDIO});i.addSubscribedMediaTrack(o,a.sid,new MediaStream([o]),new RTCRtpReceiver),t.tracks=[...t.tracks,a]}if(r.audio){const e=Yd(),n=new Ps({source:ls.MICROPHONE,sid:Math.floor(1e4*Math.random()).toString(),type:cs.AUDIO});i.addSubscribedMediaTrack(e,n.sid,new MediaStream([e]),new RTCRtpReceiver),t.tracks=[...t.tracks,n]}i.updateInfo(t)}})}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e!==Vu.ActiveSpeakersChanged&&e!==Vu.TranscriptionReceived){const t=yf(n).filter(e=>void 0!==e);e!==Vu.TrackSubscribed&&e!==Vu.TrackUnsubscribed||this.log.trace("subscribe trace: ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:t})),this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:t}))}return super.emit(e,...n)}}function yf(e){return e.map(e=>{if(e)return Array.isArray(e)?yf(e):"object"===typeof e?"logContext"in e?e.logContext:void 0:e})}vf.cleanupRegistry="undefined"!==typeof FinalizationRegistry&&new FinalizationRegistry(e=>{e()});var bf;!function(e){e[e.IDLE=0]="IDLE",e[e.RUNNING=1]="RUNNING",e[e.SKIPPED=2]="SKIPPED",e[e.SUCCESS=3]="SUCCESS",e[e.FAILED=4]="FAILED"}(bf||(bf={}));El.EventEmitter;El.EventEmitter;function kf(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t);if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}new TextEncoder;new TextDecoder;class Sf extends Error{constructor(e,t){var n;super(e,t),kf(this,"code","ERR_JOSE_GENERIC"),this.name=this.constructor.name,null===(n=Error.captureStackTrace)||void 0===n||n.call(Error,this,this.constructor)}}kf(Sf,"code","ERR_JOSE_GENERIC");kf(class extends Sf{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";super(e,{cause:{claim:n,reason:i,payload:t}}),kf(this,"code","ERR_JWT_CLAIM_VALIDATION_FAILED"),kf(this,"claim",void 0),kf(this,"reason",void 0),kf(this,"payload",void 0),this.claim=n,this.reason=i,this.payload=t}},"code","ERR_JWT_CLAIM_VALIDATION_FAILED");kf(class extends Sf{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"unspecified",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"unspecified";super(e,{cause:{claim:n,reason:i,payload:t}}),kf(this,"code","ERR_JWT_EXPIRED"),kf(this,"claim",void 0),kf(this,"reason",void 0),kf(this,"payload",void 0),this.claim=n,this.reason=i,this.payload=t}},"code","ERR_JWT_EXPIRED");kf(class extends Sf{constructor(){super(...arguments),kf(this,"code","ERR_JOSE_ALG_NOT_ALLOWED")}},"code","ERR_JOSE_ALG_NOT_ALLOWED");kf(class extends Sf{constructor(){super(...arguments),kf(this,"code","ERR_JOSE_NOT_SUPPORTED")}},"code","ERR_JOSE_NOT_SUPPORTED");kf(class extends Sf{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"decryption operation failed",arguments.length>1?arguments[1]:void 0),kf(this,"code","ERR_JWE_DECRYPTION_FAILED")}},"code","ERR_JWE_DECRYPTION_FAILED");kf(class extends Sf{constructor(){super(...arguments),kf(this,"code","ERR_JWE_INVALID")}},"code","ERR_JWE_INVALID");kf(class extends Sf{constructor(){super(...arguments),kf(this,"code","ERR_JWS_INVALID")}},"code","ERR_JWS_INVALID");class wf extends Sf{constructor(){super(...arguments),kf(this,"code","ERR_JWT_INVALID")}}kf(wf,"code","ERR_JWT_INVALID");kf(class extends Sf{constructor(){super(...arguments),kf(this,"code","ERR_JWK_INVALID")}},"code","ERR_JWK_INVALID");kf(class extends Sf{constructor(){super(...arguments),kf(this,"code","ERR_JWKS_INVALID")}},"code","ERR_JWKS_INVALID");kf(class extends Sf{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"no applicable key found in the JSON Web Key Set",arguments.length>1?arguments[1]:void 0),kf(this,"code","ERR_JWKS_NO_MATCHING_KEY")}},"code","ERR_JWKS_NO_MATCHING_KEY");kf(class extends Sf{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"multiple matching keys found in the JSON Web Key Set",arguments.length>1?arguments[1]:void 0),kf(this,Symbol.asyncIterator,void 0),kf(this,"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS")}},"code","ERR_JWKS_MULTIPLE_MATCHING_KEYS");kf(class extends Sf{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"request timed out",arguments.length>1?arguments[1]:void 0),kf(this,"code","ERR_JWKS_TIMEOUT")}},"code","ERR_JWKS_TIMEOUT");kf(class extends Sf{constructor(){super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"signature verification failed",arguments.length>1?arguments[1]:void 0),kf(this,"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED")}},"code","ERR_JWS_SIGNATURE_VERIFICATION_FAILED");new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);const Tf=bo("http://localhost:5000",{autoConnect:!0});const Cf=function(){const e=ve(),t=localStorage.getItem("username")||"Guest",n=localStorage.getItem("userId"),[i,r]=(0,o.useState)([]),[a,s]=(0,o.useState)(null),[c,l]=(0,o.useState)(null),[u,d]=(0,o.useState)(null),h=(0,o.useRef)(null),p=(0,o.useRef)(null),f=(0,o.useRef)(null);(0,o.useEffect)(()=>{(async()=>{try{const e=await Ki.get("http://localhost:5000/api/auth/all-users");r(e.data.filter(e=>e.username!==t))}catch(xf){console.error(xf)}})(),Tf.emit("register-user",{userId:n||t,userName:t})},[t,n]);const m=async(e,t)=>{try{var n;console.log("\ud83d\udcde Accepting call for room: ".concat(e));const i=await fetch("http://localhost:5000/api/livekit/token",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomName:e,userName:t})}),r=await i.json();if(!r.token)throw new Error("No token received from backend!");console.log("\u2705 LiveKit token received:",r.token);const o=new vf;o.on(Vu.Connected,()=>{console.log("\ud83c\udfa5 Connected to LiveKit room successfully!")}),o.on(Vu.Disconnected,()=>{console.log("\u274c Disconnected from LiveKit room"),v(),d(null)}),await o.connect("wss://video-chat-wfvq5jjj.livekit.cloud",r.token),await o.localParticipant.setMicrophoneEnabled(!0),await o.localParticipant.setCameraEnabled(!0),o.localParticipant.on("trackPublished",e=>{if("video"===e.kind&&e.track&&h.current){const t=e.track.attach();h.current.srcObject=t.srcObject,console.log("\ud83d\udcf7 Local track attached dynamically")}});const a=null===(n=o.localParticipant)||void 0===n?void 0:n.videoTracks;a&&"function"===typeof a.forEach?a.forEach(e=>{if(e.track&&h.current){const t=e.track.attach();h.current.srcObject=t.srcObject,console.log("\ud83d\udcf9 Local track attached immediately")}}):console.warn("\u26a0\ufe0f No local video tracks available yet."),console.log("Local tracks:",o.localParticipant.videoTracks),o.on(Vu.ParticipantConnected,e=>{console.log("\ud83d\udc65 Remote participant joined:",e.identity),e.on("trackSubscribed",e=>{if("video"===e.kind&&p.current){const t=e.attach();p.current.srcObject=t.srcObject,console.log("\ud83c\udfa5 Remote video attached")}})}),o.participants&&o.participants.size>0?(console.log("\ud83e\udde9 Existing participants:",[...o.participants.keys()]),o.participants.forEach(e=>{(e.tracks?Array.from(e.tracks.values()):[]).forEach(e=>{if(e.track&&p.current&&"video"===e.track.kind){const t=e.track.attach();p.current.srcObject=t.srcObject,console.log("\ud83c\udf9e\ufe0f Attached pre-existing remote video track")}})})):console.log("\u2139\ufe0f No existing participants at the moment (will join soon)."),f.current=o,d(o)}catch(i){console.error("\u274c Failed to join LiveKit room:",i),alert("Could not connect to call. Check console for details.")}};(0,o.useEffect)(()=>(Tf.on("incoming-call",e=>{let{fromUserId:t,fromUserName:n,roomName:i}=e;l({id:t,name:n,roomName:i}),console.log("\ud83d\udce9 Incoming call:",n,i)}),Tf.on("call-response",e=>{let{accepted:n,roomName:i}=e;n?m(i,t):alert("Call declined by user."),console.log("\ud83d\udcf2 Call response:",n,i)}),()=>{Tf.off("incoming-call"),Tf.off("call-response")}),[t]);const g=()=>{localStorage.clear(),e("/login")},v=()=>{h.current&&(h.current.srcObject=null),p.current&&(p.current.srcObject=null)};return(0,Gi.jsxs)("div",{className:"d-flex vh-100 bg-light",children:[(0,Gi.jsxs)("div",{className:"bg-white shadow p-3",style:{width:"220px"},children:[(0,Gi.jsx)("h5",{className:"mb-3",children:"Registered Users"}),(0,Gi.jsx)("ul",{className:"list-group",children:i.map(e=>(0,Gi.jsx)("li",{className:"list-group-item ".concat(a===e?"active":""),style:{cursor:"pointer"},onClick:()=>s(a===e?null:e),children:e.username},e._id))})]}),(0,Gi.jsxs)("div",{className:"flex-grow-1 d-flex justify-content-center align-items-center position-relative",children:[!a&&(0,Gi.jsxs)("div",{className:"card shadow p-5 w-100 h-100",children:[(0,Gi.jsx)("button",{className:"btn btn-sm btn-danger position-absolute",style:{top:10,right:10},onClick:g,children:"Logout"}),(0,Gi.jsxs)("h1",{className:"mb-3 text-center",children:["Hello, ",t," \ud83d\udc4b"]}),(0,Gi.jsx)("p",{className:"text-secondary text-center",children:"Welcome to your dashboard"})]}),a&&(0,Gi.jsxs)("div",{className:"card shadow position-relative w-100 h-100 p-3",children:[(0,Gi.jsx)("button",{className:"btn btn-sm btn-danger position-absolute",style:{top:10,right:10},onClick:g,children:"Logout"}),(0,Gi.jsxs)("h5",{children:["Chat with ",a.username]}),!u&&!c&&(0,Gi.jsx)("button",{className:"btn btn-success my-2",onClick:()=>{if(!a)return alert("Select a user first.");const e=a._id,i=n||t,r="room_".concat([t,a.username].sort().join("_"));Tf.emit("call-user",{toUserId:e,fromUserId:i,roomName:r}),alert("Calling ".concat(a.username,"... waiting for acceptance."))},children:"Start Video Call"}),c&&(0,Gi.jsxs)("div",{className:"alert alert-info mt-3",children:["Incoming call from ",(0,Gi.jsx)("strong",{children:c.name}),(0,Gi.jsxs)("div",{className:"mt-2",children:[(0,Gi.jsx)("button",{className:"btn btn-sm btn-primary me-2",onClick:()=>{c&&(Tf.emit("call-response",{toUserId:c.id,accepted:!0,roomName:c.roomName}),l(null),m(c.roomName,t))},children:"Accept"}),(0,Gi.jsx)("button",{className:"btn btn-sm btn-danger",onClick:()=>{c&&(Tf.emit("call-response",{toUserId:c.id,accepted:!1}),l(null))},children:"Decline"})]})]}),u&&(0,Gi.jsxs)("div",{className:"video-container d-flex justify-content-center align-items-center mt-3 w-100 h-100",children:[(0,Gi.jsx)("video",{ref:h,autoPlay:!0,muted:!0,playsInline:!0,className:"local-video",style:{width:"50%",marginRight:"10px"}}),(0,Gi.jsx)("video",{ref:p,autoPlay:!0,playsInline:!0,className:"remote-video",style:{width:"50%"}}),(0,Gi.jsx)("div",{className:"position-absolute",style:{bottom:20,right:20},children:(0,Gi.jsx)("button",{className:"btn btn-danger",onClick:()=>{f.current&&(f.current.disconnect(),d(null),v())},children:"End Call"})})]})]})]})]})},Ef=(0,o.createContext)(),Pf=e=>{let{children:t}=e;const[n,i]=(0,o.useState)(null),[r,a]=(0,o.useState)([]),[s,c]=(0,o.useState)(!1);return(0,Gi.jsx)(Ef.Provider,{value:{joinRoom:async(e,t)=>{try{const n=(await Ki.post("http://localhost:5000/api/livekit/token",{userName:e,roomName:t})).data.token;if(console.log("\u2705 LiveKit token received:",n),!n||"string"!==typeof n)throw new Error("Invalid token received from backend");const r=new vf;r.on(Vu.ParticipantConnected,e=>{console.log("\ud83d\udc65 Participant connected:",e.identity),a(t=>[...t,e])}),r.on(Vu.ParticipantDisconnected,e=>{console.log("\ud83d\udeaa Participant disconnected:",e.identity),a(t=>t.filter(t=>t.identity!==e.identity))}),r.on(Vu.Disconnected,()=>{console.log("\u274c Disconnected from LiveKit room"),c(!1),i(null),a([])});const o="wss://video-chat-wfvq5jjj.livekit.cloud";if(!o)throw new Error("Missing REACT_APP_LIVEKIT_URL in .env file");await r.connect(o,n),i(r),c(!0),console.log("\u2705 Connected to LiveKit room:",t);const s=await uf({audio:!0,video:!0});for(const e of s)await r.localParticipant.publishTrack(e);console.log("\ud83c\udfa5 Local tracks published")}catch(n){console.error("\u274c Error joining LiveKit room:",n)}},leaveRoom:async()=>{n&&(await n.disconnect(),i(null),c(!1),a([]),console.log("\ud83d\udc4b Left the room"))},room:n,participants:r,isConnected:s},children:t})},Rf=()=>{const{registerUser:e,callUser:t,respondToCall:n,incomingCall:i,inCall:r}=(0,o.useContext)(Ef),[a,s]=(0,o.useState)(""),[c,l]=(0,o.useState)(""),[u,d]=(0,o.useState)(""),[h,p]=(0,o.useState)("");return(0,Gi.jsxs)("div",{className:"p-4 container text-center",children:[(0,Gi.jsx)("h1",{className:"text-2xl fw-bold mb-3",children:"\ud83c\udfa5 LiveKit Video Call"}),r?(0,Gi.jsx)("p",{className:"text-success fs-5 fw-bold mt-4",children:"\u2705 In Call"}):(0,Gi.jsxs)(Gi.Fragment,{children:[(0,Gi.jsxs)("div",{className:"mb-3",children:[(0,Gi.jsx)("input",{className:"form-control mb-2",placeholder:"Your User ID",value:a,onChange:e=>s(e.target.value)}),(0,Gi.jsx)("input",{className:"form-control mb-2",placeholder:"Your Name",value:c,onChange:e=>l(e.target.value)}),(0,Gi.jsx)("button",{onClick:()=>{if(!a||!c)return alert("Enter your ID and Name first!");e(a,c)},className:"btn btn-primary w-100",children:"Register"})]}),(0,Gi.jsx)("hr",{}),(0,Gi.jsxs)("div",{className:"mb-3",children:[(0,Gi.jsx)("input",{className:"form-control mb-2",placeholder:"Target User ID",value:u,onChange:e=>d(e.target.value)}),(0,Gi.jsx)("input",{className:"form-control mb-2",placeholder:"Room Name",value:h,onChange:e=>p(e.target.value)}),(0,Gi.jsx)("button",{onClick:()=>{if(!u||!h)return alert("Enter target user & room name");t(u,h)},className:"btn btn-success w-100",children:"Call User"})]}),i&&(0,Gi.jsxs)("div",{className:"alert alert-info mt-4",children:[(0,Gi.jsxs)("p",{children:["\ud83d\udcde Incoming call from ",(0,Gi.jsx)("b",{children:i.fromUserName})]}),(0,Gi.jsx)("button",{onClick:()=>n(!0,i.roomName,i.fromUserId),className:"btn btn-success mx-2",children:"Accept"}),(0,Gi.jsx)("button",{onClick:()=>n(!1,i.roomName,i.fromUserId),className:"btn btn-danger mx-2",children:"Reject"})]})]})]})};const _f=function(){return(0,Gi.jsx)(Pf,{children:(0,Gi.jsx)(mt,{children:(0,Gi.jsxs)(Me,{children:[(0,Gi.jsx)(De,{path:"/register",element:(0,Gi.jsx)(Ji,{})}),(0,Gi.jsx)(De,{path:"/login",element:(0,Gi.jsx)(Qi,{})}),(0,Gi.jsx)(De,{path:"/home",element:(0,Gi.jsx)(Cf,{})}),(0,Gi.jsx)(De,{path:"/call",element:(0,Gi.jsx)(Rf,{})})]})})})},Of=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then(t=>{let{getCLS:n,getFID:i,getFCP:r,getLCP:o,getTTFB:a}=t;n(e),i(e),r(e),o(e),a(e)})};a.createRoot(document.getElementById("root")).render((0,Gi.jsx)(o.StrictMode,{children:(0,Gi.jsx)(_f,{})})),Of()})();
//# sourceMappingURL=main.9ecc0e3a.js.map